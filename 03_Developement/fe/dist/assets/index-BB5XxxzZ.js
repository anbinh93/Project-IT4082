var rS=Object.defineProperty;var sS=(e,t,n)=>t in e?rS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Pe=(e,t,n)=>sS(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}})();function iS(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var fd={exports:{}},vo={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D1;function lS(){if(D1)return vo;D1=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(a,r,l){var o=null;if(l!==void 0&&(o=""+l),r.key!==void 0&&(o=""+r.key),"key"in r){l={};for(var h in r)h!=="key"&&(l[h]=r[h])}else l=r;return r=l.ref,{$$typeof:e,type:a,key:o,ref:r!==void 0?r:null,props:l}}return vo.Fragment=t,vo.jsx=n,vo.jsxs=n,vo}var O1;function oS(){return O1||(O1=1,fd.exports=lS()),fd.exports}var u=oS(),dd={exports:{}},qe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M1;function cS(){if(M1)return qe;M1=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),p=Symbol.iterator;function y(Y){return Y===null||typeof Y!="object"?null:(Y=p&&Y[p]||Y["@@iterator"],typeof Y=="function"?Y:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,b={};function T(Y,de,H){this.props=Y,this.context=de,this.refs=b,this.updater=H||_}T.prototype.isReactComponent={},T.prototype.setState=function(Y,de){if(typeof Y!="object"&&typeof Y!="function"&&Y!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Y,de,"setState")},T.prototype.forceUpdate=function(Y){this.updater.enqueueForceUpdate(this,Y,"forceUpdate")};function S(){}S.prototype=T.prototype;function E(Y,de,H){this.props=Y,this.context=de,this.refs=b,this.updater=H||_}var C=E.prototype=new S;C.constructor=E,w(C,T.prototype),C.isPureReactComponent=!0;var A=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},K=Object.prototype.hasOwnProperty;function O(Y,de,H,Z,j,V){return H=V.ref,{$$typeof:e,type:Y,key:de,ref:H!==void 0?H:null,props:V}}function P(Y,de){return O(Y.type,de,void 0,void 0,void 0,Y.props)}function M(Y){return typeof Y=="object"&&Y!==null&&Y.$$typeof===e}function B(Y){var de={"=":"=0",":":"=2"};return"$"+Y.replace(/[=:]/g,function(H){return de[H]})}var I=/\/+/g;function te(Y,de){return typeof Y=="object"&&Y!==null&&Y.key!=null?B(""+Y.key):de.toString(36)}function q(){}function ae(Y){switch(Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason;default:switch(typeof Y.status=="string"?Y.then(q,q):(Y.status="pending",Y.then(function(de){Y.status==="pending"&&(Y.status="fulfilled",Y.value=de)},function(de){Y.status==="pending"&&(Y.status="rejected",Y.reason=de)})),Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason}}throw Y}function re(Y,de,H,Z,j){var V=typeof Y;(V==="undefined"||V==="boolean")&&(Y=null);var U=!1;if(Y===null)U=!0;else switch(V){case"bigint":case"string":case"number":U=!0;break;case"object":switch(Y.$$typeof){case e:case t:U=!0;break;case g:return U=Y._init,re(U(Y._payload),de,H,Z,j)}}if(U)return j=j(Y),U=Z===""?"."+te(Y,0):Z,A(j)?(H="",U!=null&&(H=U.replace(I,"$&/")+"/"),re(j,de,H,"",function(_e){return _e})):j!=null&&(M(j)&&(j=P(j,H+(j.key==null||Y&&Y.key===j.key?"":(""+j.key).replace(I,"$&/")+"/")+U)),de.push(j)),1;U=0;var Te=Z===""?".":Z+":";if(A(Y))for(var ie=0;ie<Y.length;ie++)Z=Y[ie],V=Te+te(Z,ie),U+=re(Z,de,H,V,j);else if(ie=y(Y),typeof ie=="function")for(Y=ie.call(Y),ie=0;!(Z=Y.next()).done;)Z=Z.value,V=Te+te(Z,ie++),U+=re(Z,de,H,V,j);else if(V==="object"){if(typeof Y.then=="function")return re(ae(Y),de,H,Z,j);throw de=String(Y),Error("Objects are not valid as a React child (found: "+(de==="[object Object]"?"object with keys {"+Object.keys(Y).join(", ")+"}":de)+"). If you meant to render a collection of children, use an array instead.")}return U}function ee(Y,de,H){if(Y==null)return Y;var Z=[],j=0;return re(Y,Z,"","",function(V){return de.call(H,V,j++)}),Z}function Q(Y){if(Y._status===-1){var de=Y._result;de=de(),de.then(function(H){(Y._status===0||Y._status===-1)&&(Y._status=1,Y._result=H)},function(H){(Y._status===0||Y._status===-1)&&(Y._status=2,Y._result=H)}),Y._status===-1&&(Y._status=0,Y._result=de)}if(Y._status===1)return Y._result.default;throw Y._result}var me=typeof reportError=="function"?reportError:function(Y){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var de=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Y=="object"&&Y!==null&&typeof Y.message=="string"?String(Y.message):String(Y),error:Y});if(!window.dispatchEvent(de))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Y);return}console.error(Y)};function ye(){}return qe.Children={map:ee,forEach:function(Y,de,H){ee(Y,function(){de.apply(this,arguments)},H)},count:function(Y){var de=0;return ee(Y,function(){de++}),de},toArray:function(Y){return ee(Y,function(de){return de})||[]},only:function(Y){if(!M(Y))throw Error("React.Children.only expected to receive a single React element child.");return Y}},qe.Component=T,qe.Fragment=n,qe.Profiler=r,qe.PureComponent=E,qe.StrictMode=a,qe.Suspense=f,qe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,qe.__COMPILER_RUNTIME={__proto__:null,c:function(Y){return F.H.useMemoCache(Y)}},qe.cache=function(Y){return function(){return Y.apply(null,arguments)}},qe.cloneElement=function(Y,de,H){if(Y==null)throw Error("The argument must be a React element, but you passed "+Y+".");var Z=w({},Y.props),j=Y.key,V=void 0;if(de!=null)for(U in de.ref!==void 0&&(V=void 0),de.key!==void 0&&(j=""+de.key),de)!K.call(de,U)||U==="key"||U==="__self"||U==="__source"||U==="ref"&&de.ref===void 0||(Z[U]=de[U]);var U=arguments.length-2;if(U===1)Z.children=H;else if(1<U){for(var Te=Array(U),ie=0;ie<U;ie++)Te[ie]=arguments[ie+2];Z.children=Te}return O(Y.type,j,void 0,void 0,V,Z)},qe.createContext=function(Y){return Y={$$typeof:o,_currentValue:Y,_currentValue2:Y,_threadCount:0,Provider:null,Consumer:null},Y.Provider=Y,Y.Consumer={$$typeof:l,_context:Y},Y},qe.createElement=function(Y,de,H){var Z,j={},V=null;if(de!=null)for(Z in de.key!==void 0&&(V=""+de.key),de)K.call(de,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(j[Z]=de[Z]);var U=arguments.length-2;if(U===1)j.children=H;else if(1<U){for(var Te=Array(U),ie=0;ie<U;ie++)Te[ie]=arguments[ie+2];j.children=Te}if(Y&&Y.defaultProps)for(Z in U=Y.defaultProps,U)j[Z]===void 0&&(j[Z]=U[Z]);return O(Y,V,void 0,void 0,null,j)},qe.createRef=function(){return{current:null}},qe.forwardRef=function(Y){return{$$typeof:h,render:Y}},qe.isValidElement=M,qe.lazy=function(Y){return{$$typeof:g,_payload:{_status:-1,_result:Y},_init:Q}},qe.memo=function(Y,de){return{$$typeof:x,type:Y,compare:de===void 0?null:de}},qe.startTransition=function(Y){var de=F.T,H={};F.T=H;try{var Z=Y(),j=F.S;j!==null&&j(H,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(ye,me)}catch(V){me(V)}finally{F.T=de}},qe.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},qe.use=function(Y){return F.H.use(Y)},qe.useActionState=function(Y,de,H){return F.H.useActionState(Y,de,H)},qe.useCallback=function(Y,de){return F.H.useCallback(Y,de)},qe.useContext=function(Y){return F.H.useContext(Y)},qe.useDebugValue=function(){},qe.useDeferredValue=function(Y,de){return F.H.useDeferredValue(Y,de)},qe.useEffect=function(Y,de,H){var Z=F.H;if(typeof H=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Z.useEffect(Y,de)},qe.useId=function(){return F.H.useId()},qe.useImperativeHandle=function(Y,de,H){return F.H.useImperativeHandle(Y,de,H)},qe.useInsertionEffect=function(Y,de){return F.H.useInsertionEffect(Y,de)},qe.useLayoutEffect=function(Y,de){return F.H.useLayoutEffect(Y,de)},qe.useMemo=function(Y,de){return F.H.useMemo(Y,de)},qe.useOptimistic=function(Y,de){return F.H.useOptimistic(Y,de)},qe.useReducer=function(Y,de,H){return F.H.useReducer(Y,de,H)},qe.useRef=function(Y){return F.H.useRef(Y)},qe.useState=function(Y){return F.H.useState(Y)},qe.useSyncExternalStore=function(Y,de,H){return F.H.useSyncExternalStore(Y,de,H)},qe.useTransition=function(){return F.H.useTransition()},qe.version="19.1.0",qe}var R1;function sx(){return R1||(R1=1,dd.exports=cS()),dd.exports}var k=sx();const Uh=iS(k);var xd={exports:{}},bo={},gd={exports:{}},md={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F1;function uS(){return F1||(F1=1,function(e){function t(ee,Q){var me=ee.length;ee.push(Q);e:for(;0<me;){var ye=me-1>>>1,Y=ee[ye];if(0<r(Y,Q))ee[ye]=Q,ee[me]=Y,me=ye;else break e}}function n(ee){return ee.length===0?null:ee[0]}function a(ee){if(ee.length===0)return null;var Q=ee[0],me=ee.pop();if(me!==Q){ee[0]=me;e:for(var ye=0,Y=ee.length,de=Y>>>1;ye<de;){var H=2*(ye+1)-1,Z=ee[H],j=H+1,V=ee[j];if(0>r(Z,me))j<Y&&0>r(V,Z)?(ee[ye]=V,ee[j]=me,ye=j):(ee[ye]=Z,ee[H]=me,ye=H);else if(j<Y&&0>r(V,me))ee[ye]=V,ee[j]=me,ye=j;else break e}}return Q}function r(ee,Q){var me=ee.sortIndex-Q.sortIndex;return me!==0?me:ee.id-Q.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,h=o.now();e.unstable_now=function(){return o.now()-h}}var f=[],x=[],g=1,p=null,y=3,_=!1,w=!1,b=!1,T=!1,S=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function A(ee){for(var Q=n(x);Q!==null;){if(Q.callback===null)a(x);else if(Q.startTime<=ee)a(x),Q.sortIndex=Q.expirationTime,t(f,Q);else break;Q=n(x)}}function F(ee){if(b=!1,A(ee),!w)if(n(f)!==null)w=!0,K||(K=!0,te());else{var Q=n(x);Q!==null&&re(F,Q.startTime-ee)}}var K=!1,O=-1,P=5,M=-1;function B(){return T?!0:!(e.unstable_now()-M<P)}function I(){if(T=!1,K){var ee=e.unstable_now();M=ee;var Q=!0;try{e:{w=!1,b&&(b=!1,E(O),O=-1),_=!0;var me=y;try{t:{for(A(ee),p=n(f);p!==null&&!(p.expirationTime>ee&&B());){var ye=p.callback;if(typeof ye=="function"){p.callback=null,y=p.priorityLevel;var Y=ye(p.expirationTime<=ee);if(ee=e.unstable_now(),typeof Y=="function"){p.callback=Y,A(ee),Q=!0;break t}p===n(f)&&a(f),A(ee)}else a(f);p=n(f)}if(p!==null)Q=!0;else{var de=n(x);de!==null&&re(F,de.startTime-ee),Q=!1}}break e}finally{p=null,y=me,_=!1}Q=void 0}}finally{Q?te():K=!1}}}var te;if(typeof C=="function")te=function(){C(I)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,ae=q.port2;q.port1.onmessage=I,te=function(){ae.postMessage(null)}}else te=function(){S(I,0)};function re(ee,Q){O=S(function(){ee(e.unstable_now())},Q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_next=function(ee){switch(y){case 1:case 2:case 3:var Q=3;break;default:Q=y}var me=y;y=Q;try{return ee()}finally{y=me}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(ee,Q){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var me=y;y=ee;try{return Q()}finally{y=me}},e.unstable_scheduleCallback=function(ee,Q,me){var ye=e.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?ye+me:ye):me=ye,ee){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=me+Y,ee={id:g++,callback:Q,priorityLevel:ee,startTime:me,expirationTime:Y,sortIndex:-1},me>ye?(ee.sortIndex=me,t(x,ee),n(f)===null&&ee===n(x)&&(b?(E(O),O=-1):b=!0,re(F,me-ye))):(ee.sortIndex=Y,t(f,ee),w||_||(w=!0,K||(K=!0,te()))),ee},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(ee){var Q=y;return function(){var me=y;y=Q;try{return ee.apply(this,arguments)}finally{y=me}}}}(md)),md}var L1;function hS(){return L1||(L1=1,gd.exports=uS()),gd.exports}var pd={exports:{}},En={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B1;function fS(){if(B1)return En;B1=1;var e=sx();function t(f){var x="https://react.dev/errors/"+f;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)x+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+f+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var a={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function l(f,x,g){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:p==null?null:""+p,children:f,containerInfo:x,implementation:g}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(f,x){if(f==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return En.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,En.createPortal=function(f,x){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(t(299));return l(f,x,null,g)},En.flushSync=function(f){var x=o.T,g=a.p;try{if(o.T=null,a.p=2,f)return f()}finally{o.T=x,a.p=g,a.d.f()}},En.preconnect=function(f,x){typeof f=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,a.d.C(f,x))},En.prefetchDNS=function(f){typeof f=="string"&&a.d.D(f)},En.preinit=function(f,x){if(typeof f=="string"&&x&&typeof x.as=="string"){var g=x.as,p=h(g,x.crossOrigin),y=typeof x.integrity=="string"?x.integrity:void 0,_=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;g==="style"?a.d.S(f,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:p,integrity:y,fetchPriority:_}):g==="script"&&a.d.X(f,{crossOrigin:p,integrity:y,fetchPriority:_,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},En.preinitModule=function(f,x){if(typeof f=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var g=h(x.as,x.crossOrigin);a.d.M(f,{crossOrigin:g,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&a.d.M(f)},En.preload=function(f,x){if(typeof f=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var g=x.as,p=h(g,x.crossOrigin);a.d.L(f,g,{crossOrigin:p,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},En.preloadModule=function(f,x){if(typeof f=="string")if(x){var g=h(x.as,x.crossOrigin);a.d.m(f,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:g,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else a.d.m(f)},En.requestFormReset=function(f){a.d.r(f)},En.unstable_batchedUpdates=function(f,x){return f(x)},En.useFormState=function(f,x,g){return o.H.useFormState(f,x,g)},En.useFormStatus=function(){return o.H.useHostTransitionStatus()},En.version="19.1.0",En}var H1;function t2(){if(H1)return pd.exports;H1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),pd.exports=fS(),pd.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P1;function dS(){if(P1)return bo;P1=1;var e=hS(),t=sx(),n=t2();function a(s){var i="https://react.dev/errors/"+s;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var i=s,c=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(c=i.return),s=i.return;while(s)}return i.tag===3?c:null}function o(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function h(s){if(l(s)!==s)throw Error(a(188))}function f(s){var i=s.alternate;if(!i){if(i=l(s),i===null)throw Error(a(188));return i!==s?null:s}for(var c=s,d=i;;){var m=c.return;if(m===null)break;var v=m.alternate;if(v===null){if(d=m.return,d!==null){c=d;continue}break}if(m.child===v.child){for(v=m.child;v;){if(v===c)return h(m),s;if(v===d)return h(m),i;v=v.sibling}throw Error(a(188))}if(c.return!==d.return)c=m,d=v;else{for(var N=!1,R=m.child;R;){if(R===c){N=!0,c=m,d=v;break}if(R===d){N=!0,d=m,c=v;break}R=R.sibling}if(!N){for(R=v.child;R;){if(R===c){N=!0,c=v,d=m;break}if(R===d){N=!0,d=v,c=m;break}R=R.sibling}if(!N)throw Error(a(189))}}if(c.alternate!==d)throw Error(a(190))}if(c.tag!==3)throw Error(a(188));return c.stateNode.current===c?s:i}function x(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s;for(s=s.child;s!==null;){if(i=x(s),i!==null)return i;s=s.sibling}return null}var g=Object.assign,p=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),E=Symbol.for("react.consumer"),C=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),K=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function te(s){return s===null||typeof s!="object"?null:(s=I&&s[I]||s["@@iterator"],typeof s=="function"?s:null)}var q=Symbol.for("react.client.reference");function ae(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===q?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case w:return"Fragment";case T:return"Profiler";case b:return"StrictMode";case F:return"Suspense";case K:return"SuspenseList";case M:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case _:return"Portal";case C:return(s.displayName||"Context")+".Provider";case E:return(s._context.displayName||"Context")+".Consumer";case A:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case O:return i=s.displayName||null,i!==null?i:ae(s.type)||"Memo";case P:i=s._payload,s=s._init;try{return ae(s(i))}catch{}}return null}var re=Array.isArray,ee=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me={pending:!1,data:null,method:null,action:null},ye=[],Y=-1;function de(s){return{current:s}}function H(s){0>Y||(s.current=ye[Y],ye[Y]=null,Y--)}function Z(s,i){Y++,ye[Y]=s.current,s.current=i}var j=de(null),V=de(null),U=de(null),Te=de(null);function ie(s,i){switch(Z(U,i),Z(V,s),Z(j,null),i.nodeType){case 9:case 11:s=(s=i.documentElement)&&(s=s.namespaceURI)?s1(s):0;break;default:if(s=i.tagName,i=i.namespaceURI)i=s1(i),s=i1(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}H(j),Z(j,s)}function _e(){H(j),H(V),H(U)}function Ne(s){s.memoizedState!==null&&Z(Te,s);var i=j.current,c=i1(i,s.type);i!==c&&(Z(V,s),Z(j,c))}function Ie(s){V.current===s&&(H(j),H(V)),Te.current===s&&(H(Te),xo._currentValue=me)}var Ue=Object.prototype.hasOwnProperty,at=e.unstable_scheduleCallback,Ye=e.unstable_cancelCallback,nn=e.unstable_shouldYield,xt=e.unstable_requestPaint,Fe=e.unstable_now,ft=e.unstable_getCurrentPriorityLevel,pe=e.unstable_ImmediatePriority,ke=e.unstable_UserBlockingPriority,ze=e.unstable_NormalPriority,et=e.unstable_LowPriority,Dt=e.unstable_IdlePriority,lt=e.log,Bn=e.unstable_setDisableYieldValue,Ea=null,fn=null;function Sn(s){if(typeof lt=="function"&&Bn(s),fn&&typeof fn.setStrictMode=="function")try{fn.setStrictMode(Ea,s)}catch{}}var On=Math.clz32?Math.clz32:Ec,Sc=Math.log,Nc=Math.LN2;function Ec(s){return s>>>=0,s===0?32:31-(Sc(s)/Nc|0)|0}var bs=256,_s=4194304;function za(s){var i=s&42;if(i!==0)return i;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function fi(s,i,c){var d=s.pendingLanes;if(d===0)return 0;var m=0,v=s.suspendedLanes,N=s.pingedLanes;s=s.warmLanes;var R=d&134217727;return R!==0?(d=R&~v,d!==0?m=za(d):(N&=R,N!==0?m=za(N):c||(c=R&~s,c!==0&&(m=za(c))))):(R=d&~v,R!==0?m=za(R):N!==0?m=za(N):c||(c=d&~s,c!==0&&(m=za(c)))),m===0?0:i!==0&&i!==m&&(i&v)===0&&(v=m&-m,c=i&-i,v>=c||v===32&&(c&4194048)!==0)?i:m}function ws(s,i){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&i)===0}function Cc(s,i){switch(s){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bl(){var s=bs;return bs<<=1,(bs&4194048)===0&&(bs=256),s}function _l(){var s=_s;return _s<<=1,(_s&62914560)===0&&(_s=4194304),s}function wl(s){for(var i=[],c=0;31>c;c++)i.push(s);return i}function Ts(s,i){s.pendingLanes|=i,i!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function di(s,i,c,d,m,v){var N=s.pendingLanes;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=c,s.entangledLanes&=c,s.errorRecoveryDisabledLanes&=c,s.shellSuspendCounter=0;var R=s.entanglements,J=s.expirationTimes,ce=s.hiddenUpdates;for(c=N&~c;0<c;){var we=31-On(c),Ee=1<<we;R[we]=0,J[we]=-1;var fe=ce[we];if(fe!==null)for(ce[we]=null,we=0;we<fe.length;we++){var ge=fe[we];ge!==null&&(ge.lane&=-536870913)}c&=~Ee}d!==0&&jc(s,d,0),v!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=v&~(N&~i))}function jc(s,i,c){s.pendingLanes|=i,s.suspendedLanes&=~i;var d=31-On(i);s.entangledLanes|=i,s.entanglements[d]=s.entanglements[d]|1073741824|c&4194090}function kc(s,i){var c=s.entangledLanes|=i;for(s=s.entanglements;c;){var d=31-On(c),m=1<<d;m&i|s[d]&i&&(s[d]|=i),c&=~m}}function Tl(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Sl(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ac(){var s=Q.p;return s!==0?s:(s=window.event,s===void 0?32:N1(s.type))}function lf(s,i){var c=Q.p;try{return Q.p=s,i()}finally{Q.p=c}}var Ua=Math.random().toString(36).slice(2),an="__reactFiber$"+Ua,rn="__reactProps$"+Ua,Lr="__reactContainer$"+Ua,Nl="__reactEvents$"+Ua,of="__reactListeners$"+Ua,D="__reactHandles$"+Ua,G="__reactResources$"+Ua,L="__reactMarker$"+Ua;function z(s){delete s[an],delete s[rn],delete s[Nl],delete s[of],delete s[D]}function W(s){var i=s[an];if(i)return i;for(var c=s.parentNode;c;){if(i=c[Lr]||c[an]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(s=u1(s);s!==null;){if(c=s[an])return c;s=u1(s)}return i}s=c,c=s.parentNode}return null}function X(s){if(s=s[an]||s[Lr]){var i=s.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return s}return null}function ue(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s.stateNode;throw Error(a(33))}function ve(s){var i=s[G];return i||(i=s[G]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function le(s){s[L]=!0}var he=new Set,xe={};function je(s,i){De(s,i),De(s+"Capture",i)}function De(s,i){for(xe[s]=i,s=0;s<i.length;s++)he.add(i[s])}var Be=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ae={},Le={};function Xe(s){return Ue.call(Le,s)?!0:Ue.call(Ae,s)?!1:Be.test(s)?Le[s]=!0:(Ae[s]=!0,!1)}function _t(s,i,c){if(Xe(i))if(c===null)s.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":s.removeAttribute(i);return;case"boolean":var d=i.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){s.removeAttribute(i);return}}s.setAttribute(i,""+c)}}function wt(s,i,c){if(c===null)s.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(i);return}s.setAttribute(i,""+c)}}function kt(s,i,c,d){if(d===null)s.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttributeNS(i,c,""+d)}}var rr,Br;function ca(s){if(rr===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);rr=i&&i[1]||"",Br=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+rr+s+Br}var Ca=!1;function Ss(s,i){if(!s||Ca)return"";Ca=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(i){var Ee=function(){throw Error()};if(Object.defineProperty(Ee.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ee,[])}catch(ge){var fe=ge}Reflect.construct(s,[],Ee)}else{try{Ee.call()}catch(ge){fe=ge}s.call(Ee.prototype)}}else{try{throw Error()}catch(ge){fe=ge}(Ee=s())&&typeof Ee.catch=="function"&&Ee.catch(function(){})}}catch(ge){if(ge&&fe&&typeof ge.stack=="string")return[ge.stack,fe.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=d.DetermineComponentFrameRoot(),N=v[0],R=v[1];if(N&&R){var J=N.split(`
`),ce=R.split(`
`);for(m=d=0;d<J.length&&!J[d].includes("DetermineComponentFrameRoot");)d++;for(;m<ce.length&&!ce[m].includes("DetermineComponentFrameRoot");)m++;if(d===J.length||m===ce.length)for(d=J.length-1,m=ce.length-1;1<=d&&0<=m&&J[d]!==ce[m];)m--;for(;1<=d&&0<=m;d--,m--)if(J[d]!==ce[m]){if(d!==1||m!==1)do if(d--,m--,0>m||J[d]!==ce[m]){var we=`
`+J[d].replace(" at new "," at ");return s.displayName&&we.includes("<anonymous>")&&(we=we.replace("<anonymous>",s.displayName)),we}while(1<=d&&0<=m);break}}}finally{Ca=!1,Error.prepareStackTrace=c}return(c=s?s.displayName||s.name:"")?ca(c):""}function ja(s){switch(s.tag){case 26:case 27:case 5:return ca(s.type);case 16:return ca("Lazy");case 13:return ca("Suspense");case 19:return ca("SuspenseList");case 0:case 15:return Ss(s.type,!1);case 11:return Ss(s.type.render,!1);case 1:return Ss(s.type,!0);case 31:return ca("Activity");default:return""}}function Jx(s){try{var i="";do i+=ja(s),s=s.return;while(s);return i}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function ua(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function eg(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function J_(s){var i=eg(s)?"checked":"value",c=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),d=""+s[i];if(!s.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,v=c.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return m.call(this)},set:function(N){d=""+N,v.call(this,N)}}),Object.defineProperty(s,i,{enumerable:c.enumerable}),{getValue:function(){return d},setValue:function(N){d=""+N},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function Dc(s){s._valueTracker||(s._valueTracker=J_(s))}function tg(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var c=i.getValue(),d="";return s&&(d=eg(s)?s.checked?"true":"false":s.value),s=d,s!==c?(i.setValue(s),!0):!1}function Oc(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var ew=/[\n"\\]/g;function ha(s){return s.replace(ew,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function cf(s,i,c,d,m,v,N,R){s.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.type=N:s.removeAttribute("type"),i!=null?N==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+ua(i)):s.value!==""+ua(i)&&(s.value=""+ua(i)):N!=="submit"&&N!=="reset"||s.removeAttribute("value"),i!=null?uf(s,N,ua(i)):c!=null?uf(s,N,ua(c)):d!=null&&s.removeAttribute("value"),m==null&&v!=null&&(s.defaultChecked=!!v),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?s.name=""+ua(R):s.removeAttribute("name")}function ng(s,i,c,d,m,v,N,R){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.type=v),i!=null||c!=null){if(!(v!=="submit"&&v!=="reset"||i!=null))return;c=c!=null?""+ua(c):"",i=i!=null?""+ua(i):c,R||i===s.value||(s.value=i),s.defaultValue=i}d=d??m,d=typeof d!="function"&&typeof d!="symbol"&&!!d,s.checked=R?s.checked:!!d,s.defaultChecked=!!d,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(s.name=N)}function uf(s,i,c){i==="number"&&Oc(s.ownerDocument)===s||s.defaultValue===""+c||(s.defaultValue=""+c)}function xi(s,i,c,d){if(s=s.options,i){i={};for(var m=0;m<c.length;m++)i["$"+c[m]]=!0;for(c=0;c<s.length;c++)m=i.hasOwnProperty("$"+s[c].value),s[c].selected!==m&&(s[c].selected=m),m&&d&&(s[c].defaultSelected=!0)}else{for(c=""+ua(c),i=null,m=0;m<s.length;m++){if(s[m].value===c){s[m].selected=!0,d&&(s[m].defaultSelected=!0);return}i!==null||s[m].disabled||(i=s[m])}i!==null&&(i.selected=!0)}}function ag(s,i,c){if(i!=null&&(i=""+ua(i),i!==s.value&&(s.value=i),c==null)){s.defaultValue!==i&&(s.defaultValue=i);return}s.defaultValue=c!=null?""+ua(c):""}function rg(s,i,c,d){if(i==null){if(d!=null){if(c!=null)throw Error(a(92));if(re(d)){if(1<d.length)throw Error(a(93));d=d[0]}c=d}c==null&&(c=""),i=c}c=ua(i),s.defaultValue=c,d=s.textContent,d===c&&d!==""&&d!==null&&(s.value=d)}function gi(s,i){if(i){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=i;return}}s.textContent=i}var tw=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function sg(s,i,c){var d=i.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="":d?s.setProperty(i,c):typeof c!="number"||c===0||tw.has(i)?i==="float"?s.cssFloat=c:s[i]=(""+c).trim():s[i]=c+"px"}function ig(s,i,c){if(i!=null&&typeof i!="object")throw Error(a(62));if(s=s.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||i!=null&&i.hasOwnProperty(d)||(d.indexOf("--")===0?s.setProperty(d,""):d==="float"?s.cssFloat="":s[d]="");for(var m in i)d=i[m],i.hasOwnProperty(m)&&c[m]!==d&&sg(s,m,d)}else for(var v in i)i.hasOwnProperty(v)&&sg(s,v,i[v])}function hf(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nw=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),aw=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Mc(s){return aw.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var ff=null;function df(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var mi=null,pi=null;function lg(s){var i=X(s);if(i&&(s=i.stateNode)){var c=s[rn]||null;e:switch(s=i.stateNode,i.type){case"input":if(cf(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),i=c.name,c.type==="radio"&&i!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+ha(""+i)+'"][type="radio"]'),i=0;i<c.length;i++){var d=c[i];if(d!==s&&d.form===s.form){var m=d[rn]||null;if(!m)throw Error(a(90));cf(d,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(i=0;i<c.length;i++)d=c[i],d.form===s.form&&tg(d)}break e;case"textarea":ag(s,c.value,c.defaultValue);break e;case"select":i=c.value,i!=null&&xi(s,!!c.multiple,i,!1)}}}var xf=!1;function og(s,i,c){if(xf)return s(i,c);xf=!0;try{var d=s(i);return d}finally{if(xf=!1,(mi!==null||pi!==null)&&(yu(),mi&&(i=mi,s=pi,pi=mi=null,lg(i),s)))for(i=0;i<s.length;i++)lg(s[i])}}function El(s,i){var c=s.stateNode;if(c===null)return null;var d=c[rn]||null;if(d===null)return null;c=d[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(s=s.type,d=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!d;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(a(231,i,typeof c));return c}var sr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gf=!1;if(sr)try{var Cl={};Object.defineProperty(Cl,"passive",{get:function(){gf=!0}}),window.addEventListener("test",Cl,Cl),window.removeEventListener("test",Cl,Cl)}catch{gf=!1}var Hr=null,mf=null,Rc=null;function cg(){if(Rc)return Rc;var s,i=mf,c=i.length,d,m="value"in Hr?Hr.value:Hr.textContent,v=m.length;for(s=0;s<c&&i[s]===m[s];s++);var N=c-s;for(d=1;d<=N&&i[c-d]===m[v-d];d++);return Rc=m.slice(s,1<d?1-d:void 0)}function Fc(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function Lc(){return!0}function ug(){return!1}function Hn(s){function i(c,d,m,v,N){this._reactName=c,this._targetInst=m,this.type=d,this.nativeEvent=v,this.target=N,this.currentTarget=null;for(var R in s)s.hasOwnProperty(R)&&(c=s[R],this[R]=c?c(v):v[R]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Lc:ug,this.isPropagationStopped=ug,this}return g(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Lc)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Lc)},persist:function(){},isPersistent:Lc}),i}var Ns={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bc=Hn(Ns),jl=g({},Ns,{view:0,detail:0}),rw=Hn(jl),pf,yf,kl,Hc=g({},jl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bf,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==kl&&(kl&&s.type==="mousemove"?(pf=s.screenX-kl.screenX,yf=s.screenY-kl.screenY):yf=pf=0,kl=s),pf)},movementY:function(s){return"movementY"in s?s.movementY:yf}}),hg=Hn(Hc),sw=g({},Hc,{dataTransfer:0}),iw=Hn(sw),lw=g({},jl,{relatedTarget:0}),vf=Hn(lw),ow=g({},Ns,{animationName:0,elapsedTime:0,pseudoElement:0}),cw=Hn(ow),uw=g({},Ns,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),hw=Hn(uw),fw=g({},Ns,{data:0}),fg=Hn(fw),dw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mw(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=gw[s])?!!i[s]:!1}function bf(){return mw}var pw=g({},jl,{key:function(s){if(s.key){var i=dw[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Fc(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?xw[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bf,charCode:function(s){return s.type==="keypress"?Fc(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Fc(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),yw=Hn(pw),vw=g({},Hc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dg=Hn(vw),bw=g({},jl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bf}),_w=Hn(bw),ww=g({},Ns,{propertyName:0,elapsedTime:0,pseudoElement:0}),Tw=Hn(ww),Sw=g({},Hc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Nw=Hn(Sw),Ew=g({},Ns,{newState:0,oldState:0}),Cw=Hn(Ew),jw=[9,13,27,32],_f=sr&&"CompositionEvent"in window,Al=null;sr&&"documentMode"in document&&(Al=document.documentMode);var kw=sr&&"TextEvent"in window&&!Al,xg=sr&&(!_f||Al&&8<Al&&11>=Al),gg=" ",mg=!1;function pg(s,i){switch(s){case"keyup":return jw.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yg(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var yi=!1;function Aw(s,i){switch(s){case"compositionend":return yg(i);case"keypress":return i.which!==32?null:(mg=!0,gg);case"textInput":return s=i.data,s===gg&&mg?null:s;default:return null}}function Dw(s,i){if(yi)return s==="compositionend"||!_f&&pg(s,i)?(s=cg(),Rc=mf=Hr=null,yi=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return xg&&i.locale!=="ko"?null:i.data;default:return null}}var Ow={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vg(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!Ow[s.type]:i==="textarea"}function bg(s,i,c,d){mi?pi?pi.push(d):pi=[d]:mi=d,i=Su(i,"onChange"),0<i.length&&(c=new Bc("onChange","change",null,c,d),s.push({event:c,listeners:i}))}var Dl=null,Ol=null;function Mw(s){e1(s,0)}function Pc(s){var i=ue(s);if(tg(i))return s}function _g(s,i){if(s==="change")return i}var wg=!1;if(sr){var wf;if(sr){var Tf="oninput"in document;if(!Tf){var Tg=document.createElement("div");Tg.setAttribute("oninput","return;"),Tf=typeof Tg.oninput=="function"}wf=Tf}else wf=!1;wg=wf&&(!document.documentMode||9<document.documentMode)}function Sg(){Dl&&(Dl.detachEvent("onpropertychange",Ng),Ol=Dl=null)}function Ng(s){if(s.propertyName==="value"&&Pc(Ol)){var i=[];bg(i,Ol,s,df(s)),og(Mw,i)}}function Rw(s,i,c){s==="focusin"?(Sg(),Dl=i,Ol=c,Dl.attachEvent("onpropertychange",Ng)):s==="focusout"&&Sg()}function Fw(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Pc(Ol)}function Lw(s,i){if(s==="click")return Pc(i)}function Bw(s,i){if(s==="input"||s==="change")return Pc(i)}function Hw(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var $n=typeof Object.is=="function"?Object.is:Hw;function Ml(s,i){if($n(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var c=Object.keys(s),d=Object.keys(i);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var m=c[d];if(!Ue.call(i,m)||!$n(s[m],i[m]))return!1}return!0}function Eg(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Cg(s,i){var c=Eg(s);s=0;for(var d;c;){if(c.nodeType===3){if(d=s+c.textContent.length,s<=i&&d>=i)return{node:c,offset:i-s};s=d}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Eg(c)}}function jg(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?jg(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function kg(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var i=Oc(s.document);i instanceof s.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)s=i.contentWindow;else break;i=Oc(s.document)}return i}function Sf(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}var Pw=sr&&"documentMode"in document&&11>=document.documentMode,vi=null,Nf=null,Rl=null,Ef=!1;function Ag(s,i,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Ef||vi==null||vi!==Oc(d)||(d=vi,"selectionStart"in d&&Sf(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Rl&&Ml(Rl,d)||(Rl=d,d=Su(Nf,"onSelect"),0<d.length&&(i=new Bc("onSelect","select",null,i,c),s.push({event:i,listeners:d}),i.target=vi)))}function Es(s,i){var c={};return c[s.toLowerCase()]=i.toLowerCase(),c["Webkit"+s]="webkit"+i,c["Moz"+s]="moz"+i,c}var bi={animationend:Es("Animation","AnimationEnd"),animationiteration:Es("Animation","AnimationIteration"),animationstart:Es("Animation","AnimationStart"),transitionrun:Es("Transition","TransitionRun"),transitionstart:Es("Transition","TransitionStart"),transitioncancel:Es("Transition","TransitionCancel"),transitionend:Es("Transition","TransitionEnd")},Cf={},Dg={};sr&&(Dg=document.createElement("div").style,"AnimationEvent"in window||(delete bi.animationend.animation,delete bi.animationiteration.animation,delete bi.animationstart.animation),"TransitionEvent"in window||delete bi.transitionend.transition);function Cs(s){if(Cf[s])return Cf[s];if(!bi[s])return s;var i=bi[s],c;for(c in i)if(i.hasOwnProperty(c)&&c in Dg)return Cf[s]=i[c];return s}var Og=Cs("animationend"),Mg=Cs("animationiteration"),Rg=Cs("animationstart"),Iw=Cs("transitionrun"),zw=Cs("transitionstart"),Uw=Cs("transitioncancel"),Fg=Cs("transitionend"),Lg=new Map,jf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");jf.push("scrollEnd");function ka(s,i){Lg.set(s,i),je(i,[s])}var Bg=new WeakMap;function fa(s,i){if(typeof s=="object"&&s!==null){var c=Bg.get(s);return c!==void 0?c:(i={value:s,source:i,stack:Jx(i)},Bg.set(s,i),i)}return{value:s,source:i,stack:Jx(i)}}var da=[],_i=0,kf=0;function Ic(){for(var s=_i,i=kf=_i=0;i<s;){var c=da[i];da[i++]=null;var d=da[i];da[i++]=null;var m=da[i];da[i++]=null;var v=da[i];if(da[i++]=null,d!==null&&m!==null){var N=d.pending;N===null?m.next=m:(m.next=N.next,N.next=m),d.pending=m}v!==0&&Hg(c,m,v)}}function zc(s,i,c,d){da[_i++]=s,da[_i++]=i,da[_i++]=c,da[_i++]=d,kf|=d,s.lanes|=d,s=s.alternate,s!==null&&(s.lanes|=d)}function Af(s,i,c,d){return zc(s,i,c,d),Uc(s)}function wi(s,i){return zc(s,null,null,i),Uc(s)}function Hg(s,i,c){s.lanes|=c;var d=s.alternate;d!==null&&(d.lanes|=c);for(var m=!1,v=s.return;v!==null;)v.childLanes|=c,d=v.alternate,d!==null&&(d.childLanes|=c),v.tag===22&&(s=v.stateNode,s===null||s._visibility&1||(m=!0)),s=v,v=v.return;return s.tag===3?(v=s.stateNode,m&&i!==null&&(m=31-On(c),s=v.hiddenUpdates,d=s[m],d===null?s[m]=[i]:d.push(i),i.lane=c|536870912),v):null}function Uc(s){if(50<so)throw so=0,L0=null,Error(a(185));for(var i=s.return;i!==null;)s=i,i=s.return;return s.tag===3?s.stateNode:null}var Ti={};function Vw(s,i,c,d){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qn(s,i,c,d){return new Vw(s,i,c,d)}function Df(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ir(s,i){var c=s.alternate;return c===null?(c=Qn(s.tag,i,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=i,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&65011712,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,i=s.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c.refCleanup=s.refCleanup,c}function Pg(s,i){s.flags&=65011714;var c=s.alternate;return c===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,i=c.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),s}function Vc(s,i,c,d,m,v){var N=0;if(d=s,typeof s=="function")Df(s)&&(N=1);else if(typeof s=="string")N=WT(s,c,j.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case M:return s=Qn(31,c,i,m),s.elementType=M,s.lanes=v,s;case w:return js(c.children,m,v,i);case b:N=8,m|=24;break;case T:return s=Qn(12,c,i,m|2),s.elementType=T,s.lanes=v,s;case F:return s=Qn(13,c,i,m),s.elementType=F,s.lanes=v,s;case K:return s=Qn(19,c,i,m),s.elementType=K,s.lanes=v,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case S:case C:N=10;break e;case E:N=9;break e;case A:N=11;break e;case O:N=14;break e;case P:N=16,d=null;break e}N=29,c=Error(a(130,s===null?"null":typeof s,"")),d=null}return i=Qn(N,c,i,m),i.elementType=s,i.type=d,i.lanes=v,i}function js(s,i,c,d){return s=Qn(7,s,d,i),s.lanes=c,s}function Of(s,i,c){return s=Qn(6,s,null,i),s.lanes=c,s}function Mf(s,i,c){return i=Qn(4,s.children!==null?s.children:[],s.key,i),i.lanes=c,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}var Si=[],Ni=0,Kc=null,Wc=0,xa=[],ga=0,ks=null,lr=1,or="";function As(s,i){Si[Ni++]=Wc,Si[Ni++]=Kc,Kc=s,Wc=i}function Ig(s,i,c){xa[ga++]=lr,xa[ga++]=or,xa[ga++]=ks,ks=s;var d=lr;s=or;var m=32-On(d)-1;d&=~(1<<m),c+=1;var v=32-On(i)+m;if(30<v){var N=m-m%5;v=(d&(1<<N)-1).toString(32),d>>=N,m-=N,lr=1<<32-On(i)+m|c<<m|d,or=v+s}else lr=1<<v|c<<m|d,or=s}function Rf(s){s.return!==null&&(As(s,1),Ig(s,1,0))}function Ff(s){for(;s===Kc;)Kc=Si[--Ni],Si[Ni]=null,Wc=Si[--Ni],Si[Ni]=null;for(;s===ks;)ks=xa[--ga],xa[ga]=null,or=xa[--ga],xa[ga]=null,lr=xa[--ga],xa[ga]=null}var Mn=null,Bt=null,ut=!1,Ds=null,Va=!1,Lf=Error(a(519));function Os(s){var i=Error(a(418,""));throw Bl(fa(i,s)),Lf}function zg(s){var i=s.stateNode,c=s.type,d=s.memoizedProps;switch(i[an]=s,i[rn]=d,c){case"dialog":nt("cancel",i),nt("close",i);break;case"iframe":case"object":case"embed":nt("load",i);break;case"video":case"audio":for(c=0;c<lo.length;c++)nt(lo[c],i);break;case"source":nt("error",i);break;case"img":case"image":case"link":nt("error",i),nt("load",i);break;case"details":nt("toggle",i);break;case"input":nt("invalid",i),ng(i,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0),Dc(i);break;case"select":nt("invalid",i);break;case"textarea":nt("invalid",i),rg(i,d.value,d.defaultValue,d.children),Dc(i)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||i.textContent===""+c||d.suppressHydrationWarning===!0||r1(i.textContent,c)?(d.popover!=null&&(nt("beforetoggle",i),nt("toggle",i)),d.onScroll!=null&&nt("scroll",i),d.onScrollEnd!=null&&nt("scrollend",i),d.onClick!=null&&(i.onclick=Nu),i=!0):i=!1,i||Os(s)}function Ug(s){for(Mn=s.return;Mn;)switch(Mn.tag){case 5:case 13:Va=!1;return;case 27:case 3:Va=!0;return;default:Mn=Mn.return}}function Fl(s){if(s!==Mn)return!1;if(!ut)return Ug(s),ut=!0,!1;var i=s.tag,c;if((c=i!==3&&i!==27)&&((c=i===5)&&(c=s.type,c=!(c!=="form"&&c!=="button")||Z0(s.type,s.memoizedProps)),c=!c),c&&Bt&&Os(s),Ug(s),i===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8)if(c=s.data,c==="/$"){if(i===0){Bt=Da(s.nextSibling);break e}i--}else c!=="$"&&c!=="$!"&&c!=="$?"||i++;s=s.nextSibling}Bt=null}}else i===27?(i=Bt,es(s.type)?(s=nd,nd=null,Bt=s):Bt=i):Bt=Mn?Da(s.stateNode.nextSibling):null;return!0}function Ll(){Bt=Mn=null,ut=!1}function Vg(){var s=Ds;return s!==null&&(zn===null?zn=s:zn.push.apply(zn,s),Ds=null),s}function Bl(s){Ds===null?Ds=[s]:Ds.push(s)}var Bf=de(null),Ms=null,cr=null;function Pr(s,i,c){Z(Bf,i._currentValue),i._currentValue=c}function ur(s){s._currentValue=Bf.current,H(Bf)}function Hf(s,i,c){for(;s!==null;){var d=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,d!==null&&(d.childLanes|=i)):d!==null&&(d.childLanes&i)!==i&&(d.childLanes|=i),s===c)break;s=s.return}}function Pf(s,i,c,d){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var v=m.dependencies;if(v!==null){var N=m.child;v=v.firstContext;e:for(;v!==null;){var R=v;v=m;for(var J=0;J<i.length;J++)if(R.context===i[J]){v.lanes|=c,R=v.alternate,R!==null&&(R.lanes|=c),Hf(v.return,c,s),d||(N=null);break e}v=R.next}}else if(m.tag===18){if(N=m.return,N===null)throw Error(a(341));N.lanes|=c,v=N.alternate,v!==null&&(v.lanes|=c),Hf(N,c,s),N=null}else N=m.child;if(N!==null)N.return=m;else for(N=m;N!==null;){if(N===s){N=null;break}if(m=N.sibling,m!==null){m.return=N.return,N=m;break}N=N.return}m=N}}function Hl(s,i,c,d){s=null;for(var m=i,v=!1;m!==null;){if(!v){if((m.flags&524288)!==0)v=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var N=m.alternate;if(N===null)throw Error(a(387));if(N=N.memoizedProps,N!==null){var R=m.type;$n(m.pendingProps.value,N.value)||(s!==null?s.push(R):s=[R])}}else if(m===Te.current){if(N=m.alternate,N===null)throw Error(a(387));N.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(xo):s=[xo])}m=m.return}s!==null&&Pf(i,s,c,d),i.flags|=262144}function Gc(s){for(s=s.firstContext;s!==null;){if(!$n(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Rs(s){Ms=s,cr=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Nn(s){return Kg(Ms,s)}function Xc(s,i){return Ms===null&&Rs(s),Kg(s,i)}function Kg(s,i){var c=i._currentValue;if(i={context:i,memoizedValue:c,next:null},cr===null){if(s===null)throw Error(a(308));cr=i,s.dependencies={lanes:0,firstContext:i},s.flags|=524288}else cr=cr.next=i;return c}var Kw=typeof AbortController<"u"?AbortController:function(){var s=[],i=this.signal={aborted:!1,addEventListener:function(c,d){s.push(d)}};this.abort=function(){i.aborted=!0,s.forEach(function(c){return c()})}},Ww=e.unstable_scheduleCallback,Gw=e.unstable_NormalPriority,Zt={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function If(){return{controller:new Kw,data:new Map,refCount:0}}function Pl(s){s.refCount--,s.refCount===0&&Ww(Gw,function(){s.controller.abort()})}var Il=null,zf=0,Ei=0,Ci=null;function Xw(s,i){if(Il===null){var c=Il=[];zf=0,Ei=V0(),Ci={status:"pending",value:void 0,then:function(d){c.push(d)}}}return zf++,i.then(Wg,Wg),i}function Wg(){if(--zf===0&&Il!==null){Ci!==null&&(Ci.status="fulfilled");var s=Il;Il=null,Ei=0,Ci=null;for(var i=0;i<s.length;i++)(0,s[i])()}}function Yw(s,i){var c=[],d={status:"pending",value:null,reason:null,then:function(m){c.push(m)}};return s.then(function(){d.status="fulfilled",d.value=i;for(var m=0;m<c.length;m++)(0,c[m])(i)},function(m){for(d.status="rejected",d.reason=m,m=0;m<c.length;m++)(0,c[m])(void 0)}),d}var Gg=ee.S;ee.S=function(s,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&Xw(s,i),Gg!==null&&Gg(s,i)};var Fs=de(null);function Uf(){var s=Fs.current;return s!==null?s:At.pooledCache}function Yc(s,i){i===null?Z(Fs,Fs.current):Z(Fs,i.pool)}function Xg(){var s=Uf();return s===null?null:{parent:Zt._currentValue,pool:s}}var zl=Error(a(460)),Yg=Error(a(474)),qc=Error(a(542)),Vf={then:function(){}};function qg(s){return s=s.status,s==="fulfilled"||s==="rejected"}function $c(){}function $g(s,i,c){switch(c=s[c],c===void 0?s.push(i):c!==i&&(i.then($c,$c),i=c),i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,Zg(s),s;default:if(typeof i.status=="string")i.then($c,$c);else{if(s=At,s!==null&&100<s.shellSuspendCounter)throw Error(a(482));s=i,s.status="pending",s.then(function(d){if(i.status==="pending"){var m=i;m.status="fulfilled",m.value=d}},function(d){if(i.status==="pending"){var m=i;m.status="rejected",m.reason=d}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,Zg(s),s}throw Ul=i,zl}}var Ul=null;function Qg(){if(Ul===null)throw Error(a(459));var s=Ul;return Ul=null,s}function Zg(s){if(s===zl||s===qc)throw Error(a(483))}var Ir=!1;function Kf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Wf(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function zr(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ur(s,i,c){var d=s.updateQueue;if(d===null)return null;if(d=d.shared,(gt&2)!==0){var m=d.pending;return m===null?i.next=i:(i.next=m.next,m.next=i),d.pending=i,i=Uc(s),Hg(s,null,c),i}return zc(s,d,i,c),Uc(s)}function Vl(s,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194048)!==0)){var d=i.lanes;d&=s.pendingLanes,c|=d,i.lanes=c,kc(s,c)}}function Gf(s,i){var c=s.updateQueue,d=s.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var m=null,v=null;if(c=c.firstBaseUpdate,c!==null){do{var N={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};v===null?m=v=N:v=v.next=N,c=c.next}while(c!==null);v===null?m=v=i:v=v.next=i}else m=v=i;c={baseState:d.baseState,firstBaseUpdate:m,lastBaseUpdate:v,shared:d.shared,callbacks:d.callbacks},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=i:s.next=i,c.lastBaseUpdate=i}var Xf=!1;function Kl(){if(Xf){var s=Ci;if(s!==null)throw s}}function Wl(s,i,c,d){Xf=!1;var m=s.updateQueue;Ir=!1;var v=m.firstBaseUpdate,N=m.lastBaseUpdate,R=m.shared.pending;if(R!==null){m.shared.pending=null;var J=R,ce=J.next;J.next=null,N===null?v=ce:N.next=ce,N=J;var we=s.alternate;we!==null&&(we=we.updateQueue,R=we.lastBaseUpdate,R!==N&&(R===null?we.firstBaseUpdate=ce:R.next=ce,we.lastBaseUpdate=J))}if(v!==null){var Ee=m.baseState;N=0,we=ce=J=null,R=v;do{var fe=R.lane&-536870913,ge=fe!==R.lane;if(ge?(st&fe)===fe:(d&fe)===fe){fe!==0&&fe===Ei&&(Xf=!0),we!==null&&(we=we.next={lane:0,tag:R.tag,payload:R.payload,callback:null,next:null});e:{var Ge=s,Ke=R;fe=i;var Nt=c;switch(Ke.tag){case 1:if(Ge=Ke.payload,typeof Ge=="function"){Ee=Ge.call(Nt,Ee,fe);break e}Ee=Ge;break e;case 3:Ge.flags=Ge.flags&-65537|128;case 0:if(Ge=Ke.payload,fe=typeof Ge=="function"?Ge.call(Nt,Ee,fe):Ge,fe==null)break e;Ee=g({},Ee,fe);break e;case 2:Ir=!0}}fe=R.callback,fe!==null&&(s.flags|=64,ge&&(s.flags|=8192),ge=m.callbacks,ge===null?m.callbacks=[fe]:ge.push(fe))}else ge={lane:fe,tag:R.tag,payload:R.payload,callback:R.callback,next:null},we===null?(ce=we=ge,J=Ee):we=we.next=ge,N|=fe;if(R=R.next,R===null){if(R=m.shared.pending,R===null)break;ge=R,R=ge.next,ge.next=null,m.lastBaseUpdate=ge,m.shared.pending=null}}while(!0);we===null&&(J=Ee),m.baseState=J,m.firstBaseUpdate=ce,m.lastBaseUpdate=we,v===null&&(m.shared.lanes=0),$r|=N,s.lanes=N,s.memoizedState=Ee}}function Jg(s,i){if(typeof s!="function")throw Error(a(191,s));s.call(i)}function em(s,i){var c=s.callbacks;if(c!==null)for(s.callbacks=null,s=0;s<c.length;s++)Jg(c[s],i)}var ji=de(null),Qc=de(0);function tm(s,i){s=pr,Z(Qc,s),Z(ji,i),pr=s|i.baseLanes}function Yf(){Z(Qc,pr),Z(ji,ji.current)}function qf(){pr=Qc.current,H(ji),H(Qc)}var Vr=0,Qe=null,Tt=null,Gt=null,Zc=!1,ki=!1,Ls=!1,Jc=0,Gl=0,Ai=null,qw=0;function Kt(){throw Error(a(321))}function $f(s,i){if(i===null)return!1;for(var c=0;c<i.length&&c<s.length;c++)if(!$n(s[c],i[c]))return!1;return!0}function Qf(s,i,c,d,m,v){return Vr=v,Qe=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,ee.H=s===null||s.memoizedState===null?Hm:Pm,Ls=!1,v=c(d,m),Ls=!1,ki&&(v=am(i,c,d,m)),nm(s),v}function nm(s){ee.H=su;var i=Tt!==null&&Tt.next!==null;if(Vr=0,Gt=Tt=Qe=null,Zc=!1,Gl=0,Ai=null,i)throw Error(a(300));s===null||sn||(s=s.dependencies,s!==null&&Gc(s)&&(sn=!0))}function am(s,i,c,d){Qe=s;var m=0;do{if(ki&&(Ai=null),Gl=0,ki=!1,25<=m)throw Error(a(301));if(m+=1,Gt=Tt=null,s.updateQueue!=null){var v=s.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}ee.H=nT,v=i(c,d)}while(ki);return v}function $w(){var s=ee.H,i=s.useState()[0];return i=typeof i.then=="function"?Xl(i):i,s=s.useState()[0],(Tt!==null?Tt.memoizedState:null)!==s&&(Qe.flags|=1024),i}function Zf(){var s=Jc!==0;return Jc=0,s}function Jf(s,i,c){i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~c}function e0(s){if(Zc){for(s=s.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}Zc=!1}Vr=0,Gt=Tt=Qe=null,ki=!1,Gl=Jc=0,Ai=null}function Pn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gt===null?Qe.memoizedState=Gt=s:Gt=Gt.next=s,Gt}function Xt(){if(Tt===null){var s=Qe.alternate;s=s!==null?s.memoizedState:null}else s=Tt.next;var i=Gt===null?Qe.memoizedState:Gt.next;if(i!==null)Gt=i,Tt=s;else{if(s===null)throw Qe.alternate===null?Error(a(467)):Error(a(310));Tt=s,s={memoizedState:Tt.memoizedState,baseState:Tt.baseState,baseQueue:Tt.baseQueue,queue:Tt.queue,next:null},Gt===null?Qe.memoizedState=Gt=s:Gt=Gt.next=s}return Gt}function t0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Xl(s){var i=Gl;return Gl+=1,Ai===null&&(Ai=[]),s=$g(Ai,s,i),i=Qe,(Gt===null?i.memoizedState:Gt.next)===null&&(i=i.alternate,ee.H=i===null||i.memoizedState===null?Hm:Pm),s}function eu(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Xl(s);if(s.$$typeof===C)return Nn(s)}throw Error(a(438,String(s)))}function n0(s){var i=null,c=Qe.updateQueue;if(c!==null&&(i=c.memoCache),i==null){var d=Qe.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(i={data:d.data.map(function(m){return m.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),c===null&&(c=t0(),Qe.updateQueue=c),c.memoCache=i,c=i.data[i.index],c===void 0)for(c=i.data[i.index]=Array(s),d=0;d<s;d++)c[d]=B;return i.index++,c}function hr(s,i){return typeof i=="function"?i(s):i}function tu(s){var i=Xt();return a0(i,Tt,s)}function a0(s,i,c){var d=s.queue;if(d===null)throw Error(a(311));d.lastRenderedReducer=c;var m=s.baseQueue,v=d.pending;if(v!==null){if(m!==null){var N=m.next;m.next=v.next,v.next=N}i.baseQueue=m=v,d.pending=null}if(v=s.baseState,m===null)s.memoizedState=v;else{i=m.next;var R=N=null,J=null,ce=i,we=!1;do{var Ee=ce.lane&-536870913;if(Ee!==ce.lane?(st&Ee)===Ee:(Vr&Ee)===Ee){var fe=ce.revertLane;if(fe===0)J!==null&&(J=J.next={lane:0,revertLane:0,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null}),Ee===Ei&&(we=!0);else if((Vr&fe)===fe){ce=ce.next,fe===Ei&&(we=!0);continue}else Ee={lane:0,revertLane:ce.revertLane,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},J===null?(R=J=Ee,N=v):J=J.next=Ee,Qe.lanes|=fe,$r|=fe;Ee=ce.action,Ls&&c(v,Ee),v=ce.hasEagerState?ce.eagerState:c(v,Ee)}else fe={lane:Ee,revertLane:ce.revertLane,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},J===null?(R=J=fe,N=v):J=J.next=fe,Qe.lanes|=Ee,$r|=Ee;ce=ce.next}while(ce!==null&&ce!==i);if(J===null?N=v:J.next=R,!$n(v,s.memoizedState)&&(sn=!0,we&&(c=Ci,c!==null)))throw c;s.memoizedState=v,s.baseState=N,s.baseQueue=J,d.lastRenderedState=v}return m===null&&(d.lanes=0),[s.memoizedState,d.dispatch]}function r0(s){var i=Xt(),c=i.queue;if(c===null)throw Error(a(311));c.lastRenderedReducer=s;var d=c.dispatch,m=c.pending,v=i.memoizedState;if(m!==null){c.pending=null;var N=m=m.next;do v=s(v,N.action),N=N.next;while(N!==m);$n(v,i.memoizedState)||(sn=!0),i.memoizedState=v,i.baseQueue===null&&(i.baseState=v),c.lastRenderedState=v}return[v,d]}function rm(s,i,c){var d=Qe,m=Xt(),v=ut;if(v){if(c===void 0)throw Error(a(407));c=c()}else c=i();var N=!$n((Tt||m).memoizedState,c);N&&(m.memoizedState=c,sn=!0),m=m.queue;var R=lm.bind(null,d,m,s);if(Yl(2048,8,R,[s]),m.getSnapshot!==i||N||Gt!==null&&Gt.memoizedState.tag&1){if(d.flags|=2048,Di(9,nu(),im.bind(null,d,m,c,i),null),At===null)throw Error(a(349));v||(Vr&124)!==0||sm(d,i,c)}return c}function sm(s,i,c){s.flags|=16384,s={getSnapshot:i,value:c},i=Qe.updateQueue,i===null?(i=t0(),Qe.updateQueue=i,i.stores=[s]):(c=i.stores,c===null?i.stores=[s]:c.push(s))}function im(s,i,c,d){i.value=c,i.getSnapshot=d,om(i)&&cm(s)}function lm(s,i,c){return c(function(){om(i)&&cm(s)})}function om(s){var i=s.getSnapshot;s=s.value;try{var c=i();return!$n(s,c)}catch{return!0}}function cm(s){var i=wi(s,2);i!==null&&na(i,s,2)}function s0(s){var i=Pn();if(typeof s=="function"){var c=s;if(s=c(),Ls){Sn(!0);try{c()}finally{Sn(!1)}}}return i.memoizedState=i.baseState=s,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:s},i}function um(s,i,c,d){return s.baseState=c,a0(s,Tt,typeof d=="function"?d:hr)}function Qw(s,i,c,d,m){if(ru(s))throw Error(a(485));if(s=i.action,s!==null){var v={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){v.listeners.push(N)}};ee.T!==null?c(!0):v.isTransition=!1,d(v),c=i.pending,c===null?(v.next=i.pending=v,hm(i,v)):(v.next=c.next,i.pending=c.next=v)}}function hm(s,i){var c=i.action,d=i.payload,m=s.state;if(i.isTransition){var v=ee.T,N={};ee.T=N;try{var R=c(m,d),J=ee.S;J!==null&&J(N,R),fm(s,i,R)}catch(ce){i0(s,i,ce)}finally{ee.T=v}}else try{v=c(m,d),fm(s,i,v)}catch(ce){i0(s,i,ce)}}function fm(s,i,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){dm(s,i,d)},function(d){return i0(s,i,d)}):dm(s,i,c)}function dm(s,i,c){i.status="fulfilled",i.value=c,xm(i),s.state=c,i=s.pending,i!==null&&(c=i.next,c===i?s.pending=null:(c=c.next,i.next=c,hm(s,c)))}function i0(s,i,c){var d=s.pending;if(s.pending=null,d!==null){d=d.next;do i.status="rejected",i.reason=c,xm(i),i=i.next;while(i!==d)}s.action=null}function xm(s){s=s.listeners;for(var i=0;i<s.length;i++)(0,s[i])()}function gm(s,i){return i}function mm(s,i){if(ut){var c=At.formState;if(c!==null){e:{var d=Qe;if(ut){if(Bt){t:{for(var m=Bt,v=Va;m.nodeType!==8;){if(!v){m=null;break t}if(m=Da(m.nextSibling),m===null){m=null;break t}}v=m.data,m=v==="F!"||v==="F"?m:null}if(m){Bt=Da(m.nextSibling),d=m.data==="F!";break e}}Os(d)}d=!1}d&&(i=c[0])}}return c=Pn(),c.memoizedState=c.baseState=i,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gm,lastRenderedState:i},c.queue=d,c=Fm.bind(null,Qe,d),d.dispatch=c,d=s0(!1),v=h0.bind(null,Qe,!1,d.queue),d=Pn(),m={state:i,dispatch:null,action:s,pending:null},d.queue=m,c=Qw.bind(null,Qe,m,v,c),m.dispatch=c,d.memoizedState=s,[i,c,!1]}function pm(s){var i=Xt();return ym(i,Tt,s)}function ym(s,i,c){if(i=a0(s,i,gm)[0],s=tu(hr)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var d=Xl(i)}catch(N){throw N===zl?qc:N}else d=i;i=Xt();var m=i.queue,v=m.dispatch;return c!==i.memoizedState&&(Qe.flags|=2048,Di(9,nu(),Zw.bind(null,m,c),null)),[d,v,s]}function Zw(s,i){s.action=i}function vm(s){var i=Xt(),c=Tt;if(c!==null)return ym(i,c,s);Xt(),i=i.memoizedState,c=Xt();var d=c.queue.dispatch;return c.memoizedState=s,[i,d,!1]}function Di(s,i,c,d){return s={tag:s,create:c,deps:d,inst:i,next:null},i=Qe.updateQueue,i===null&&(i=t0(),Qe.updateQueue=i),c=i.lastEffect,c===null?i.lastEffect=s.next=s:(d=c.next,c.next=s,s.next=d,i.lastEffect=s),s}function nu(){return{destroy:void 0,resource:void 0}}function bm(){return Xt().memoizedState}function au(s,i,c,d){var m=Pn();d=d===void 0?null:d,Qe.flags|=s,m.memoizedState=Di(1|i,nu(),c,d)}function Yl(s,i,c,d){var m=Xt();d=d===void 0?null:d;var v=m.memoizedState.inst;Tt!==null&&d!==null&&$f(d,Tt.memoizedState.deps)?m.memoizedState=Di(i,v,c,d):(Qe.flags|=s,m.memoizedState=Di(1|i,v,c,d))}function _m(s,i){au(8390656,8,s,i)}function wm(s,i){Yl(2048,8,s,i)}function Tm(s,i){return Yl(4,2,s,i)}function Sm(s,i){return Yl(4,4,s,i)}function Nm(s,i){if(typeof i=="function"){s=s();var c=i(s);return function(){typeof c=="function"?c():i(null)}}if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function Em(s,i,c){c=c!=null?c.concat([s]):null,Yl(4,4,Nm.bind(null,i,s),c)}function l0(){}function Cm(s,i){var c=Xt();i=i===void 0?null:i;var d=c.memoizedState;return i!==null&&$f(i,d[1])?d[0]:(c.memoizedState=[s,i],s)}function jm(s,i){var c=Xt();i=i===void 0?null:i;var d=c.memoizedState;if(i!==null&&$f(i,d[1]))return d[0];if(d=s(),Ls){Sn(!0);try{s()}finally{Sn(!1)}}return c.memoizedState=[d,i],d}function o0(s,i,c){return c===void 0||(Vr&1073741824)!==0?s.memoizedState=i:(s.memoizedState=c,s=Dp(),Qe.lanes|=s,$r|=s,c)}function km(s,i,c,d){return $n(c,i)?c:ji.current!==null?(s=o0(s,c,d),$n(s,i)||(sn=!0),s):(Vr&42)===0?(sn=!0,s.memoizedState=c):(s=Dp(),Qe.lanes|=s,$r|=s,i)}function Am(s,i,c,d,m){var v=Q.p;Q.p=v!==0&&8>v?v:8;var N=ee.T,R={};ee.T=R,h0(s,!1,i,c);try{var J=m(),ce=ee.S;if(ce!==null&&ce(R,J),J!==null&&typeof J=="object"&&typeof J.then=="function"){var we=Yw(J,d);ql(s,i,we,ta(s))}else ql(s,i,d,ta(s))}catch(Ee){ql(s,i,{then:function(){},status:"rejected",reason:Ee},ta())}finally{Q.p=v,ee.T=N}}function Jw(){}function c0(s,i,c,d){if(s.tag!==5)throw Error(a(476));var m=Dm(s).queue;Am(s,m,i,me,c===null?Jw:function(){return Om(s),c(d)})}function Dm(s){var i=s.memoizedState;if(i!==null)return i;i={memoizedState:me,baseState:me,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:me},next:null};var c={};return i.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:c},next:null},s.memoizedState=i,s=s.alternate,s!==null&&(s.memoizedState=i),i}function Om(s){var i=Dm(s).next.queue;ql(s,i,{},ta())}function u0(){return Nn(xo)}function Mm(){return Xt().memoizedState}function Rm(){return Xt().memoizedState}function eT(s){for(var i=s.return;i!==null;){switch(i.tag){case 24:case 3:var c=ta();s=zr(c);var d=Ur(i,s,c);d!==null&&(na(d,i,c),Vl(d,i,c)),i={cache:If()},s.payload=i;return}i=i.return}}function tT(s,i,c){var d=ta();c={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},ru(s)?Lm(i,c):(c=Af(s,i,c,d),c!==null&&(na(c,s,d),Bm(c,i,d)))}function Fm(s,i,c){var d=ta();ql(s,i,c,d)}function ql(s,i,c,d){var m={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(ru(s))Lm(i,m);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=i.lastRenderedReducer,v!==null))try{var N=i.lastRenderedState,R=v(N,c);if(m.hasEagerState=!0,m.eagerState=R,$n(R,N))return zc(s,i,m,0),At===null&&Ic(),!1}catch{}finally{}if(c=Af(s,i,m,d),c!==null)return na(c,s,d),Bm(c,i,d),!0}return!1}function h0(s,i,c,d){if(d={lane:2,revertLane:V0(),action:d,hasEagerState:!1,eagerState:null,next:null},ru(s)){if(i)throw Error(a(479))}else i=Af(s,c,d,2),i!==null&&na(i,s,2)}function ru(s){var i=s.alternate;return s===Qe||i!==null&&i===Qe}function Lm(s,i){ki=Zc=!0;var c=s.pending;c===null?i.next=i:(i.next=c.next,c.next=i),s.pending=i}function Bm(s,i,c){if((c&4194048)!==0){var d=i.lanes;d&=s.pendingLanes,c|=d,i.lanes=c,kc(s,c)}}var su={readContext:Nn,use:eu,useCallback:Kt,useContext:Kt,useEffect:Kt,useImperativeHandle:Kt,useLayoutEffect:Kt,useInsertionEffect:Kt,useMemo:Kt,useReducer:Kt,useRef:Kt,useState:Kt,useDebugValue:Kt,useDeferredValue:Kt,useTransition:Kt,useSyncExternalStore:Kt,useId:Kt,useHostTransitionStatus:Kt,useFormState:Kt,useActionState:Kt,useOptimistic:Kt,useMemoCache:Kt,useCacheRefresh:Kt},Hm={readContext:Nn,use:eu,useCallback:function(s,i){return Pn().memoizedState=[s,i===void 0?null:i],s},useContext:Nn,useEffect:_m,useImperativeHandle:function(s,i,c){c=c!=null?c.concat([s]):null,au(4194308,4,Nm.bind(null,i,s),c)},useLayoutEffect:function(s,i){return au(4194308,4,s,i)},useInsertionEffect:function(s,i){au(4,2,s,i)},useMemo:function(s,i){var c=Pn();i=i===void 0?null:i;var d=s();if(Ls){Sn(!0);try{s()}finally{Sn(!1)}}return c.memoizedState=[d,i],d},useReducer:function(s,i,c){var d=Pn();if(c!==void 0){var m=c(i);if(Ls){Sn(!0);try{c(i)}finally{Sn(!1)}}}else m=i;return d.memoizedState=d.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},d.queue=s,s=s.dispatch=tT.bind(null,Qe,s),[d.memoizedState,s]},useRef:function(s){var i=Pn();return s={current:s},i.memoizedState=s},useState:function(s){s=s0(s);var i=s.queue,c=Fm.bind(null,Qe,i);return i.dispatch=c,[s.memoizedState,c]},useDebugValue:l0,useDeferredValue:function(s,i){var c=Pn();return o0(c,s,i)},useTransition:function(){var s=s0(!1);return s=Am.bind(null,Qe,s.queue,!0,!1),Pn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,i,c){var d=Qe,m=Pn();if(ut){if(c===void 0)throw Error(a(407));c=c()}else{if(c=i(),At===null)throw Error(a(349));(st&124)!==0||sm(d,i,c)}m.memoizedState=c;var v={value:c,getSnapshot:i};return m.queue=v,_m(lm.bind(null,d,v,s),[s]),d.flags|=2048,Di(9,nu(),im.bind(null,d,v,c,i),null),c},useId:function(){var s=Pn(),i=At.identifierPrefix;if(ut){var c=or,d=lr;c=(d&~(1<<32-On(d)-1)).toString(32)+c,i="«"+i+"R"+c,c=Jc++,0<c&&(i+="H"+c.toString(32)),i+="»"}else c=qw++,i="«"+i+"r"+c.toString(32)+"»";return s.memoizedState=i},useHostTransitionStatus:u0,useFormState:mm,useActionState:mm,useOptimistic:function(s){var i=Pn();i.memoizedState=i.baseState=s;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=c,i=h0.bind(null,Qe,!0,c),c.dispatch=i,[s,i]},useMemoCache:n0,useCacheRefresh:function(){return Pn().memoizedState=eT.bind(null,Qe)}},Pm={readContext:Nn,use:eu,useCallback:Cm,useContext:Nn,useEffect:wm,useImperativeHandle:Em,useInsertionEffect:Tm,useLayoutEffect:Sm,useMemo:jm,useReducer:tu,useRef:bm,useState:function(){return tu(hr)},useDebugValue:l0,useDeferredValue:function(s,i){var c=Xt();return km(c,Tt.memoizedState,s,i)},useTransition:function(){var s=tu(hr)[0],i=Xt().memoizedState;return[typeof s=="boolean"?s:Xl(s),i]},useSyncExternalStore:rm,useId:Mm,useHostTransitionStatus:u0,useFormState:pm,useActionState:pm,useOptimistic:function(s,i){var c=Xt();return um(c,Tt,s,i)},useMemoCache:n0,useCacheRefresh:Rm},nT={readContext:Nn,use:eu,useCallback:Cm,useContext:Nn,useEffect:wm,useImperativeHandle:Em,useInsertionEffect:Tm,useLayoutEffect:Sm,useMemo:jm,useReducer:r0,useRef:bm,useState:function(){return r0(hr)},useDebugValue:l0,useDeferredValue:function(s,i){var c=Xt();return Tt===null?o0(c,s,i):km(c,Tt.memoizedState,s,i)},useTransition:function(){var s=r0(hr)[0],i=Xt().memoizedState;return[typeof s=="boolean"?s:Xl(s),i]},useSyncExternalStore:rm,useId:Mm,useHostTransitionStatus:u0,useFormState:vm,useActionState:vm,useOptimistic:function(s,i){var c=Xt();return Tt!==null?um(c,Tt,s,i):(c.baseState=s,[s,c.queue.dispatch])},useMemoCache:n0,useCacheRefresh:Rm},Oi=null,$l=0;function iu(s){var i=$l;return $l+=1,Oi===null&&(Oi=[]),$g(Oi,s,i)}function Ql(s,i){i=i.props.ref,s.ref=i!==void 0?i:null}function lu(s,i){throw i.$$typeof===p?Error(a(525)):(s=Object.prototype.toString.call(i),Error(a(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)))}function Im(s){var i=s._init;return i(s._payload)}function zm(s){function i(se,ne){if(s){var oe=se.deletions;oe===null?(se.deletions=[ne],se.flags|=16):oe.push(ne)}}function c(se,ne){if(!s)return null;for(;ne!==null;)i(se,ne),ne=ne.sibling;return null}function d(se){for(var ne=new Map;se!==null;)se.key!==null?ne.set(se.key,se):ne.set(se.index,se),se=se.sibling;return ne}function m(se,ne){return se=ir(se,ne),se.index=0,se.sibling=null,se}function v(se,ne,oe){return se.index=oe,s?(oe=se.alternate,oe!==null?(oe=oe.index,oe<ne?(se.flags|=67108866,ne):oe):(se.flags|=67108866,ne)):(se.flags|=1048576,ne)}function N(se){return s&&se.alternate===null&&(se.flags|=67108866),se}function R(se,ne,oe,Se){return ne===null||ne.tag!==6?(ne=Of(oe,se.mode,Se),ne.return=se,ne):(ne=m(ne,oe),ne.return=se,ne)}function J(se,ne,oe,Se){var He=oe.type;return He===w?we(se,ne,oe.props.children,Se,oe.key):ne!==null&&(ne.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===P&&Im(He)===ne.type)?(ne=m(ne,oe.props),Ql(ne,oe),ne.return=se,ne):(ne=Vc(oe.type,oe.key,oe.props,null,se.mode,Se),Ql(ne,oe),ne.return=se,ne)}function ce(se,ne,oe,Se){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==oe.containerInfo||ne.stateNode.implementation!==oe.implementation?(ne=Mf(oe,se.mode,Se),ne.return=se,ne):(ne=m(ne,oe.children||[]),ne.return=se,ne)}function we(se,ne,oe,Se,He){return ne===null||ne.tag!==7?(ne=js(oe,se.mode,Se,He),ne.return=se,ne):(ne=m(ne,oe),ne.return=se,ne)}function Ee(se,ne,oe){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return ne=Of(""+ne,se.mode,oe),ne.return=se,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case y:return oe=Vc(ne.type,ne.key,ne.props,null,se.mode,oe),Ql(oe,ne),oe.return=se,oe;case _:return ne=Mf(ne,se.mode,oe),ne.return=se,ne;case P:var Se=ne._init;return ne=Se(ne._payload),Ee(se,ne,oe)}if(re(ne)||te(ne))return ne=js(ne,se.mode,oe,null),ne.return=se,ne;if(typeof ne.then=="function")return Ee(se,iu(ne),oe);if(ne.$$typeof===C)return Ee(se,Xc(se,ne),oe);lu(se,ne)}return null}function fe(se,ne,oe,Se){var He=ne!==null?ne.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return He!==null?null:R(se,ne,""+oe,Se);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case y:return oe.key===He?J(se,ne,oe,Se):null;case _:return oe.key===He?ce(se,ne,oe,Se):null;case P:return He=oe._init,oe=He(oe._payload),fe(se,ne,oe,Se)}if(re(oe)||te(oe))return He!==null?null:we(se,ne,oe,Se,null);if(typeof oe.then=="function")return fe(se,ne,iu(oe),Se);if(oe.$$typeof===C)return fe(se,ne,Xc(se,oe),Se);lu(se,oe)}return null}function ge(se,ne,oe,Se,He){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return se=se.get(oe)||null,R(ne,se,""+Se,He);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case y:return se=se.get(Se.key===null?oe:Se.key)||null,J(ne,se,Se,He);case _:return se=se.get(Se.key===null?oe:Se.key)||null,ce(ne,se,Se,He);case P:var Ze=Se._init;return Se=Ze(Se._payload),ge(se,ne,oe,Se,He)}if(re(Se)||te(Se))return se=se.get(oe)||null,we(ne,se,Se,He,null);if(typeof Se.then=="function")return ge(se,ne,oe,iu(Se),He);if(Se.$$typeof===C)return ge(se,ne,oe,Xc(ne,Se),He);lu(ne,Se)}return null}function Ge(se,ne,oe,Se){for(var He=null,Ze=null,Ve=ne,We=ne=0,on=null;Ve!==null&&We<oe.length;We++){Ve.index>We?(on=Ve,Ve=null):on=Ve.sibling;var ot=fe(se,Ve,oe[We],Se);if(ot===null){Ve===null&&(Ve=on);break}s&&Ve&&ot.alternate===null&&i(se,Ve),ne=v(ot,ne,We),Ze===null?He=ot:Ze.sibling=ot,Ze=ot,Ve=on}if(We===oe.length)return c(se,Ve),ut&&As(se,We),He;if(Ve===null){for(;We<oe.length;We++)Ve=Ee(se,oe[We],Se),Ve!==null&&(ne=v(Ve,ne,We),Ze===null?He=Ve:Ze.sibling=Ve,Ze=Ve);return ut&&As(se,We),He}for(Ve=d(Ve);We<oe.length;We++)on=ge(Ve,se,We,oe[We],Se),on!==null&&(s&&on.alternate!==null&&Ve.delete(on.key===null?We:on.key),ne=v(on,ne,We),Ze===null?He=on:Ze.sibling=on,Ze=on);return s&&Ve.forEach(function(ss){return i(se,ss)}),ut&&As(se,We),He}function Ke(se,ne,oe,Se){if(oe==null)throw Error(a(151));for(var He=null,Ze=null,Ve=ne,We=ne=0,on=null,ot=oe.next();Ve!==null&&!ot.done;We++,ot=oe.next()){Ve.index>We?(on=Ve,Ve=null):on=Ve.sibling;var ss=fe(se,Ve,ot.value,Se);if(ss===null){Ve===null&&(Ve=on);break}s&&Ve&&ss.alternate===null&&i(se,Ve),ne=v(ss,ne,We),Ze===null?He=ss:Ze.sibling=ss,Ze=ss,Ve=on}if(ot.done)return c(se,Ve),ut&&As(se,We),He;if(Ve===null){for(;!ot.done;We++,ot=oe.next())ot=Ee(se,ot.value,Se),ot!==null&&(ne=v(ot,ne,We),Ze===null?He=ot:Ze.sibling=ot,Ze=ot);return ut&&As(se,We),He}for(Ve=d(Ve);!ot.done;We++,ot=oe.next())ot=ge(Ve,se,We,ot.value,Se),ot!==null&&(s&&ot.alternate!==null&&Ve.delete(ot.key===null?We:ot.key),ne=v(ot,ne,We),Ze===null?He=ot:Ze.sibling=ot,Ze=ot);return s&&Ve.forEach(function(aS){return i(se,aS)}),ut&&As(se,We),He}function Nt(se,ne,oe,Se){if(typeof oe=="object"&&oe!==null&&oe.type===w&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case y:e:{for(var He=oe.key;ne!==null;){if(ne.key===He){if(He=oe.type,He===w){if(ne.tag===7){c(se,ne.sibling),Se=m(ne,oe.props.children),Se.return=se,se=Se;break e}}else if(ne.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===P&&Im(He)===ne.type){c(se,ne.sibling),Se=m(ne,oe.props),Ql(Se,oe),Se.return=se,se=Se;break e}c(se,ne);break}else i(se,ne);ne=ne.sibling}oe.type===w?(Se=js(oe.props.children,se.mode,Se,oe.key),Se.return=se,se=Se):(Se=Vc(oe.type,oe.key,oe.props,null,se.mode,Se),Ql(Se,oe),Se.return=se,se=Se)}return N(se);case _:e:{for(He=oe.key;ne!==null;){if(ne.key===He)if(ne.tag===4&&ne.stateNode.containerInfo===oe.containerInfo&&ne.stateNode.implementation===oe.implementation){c(se,ne.sibling),Se=m(ne,oe.children||[]),Se.return=se,se=Se;break e}else{c(se,ne);break}else i(se,ne);ne=ne.sibling}Se=Mf(oe,se.mode,Se),Se.return=se,se=Se}return N(se);case P:return He=oe._init,oe=He(oe._payload),Nt(se,ne,oe,Se)}if(re(oe))return Ge(se,ne,oe,Se);if(te(oe)){if(He=te(oe),typeof He!="function")throw Error(a(150));return oe=He.call(oe),Ke(se,ne,oe,Se)}if(typeof oe.then=="function")return Nt(se,ne,iu(oe),Se);if(oe.$$typeof===C)return Nt(se,ne,Xc(se,oe),Se);lu(se,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,ne!==null&&ne.tag===6?(c(se,ne.sibling),Se=m(ne,oe),Se.return=se,se=Se):(c(se,ne),Se=Of(oe,se.mode,Se),Se.return=se,se=Se),N(se)):c(se,ne)}return function(se,ne,oe,Se){try{$l=0;var He=Nt(se,ne,oe,Se);return Oi=null,He}catch(Ve){if(Ve===zl||Ve===qc)throw Ve;var Ze=Qn(29,Ve,null,se.mode);return Ze.lanes=Se,Ze.return=se,Ze}finally{}}}var Mi=zm(!0),Um=zm(!1),ma=de(null),Ka=null;function Kr(s){var i=s.alternate;Z(Jt,Jt.current&1),Z(ma,s),Ka===null&&(i===null||ji.current!==null||i.memoizedState!==null)&&(Ka=s)}function Vm(s){if(s.tag===22){if(Z(Jt,Jt.current),Z(ma,s),Ka===null){var i=s.alternate;i!==null&&i.memoizedState!==null&&(Ka=s)}}else Wr()}function Wr(){Z(Jt,Jt.current),Z(ma,ma.current)}function fr(s){H(ma),Ka===s&&(Ka=null),H(Jt)}var Jt=de(0);function ou(s){for(var i=s;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||td(c)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function f0(s,i,c,d){i=s.memoizedState,c=c(d,i),c=c==null?i:g({},i,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var d0={enqueueSetState:function(s,i,c){s=s._reactInternals;var d=ta(),m=zr(d);m.payload=i,c!=null&&(m.callback=c),i=Ur(s,m,d),i!==null&&(na(i,s,d),Vl(i,s,d))},enqueueReplaceState:function(s,i,c){s=s._reactInternals;var d=ta(),m=zr(d);m.tag=1,m.payload=i,c!=null&&(m.callback=c),i=Ur(s,m,d),i!==null&&(na(i,s,d),Vl(i,s,d))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var c=ta(),d=zr(c);d.tag=2,i!=null&&(d.callback=i),i=Ur(s,d,c),i!==null&&(na(i,s,c),Vl(i,s,c))}};function Km(s,i,c,d,m,v,N){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(d,v,N):i.prototype&&i.prototype.isPureReactComponent?!Ml(c,d)||!Ml(m,v):!0}function Wm(s,i,c,d){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,d),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,d),i.state!==s&&d0.enqueueReplaceState(i,i.state,null)}function Bs(s,i){var c=i;if("ref"in i){c={};for(var d in i)d!=="ref"&&(c[d]=i[d])}if(s=s.defaultProps){c===i&&(c=g({},c));for(var m in s)c[m]===void 0&&(c[m]=s[m])}return c}var cu=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Gm(s){cu(s)}function Xm(s){console.error(s)}function Ym(s){cu(s)}function uu(s,i){try{var c=s.onUncaughtError;c(i.value,{componentStack:i.stack})}catch(d){setTimeout(function(){throw d})}}function qm(s,i,c){try{var d=s.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function x0(s,i,c){return c=zr(c),c.tag=3,c.payload={element:null},c.callback=function(){uu(s,i)},c}function $m(s){return s=zr(s),s.tag=3,s}function Qm(s,i,c,d){var m=c.type.getDerivedStateFromError;if(typeof m=="function"){var v=d.value;s.payload=function(){return m(v)},s.callback=function(){qm(i,c,d)}}var N=c.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(s.callback=function(){qm(i,c,d),typeof m!="function"&&(Qr===null?Qr=new Set([this]):Qr.add(this));var R=d.stack;this.componentDidCatch(d.value,{componentStack:R!==null?R:""})})}function aT(s,i,c,d,m){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(i=c.alternate,i!==null&&Hl(i,c,m,!0),c=ma.current,c!==null){switch(c.tag){case 13:return Ka===null?H0():c.alternate===null&&Ht===0&&(Ht=3),c.flags&=-257,c.flags|=65536,c.lanes=m,d===Vf?c.flags|=16384:(i=c.updateQueue,i===null?c.updateQueue=new Set([d]):i.add(d),I0(s,d,m)),!1;case 22:return c.flags|=65536,d===Vf?c.flags|=16384:(i=c.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=i):(c=i.retryQueue,c===null?i.retryQueue=new Set([d]):c.add(d)),I0(s,d,m)),!1}throw Error(a(435,c.tag))}return I0(s,d,m),H0(),!1}if(ut)return i=ma.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=m,d!==Lf&&(s=Error(a(422),{cause:d}),Bl(fa(s,c)))):(d!==Lf&&(i=Error(a(423),{cause:d}),Bl(fa(i,c))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,d=fa(d,c),m=x0(s.stateNode,d,m),Gf(s,m),Ht!==4&&(Ht=2)),!1;var v=Error(a(520),{cause:d});if(v=fa(v,c),ro===null?ro=[v]:ro.push(v),Ht!==4&&(Ht=2),i===null)return!0;d=fa(d,c),c=i;do{switch(c.tag){case 3:return c.flags|=65536,s=m&-m,c.lanes|=s,s=x0(c.stateNode,d,s),Gf(c,s),!1;case 1:if(i=c.type,v=c.stateNode,(c.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Qr===null||!Qr.has(v))))return c.flags|=65536,m&=-m,c.lanes|=m,m=$m(m),Qm(m,s,c,d),Gf(c,m),!1}c=c.return}while(c!==null);return!1}var Zm=Error(a(461)),sn=!1;function dn(s,i,c,d){i.child=s===null?Um(i,null,c,d):Mi(i,s.child,c,d)}function Jm(s,i,c,d,m){c=c.render;var v=i.ref;if("ref"in d){var N={};for(var R in d)R!=="ref"&&(N[R]=d[R])}else N=d;return Rs(i),d=Qf(s,i,c,N,v,m),R=Zf(),s!==null&&!sn?(Jf(s,i,m),dr(s,i,m)):(ut&&R&&Rf(i),i.flags|=1,dn(s,i,d,m),i.child)}function ep(s,i,c,d,m){if(s===null){var v=c.type;return typeof v=="function"&&!Df(v)&&v.defaultProps===void 0&&c.compare===null?(i.tag=15,i.type=v,tp(s,i,v,d,m)):(s=Vc(c.type,null,d,i,i.mode,m),s.ref=i.ref,s.return=i,i.child=s)}if(v=s.child,!w0(s,m)){var N=v.memoizedProps;if(c=c.compare,c=c!==null?c:Ml,c(N,d)&&s.ref===i.ref)return dr(s,i,m)}return i.flags|=1,s=ir(v,d),s.ref=i.ref,s.return=i,i.child=s}function tp(s,i,c,d,m){if(s!==null){var v=s.memoizedProps;if(Ml(v,d)&&s.ref===i.ref)if(sn=!1,i.pendingProps=d=v,w0(s,m))(s.flags&131072)!==0&&(sn=!0);else return i.lanes=s.lanes,dr(s,i,m)}return g0(s,i,c,d,m)}function np(s,i,c){var d=i.pendingProps,m=d.children,v=s!==null?s.memoizedState:null;if(d.mode==="hidden"){if((i.flags&128)!==0){if(d=v!==null?v.baseLanes|c:c,s!==null){for(m=i.child=s.child,v=0;m!==null;)v=v|m.lanes|m.childLanes,m=m.sibling;i.childLanes=v&~d}else i.childLanes=0,i.child=null;return ap(s,i,d,c)}if((c&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},s!==null&&Yc(i,v!==null?v.cachePool:null),v!==null?tm(i,v):Yf(),Vm(i);else return i.lanes=i.childLanes=536870912,ap(s,i,v!==null?v.baseLanes|c:c,c)}else v!==null?(Yc(i,v.cachePool),tm(i,v),Wr(),i.memoizedState=null):(s!==null&&Yc(i,null),Yf(),Wr());return dn(s,i,m,c),i.child}function ap(s,i,c,d){var m=Uf();return m=m===null?null:{parent:Zt._currentValue,pool:m},i.memoizedState={baseLanes:c,cachePool:m},s!==null&&Yc(i,null),Yf(),Vm(i),s!==null&&Hl(s,i,d,!0),null}function hu(s,i){var c=i.ref;if(c===null)s!==null&&s.ref!==null&&(i.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(a(284));(s===null||s.ref!==c)&&(i.flags|=4194816)}}function g0(s,i,c,d,m){return Rs(i),c=Qf(s,i,c,d,void 0,m),d=Zf(),s!==null&&!sn?(Jf(s,i,m),dr(s,i,m)):(ut&&d&&Rf(i),i.flags|=1,dn(s,i,c,m),i.child)}function rp(s,i,c,d,m,v){return Rs(i),i.updateQueue=null,c=am(i,d,c,m),nm(s),d=Zf(),s!==null&&!sn?(Jf(s,i,v),dr(s,i,v)):(ut&&d&&Rf(i),i.flags|=1,dn(s,i,c,v),i.child)}function sp(s,i,c,d,m){if(Rs(i),i.stateNode===null){var v=Ti,N=c.contextType;typeof N=="object"&&N!==null&&(v=Nn(N)),v=new c(d,v),i.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=d0,i.stateNode=v,v._reactInternals=i,v=i.stateNode,v.props=d,v.state=i.memoizedState,v.refs={},Kf(i),N=c.contextType,v.context=typeof N=="object"&&N!==null?Nn(N):Ti,v.state=i.memoizedState,N=c.getDerivedStateFromProps,typeof N=="function"&&(f0(i,c,N,d),v.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(N=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),N!==v.state&&d0.enqueueReplaceState(v,v.state,null),Wl(i,d,v,m),Kl(),v.state=i.memoizedState),typeof v.componentDidMount=="function"&&(i.flags|=4194308),d=!0}else if(s===null){v=i.stateNode;var R=i.memoizedProps,J=Bs(c,R);v.props=J;var ce=v.context,we=c.contextType;N=Ti,typeof we=="object"&&we!==null&&(N=Nn(we));var Ee=c.getDerivedStateFromProps;we=typeof Ee=="function"||typeof v.getSnapshotBeforeUpdate=="function",R=i.pendingProps!==R,we||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(R||ce!==N)&&Wm(i,v,d,N),Ir=!1;var fe=i.memoizedState;v.state=fe,Wl(i,d,v,m),Kl(),ce=i.memoizedState,R||fe!==ce||Ir?(typeof Ee=="function"&&(f0(i,c,Ee,d),ce=i.memoizedState),(J=Ir||Km(i,c,J,d,fe,ce,N))?(we||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(i.flags|=4194308)):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=d,i.memoizedState=ce),v.props=d,v.state=ce,v.context=N,d=J):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),d=!1)}else{v=i.stateNode,Wf(s,i),N=i.memoizedProps,we=Bs(c,N),v.props=we,Ee=i.pendingProps,fe=v.context,ce=c.contextType,J=Ti,typeof ce=="object"&&ce!==null&&(J=Nn(ce)),R=c.getDerivedStateFromProps,(ce=typeof R=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(N!==Ee||fe!==J)&&Wm(i,v,d,J),Ir=!1,fe=i.memoizedState,v.state=fe,Wl(i,d,v,m),Kl();var ge=i.memoizedState;N!==Ee||fe!==ge||Ir||s!==null&&s.dependencies!==null&&Gc(s.dependencies)?(typeof R=="function"&&(f0(i,c,R,d),ge=i.memoizedState),(we=Ir||Km(i,c,we,d,fe,ge,J)||s!==null&&s.dependencies!==null&&Gc(s.dependencies))?(ce||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(d,ge,J),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(d,ge,J)),typeof v.componentDidUpdate=="function"&&(i.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof v.componentDidUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(i.flags|=1024),i.memoizedProps=d,i.memoizedState=ge),v.props=d,v.state=ge,v.context=J,d=we):(typeof v.componentDidUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(i.flags|=1024),d=!1)}return v=d,hu(s,i),d=(i.flags&128)!==0,v||d?(v=i.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:v.render(),i.flags|=1,s!==null&&d?(i.child=Mi(i,s.child,null,m),i.child=Mi(i,null,c,m)):dn(s,i,c,m),i.memoizedState=v.state,s=i.child):s=dr(s,i,m),s}function ip(s,i,c,d){return Ll(),i.flags|=256,dn(s,i,c,d),i.child}var m0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function p0(s){return{baseLanes:s,cachePool:Xg()}}function y0(s,i,c){return s=s!==null?s.childLanes&~c:0,i&&(s|=pa),s}function lp(s,i,c){var d=i.pendingProps,m=!1,v=(i.flags&128)!==0,N;if((N=v)||(N=s!==null&&s.memoizedState===null?!1:(Jt.current&2)!==0),N&&(m=!0,i.flags&=-129),N=(i.flags&32)!==0,i.flags&=-33,s===null){if(ut){if(m?Kr(i):Wr(),ut){var R=Bt,J;if(J=R){e:{for(J=R,R=Va;J.nodeType!==8;){if(!R){R=null;break e}if(J=Da(J.nextSibling),J===null){R=null;break e}}R=J}R!==null?(i.memoizedState={dehydrated:R,treeContext:ks!==null?{id:lr,overflow:or}:null,retryLane:536870912,hydrationErrors:null},J=Qn(18,null,null,0),J.stateNode=R,J.return=i,i.child=J,Mn=i,Bt=null,J=!0):J=!1}J||Os(i)}if(R=i.memoizedState,R!==null&&(R=R.dehydrated,R!==null))return td(R)?i.lanes=32:i.lanes=536870912,null;fr(i)}return R=d.children,d=d.fallback,m?(Wr(),m=i.mode,R=fu({mode:"hidden",children:R},m),d=js(d,m,c,null),R.return=i,d.return=i,R.sibling=d,i.child=R,m=i.child,m.memoizedState=p0(c),m.childLanes=y0(s,N,c),i.memoizedState=m0,d):(Kr(i),v0(i,R))}if(J=s.memoizedState,J!==null&&(R=J.dehydrated,R!==null)){if(v)i.flags&256?(Kr(i),i.flags&=-257,i=b0(s,i,c)):i.memoizedState!==null?(Wr(),i.child=s.child,i.flags|=128,i=null):(Wr(),m=d.fallback,R=i.mode,d=fu({mode:"visible",children:d.children},R),m=js(m,R,c,null),m.flags|=2,d.return=i,m.return=i,d.sibling=m,i.child=d,Mi(i,s.child,null,c),d=i.child,d.memoizedState=p0(c),d.childLanes=y0(s,N,c),i.memoizedState=m0,i=m);else if(Kr(i),td(R)){if(N=R.nextSibling&&R.nextSibling.dataset,N)var ce=N.dgst;N=ce,d=Error(a(419)),d.stack="",d.digest=N,Bl({value:d,source:null,stack:null}),i=b0(s,i,c)}else if(sn||Hl(s,i,c,!1),N=(c&s.childLanes)!==0,sn||N){if(N=At,N!==null&&(d=c&-c,d=(d&42)!==0?1:Tl(d),d=(d&(N.suspendedLanes|c))!==0?0:d,d!==0&&d!==J.retryLane))throw J.retryLane=d,wi(s,d),na(N,s,d),Zm;R.data==="$?"||H0(),i=b0(s,i,c)}else R.data==="$?"?(i.flags|=192,i.child=s.child,i=null):(s=J.treeContext,Bt=Da(R.nextSibling),Mn=i,ut=!0,Ds=null,Va=!1,s!==null&&(xa[ga++]=lr,xa[ga++]=or,xa[ga++]=ks,lr=s.id,or=s.overflow,ks=i),i=v0(i,d.children),i.flags|=4096);return i}return m?(Wr(),m=d.fallback,R=i.mode,J=s.child,ce=J.sibling,d=ir(J,{mode:"hidden",children:d.children}),d.subtreeFlags=J.subtreeFlags&65011712,ce!==null?m=ir(ce,m):(m=js(m,R,c,null),m.flags|=2),m.return=i,d.return=i,d.sibling=m,i.child=d,d=m,m=i.child,R=s.child.memoizedState,R===null?R=p0(c):(J=R.cachePool,J!==null?(ce=Zt._currentValue,J=J.parent!==ce?{parent:ce,pool:ce}:J):J=Xg(),R={baseLanes:R.baseLanes|c,cachePool:J}),m.memoizedState=R,m.childLanes=y0(s,N,c),i.memoizedState=m0,d):(Kr(i),c=s.child,s=c.sibling,c=ir(c,{mode:"visible",children:d.children}),c.return=i,c.sibling=null,s!==null&&(N=i.deletions,N===null?(i.deletions=[s],i.flags|=16):N.push(s)),i.child=c,i.memoizedState=null,c)}function v0(s,i){return i=fu({mode:"visible",children:i},s.mode),i.return=s,s.child=i}function fu(s,i){return s=Qn(22,s,null,i),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function b0(s,i,c){return Mi(i,s.child,null,c),s=v0(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function op(s,i,c){s.lanes|=i;var d=s.alternate;d!==null&&(d.lanes|=i),Hf(s.return,i,c)}function _0(s,i,c,d,m){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:m}:(v.isBackwards=i,v.rendering=null,v.renderingStartTime=0,v.last=d,v.tail=c,v.tailMode=m)}function cp(s,i,c){var d=i.pendingProps,m=d.revealOrder,v=d.tail;if(dn(s,i,d.children,c),d=Jt.current,(d&2)!==0)d=d&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&op(s,c,i);else if(s.tag===19)op(s,c,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}d&=1}switch(Z(Jt,d),m){case"forwards":for(c=i.child,m=null;c!==null;)s=c.alternate,s!==null&&ou(s)===null&&(m=c),c=c.sibling;c=m,c===null?(m=i.child,i.child=null):(m=c.sibling,c.sibling=null),_0(i,!1,m,c,v);break;case"backwards":for(c=null,m=i.child,i.child=null;m!==null;){if(s=m.alternate,s!==null&&ou(s)===null){i.child=m;break}s=m.sibling,m.sibling=c,c=m,m=s}_0(i,!0,c,null,v);break;case"together":_0(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function dr(s,i,c){if(s!==null&&(i.dependencies=s.dependencies),$r|=i.lanes,(c&i.childLanes)===0)if(s!==null){if(Hl(s,i,c,!1),(c&i.childLanes)===0)return null}else return null;if(s!==null&&i.child!==s.child)throw Error(a(153));if(i.child!==null){for(s=i.child,c=ir(s,s.pendingProps),i.child=c,c.return=i;s.sibling!==null;)s=s.sibling,c=c.sibling=ir(s,s.pendingProps),c.return=i;c.sibling=null}return i.child}function w0(s,i){return(s.lanes&i)!==0?!0:(s=s.dependencies,!!(s!==null&&Gc(s)))}function rT(s,i,c){switch(i.tag){case 3:ie(i,i.stateNode.containerInfo),Pr(i,Zt,s.memoizedState.cache),Ll();break;case 27:case 5:Ne(i);break;case 4:ie(i,i.stateNode.containerInfo);break;case 10:Pr(i,i.type,i.memoizedProps.value);break;case 13:var d=i.memoizedState;if(d!==null)return d.dehydrated!==null?(Kr(i),i.flags|=128,null):(c&i.child.childLanes)!==0?lp(s,i,c):(Kr(i),s=dr(s,i,c),s!==null?s.sibling:null);Kr(i);break;case 19:var m=(s.flags&128)!==0;if(d=(c&i.childLanes)!==0,d||(Hl(s,i,c,!1),d=(c&i.childLanes)!==0),m){if(d)return cp(s,i,c);i.flags|=128}if(m=i.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Z(Jt,Jt.current),d)break;return null;case 22:case 23:return i.lanes=0,np(s,i,c);case 24:Pr(i,Zt,s.memoizedState.cache)}return dr(s,i,c)}function up(s,i,c){if(s!==null)if(s.memoizedProps!==i.pendingProps)sn=!0;else{if(!w0(s,c)&&(i.flags&128)===0)return sn=!1,rT(s,i,c);sn=(s.flags&131072)!==0}else sn=!1,ut&&(i.flags&1048576)!==0&&Ig(i,Wc,i.index);switch(i.lanes=0,i.tag){case 16:e:{s=i.pendingProps;var d=i.elementType,m=d._init;if(d=m(d._payload),i.type=d,typeof d=="function")Df(d)?(s=Bs(d,s),i.tag=1,i=sp(null,i,d,s,c)):(i.tag=0,i=g0(null,i,d,s,c));else{if(d!=null){if(m=d.$$typeof,m===A){i.tag=11,i=Jm(null,i,d,s,c);break e}else if(m===O){i.tag=14,i=ep(null,i,d,s,c);break e}}throw i=ae(d)||d,Error(a(306,i,""))}}return i;case 0:return g0(s,i,i.type,i.pendingProps,c);case 1:return d=i.type,m=Bs(d,i.pendingProps),sp(s,i,d,m,c);case 3:e:{if(ie(i,i.stateNode.containerInfo),s===null)throw Error(a(387));d=i.pendingProps;var v=i.memoizedState;m=v.element,Wf(s,i),Wl(i,d,null,c);var N=i.memoizedState;if(d=N.cache,Pr(i,Zt,d),d!==v.cache&&Pf(i,[Zt],c,!0),Kl(),d=N.element,v.isDehydrated)if(v={element:d,isDehydrated:!1,cache:N.cache},i.updateQueue.baseState=v,i.memoizedState=v,i.flags&256){i=ip(s,i,d,c);break e}else if(d!==m){m=fa(Error(a(424)),i),Bl(m),i=ip(s,i,d,c);break e}else{switch(s=i.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Bt=Da(s.firstChild),Mn=i,ut=!0,Ds=null,Va=!0,c=Um(i,null,d,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Ll(),d===m){i=dr(s,i,c);break e}dn(s,i,d,c)}i=i.child}return i;case 26:return hu(s,i),s===null?(c=x1(i.type,null,i.pendingProps,null))?i.memoizedState=c:ut||(c=i.type,s=i.pendingProps,d=Eu(U.current).createElement(c),d[an]=i,d[rn]=s,gn(d,c,s),le(d),i.stateNode=d):i.memoizedState=x1(i.type,s.memoizedProps,i.pendingProps,s.memoizedState),null;case 27:return Ne(i),s===null&&ut&&(d=i.stateNode=h1(i.type,i.pendingProps,U.current),Mn=i,Va=!0,m=Bt,es(i.type)?(nd=m,Bt=Da(d.firstChild)):Bt=m),dn(s,i,i.pendingProps.children,c),hu(s,i),s===null&&(i.flags|=4194304),i.child;case 5:return s===null&&ut&&((m=d=Bt)&&(d=OT(d,i.type,i.pendingProps,Va),d!==null?(i.stateNode=d,Mn=i,Bt=Da(d.firstChild),Va=!1,m=!0):m=!1),m||Os(i)),Ne(i),m=i.type,v=i.pendingProps,N=s!==null?s.memoizedProps:null,d=v.children,Z0(m,v)?d=null:N!==null&&Z0(m,N)&&(i.flags|=32),i.memoizedState!==null&&(m=Qf(s,i,$w,null,null,c),xo._currentValue=m),hu(s,i),dn(s,i,d,c),i.child;case 6:return s===null&&ut&&((s=c=Bt)&&(c=MT(c,i.pendingProps,Va),c!==null?(i.stateNode=c,Mn=i,Bt=null,s=!0):s=!1),s||Os(i)),null;case 13:return lp(s,i,c);case 4:return ie(i,i.stateNode.containerInfo),d=i.pendingProps,s===null?i.child=Mi(i,null,d,c):dn(s,i,d,c),i.child;case 11:return Jm(s,i,i.type,i.pendingProps,c);case 7:return dn(s,i,i.pendingProps,c),i.child;case 8:return dn(s,i,i.pendingProps.children,c),i.child;case 12:return dn(s,i,i.pendingProps.children,c),i.child;case 10:return d=i.pendingProps,Pr(i,i.type,d.value),dn(s,i,d.children,c),i.child;case 9:return m=i.type._context,d=i.pendingProps.children,Rs(i),m=Nn(m),d=d(m),i.flags|=1,dn(s,i,d,c),i.child;case 14:return ep(s,i,i.type,i.pendingProps,c);case 15:return tp(s,i,i.type,i.pendingProps,c);case 19:return cp(s,i,c);case 31:return d=i.pendingProps,c=i.mode,d={mode:d.mode,children:d.children},s===null?(c=fu(d,c),c.ref=i.ref,i.child=c,c.return=i,i=c):(c=ir(s.child,d),c.ref=i.ref,i.child=c,c.return=i,i=c),i;case 22:return np(s,i,c);case 24:return Rs(i),d=Nn(Zt),s===null?(m=Uf(),m===null&&(m=At,v=If(),m.pooledCache=v,v.refCount++,v!==null&&(m.pooledCacheLanes|=c),m=v),i.memoizedState={parent:d,cache:m},Kf(i),Pr(i,Zt,m)):((s.lanes&c)!==0&&(Wf(s,i),Wl(i,null,null,c),Kl()),m=s.memoizedState,v=i.memoizedState,m.parent!==d?(m={parent:d,cache:d},i.memoizedState=m,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=m),Pr(i,Zt,d)):(d=v.cache,Pr(i,Zt,d),d!==m.cache&&Pf(i,[Zt],c,!0))),dn(s,i,i.pendingProps.children,c),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function xr(s){s.flags|=4}function hp(s,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!v1(i)){if(i=ma.current,i!==null&&((st&4194048)===st?Ka!==null:(st&62914560)!==st&&(st&536870912)===0||i!==Ka))throw Ul=Vf,Yg;s.flags|=8192}}function du(s,i){i!==null&&(s.flags|=4),s.flags&16384&&(i=s.tag!==22?_l():536870912,s.lanes|=i,Bi|=i)}function Zl(s,i){if(!ut)switch(s.tailMode){case"hidden":i=s.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:d.sibling=null}}function Lt(s){var i=s.alternate!==null&&s.alternate.child===s.child,c=0,d=0;if(i)for(var m=s.child;m!==null;)c|=m.lanes|m.childLanes,d|=m.subtreeFlags&65011712,d|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)c|=m.lanes|m.childLanes,d|=m.subtreeFlags,d|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=d,s.childLanes=c,i}function sT(s,i,c){var d=i.pendingProps;switch(Ff(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Lt(i),null;case 1:return Lt(i),null;case 3:return c=i.stateNode,d=null,s!==null&&(d=s.memoizedState.cache),i.memoizedState.cache!==d&&(i.flags|=2048),ur(Zt),_e(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(Fl(i)?xr(i):s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Vg())),Lt(i),null;case 26:return c=i.memoizedState,s===null?(xr(i),c!==null?(Lt(i),hp(i,c)):(Lt(i),i.flags&=-16777217)):c?c!==s.memoizedState?(xr(i),Lt(i),hp(i,c)):(Lt(i),i.flags&=-16777217):(s.memoizedProps!==d&&xr(i),Lt(i),i.flags&=-16777217),null;case 27:Ie(i),c=U.current;var m=i.type;if(s!==null&&i.stateNode!=null)s.memoizedProps!==d&&xr(i);else{if(!d){if(i.stateNode===null)throw Error(a(166));return Lt(i),null}s=j.current,Fl(i)?zg(i):(s=h1(m,d,c),i.stateNode=s,xr(i))}return Lt(i),null;case 5:if(Ie(i),c=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==d&&xr(i);else{if(!d){if(i.stateNode===null)throw Error(a(166));return Lt(i),null}if(s=j.current,Fl(i))zg(i);else{switch(m=Eu(U.current),s){case 1:s=m.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:s=m.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":s=m.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":s=m.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":s=m.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof d.is=="string"?m.createElement("select",{is:d.is}):m.createElement("select"),d.multiple?s.multiple=!0:d.size&&(s.size=d.size);break;default:s=typeof d.is=="string"?m.createElement(c,{is:d.is}):m.createElement(c)}}s[an]=i,s[rn]=d;e:for(m=i.child;m!==null;){if(m.tag===5||m.tag===6)s.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===i)break e;for(;m.sibling===null;){if(m.return===null||m.return===i)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}i.stateNode=s;e:switch(gn(s,c,d),c){case"button":case"input":case"select":case"textarea":s=!!d.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&xr(i)}}return Lt(i),i.flags&=-16777217,null;case 6:if(s&&i.stateNode!=null)s.memoizedProps!==d&&xr(i);else{if(typeof d!="string"&&i.stateNode===null)throw Error(a(166));if(s=U.current,Fl(i)){if(s=i.stateNode,c=i.memoizedProps,d=null,m=Mn,m!==null)switch(m.tag){case 27:case 5:d=m.memoizedProps}s[an]=i,s=!!(s.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||r1(s.nodeValue,c)),s||Os(i)}else s=Eu(s).createTextNode(d),s[an]=i,i.stateNode=s}return Lt(i),null;case 13:if(d=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=Fl(i),d!==null&&d.dehydrated!==null){if(s===null){if(!m)throw Error(a(318));if(m=i.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(a(317));m[an]=i}else Ll(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Lt(i),m=!1}else m=Vg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return i.flags&256?(fr(i),i):(fr(i),null)}if(fr(i),(i.flags&128)!==0)return i.lanes=c,i;if(c=d!==null,s=s!==null&&s.memoizedState!==null,c){d=i.child,m=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(m=d.alternate.memoizedState.cachePool.pool);var v=null;d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(v=d.memoizedState.cachePool.pool),v!==m&&(d.flags|=2048)}return c!==s&&c&&(i.child.flags|=8192),du(i,i.updateQueue),Lt(i),null;case 4:return _e(),s===null&&X0(i.stateNode.containerInfo),Lt(i),null;case 10:return ur(i.type),Lt(i),null;case 19:if(H(Jt),m=i.memoizedState,m===null)return Lt(i),null;if(d=(i.flags&128)!==0,v=m.rendering,v===null)if(d)Zl(m,!1);else{if(Ht!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(v=ou(s),v!==null){for(i.flags|=128,Zl(m,!1),s=v.updateQueue,i.updateQueue=s,du(i,s),i.subtreeFlags=0,s=c,c=i.child;c!==null;)Pg(c,s),c=c.sibling;return Z(Jt,Jt.current&1|2),i.child}s=s.sibling}m.tail!==null&&Fe()>mu&&(i.flags|=128,d=!0,Zl(m,!1),i.lanes=4194304)}else{if(!d)if(s=ou(v),s!==null){if(i.flags|=128,d=!0,s=s.updateQueue,i.updateQueue=s,du(i,s),Zl(m,!0),m.tail===null&&m.tailMode==="hidden"&&!v.alternate&&!ut)return Lt(i),null}else 2*Fe()-m.renderingStartTime>mu&&c!==536870912&&(i.flags|=128,d=!0,Zl(m,!1),i.lanes=4194304);m.isBackwards?(v.sibling=i.child,i.child=v):(s=m.last,s!==null?s.sibling=v:i.child=v,m.last=v)}return m.tail!==null?(i=m.tail,m.rendering=i,m.tail=i.sibling,m.renderingStartTime=Fe(),i.sibling=null,s=Jt.current,Z(Jt,d?s&1|2:s&1),i):(Lt(i),null);case 22:case 23:return fr(i),qf(),d=i.memoizedState!==null,s!==null?s.memoizedState!==null!==d&&(i.flags|=8192):d&&(i.flags|=8192),d?(c&536870912)!==0&&(i.flags&128)===0&&(Lt(i),i.subtreeFlags&6&&(i.flags|=8192)):Lt(i),c=i.updateQueue,c!==null&&du(i,c.retryQueue),c=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),d=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),d!==c&&(i.flags|=2048),s!==null&&H(Fs),null;case 24:return c=null,s!==null&&(c=s.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),ur(Zt),Lt(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function iT(s,i){switch(Ff(i),i.tag){case 1:return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return ur(Zt),_e(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 26:case 27:case 5:return Ie(i),null;case 13:if(fr(i),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(a(340));Ll()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return H(Jt),null;case 4:return _e(),null;case 10:return ur(i.type),null;case 22:case 23:return fr(i),qf(),s!==null&&H(Fs),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 24:return ur(Zt),null;case 25:return null;default:return null}}function fp(s,i){switch(Ff(i),i.tag){case 3:ur(Zt),_e();break;case 26:case 27:case 5:Ie(i);break;case 4:_e();break;case 13:fr(i);break;case 19:H(Jt);break;case 10:ur(i.type);break;case 22:case 23:fr(i),qf(),s!==null&&H(Fs);break;case 24:ur(Zt)}}function Jl(s,i){try{var c=i.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var m=d.next;c=m;do{if((c.tag&s)===s){d=void 0;var v=c.create,N=c.inst;d=v(),N.destroy=d}c=c.next}while(c!==m)}}catch(R){Ct(i,i.return,R)}}function Gr(s,i,c){try{var d=i.updateQueue,m=d!==null?d.lastEffect:null;if(m!==null){var v=m.next;d=v;do{if((d.tag&s)===s){var N=d.inst,R=N.destroy;if(R!==void 0){N.destroy=void 0,m=i;var J=c,ce=R;try{ce()}catch(we){Ct(m,J,we)}}}d=d.next}while(d!==v)}}catch(we){Ct(i,i.return,we)}}function dp(s){var i=s.updateQueue;if(i!==null){var c=s.stateNode;try{em(i,c)}catch(d){Ct(s,s.return,d)}}}function xp(s,i,c){c.props=Bs(s.type,s.memoizedProps),c.state=s.memoizedState;try{c.componentWillUnmount()}catch(d){Ct(s,i,d)}}function eo(s,i){try{var c=s.ref;if(c!==null){switch(s.tag){case 26:case 27:case 5:var d=s.stateNode;break;case 30:d=s.stateNode;break;default:d=s.stateNode}typeof c=="function"?s.refCleanup=c(d):c.current=d}}catch(m){Ct(s,i,m)}}function Wa(s,i){var c=s.ref,d=s.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(m){Ct(s,i,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(m){Ct(s,i,m)}else c.current=null}function gp(s){var i=s.type,c=s.memoizedProps,d=s.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break e;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(m){Ct(s,s.return,m)}}function T0(s,i,c){try{var d=s.stateNode;CT(d,s.type,c,i),d[rn]=i}catch(m){Ct(s,s.return,m)}}function mp(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&es(s.type)||s.tag===4}function S0(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||mp(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&es(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function N0(s,i,c){var d=s.tag;if(d===5||d===6)s=s.stateNode,i?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(s,i):(i=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,i.appendChild(s),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=Nu));else if(d!==4&&(d===27&&es(s.type)&&(c=s.stateNode,i=null),s=s.child,s!==null))for(N0(s,i,c),s=s.sibling;s!==null;)N0(s,i,c),s=s.sibling}function xu(s,i,c){var d=s.tag;if(d===5||d===6)s=s.stateNode,i?c.insertBefore(s,i):c.appendChild(s);else if(d!==4&&(d===27&&es(s.type)&&(c=s.stateNode),s=s.child,s!==null))for(xu(s,i,c),s=s.sibling;s!==null;)xu(s,i,c),s=s.sibling}function pp(s){var i=s.stateNode,c=s.memoizedProps;try{for(var d=s.type,m=i.attributes;m.length;)i.removeAttributeNode(m[0]);gn(i,d,c),i[an]=s,i[rn]=c}catch(v){Ct(s,s.return,v)}}var gr=!1,Wt=!1,E0=!1,yp=typeof WeakSet=="function"?WeakSet:Set,ln=null;function lT(s,i){if(s=s.containerInfo,$0=Ou,s=kg(s),Sf(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var m=d.anchorOffset,v=d.focusNode;d=d.focusOffset;try{c.nodeType,v.nodeType}catch{c=null;break e}var N=0,R=-1,J=-1,ce=0,we=0,Ee=s,fe=null;t:for(;;){for(var ge;Ee!==c||m!==0&&Ee.nodeType!==3||(R=N+m),Ee!==v||d!==0&&Ee.nodeType!==3||(J=N+d),Ee.nodeType===3&&(N+=Ee.nodeValue.length),(ge=Ee.firstChild)!==null;)fe=Ee,Ee=ge;for(;;){if(Ee===s)break t;if(fe===c&&++ce===m&&(R=N),fe===v&&++we===d&&(J=N),(ge=Ee.nextSibling)!==null)break;Ee=fe,fe=Ee.parentNode}Ee=ge}c=R===-1||J===-1?null:{start:R,end:J}}else c=null}c=c||{start:0,end:0}}else c=null;for(Q0={focusedElem:s,selectionRange:c},Ou=!1,ln=i;ln!==null;)if(i=ln,s=i.child,(i.subtreeFlags&1024)!==0&&s!==null)s.return=i,ln=s;else for(;ln!==null;){switch(i=ln,v=i.alternate,s=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&v!==null){s=void 0,c=i,m=v.memoizedProps,v=v.memoizedState,d=c.stateNode;try{var Ge=Bs(c.type,m,c.elementType===c.type);s=d.getSnapshotBeforeUpdate(Ge,v),d.__reactInternalSnapshotBeforeUpdate=s}catch(Ke){Ct(c,c.return,Ke)}}break;case 3:if((s&1024)!==0){if(s=i.stateNode.containerInfo,c=s.nodeType,c===9)ed(s);else if(c===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":ed(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(a(163))}if(s=i.sibling,s!==null){s.return=i.return,ln=s;break}ln=i.return}}function vp(s,i,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:Xr(s,c),d&4&&Jl(5,c);break;case 1:if(Xr(s,c),d&4)if(s=c.stateNode,i===null)try{s.componentDidMount()}catch(N){Ct(c,c.return,N)}else{var m=Bs(c.type,i.memoizedProps);i=i.memoizedState;try{s.componentDidUpdate(m,i,s.__reactInternalSnapshotBeforeUpdate)}catch(N){Ct(c,c.return,N)}}d&64&&dp(c),d&512&&eo(c,c.return);break;case 3:if(Xr(s,c),d&64&&(s=c.updateQueue,s!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{em(s,i)}catch(N){Ct(c,c.return,N)}}break;case 27:i===null&&d&4&&pp(c);case 26:case 5:Xr(s,c),i===null&&d&4&&gp(c),d&512&&eo(c,c.return);break;case 12:Xr(s,c);break;case 13:Xr(s,c),d&4&&wp(s,c),d&64&&(s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(c=mT.bind(null,c),RT(s,c))));break;case 22:if(d=c.memoizedState!==null||gr,!d){i=i!==null&&i.memoizedState!==null||Wt,m=gr;var v=Wt;gr=d,(Wt=i)&&!v?Yr(s,c,(c.subtreeFlags&8772)!==0):Xr(s,c),gr=m,Wt=v}break;case 30:break;default:Xr(s,c)}}function bp(s){var i=s.alternate;i!==null&&(s.alternate=null,bp(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&z(i)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Mt=null,In=!1;function mr(s,i,c){for(c=c.child;c!==null;)_p(s,i,c),c=c.sibling}function _p(s,i,c){if(fn&&typeof fn.onCommitFiberUnmount=="function")try{fn.onCommitFiberUnmount(Ea,c)}catch{}switch(c.tag){case 26:Wt||Wa(c,i),mr(s,i,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Wt||Wa(c,i);var d=Mt,m=In;es(c.type)&&(Mt=c.stateNode,In=!1),mr(s,i,c),co(c.stateNode),Mt=d,In=m;break;case 5:Wt||Wa(c,i);case 6:if(d=Mt,m=In,Mt=null,mr(s,i,c),Mt=d,In=m,Mt!==null)if(In)try{(Mt.nodeType===9?Mt.body:Mt.nodeName==="HTML"?Mt.ownerDocument.body:Mt).removeChild(c.stateNode)}catch(v){Ct(c,i,v)}else try{Mt.removeChild(c.stateNode)}catch(v){Ct(c,i,v)}break;case 18:Mt!==null&&(In?(s=Mt,c1(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,c.stateNode),yo(s)):c1(Mt,c.stateNode));break;case 4:d=Mt,m=In,Mt=c.stateNode.containerInfo,In=!0,mr(s,i,c),Mt=d,In=m;break;case 0:case 11:case 14:case 15:Wt||Gr(2,c,i),Wt||Gr(4,c,i),mr(s,i,c);break;case 1:Wt||(Wa(c,i),d=c.stateNode,typeof d.componentWillUnmount=="function"&&xp(c,i,d)),mr(s,i,c);break;case 21:mr(s,i,c);break;case 22:Wt=(d=Wt)||c.memoizedState!==null,mr(s,i,c),Wt=d;break;default:mr(s,i,c)}}function wp(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{yo(s)}catch(c){Ct(i,i.return,c)}}function oT(s){switch(s.tag){case 13:case 19:var i=s.stateNode;return i===null&&(i=s.stateNode=new yp),i;case 22:return s=s.stateNode,i=s._retryCache,i===null&&(i=s._retryCache=new yp),i;default:throw Error(a(435,s.tag))}}function C0(s,i){var c=oT(s);i.forEach(function(d){var m=pT.bind(null,s,d);c.has(d)||(c.add(d),d.then(m,m))})}function Zn(s,i){var c=i.deletions;if(c!==null)for(var d=0;d<c.length;d++){var m=c[d],v=s,N=i,R=N;e:for(;R!==null;){switch(R.tag){case 27:if(es(R.type)){Mt=R.stateNode,In=!1;break e}break;case 5:Mt=R.stateNode,In=!1;break e;case 3:case 4:Mt=R.stateNode.containerInfo,In=!0;break e}R=R.return}if(Mt===null)throw Error(a(160));_p(v,N,m),Mt=null,In=!1,v=m.alternate,v!==null&&(v.return=null),m.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)Tp(i,s),i=i.sibling}var Aa=null;function Tp(s,i){var c=s.alternate,d=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Zn(i,s),Jn(s),d&4&&(Gr(3,s,s.return),Jl(3,s),Gr(5,s,s.return));break;case 1:Zn(i,s),Jn(s),d&512&&(Wt||c===null||Wa(c,c.return)),d&64&&gr&&(s=s.updateQueue,s!==null&&(d=s.callbacks,d!==null&&(c=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var m=Aa;if(Zn(i,s),Jn(s),d&512&&(Wt||c===null||Wa(c,c.return)),d&4){var v=c!==null?c.memoizedState:null;if(d=s.memoizedState,c===null)if(d===null)if(s.stateNode===null){e:{d=s.type,c=s.memoizedProps,m=m.ownerDocument||m;t:switch(d){case"title":v=m.getElementsByTagName("title")[0],(!v||v[L]||v[an]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=m.createElement(d),m.head.insertBefore(v,m.querySelector("head > title"))),gn(v,d,c),v[an]=s,le(v),d=v;break e;case"link":var N=p1("link","href",m).get(d+(c.href||""));if(N){for(var R=0;R<N.length;R++)if(v=N[R],v.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&v.getAttribute("rel")===(c.rel==null?null:c.rel)&&v.getAttribute("title")===(c.title==null?null:c.title)&&v.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){N.splice(R,1);break t}}v=m.createElement(d),gn(v,d,c),m.head.appendChild(v);break;case"meta":if(N=p1("meta","content",m).get(d+(c.content||""))){for(R=0;R<N.length;R++)if(v=N[R],v.getAttribute("content")===(c.content==null?null:""+c.content)&&v.getAttribute("name")===(c.name==null?null:c.name)&&v.getAttribute("property")===(c.property==null?null:c.property)&&v.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&v.getAttribute("charset")===(c.charSet==null?null:c.charSet)){N.splice(R,1);break t}}v=m.createElement(d),gn(v,d,c),m.head.appendChild(v);break;default:throw Error(a(468,d))}v[an]=s,le(v),d=v}s.stateNode=d}else y1(m,s.type,s.stateNode);else s.stateNode=m1(m,d,s.memoizedProps);else v!==d?(v===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):v.count--,d===null?y1(m,s.type,s.stateNode):m1(m,d,s.memoizedProps)):d===null&&s.stateNode!==null&&T0(s,s.memoizedProps,c.memoizedProps)}break;case 27:Zn(i,s),Jn(s),d&512&&(Wt||c===null||Wa(c,c.return)),c!==null&&d&4&&T0(s,s.memoizedProps,c.memoizedProps);break;case 5:if(Zn(i,s),Jn(s),d&512&&(Wt||c===null||Wa(c,c.return)),s.flags&32){m=s.stateNode;try{gi(m,"")}catch(ge){Ct(s,s.return,ge)}}d&4&&s.stateNode!=null&&(m=s.memoizedProps,T0(s,m,c!==null?c.memoizedProps:m)),d&1024&&(E0=!0);break;case 6:if(Zn(i,s),Jn(s),d&4){if(s.stateNode===null)throw Error(a(162));d=s.memoizedProps,c=s.stateNode;try{c.nodeValue=d}catch(ge){Ct(s,s.return,ge)}}break;case 3:if(ku=null,m=Aa,Aa=Cu(i.containerInfo),Zn(i,s),Aa=m,Jn(s),d&4&&c!==null&&c.memoizedState.isDehydrated)try{yo(i.containerInfo)}catch(ge){Ct(s,s.return,ge)}E0&&(E0=!1,Sp(s));break;case 4:d=Aa,Aa=Cu(s.stateNode.containerInfo),Zn(i,s),Jn(s),Aa=d;break;case 12:Zn(i,s),Jn(s);break;case 13:Zn(i,s),Jn(s),s.child.flags&8192&&s.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(M0=Fe()),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,C0(s,d)));break;case 22:m=s.memoizedState!==null;var J=c!==null&&c.memoizedState!==null,ce=gr,we=Wt;if(gr=ce||m,Wt=we||J,Zn(i,s),Wt=we,gr=ce,Jn(s),d&8192)e:for(i=s.stateNode,i._visibility=m?i._visibility&-2:i._visibility|1,m&&(c===null||J||gr||Wt||Hs(s)),c=null,i=s;;){if(i.tag===5||i.tag===26){if(c===null){J=c=i;try{if(v=J.stateNode,m)N=v.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{R=J.stateNode;var Ee=J.memoizedProps.style,fe=Ee!=null&&Ee.hasOwnProperty("display")?Ee.display:null;R.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(ge){Ct(J,J.return,ge)}}}else if(i.tag===6){if(c===null){J=i;try{J.stateNode.nodeValue=m?"":J.memoizedProps}catch(ge){Ct(J,J.return,ge)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===s)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;c===i&&(c=null),i=i.return}c===i&&(c=null),i.sibling.return=i.return,i=i.sibling}d&4&&(d=s.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,C0(s,c))));break;case 19:Zn(i,s),Jn(s),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,C0(s,d)));break;case 30:break;case 21:break;default:Zn(i,s),Jn(s)}}function Jn(s){var i=s.flags;if(i&2){try{for(var c,d=s.return;d!==null;){if(mp(d)){c=d;break}d=d.return}if(c==null)throw Error(a(160));switch(c.tag){case 27:var m=c.stateNode,v=S0(s);xu(s,v,m);break;case 5:var N=c.stateNode;c.flags&32&&(gi(N,""),c.flags&=-33);var R=S0(s);xu(s,R,N);break;case 3:case 4:var J=c.stateNode.containerInfo,ce=S0(s);N0(s,ce,J);break;default:throw Error(a(161))}}catch(we){Ct(s,s.return,we)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function Sp(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var i=s;Sp(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),s=s.sibling}}function Xr(s,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)vp(s,i.alternate,i),i=i.sibling}function Hs(s){for(s=s.child;s!==null;){var i=s;switch(i.tag){case 0:case 11:case 14:case 15:Gr(4,i,i.return),Hs(i);break;case 1:Wa(i,i.return);var c=i.stateNode;typeof c.componentWillUnmount=="function"&&xp(i,i.return,c),Hs(i);break;case 27:co(i.stateNode);case 26:case 5:Wa(i,i.return),Hs(i);break;case 22:i.memoizedState===null&&Hs(i);break;case 30:Hs(i);break;default:Hs(i)}s=s.sibling}}function Yr(s,i,c){for(c=c&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var d=i.alternate,m=s,v=i,N=v.flags;switch(v.tag){case 0:case 11:case 15:Yr(m,v,c),Jl(4,v);break;case 1:if(Yr(m,v,c),d=v,m=d.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(ce){Ct(d,d.return,ce)}if(d=v,m=d.updateQueue,m!==null){var R=d.stateNode;try{var J=m.shared.hiddenCallbacks;if(J!==null)for(m.shared.hiddenCallbacks=null,m=0;m<J.length;m++)Jg(J[m],R)}catch(ce){Ct(d,d.return,ce)}}c&&N&64&&dp(v),eo(v,v.return);break;case 27:pp(v);case 26:case 5:Yr(m,v,c),c&&d===null&&N&4&&gp(v),eo(v,v.return);break;case 12:Yr(m,v,c);break;case 13:Yr(m,v,c),c&&N&4&&wp(m,v);break;case 22:v.memoizedState===null&&Yr(m,v,c),eo(v,v.return);break;case 30:break;default:Yr(m,v,c)}i=i.sibling}}function j0(s,i){var c=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),s=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==c&&(s!=null&&s.refCount++,c!=null&&Pl(c))}function k0(s,i){s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Pl(s))}function Ga(s,i,c,d){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Np(s,i,c,d),i=i.sibling}function Np(s,i,c,d){var m=i.flags;switch(i.tag){case 0:case 11:case 15:Ga(s,i,c,d),m&2048&&Jl(9,i);break;case 1:Ga(s,i,c,d);break;case 3:Ga(s,i,c,d),m&2048&&(s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Pl(s)));break;case 12:if(m&2048){Ga(s,i,c,d),s=i.stateNode;try{var v=i.memoizedProps,N=v.id,R=v.onPostCommit;typeof R=="function"&&R(N,i.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(J){Ct(i,i.return,J)}}else Ga(s,i,c,d);break;case 13:Ga(s,i,c,d);break;case 23:break;case 22:v=i.stateNode,N=i.alternate,i.memoizedState!==null?v._visibility&2?Ga(s,i,c,d):to(s,i):v._visibility&2?Ga(s,i,c,d):(v._visibility|=2,Ri(s,i,c,d,(i.subtreeFlags&10256)!==0)),m&2048&&j0(N,i);break;case 24:Ga(s,i,c,d),m&2048&&k0(i.alternate,i);break;default:Ga(s,i,c,d)}}function Ri(s,i,c,d,m){for(m=m&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var v=s,N=i,R=c,J=d,ce=N.flags;switch(N.tag){case 0:case 11:case 15:Ri(v,N,R,J,m),Jl(8,N);break;case 23:break;case 22:var we=N.stateNode;N.memoizedState!==null?we._visibility&2?Ri(v,N,R,J,m):to(v,N):(we._visibility|=2,Ri(v,N,R,J,m)),m&&ce&2048&&j0(N.alternate,N);break;case 24:Ri(v,N,R,J,m),m&&ce&2048&&k0(N.alternate,N);break;default:Ri(v,N,R,J,m)}i=i.sibling}}function to(s,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var c=s,d=i,m=d.flags;switch(d.tag){case 22:to(c,d),m&2048&&j0(d.alternate,d);break;case 24:to(c,d),m&2048&&k0(d.alternate,d);break;default:to(c,d)}i=i.sibling}}var no=8192;function Fi(s){if(s.subtreeFlags&no)for(s=s.child;s!==null;)Ep(s),s=s.sibling}function Ep(s){switch(s.tag){case 26:Fi(s),s.flags&no&&s.memoizedState!==null&&XT(Aa,s.memoizedState,s.memoizedProps);break;case 5:Fi(s);break;case 3:case 4:var i=Aa;Aa=Cu(s.stateNode.containerInfo),Fi(s),Aa=i;break;case 22:s.memoizedState===null&&(i=s.alternate,i!==null&&i.memoizedState!==null?(i=no,no=16777216,Fi(s),no=i):Fi(s));break;default:Fi(s)}}function Cp(s){var i=s.alternate;if(i!==null&&(s=i.child,s!==null)){i.child=null;do i=s.sibling,s.sibling=null,s=i;while(s!==null)}}function ao(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var d=i[c];ln=d,kp(d,s)}Cp(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)jp(s),s=s.sibling}function jp(s){switch(s.tag){case 0:case 11:case 15:ao(s),s.flags&2048&&Gr(9,s,s.return);break;case 3:ao(s);break;case 12:ao(s);break;case 22:var i=s.stateNode;s.memoizedState!==null&&i._visibility&2&&(s.return===null||s.return.tag!==13)?(i._visibility&=-3,gu(s)):ao(s);break;default:ao(s)}}function gu(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var d=i[c];ln=d,kp(d,s)}Cp(s)}for(s=s.child;s!==null;){switch(i=s,i.tag){case 0:case 11:case 15:Gr(8,i,i.return),gu(i);break;case 22:c=i.stateNode,c._visibility&2&&(c._visibility&=-3,gu(i));break;default:gu(i)}s=s.sibling}}function kp(s,i){for(;ln!==null;){var c=ln;switch(c.tag){case 0:case 11:case 15:Gr(8,c,i);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:Pl(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,ln=d;else e:for(c=s;ln!==null;){d=ln;var m=d.sibling,v=d.return;if(bp(d),d===c){ln=null;break e}if(m!==null){m.return=v,ln=m;break e}ln=v}}}var cT={getCacheForType:function(s){var i=Nn(Zt),c=i.data.get(s);return c===void 0&&(c=s(),i.data.set(s,c)),c}},uT=typeof WeakMap=="function"?WeakMap:Map,gt=0,At=null,tt=null,st=0,mt=0,ea=null,qr=!1,Li=!1,A0=!1,pr=0,Ht=0,$r=0,Ps=0,D0=0,pa=0,Bi=0,ro=null,zn=null,O0=!1,M0=0,mu=1/0,pu=null,Qr=null,xn=0,Zr=null,Hi=null,Pi=0,R0=0,F0=null,Ap=null,so=0,L0=null;function ta(){if((gt&2)!==0&&st!==0)return st&-st;if(ee.T!==null){var s=Ei;return s!==0?s:V0()}return Ac()}function Dp(){pa===0&&(pa=(st&536870912)===0||ut?bl():536870912);var s=ma.current;return s!==null&&(s.flags|=32),pa}function na(s,i,c){(s===At&&(mt===2||mt===9)||s.cancelPendingCommit!==null)&&(Ii(s,0),Jr(s,st,pa,!1)),Ts(s,c),((gt&2)===0||s!==At)&&(s===At&&((gt&2)===0&&(Ps|=c),Ht===4&&Jr(s,st,pa,!1)),Xa(s))}function Op(s,i,c){if((gt&6)!==0)throw Error(a(327));var d=!c&&(i&124)===0&&(i&s.expiredLanes)===0||ws(s,i),m=d?dT(s,i):P0(s,i,!0),v=d;do{if(m===0){Li&&!d&&Jr(s,i,0,!1);break}else{if(c=s.current.alternate,v&&!hT(c)){m=P0(s,i,!1),v=!1;continue}if(m===2){if(v=i,s.errorRecoveryDisabledLanes&v)var N=0;else N=s.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){i=N;e:{var R=s;m=ro;var J=R.current.memoizedState.isDehydrated;if(J&&(Ii(R,N).flags|=256),N=P0(R,N,!1),N!==2){if(A0&&!J){R.errorRecoveryDisabledLanes|=v,Ps|=v,m=4;break e}v=zn,zn=m,v!==null&&(zn===null?zn=v:zn.push.apply(zn,v))}m=N}if(v=!1,m!==2)continue}}if(m===1){Ii(s,0),Jr(s,i,0,!0);break}e:{switch(d=s,v=m,v){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:Jr(d,i,pa,!qr);break e;case 2:zn=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(m=M0+300-Fe(),10<m)){if(Jr(d,i,pa,!qr),fi(d,0,!0)!==0)break e;d.timeoutHandle=l1(Mp.bind(null,d,c,zn,pu,O0,i,pa,Ps,Bi,qr,v,2,-0,0),m);break e}Mp(d,c,zn,pu,O0,i,pa,Ps,Bi,qr,v,0,-0,0)}}break}while(!0);Xa(s)}function Mp(s,i,c,d,m,v,N,R,J,ce,we,Ee,fe,ge){if(s.timeoutHandle=-1,Ee=i.subtreeFlags,(Ee&8192||(Ee&16785408)===16785408)&&(fo={stylesheets:null,count:0,unsuspend:GT},Ep(i),Ee=YT(),Ee!==null)){s.cancelPendingCommit=Ee(Ip.bind(null,s,i,v,c,d,m,N,R,J,we,1,fe,ge)),Jr(s,v,N,!ce);return}Ip(s,i,v,c,d,m,N,R,J)}function hT(s){for(var i=s;;){var c=i.tag;if((c===0||c===11||c===15)&&i.flags&16384&&(c=i.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var m=c[d],v=m.getSnapshot;m=m.value;try{if(!$n(v(),m))return!1}catch{return!1}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Jr(s,i,c,d){i&=~D0,i&=~Ps,s.suspendedLanes|=i,s.pingedLanes&=~i,d&&(s.warmLanes|=i),d=s.expirationTimes;for(var m=i;0<m;){var v=31-On(m),N=1<<v;d[v]=-1,m&=~N}c!==0&&jc(s,c,i)}function yu(){return(gt&6)===0?(io(0),!1):!0}function B0(){if(tt!==null){if(mt===0)var s=tt.return;else s=tt,cr=Ms=null,e0(s),Oi=null,$l=0,s=tt;for(;s!==null;)fp(s.alternate,s),s=s.return;tt=null}}function Ii(s,i){var c=s.timeoutHandle;c!==-1&&(s.timeoutHandle=-1,kT(c)),c=s.cancelPendingCommit,c!==null&&(s.cancelPendingCommit=null,c()),B0(),At=s,tt=c=ir(s.current,null),st=i,mt=0,ea=null,qr=!1,Li=ws(s,i),A0=!1,Bi=pa=D0=Ps=$r=Ht=0,zn=ro=null,O0=!1,(i&8)!==0&&(i|=i&32);var d=s.entangledLanes;if(d!==0)for(s=s.entanglements,d&=i;0<d;){var m=31-On(d),v=1<<m;i|=s[m],d&=~v}return pr=i,Ic(),c}function Rp(s,i){Qe=null,ee.H=su,i===zl||i===qc?(i=Qg(),mt=3):i===Yg?(i=Qg(),mt=4):mt=i===Zm?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,ea=i,tt===null&&(Ht=1,uu(s,fa(i,s.current)))}function Fp(){var s=ee.H;return ee.H=su,s===null?su:s}function Lp(){var s=ee.A;return ee.A=cT,s}function H0(){Ht=4,qr||(st&4194048)!==st&&ma.current!==null||(Li=!0),($r&134217727)===0&&(Ps&134217727)===0||At===null||Jr(At,st,pa,!1)}function P0(s,i,c){var d=gt;gt|=2;var m=Fp(),v=Lp();(At!==s||st!==i)&&(pu=null,Ii(s,i)),i=!1;var N=Ht;e:do try{if(mt!==0&&tt!==null){var R=tt,J=ea;switch(mt){case 8:B0(),N=6;break e;case 3:case 2:case 9:case 6:ma.current===null&&(i=!0);var ce=mt;if(mt=0,ea=null,zi(s,R,J,ce),c&&Li){N=0;break e}break;default:ce=mt,mt=0,ea=null,zi(s,R,J,ce)}}fT(),N=Ht;break}catch(we){Rp(s,we)}while(!0);return i&&s.shellSuspendCounter++,cr=Ms=null,gt=d,ee.H=m,ee.A=v,tt===null&&(At=null,st=0,Ic()),N}function fT(){for(;tt!==null;)Bp(tt)}function dT(s,i){var c=gt;gt|=2;var d=Fp(),m=Lp();At!==s||st!==i?(pu=null,mu=Fe()+500,Ii(s,i)):Li=ws(s,i);e:do try{if(mt!==0&&tt!==null){i=tt;var v=ea;t:switch(mt){case 1:mt=0,ea=null,zi(s,i,v,1);break;case 2:case 9:if(qg(v)){mt=0,ea=null,Hp(i);break}i=function(){mt!==2&&mt!==9||At!==s||(mt=7),Xa(s)},v.then(i,i);break e;case 3:mt=7;break e;case 4:mt=5;break e;case 7:qg(v)?(mt=0,ea=null,Hp(i)):(mt=0,ea=null,zi(s,i,v,7));break;case 5:var N=null;switch(tt.tag){case 26:N=tt.memoizedState;case 5:case 27:var R=tt;if(!N||v1(N)){mt=0,ea=null;var J=R.sibling;if(J!==null)tt=J;else{var ce=R.return;ce!==null?(tt=ce,vu(ce)):tt=null}break t}}mt=0,ea=null,zi(s,i,v,5);break;case 6:mt=0,ea=null,zi(s,i,v,6);break;case 8:B0(),Ht=6;break e;default:throw Error(a(462))}}xT();break}catch(we){Rp(s,we)}while(!0);return cr=Ms=null,ee.H=d,ee.A=m,gt=c,tt!==null?0:(At=null,st=0,Ic(),Ht)}function xT(){for(;tt!==null&&!nn();)Bp(tt)}function Bp(s){var i=up(s.alternate,s,pr);s.memoizedProps=s.pendingProps,i===null?vu(s):tt=i}function Hp(s){var i=s,c=i.alternate;switch(i.tag){case 15:case 0:i=rp(c,i,i.pendingProps,i.type,void 0,st);break;case 11:i=rp(c,i,i.pendingProps,i.type.render,i.ref,st);break;case 5:e0(i);default:fp(c,i),i=tt=Pg(i,pr),i=up(c,i,pr)}s.memoizedProps=s.pendingProps,i===null?vu(s):tt=i}function zi(s,i,c,d){cr=Ms=null,e0(i),Oi=null,$l=0;var m=i.return;try{if(aT(s,m,i,c,st)){Ht=1,uu(s,fa(c,s.current)),tt=null;return}}catch(v){if(m!==null)throw tt=m,v;Ht=1,uu(s,fa(c,s.current)),tt=null;return}i.flags&32768?(ut||d===1?s=!0:Li||(st&536870912)!==0?s=!1:(qr=s=!0,(d===2||d===9||d===3||d===6)&&(d=ma.current,d!==null&&d.tag===13&&(d.flags|=16384))),Pp(i,s)):vu(i)}function vu(s){var i=s;do{if((i.flags&32768)!==0){Pp(i,qr);return}s=i.return;var c=sT(i.alternate,i,pr);if(c!==null){tt=c;return}if(i=i.sibling,i!==null){tt=i;return}tt=i=s}while(i!==null);Ht===0&&(Ht=5)}function Pp(s,i){do{var c=iT(s.alternate,s);if(c!==null){c.flags&=32767,tt=c;return}if(c=s.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!i&&(s=s.sibling,s!==null)){tt=s;return}tt=s=c}while(s!==null);Ht=6,tt=null}function Ip(s,i,c,d,m,v,N,R,J){s.cancelPendingCommit=null;do bu();while(xn!==0);if((gt&6)!==0)throw Error(a(327));if(i!==null){if(i===s.current)throw Error(a(177));if(v=i.lanes|i.childLanes,v|=kf,di(s,c,v,N,R,J),s===At&&(tt=At=null,st=0),Hi=i,Zr=s,Pi=c,R0=v,F0=m,Ap=d,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,yT(ze,function(){return Wp(),null})):(s.callbackNode=null,s.callbackPriority=0),d=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||d){d=ee.T,ee.T=null,m=Q.p,Q.p=2,N=gt,gt|=4;try{lT(s,i,c)}finally{gt=N,Q.p=m,ee.T=d}}xn=1,zp(),Up(),Vp()}}function zp(){if(xn===1){xn=0;var s=Zr,i=Hi,c=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||c){c=ee.T,ee.T=null;var d=Q.p;Q.p=2;var m=gt;gt|=4;try{Tp(i,s);var v=Q0,N=kg(s.containerInfo),R=v.focusedElem,J=v.selectionRange;if(N!==R&&R&&R.ownerDocument&&jg(R.ownerDocument.documentElement,R)){if(J!==null&&Sf(R)){var ce=J.start,we=J.end;if(we===void 0&&(we=ce),"selectionStart"in R)R.selectionStart=ce,R.selectionEnd=Math.min(we,R.value.length);else{var Ee=R.ownerDocument||document,fe=Ee&&Ee.defaultView||window;if(fe.getSelection){var ge=fe.getSelection(),Ge=R.textContent.length,Ke=Math.min(J.start,Ge),Nt=J.end===void 0?Ke:Math.min(J.end,Ge);!ge.extend&&Ke>Nt&&(N=Nt,Nt=Ke,Ke=N);var se=Cg(R,Ke),ne=Cg(R,Nt);if(se&&ne&&(ge.rangeCount!==1||ge.anchorNode!==se.node||ge.anchorOffset!==se.offset||ge.focusNode!==ne.node||ge.focusOffset!==ne.offset)){var oe=Ee.createRange();oe.setStart(se.node,se.offset),ge.removeAllRanges(),Ke>Nt?(ge.addRange(oe),ge.extend(ne.node,ne.offset)):(oe.setEnd(ne.node,ne.offset),ge.addRange(oe))}}}}for(Ee=[],ge=R;ge=ge.parentNode;)ge.nodeType===1&&Ee.push({element:ge,left:ge.scrollLeft,top:ge.scrollTop});for(typeof R.focus=="function"&&R.focus(),R=0;R<Ee.length;R++){var Se=Ee[R];Se.element.scrollLeft=Se.left,Se.element.scrollTop=Se.top}}Ou=!!$0,Q0=$0=null}finally{gt=m,Q.p=d,ee.T=c}}s.current=i,xn=2}}function Up(){if(xn===2){xn=0;var s=Zr,i=Hi,c=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||c){c=ee.T,ee.T=null;var d=Q.p;Q.p=2;var m=gt;gt|=4;try{vp(s,i.alternate,i)}finally{gt=m,Q.p=d,ee.T=c}}xn=3}}function Vp(){if(xn===4||xn===3){xn=0,xt();var s=Zr,i=Hi,c=Pi,d=Ap;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?xn=5:(xn=0,Hi=Zr=null,Kp(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(Qr=null),Sl(c),i=i.stateNode,fn&&typeof fn.onCommitFiberRoot=="function")try{fn.onCommitFiberRoot(Ea,i,void 0,(i.current.flags&128)===128)}catch{}if(d!==null){i=ee.T,m=Q.p,Q.p=2,ee.T=null;try{for(var v=s.onRecoverableError,N=0;N<d.length;N++){var R=d[N];v(R.value,{componentStack:R.stack})}}finally{ee.T=i,Q.p=m}}(Pi&3)!==0&&bu(),Xa(s),m=s.pendingLanes,(c&4194090)!==0&&(m&42)!==0?s===L0?so++:(so=0,L0=s):so=0,io(0)}}function Kp(s,i){(s.pooledCacheLanes&=i)===0&&(i=s.pooledCache,i!=null&&(s.pooledCache=null,Pl(i)))}function bu(s){return zp(),Up(),Vp(),Wp()}function Wp(){if(xn!==5)return!1;var s=Zr,i=R0;R0=0;var c=Sl(Pi),d=ee.T,m=Q.p;try{Q.p=32>c?32:c,ee.T=null,c=F0,F0=null;var v=Zr,N=Pi;if(xn=0,Hi=Zr=null,Pi=0,(gt&6)!==0)throw Error(a(331));var R=gt;if(gt|=4,jp(v.current),Np(v,v.current,N,c),gt=R,io(0,!1),fn&&typeof fn.onPostCommitFiberRoot=="function")try{fn.onPostCommitFiberRoot(Ea,v)}catch{}return!0}finally{Q.p=m,ee.T=d,Kp(s,i)}}function Gp(s,i,c){i=fa(c,i),i=x0(s.stateNode,i,2),s=Ur(s,i,2),s!==null&&(Ts(s,2),Xa(s))}function Ct(s,i,c){if(s.tag===3)Gp(s,s,c);else for(;i!==null;){if(i.tag===3){Gp(i,s,c);break}else if(i.tag===1){var d=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Qr===null||!Qr.has(d))){s=fa(c,s),c=$m(2),d=Ur(i,c,2),d!==null&&(Qm(c,d,i,s),Ts(d,2),Xa(d));break}}i=i.return}}function I0(s,i,c){var d=s.pingCache;if(d===null){d=s.pingCache=new uT;var m=new Set;d.set(i,m)}else m=d.get(i),m===void 0&&(m=new Set,d.set(i,m));m.has(c)||(A0=!0,m.add(c),s=gT.bind(null,s,i,c),i.then(s,s))}function gT(s,i,c){var d=s.pingCache;d!==null&&d.delete(i),s.pingedLanes|=s.suspendedLanes&c,s.warmLanes&=~c,At===s&&(st&c)===c&&(Ht===4||Ht===3&&(st&62914560)===st&&300>Fe()-M0?(gt&2)===0&&Ii(s,0):D0|=c,Bi===st&&(Bi=0)),Xa(s)}function Xp(s,i){i===0&&(i=_l()),s=wi(s,i),s!==null&&(Ts(s,i),Xa(s))}function mT(s){var i=s.memoizedState,c=0;i!==null&&(c=i.retryLane),Xp(s,c)}function pT(s,i){var c=0;switch(s.tag){case 13:var d=s.stateNode,m=s.memoizedState;m!==null&&(c=m.retryLane);break;case 19:d=s.stateNode;break;case 22:d=s.stateNode._retryCache;break;default:throw Error(a(314))}d!==null&&d.delete(i),Xp(s,c)}function yT(s,i){return at(s,i)}var _u=null,Ui=null,z0=!1,wu=!1,U0=!1,Is=0;function Xa(s){s!==Ui&&s.next===null&&(Ui===null?_u=Ui=s:Ui=Ui.next=s),wu=!0,z0||(z0=!0,bT())}function io(s,i){if(!U0&&wu){U0=!0;do for(var c=!1,d=_u;d!==null;){if(s!==0){var m=d.pendingLanes;if(m===0)var v=0;else{var N=d.suspendedLanes,R=d.pingedLanes;v=(1<<31-On(42|s)+1)-1,v&=m&~(N&~R),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(c=!0,Qp(d,v))}else v=st,v=fi(d,d===At?v:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(v&3)===0||ws(d,v)||(c=!0,Qp(d,v));d=d.next}while(c);U0=!1}}function vT(){Yp()}function Yp(){wu=z0=!1;var s=0;Is!==0&&(jT()&&(s=Is),Is=0);for(var i=Fe(),c=null,d=_u;d!==null;){var m=d.next,v=qp(d,i);v===0?(d.next=null,c===null?_u=m:c.next=m,m===null&&(Ui=c)):(c=d,(s!==0||(v&3)!==0)&&(wu=!0)),d=m}io(s)}function qp(s,i){for(var c=s.suspendedLanes,d=s.pingedLanes,m=s.expirationTimes,v=s.pendingLanes&-62914561;0<v;){var N=31-On(v),R=1<<N,J=m[N];J===-1?((R&c)===0||(R&d)!==0)&&(m[N]=Cc(R,i)):J<=i&&(s.expiredLanes|=R),v&=~R}if(i=At,c=st,c=fi(s,s===i?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d=s.callbackNode,c===0||s===i&&(mt===2||mt===9)||s.cancelPendingCommit!==null)return d!==null&&d!==null&&Ye(d),s.callbackNode=null,s.callbackPriority=0;if((c&3)===0||ws(s,c)){if(i=c&-c,i===s.callbackPriority)return i;switch(d!==null&&Ye(d),Sl(c)){case 2:case 8:c=ke;break;case 32:c=ze;break;case 268435456:c=Dt;break;default:c=ze}return d=$p.bind(null,s),c=at(c,d),s.callbackPriority=i,s.callbackNode=c,i}return d!==null&&d!==null&&Ye(d),s.callbackPriority=2,s.callbackNode=null,2}function $p(s,i){if(xn!==0&&xn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var c=s.callbackNode;if(bu()&&s.callbackNode!==c)return null;var d=st;return d=fi(s,s===At?d:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d===0?null:(Op(s,d,i),qp(s,Fe()),s.callbackNode!=null&&s.callbackNode===c?$p.bind(null,s):null)}function Qp(s,i){if(bu())return null;Op(s,i,!0)}function bT(){AT(function(){(gt&6)!==0?at(pe,vT):Yp()})}function V0(){return Is===0&&(Is=bl()),Is}function Zp(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Mc(""+s)}function Jp(s,i){var c=i.ownerDocument.createElement("input");return c.name=i.name,c.value=i.value,s.id&&c.setAttribute("form",s.id),i.parentNode.insertBefore(c,i),s=new FormData(s),c.parentNode.removeChild(c),s}function _T(s,i,c,d,m){if(i==="submit"&&c&&c.stateNode===m){var v=Zp((m[rn]||null).action),N=d.submitter;N&&(i=(i=N[rn]||null)?Zp(i.formAction):N.getAttribute("formAction"),i!==null&&(v=i,N=null));var R=new Bc("action","action",null,d,m);s.push({event:R,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(Is!==0){var J=N?Jp(m,N):new FormData(m);c0(c,{pending:!0,data:J,method:m.method,action:v},null,J)}}else typeof v=="function"&&(R.preventDefault(),J=N?Jp(m,N):new FormData(m),c0(c,{pending:!0,data:J,method:m.method,action:v},v,J))},currentTarget:m}]})}}for(var K0=0;K0<jf.length;K0++){var W0=jf[K0],wT=W0.toLowerCase(),TT=W0[0].toUpperCase()+W0.slice(1);ka(wT,"on"+TT)}ka(Og,"onAnimationEnd"),ka(Mg,"onAnimationIteration"),ka(Rg,"onAnimationStart"),ka("dblclick","onDoubleClick"),ka("focusin","onFocus"),ka("focusout","onBlur"),ka(Iw,"onTransitionRun"),ka(zw,"onTransitionStart"),ka(Uw,"onTransitionCancel"),ka(Fg,"onTransitionEnd"),De("onMouseEnter",["mouseout","mouseover"]),De("onMouseLeave",["mouseout","mouseover"]),De("onPointerEnter",["pointerout","pointerover"]),De("onPointerLeave",["pointerout","pointerover"]),je("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),je("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),je("onBeforeInput",["compositionend","keypress","textInput","paste"]),je("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),je("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),je("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ST=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(lo));function e1(s,i){i=(i&4)!==0;for(var c=0;c<s.length;c++){var d=s[c],m=d.event;d=d.listeners;e:{var v=void 0;if(i)for(var N=d.length-1;0<=N;N--){var R=d[N],J=R.instance,ce=R.currentTarget;if(R=R.listener,J!==v&&m.isPropagationStopped())break e;v=R,m.currentTarget=ce;try{v(m)}catch(we){cu(we)}m.currentTarget=null,v=J}else for(N=0;N<d.length;N++){if(R=d[N],J=R.instance,ce=R.currentTarget,R=R.listener,J!==v&&m.isPropagationStopped())break e;v=R,m.currentTarget=ce;try{v(m)}catch(we){cu(we)}m.currentTarget=null,v=J}}}}function nt(s,i){var c=i[Nl];c===void 0&&(c=i[Nl]=new Set);var d=s+"__bubble";c.has(d)||(t1(i,s,2,!1),c.add(d))}function G0(s,i,c){var d=0;i&&(d|=4),t1(c,s,d,i)}var Tu="_reactListening"+Math.random().toString(36).slice(2);function X0(s){if(!s[Tu]){s[Tu]=!0,he.forEach(function(c){c!=="selectionchange"&&(ST.has(c)||G0(c,!1,s),G0(c,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[Tu]||(i[Tu]=!0,G0("selectionchange",!1,i))}}function t1(s,i,c,d){switch(N1(i)){case 2:var m=QT;break;case 8:m=ZT;break;default:m=ld}c=m.bind(null,i,c,s),m=void 0,!gf||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(m=!0),d?m!==void 0?s.addEventListener(i,c,{capture:!0,passive:m}):s.addEventListener(i,c,!0):m!==void 0?s.addEventListener(i,c,{passive:m}):s.addEventListener(i,c,!1)}function Y0(s,i,c,d,m){var v=d;if((i&1)===0&&(i&2)===0&&d!==null)e:for(;;){if(d===null)return;var N=d.tag;if(N===3||N===4){var R=d.stateNode.containerInfo;if(R===m)break;if(N===4)for(N=d.return;N!==null;){var J=N.tag;if((J===3||J===4)&&N.stateNode.containerInfo===m)return;N=N.return}for(;R!==null;){if(N=W(R),N===null)return;if(J=N.tag,J===5||J===6||J===26||J===27){d=v=N;continue e}R=R.parentNode}}d=d.return}og(function(){var ce=v,we=df(c),Ee=[];e:{var fe=Lg.get(s);if(fe!==void 0){var ge=Bc,Ge=s;switch(s){case"keypress":if(Fc(c)===0)break e;case"keydown":case"keyup":ge=yw;break;case"focusin":Ge="focus",ge=vf;break;case"focusout":Ge="blur",ge=vf;break;case"beforeblur":case"afterblur":ge=vf;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=hg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=iw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=_w;break;case Og:case Mg:case Rg:ge=cw;break;case Fg:ge=Tw;break;case"scroll":case"scrollend":ge=rw;break;case"wheel":ge=Nw;break;case"copy":case"cut":case"paste":ge=hw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=dg;break;case"toggle":case"beforetoggle":ge=Cw}var Ke=(i&4)!==0,Nt=!Ke&&(s==="scroll"||s==="scrollend"),se=Ke?fe!==null?fe+"Capture":null:fe;Ke=[];for(var ne=ce,oe;ne!==null;){var Se=ne;if(oe=Se.stateNode,Se=Se.tag,Se!==5&&Se!==26&&Se!==27||oe===null||se===null||(Se=El(ne,se),Se!=null&&Ke.push(oo(ne,Se,oe))),Nt)break;ne=ne.return}0<Ke.length&&(fe=new ge(fe,Ge,null,c,we),Ee.push({event:fe,listeners:Ke}))}}if((i&7)===0){e:{if(fe=s==="mouseover"||s==="pointerover",ge=s==="mouseout"||s==="pointerout",fe&&c!==ff&&(Ge=c.relatedTarget||c.fromElement)&&(W(Ge)||Ge[Lr]))break e;if((ge||fe)&&(fe=we.window===we?we:(fe=we.ownerDocument)?fe.defaultView||fe.parentWindow:window,ge?(Ge=c.relatedTarget||c.toElement,ge=ce,Ge=Ge?W(Ge):null,Ge!==null&&(Nt=l(Ge),Ke=Ge.tag,Ge!==Nt||Ke!==5&&Ke!==27&&Ke!==6)&&(Ge=null)):(ge=null,Ge=ce),ge!==Ge)){if(Ke=hg,Se="onMouseLeave",se="onMouseEnter",ne="mouse",(s==="pointerout"||s==="pointerover")&&(Ke=dg,Se="onPointerLeave",se="onPointerEnter",ne="pointer"),Nt=ge==null?fe:ue(ge),oe=Ge==null?fe:ue(Ge),fe=new Ke(Se,ne+"leave",ge,c,we),fe.target=Nt,fe.relatedTarget=oe,Se=null,W(we)===ce&&(Ke=new Ke(se,ne+"enter",Ge,c,we),Ke.target=oe,Ke.relatedTarget=Nt,Se=Ke),Nt=Se,ge&&Ge)t:{for(Ke=ge,se=Ge,ne=0,oe=Ke;oe;oe=Vi(oe))ne++;for(oe=0,Se=se;Se;Se=Vi(Se))oe++;for(;0<ne-oe;)Ke=Vi(Ke),ne--;for(;0<oe-ne;)se=Vi(se),oe--;for(;ne--;){if(Ke===se||se!==null&&Ke===se.alternate)break t;Ke=Vi(Ke),se=Vi(se)}Ke=null}else Ke=null;ge!==null&&n1(Ee,fe,ge,Ke,!1),Ge!==null&&Nt!==null&&n1(Ee,Nt,Ge,Ke,!0)}}e:{if(fe=ce?ue(ce):window,ge=fe.nodeName&&fe.nodeName.toLowerCase(),ge==="select"||ge==="input"&&fe.type==="file")var He=_g;else if(vg(fe))if(wg)He=Bw;else{He=Fw;var Ze=Rw}else ge=fe.nodeName,!ge||ge.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?ce&&hf(ce.elementType)&&(He=_g):He=Lw;if(He&&(He=He(s,ce))){bg(Ee,He,c,we);break e}Ze&&Ze(s,fe,ce),s==="focusout"&&ce&&fe.type==="number"&&ce.memoizedProps.value!=null&&uf(fe,"number",fe.value)}switch(Ze=ce?ue(ce):window,s){case"focusin":(vg(Ze)||Ze.contentEditable==="true")&&(vi=Ze,Nf=ce,Rl=null);break;case"focusout":Rl=Nf=vi=null;break;case"mousedown":Ef=!0;break;case"contextmenu":case"mouseup":case"dragend":Ef=!1,Ag(Ee,c,we);break;case"selectionchange":if(Pw)break;case"keydown":case"keyup":Ag(Ee,c,we)}var Ve;if(_f)e:{switch(s){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else yi?pg(s,c)&&(We="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(We="onCompositionStart");We&&(xg&&c.locale!=="ko"&&(yi||We!=="onCompositionStart"?We==="onCompositionEnd"&&yi&&(Ve=cg()):(Hr=we,mf="value"in Hr?Hr.value:Hr.textContent,yi=!0)),Ze=Su(ce,We),0<Ze.length&&(We=new fg(We,s,null,c,we),Ee.push({event:We,listeners:Ze}),Ve?We.data=Ve:(Ve=yg(c),Ve!==null&&(We.data=Ve)))),(Ve=kw?Aw(s,c):Dw(s,c))&&(We=Su(ce,"onBeforeInput"),0<We.length&&(Ze=new fg("onBeforeInput","beforeinput",null,c,we),Ee.push({event:Ze,listeners:We}),Ze.data=Ve)),_T(Ee,s,ce,c,we)}e1(Ee,i)})}function oo(s,i,c){return{instance:s,listener:i,currentTarget:c}}function Su(s,i){for(var c=i+"Capture",d=[];s!==null;){var m=s,v=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||v===null||(m=El(s,c),m!=null&&d.unshift(oo(s,m,v)),m=El(s,i),m!=null&&d.push(oo(s,m,v))),s.tag===3)return d;s=s.return}return[]}function Vi(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function n1(s,i,c,d,m){for(var v=i._reactName,N=[];c!==null&&c!==d;){var R=c,J=R.alternate,ce=R.stateNode;if(R=R.tag,J!==null&&J===d)break;R!==5&&R!==26&&R!==27||ce===null||(J=ce,m?(ce=El(c,v),ce!=null&&N.unshift(oo(c,ce,J))):m||(ce=El(c,v),ce!=null&&N.push(oo(c,ce,J)))),c=c.return}N.length!==0&&s.push({event:i,listeners:N})}var NT=/\r\n?/g,ET=/\u0000|\uFFFD/g;function a1(s){return(typeof s=="string"?s:""+s).replace(NT,`
`).replace(ET,"")}function r1(s,i){return i=a1(i),a1(s)===i}function Nu(){}function St(s,i,c,d,m,v){switch(c){case"children":typeof d=="string"?i==="body"||i==="textarea"&&d===""||gi(s,d):(typeof d=="number"||typeof d=="bigint")&&i!=="body"&&gi(s,""+d);break;case"className":wt(s,"class",d);break;case"tabIndex":wt(s,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":wt(s,c,d);break;case"style":ig(s,d,v);break;case"data":if(i!=="object"){wt(s,"data",d);break}case"src":case"href":if(d===""&&(i!=="a"||c!=="href")){s.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(c);break}d=Mc(""+d),s.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){s.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(c==="formAction"?(i!=="input"&&St(s,i,"name",m.name,m,null),St(s,i,"formEncType",m.formEncType,m,null),St(s,i,"formMethod",m.formMethod,m,null),St(s,i,"formTarget",m.formTarget,m,null)):(St(s,i,"encType",m.encType,m,null),St(s,i,"method",m.method,m,null),St(s,i,"target",m.target,m,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(c);break}d=Mc(""+d),s.setAttribute(c,d);break;case"onClick":d!=null&&(s.onclick=Nu);break;case"onScroll":d!=null&&nt("scroll",s);break;case"onScrollEnd":d!=null&&nt("scrollend",s);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(a(61));if(c=d.__html,c!=null){if(m.children!=null)throw Error(a(60));s.innerHTML=c}}break;case"multiple":s.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":s.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){s.removeAttribute("xlink:href");break}c=Mc(""+d),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,""+d):s.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,""):s.removeAttribute(c);break;case"capture":case"download":d===!0?s.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,d):s.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?s.setAttribute(c,d):s.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?s.removeAttribute(c):s.setAttribute(c,d);break;case"popover":nt("beforetoggle",s),nt("toggle",s),_t(s,"popover",d);break;case"xlinkActuate":kt(s,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":kt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":kt(s,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":kt(s,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":kt(s,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":kt(s,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":kt(s,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":kt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":kt(s,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":_t(s,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=nw.get(c)||c,_t(s,c,d))}}function q0(s,i,c,d,m,v){switch(c){case"style":ig(s,d,v);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(a(61));if(c=d.__html,c!=null){if(m.children!=null)throw Error(a(60));s.innerHTML=c}}break;case"children":typeof d=="string"?gi(s,d):(typeof d=="number"||typeof d=="bigint")&&gi(s,""+d);break;case"onScroll":d!=null&&nt("scroll",s);break;case"onScrollEnd":d!=null&&nt("scrollend",s);break;case"onClick":d!=null&&(s.onclick=Nu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xe.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(m=c.endsWith("Capture"),i=c.slice(2,m?c.length-7:void 0),v=s[rn]||null,v=v!=null?v[c]:null,typeof v=="function"&&s.removeEventListener(i,v,m),typeof d=="function")){typeof v!="function"&&v!==null&&(c in s?s[c]=null:s.hasAttribute(c)&&s.removeAttribute(c)),s.addEventListener(i,d,m);break e}c in s?s[c]=d:d===!0?s.setAttribute(c,""):_t(s,c,d)}}}function gn(s,i,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":nt("error",s),nt("load",s);var d=!1,m=!1,v;for(v in c)if(c.hasOwnProperty(v)){var N=c[v];if(N!=null)switch(v){case"src":d=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:St(s,i,v,N,c,null)}}m&&St(s,i,"srcSet",c.srcSet,c,null),d&&St(s,i,"src",c.src,c,null);return;case"input":nt("invalid",s);var R=v=N=m=null,J=null,ce=null;for(d in c)if(c.hasOwnProperty(d)){var we=c[d];if(we!=null)switch(d){case"name":m=we;break;case"type":N=we;break;case"checked":J=we;break;case"defaultChecked":ce=we;break;case"value":v=we;break;case"defaultValue":R=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(a(137,i));break;default:St(s,i,d,we,c,null)}}ng(s,v,R,J,ce,N,m,!1),Dc(s);return;case"select":nt("invalid",s),d=N=v=null;for(m in c)if(c.hasOwnProperty(m)&&(R=c[m],R!=null))switch(m){case"value":v=R;break;case"defaultValue":N=R;break;case"multiple":d=R;default:St(s,i,m,R,c,null)}i=v,c=N,s.multiple=!!d,i!=null?xi(s,!!d,i,!1):c!=null&&xi(s,!!d,c,!0);return;case"textarea":nt("invalid",s),v=m=d=null;for(N in c)if(c.hasOwnProperty(N)&&(R=c[N],R!=null))switch(N){case"value":d=R;break;case"defaultValue":m=R;break;case"children":v=R;break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(a(91));break;default:St(s,i,N,R,c,null)}rg(s,d,m,v),Dc(s);return;case"option":for(J in c)if(c.hasOwnProperty(J)&&(d=c[J],d!=null))switch(J){case"selected":s.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:St(s,i,J,d,c,null)}return;case"dialog":nt("beforetoggle",s),nt("toggle",s),nt("cancel",s),nt("close",s);break;case"iframe":case"object":nt("load",s);break;case"video":case"audio":for(d=0;d<lo.length;d++)nt(lo[d],s);break;case"image":nt("error",s),nt("load",s);break;case"details":nt("toggle",s);break;case"embed":case"source":case"link":nt("error",s),nt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ce in c)if(c.hasOwnProperty(ce)&&(d=c[ce],d!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:St(s,i,ce,d,c,null)}return;default:if(hf(i)){for(we in c)c.hasOwnProperty(we)&&(d=c[we],d!==void 0&&q0(s,i,we,d,c,void 0));return}}for(R in c)c.hasOwnProperty(R)&&(d=c[R],d!=null&&St(s,i,R,d,c,null))}function CT(s,i,c,d){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,v=null,N=null,R=null,J=null,ce=null,we=null;for(ge in c){var Ee=c[ge];if(c.hasOwnProperty(ge)&&Ee!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":J=Ee;default:d.hasOwnProperty(ge)||St(s,i,ge,null,d,Ee)}}for(var fe in d){var ge=d[fe];if(Ee=c[fe],d.hasOwnProperty(fe)&&(ge!=null||Ee!=null))switch(fe){case"type":v=ge;break;case"name":m=ge;break;case"checked":ce=ge;break;case"defaultChecked":we=ge;break;case"value":N=ge;break;case"defaultValue":R=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(a(137,i));break;default:ge!==Ee&&St(s,i,fe,ge,d,Ee)}}cf(s,N,R,J,ce,we,v,m);return;case"select":ge=N=R=fe=null;for(v in c)if(J=c[v],c.hasOwnProperty(v)&&J!=null)switch(v){case"value":break;case"multiple":ge=J;default:d.hasOwnProperty(v)||St(s,i,v,null,d,J)}for(m in d)if(v=d[m],J=c[m],d.hasOwnProperty(m)&&(v!=null||J!=null))switch(m){case"value":fe=v;break;case"defaultValue":R=v;break;case"multiple":N=v;default:v!==J&&St(s,i,m,v,d,J)}i=R,c=N,d=ge,fe!=null?xi(s,!!c,fe,!1):!!d!=!!c&&(i!=null?xi(s,!!c,i,!0):xi(s,!!c,c?[]:"",!1));return;case"textarea":ge=fe=null;for(R in c)if(m=c[R],c.hasOwnProperty(R)&&m!=null&&!d.hasOwnProperty(R))switch(R){case"value":break;case"children":break;default:St(s,i,R,null,d,m)}for(N in d)if(m=d[N],v=c[N],d.hasOwnProperty(N)&&(m!=null||v!=null))switch(N){case"value":fe=m;break;case"defaultValue":ge=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(a(91));break;default:m!==v&&St(s,i,N,m,d,v)}ag(s,fe,ge);return;case"option":for(var Ge in c)if(fe=c[Ge],c.hasOwnProperty(Ge)&&fe!=null&&!d.hasOwnProperty(Ge))switch(Ge){case"selected":s.selected=!1;break;default:St(s,i,Ge,null,d,fe)}for(J in d)if(fe=d[J],ge=c[J],d.hasOwnProperty(J)&&fe!==ge&&(fe!=null||ge!=null))switch(J){case"selected":s.selected=fe&&typeof fe!="function"&&typeof fe!="symbol";break;default:St(s,i,J,fe,d,ge)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ke in c)fe=c[Ke],c.hasOwnProperty(Ke)&&fe!=null&&!d.hasOwnProperty(Ke)&&St(s,i,Ke,null,d,fe);for(ce in d)if(fe=d[ce],ge=c[ce],d.hasOwnProperty(ce)&&fe!==ge&&(fe!=null||ge!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(a(137,i));break;default:St(s,i,ce,fe,d,ge)}return;default:if(hf(i)){for(var Nt in c)fe=c[Nt],c.hasOwnProperty(Nt)&&fe!==void 0&&!d.hasOwnProperty(Nt)&&q0(s,i,Nt,void 0,d,fe);for(we in d)fe=d[we],ge=c[we],!d.hasOwnProperty(we)||fe===ge||fe===void 0&&ge===void 0||q0(s,i,we,fe,d,ge);return}}for(var se in c)fe=c[se],c.hasOwnProperty(se)&&fe!=null&&!d.hasOwnProperty(se)&&St(s,i,se,null,d,fe);for(Ee in d)fe=d[Ee],ge=c[Ee],!d.hasOwnProperty(Ee)||fe===ge||fe==null&&ge==null||St(s,i,Ee,fe,d,ge)}var $0=null,Q0=null;function Eu(s){return s.nodeType===9?s:s.ownerDocument}function s1(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function i1(s,i){if(s===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&i==="foreignObject"?0:s}function Z0(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var J0=null;function jT(){var s=window.event;return s&&s.type==="popstate"?s===J0?!1:(J0=s,!0):(J0=null,!1)}var l1=typeof setTimeout=="function"?setTimeout:void 0,kT=typeof clearTimeout=="function"?clearTimeout:void 0,o1=typeof Promise=="function"?Promise:void 0,AT=typeof queueMicrotask=="function"?queueMicrotask:typeof o1<"u"?function(s){return o1.resolve(null).then(s).catch(DT)}:l1;function DT(s){setTimeout(function(){throw s})}function es(s){return s==="head"}function c1(s,i){var c=i,d=0,m=0;do{var v=c.nextSibling;if(s.removeChild(c),v&&v.nodeType===8)if(c=v.data,c==="/$"){if(0<d&&8>d){c=d;var N=s.ownerDocument;if(c&1&&co(N.documentElement),c&2&&co(N.body),c&4)for(c=N.head,co(c),N=c.firstChild;N;){var R=N.nextSibling,J=N.nodeName;N[L]||J==="SCRIPT"||J==="STYLE"||J==="LINK"&&N.rel.toLowerCase()==="stylesheet"||c.removeChild(N),N=R}}if(m===0){s.removeChild(v),yo(i);return}m--}else c==="$"||c==="$?"||c==="$!"?m++:d=c.charCodeAt(0)-48;else d=0;c=v}while(c);yo(i)}function ed(s){var i=s.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var c=i;switch(i=i.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":ed(c),z(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}s.removeChild(c)}}function OT(s,i,c,d){for(;s.nodeType===1;){var m=c;if(s.nodeName.toLowerCase()!==i.toLowerCase()){if(!d&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(d){if(!s[L])switch(i){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(v=s.getAttribute("rel"),v==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(v!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(v=s.getAttribute("src"),(v!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&v&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(i==="input"&&s.type==="hidden"){var v=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===v)return s}else return s;if(s=Da(s.nextSibling),s===null)break}return null}function MT(s,i,c){if(i==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=Da(s.nextSibling),s===null))return null;return s}function td(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function RT(s,i){var c=s.ownerDocument;if(s.data!=="$?"||c.readyState==="complete")i();else{var d=function(){i(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),s._reactRetry=d}}function Da(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return s}var nd=null;function u1(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"){if(i===0)return s;i--}else c==="/$"&&i++}s=s.previousSibling}return null}function h1(s,i,c){switch(i=Eu(c),s){case"html":if(s=i.documentElement,!s)throw Error(a(452));return s;case"head":if(s=i.head,!s)throw Error(a(453));return s;case"body":if(s=i.body,!s)throw Error(a(454));return s;default:throw Error(a(451))}}function co(s){for(var i=s.attributes;i.length;)s.removeAttributeNode(i[0]);z(s)}var ya=new Map,f1=new Set;function Cu(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var yr=Q.d;Q.d={f:FT,r:LT,D:BT,C:HT,L:PT,m:IT,X:UT,S:zT,M:VT};function FT(){var s=yr.f(),i=yu();return s||i}function LT(s){var i=X(s);i!==null&&i.tag===5&&i.type==="form"?Om(i):yr.r(s)}var Ki=typeof document>"u"?null:document;function d1(s,i,c){var d=Ki;if(d&&typeof i=="string"&&i){var m=ha(i);m='link[rel="'+s+'"][href="'+m+'"]',typeof c=="string"&&(m+='[crossorigin="'+c+'"]'),f1.has(m)||(f1.add(m),s={rel:s,crossOrigin:c,href:i},d.querySelector(m)===null&&(i=d.createElement("link"),gn(i,"link",s),le(i),d.head.appendChild(i)))}}function BT(s){yr.D(s),d1("dns-prefetch",s,null)}function HT(s,i){yr.C(s,i),d1("preconnect",s,i)}function PT(s,i,c){yr.L(s,i,c);var d=Ki;if(d&&s&&i){var m='link[rel="preload"][as="'+ha(i)+'"]';i==="image"&&c&&c.imageSrcSet?(m+='[imagesrcset="'+ha(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(m+='[imagesizes="'+ha(c.imageSizes)+'"]')):m+='[href="'+ha(s)+'"]';var v=m;switch(i){case"style":v=Wi(s);break;case"script":v=Gi(s)}ya.has(v)||(s=g({rel:"preload",href:i==="image"&&c&&c.imageSrcSet?void 0:s,as:i},c),ya.set(v,s),d.querySelector(m)!==null||i==="style"&&d.querySelector(uo(v))||i==="script"&&d.querySelector(ho(v))||(i=d.createElement("link"),gn(i,"link",s),le(i),d.head.appendChild(i)))}}function IT(s,i){yr.m(s,i);var c=Ki;if(c&&s){var d=i&&typeof i.as=="string"?i.as:"script",m='link[rel="modulepreload"][as="'+ha(d)+'"][href="'+ha(s)+'"]',v=m;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=Gi(s)}if(!ya.has(v)&&(s=g({rel:"modulepreload",href:s},i),ya.set(v,s),c.querySelector(m)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(ho(v)))return}d=c.createElement("link"),gn(d,"link",s),le(d),c.head.appendChild(d)}}}function zT(s,i,c){yr.S(s,i,c);var d=Ki;if(d&&s){var m=ve(d).hoistableStyles,v=Wi(s);i=i||"default";var N=m.get(v);if(!N){var R={loading:0,preload:null};if(N=d.querySelector(uo(v)))R.loading=5;else{s=g({rel:"stylesheet",href:s,"data-precedence":i},c),(c=ya.get(v))&&ad(s,c);var J=N=d.createElement("link");le(J),gn(J,"link",s),J._p=new Promise(function(ce,we){J.onload=ce,J.onerror=we}),J.addEventListener("load",function(){R.loading|=1}),J.addEventListener("error",function(){R.loading|=2}),R.loading|=4,ju(N,i,d)}N={type:"stylesheet",instance:N,count:1,state:R},m.set(v,N)}}}function UT(s,i){yr.X(s,i);var c=Ki;if(c&&s){var d=ve(c).hoistableScripts,m=Gi(s),v=d.get(m);v||(v=c.querySelector(ho(m)),v||(s=g({src:s,async:!0},i),(i=ya.get(m))&&rd(s,i),v=c.createElement("script"),le(v),gn(v,"link",s),c.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},d.set(m,v))}}function VT(s,i){yr.M(s,i);var c=Ki;if(c&&s){var d=ve(c).hoistableScripts,m=Gi(s),v=d.get(m);v||(v=c.querySelector(ho(m)),v||(s=g({src:s,async:!0,type:"module"},i),(i=ya.get(m))&&rd(s,i),v=c.createElement("script"),le(v),gn(v,"link",s),c.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},d.set(m,v))}}function x1(s,i,c,d){var m=(m=U.current)?Cu(m):null;if(!m)throw Error(a(446));switch(s){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(i=Wi(c.href),c=ve(m).hoistableStyles,d=c.get(i),d||(d={type:"style",instance:null,count:0,state:null},c.set(i,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){s=Wi(c.href);var v=ve(m).hoistableStyles,N=v.get(s);if(N||(m=m.ownerDocument||m,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(s,N),(v=m.querySelector(uo(s)))&&!v._p&&(N.instance=v,N.state.loading=5),ya.has(s)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},ya.set(s,c),v||KT(m,s,c,N.state))),i&&d===null)throw Error(a(528,""));return N}if(i&&d!==null)throw Error(a(529,""));return null;case"script":return i=c.async,c=c.src,typeof c=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Gi(c),c=ve(m).hoistableScripts,d=c.get(i),d||(d={type:"script",instance:null,count:0,state:null},c.set(i,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,s))}}function Wi(s){return'href="'+ha(s)+'"'}function uo(s){return'link[rel="stylesheet"]['+s+"]"}function g1(s){return g({},s,{"data-precedence":s.precedence,precedence:null})}function KT(s,i,c,d){s.querySelector('link[rel="preload"][as="style"]['+i+"]")?d.loading=1:(i=s.createElement("link"),d.preload=i,i.addEventListener("load",function(){return d.loading|=1}),i.addEventListener("error",function(){return d.loading|=2}),gn(i,"link",c),le(i),s.head.appendChild(i))}function Gi(s){return'[src="'+ha(s)+'"]'}function ho(s){return"script[async]"+s}function m1(s,i,c){if(i.count++,i.instance===null)switch(i.type){case"style":var d=s.querySelector('style[data-href~="'+ha(c.href)+'"]');if(d)return i.instance=d,le(d),d;var m=g({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(s.ownerDocument||s).createElement("style"),le(d),gn(d,"style",m),ju(d,c.precedence,s),i.instance=d;case"stylesheet":m=Wi(c.href);var v=s.querySelector(uo(m));if(v)return i.state.loading|=4,i.instance=v,le(v),v;d=g1(c),(m=ya.get(m))&&ad(d,m),v=(s.ownerDocument||s).createElement("link"),le(v);var N=v;return N._p=new Promise(function(R,J){N.onload=R,N.onerror=J}),gn(v,"link",d),i.state.loading|=4,ju(v,c.precedence,s),i.instance=v;case"script":return v=Gi(c.src),(m=s.querySelector(ho(v)))?(i.instance=m,le(m),m):(d=c,(m=ya.get(v))&&(d=g({},c),rd(d,m)),s=s.ownerDocument||s,m=s.createElement("script"),le(m),gn(m,"link",d),s.head.appendChild(m),i.instance=m);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(d=i.instance,i.state.loading|=4,ju(d,c.precedence,s));return i.instance}function ju(s,i,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=d.length?d[d.length-1]:null,v=m,N=0;N<d.length;N++){var R=d[N];if(R.dataset.precedence===i)v=R;else if(v!==m)break}v?v.parentNode.insertBefore(s,v.nextSibling):(i=c.nodeType===9?c.head:c,i.insertBefore(s,i.firstChild))}function ad(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.title==null&&(s.title=i.title)}function rd(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.integrity==null&&(s.integrity=i.integrity)}var ku=null;function p1(s,i,c){if(ku===null){var d=new Map,m=ku=new Map;m.set(c,d)}else m=ku,d=m.get(c),d||(d=new Map,m.set(c,d));if(d.has(s))return d;for(d.set(s,null),c=c.getElementsByTagName(s),m=0;m<c.length;m++){var v=c[m];if(!(v[L]||v[an]||s==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var N=v.getAttribute(i)||"";N=s+N;var R=d.get(N);R?R.push(v):d.set(N,[v])}}return d}function y1(s,i,c){s=s.ownerDocument||s,s.head.insertBefore(c,i==="title"?s.querySelector("head > title"):null)}function WT(s,i,c){if(c===1||i.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return s=i.disabled,typeof i.precedence=="string"&&s==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function v1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var fo=null;function GT(){}function XT(s,i,c){if(fo===null)throw Error(a(475));var d=fo;if(i.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var m=Wi(c.href),v=s.querySelector(uo(m));if(v){s=v._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(d.count++,d=Au.bind(d),s.then(d,d)),i.state.loading|=4,i.instance=v,le(v);return}v=s.ownerDocument||s,c=g1(c),(m=ya.get(m))&&ad(c,m),v=v.createElement("link"),le(v);var N=v;N._p=new Promise(function(R,J){N.onload=R,N.onerror=J}),gn(v,"link",c),i.instance=v}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(i,s),(s=i.state.preload)&&(i.state.loading&3)===0&&(d.count++,i=Au.bind(d),s.addEventListener("load",i),s.addEventListener("error",i))}}function YT(){if(fo===null)throw Error(a(475));var s=fo;return s.stylesheets&&s.count===0&&sd(s,s.stylesheets),0<s.count?function(i){var c=setTimeout(function(){if(s.stylesheets&&sd(s,s.stylesheets),s.unsuspend){var d=s.unsuspend;s.unsuspend=null,d()}},6e4);return s.unsuspend=i,function(){s.unsuspend=null,clearTimeout(c)}}:null}function Au(){if(this.count--,this.count===0){if(this.stylesheets)sd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Du=null;function sd(s,i){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Du=new Map,i.forEach(qT,s),Du=null,Au.call(s))}function qT(s,i){if(!(i.state.loading&4)){var c=Du.get(s);if(c)var d=c.get(null);else{c=new Map,Du.set(s,c);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<m.length;v++){var N=m[v];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(c.set(N.dataset.precedence,N),d=N)}d&&c.set(null,d)}m=i.instance,N=m.getAttribute("data-precedence"),v=c.get(N)||d,v===d&&c.set(null,m),c.set(N,m),this.count++,d=Au.bind(this),m.addEventListener("load",d),m.addEventListener("error",d),v?v.parentNode.insertBefore(m,v.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),i.state.loading|=4}}var xo={$$typeof:C,Provider:null,Consumer:null,_currentValue:me,_currentValue2:me,_threadCount:0};function $T(s,i,c,d,m,v,N,R){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=wl(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wl(0),this.hiddenUpdates=wl(null),this.identifierPrefix=d,this.onUncaughtError=m,this.onCaughtError=v,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=R,this.incompleteTransitions=new Map}function b1(s,i,c,d,m,v,N,R,J,ce,we,Ee){return s=new $T(s,i,c,N,R,J,ce,Ee),i=1,v===!0&&(i|=24),v=Qn(3,null,null,i),s.current=v,v.stateNode=s,i=If(),i.refCount++,s.pooledCache=i,i.refCount++,v.memoizedState={element:d,isDehydrated:c,cache:i},Kf(v),s}function _1(s){return s?(s=Ti,s):Ti}function w1(s,i,c,d,m,v){m=_1(m),d.context===null?d.context=m:d.pendingContext=m,d=zr(i),d.payload={element:c},v=v===void 0?null:v,v!==null&&(d.callback=v),c=Ur(s,d,i),c!==null&&(na(c,s,i),Vl(c,s,i))}function T1(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<i?c:i}}function id(s,i){T1(s,i),(s=s.alternate)&&T1(s,i)}function S1(s){if(s.tag===13){var i=wi(s,67108864);i!==null&&na(i,s,67108864),id(s,67108864)}}var Ou=!0;function QT(s,i,c,d){var m=ee.T;ee.T=null;var v=Q.p;try{Q.p=2,ld(s,i,c,d)}finally{Q.p=v,ee.T=m}}function ZT(s,i,c,d){var m=ee.T;ee.T=null;var v=Q.p;try{Q.p=8,ld(s,i,c,d)}finally{Q.p=v,ee.T=m}}function ld(s,i,c,d){if(Ou){var m=od(d);if(m===null)Y0(s,i,d,Mu,c),E1(s,d);else if(eS(m,s,i,c,d))d.stopPropagation();else if(E1(s,d),i&4&&-1<JT.indexOf(s)){for(;m!==null;){var v=X(m);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var N=za(v.pendingLanes);if(N!==0){var R=v;for(R.pendingLanes|=2,R.entangledLanes|=2;N;){var J=1<<31-On(N);R.entanglements[1]|=J,N&=~J}Xa(v),(gt&6)===0&&(mu=Fe()+500,io(0))}}break;case 13:R=wi(v,2),R!==null&&na(R,v,2),yu(),id(v,2)}if(v=od(d),v===null&&Y0(s,i,d,Mu,c),v===m)break;m=v}m!==null&&d.stopPropagation()}else Y0(s,i,d,null,c)}}function od(s){return s=df(s),cd(s)}var Mu=null;function cd(s){if(Mu=null,s=W(s),s!==null){var i=l(s);if(i===null)s=null;else{var c=i.tag;if(c===13){if(s=o(i),s!==null)return s;s=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null)}}return Mu=s,null}function N1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ft()){case pe:return 2;case ke:return 8;case ze:case et:return 32;case Dt:return 268435456;default:return 32}default:return 32}}var ud=!1,ts=null,ns=null,as=null,go=new Map,mo=new Map,rs=[],JT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function E1(s,i){switch(s){case"focusin":case"focusout":ts=null;break;case"dragenter":case"dragleave":ns=null;break;case"mouseover":case"mouseout":as=null;break;case"pointerover":case"pointerout":go.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":mo.delete(i.pointerId)}}function po(s,i,c,d,m,v){return s===null||s.nativeEvent!==v?(s={blockedOn:i,domEventName:c,eventSystemFlags:d,nativeEvent:v,targetContainers:[m]},i!==null&&(i=X(i),i!==null&&S1(i)),s):(s.eventSystemFlags|=d,i=s.targetContainers,m!==null&&i.indexOf(m)===-1&&i.push(m),s)}function eS(s,i,c,d,m){switch(i){case"focusin":return ts=po(ts,s,i,c,d,m),!0;case"dragenter":return ns=po(ns,s,i,c,d,m),!0;case"mouseover":return as=po(as,s,i,c,d,m),!0;case"pointerover":var v=m.pointerId;return go.set(v,po(go.get(v)||null,s,i,c,d,m)),!0;case"gotpointercapture":return v=m.pointerId,mo.set(v,po(mo.get(v)||null,s,i,c,d,m)),!0}return!1}function C1(s){var i=W(s.target);if(i!==null){var c=l(i);if(c!==null){if(i=c.tag,i===13){if(i=o(c),i!==null){s.blockedOn=i,lf(s.priority,function(){if(c.tag===13){var d=ta();d=Tl(d);var m=wi(c,d);m!==null&&na(m,c,d),id(c,d)}});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Ru(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var c=od(s.nativeEvent);if(c===null){c=s.nativeEvent;var d=new c.constructor(c.type,c);ff=d,c.target.dispatchEvent(d),ff=null}else return i=X(c),i!==null&&S1(i),s.blockedOn=c,!1;i.shift()}return!0}function j1(s,i,c){Ru(s)&&c.delete(i)}function tS(){ud=!1,ts!==null&&Ru(ts)&&(ts=null),ns!==null&&Ru(ns)&&(ns=null),as!==null&&Ru(as)&&(as=null),go.forEach(j1),mo.forEach(j1)}function Fu(s,i){s.blockedOn===i&&(s.blockedOn=null,ud||(ud=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,tS)))}var Lu=null;function k1(s){Lu!==s&&(Lu=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Lu===s&&(Lu=null);for(var i=0;i<s.length;i+=3){var c=s[i],d=s[i+1],m=s[i+2];if(typeof d!="function"){if(cd(d||c)===null)continue;break}var v=X(c);v!==null&&(s.splice(i,3),i-=3,c0(v,{pending:!0,data:m,method:c.method,action:d},d,m))}}))}function yo(s){function i(J){return Fu(J,s)}ts!==null&&Fu(ts,s),ns!==null&&Fu(ns,s),as!==null&&Fu(as,s),go.forEach(i),mo.forEach(i);for(var c=0;c<rs.length;c++){var d=rs[c];d.blockedOn===s&&(d.blockedOn=null)}for(;0<rs.length&&(c=rs[0],c.blockedOn===null);)C1(c),c.blockedOn===null&&rs.shift();if(c=(s.ownerDocument||s).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var m=c[d],v=c[d+1],N=m[rn]||null;if(typeof v=="function")N||k1(c);else if(N){var R=null;if(v&&v.hasAttribute("formAction")){if(m=v,N=v[rn]||null)R=N.formAction;else if(cd(m)!==null)continue}else R=N.action;typeof R=="function"?c[d+1]=R:(c.splice(d,3),d-=3),k1(c)}}}function hd(s){this._internalRoot=s}Bu.prototype.render=hd.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(a(409));var c=i.current,d=ta();w1(c,d,s,i,null,null)},Bu.prototype.unmount=hd.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;w1(s.current,2,null,s,null,null),yu(),i[Lr]=null}};function Bu(s){this._internalRoot=s}Bu.prototype.unstable_scheduleHydration=function(s){if(s){var i=Ac();s={blockedOn:null,target:s,priority:i};for(var c=0;c<rs.length&&i!==0&&i<rs[c].priority;c++);rs.splice(c,0,s),c===0&&C1(s)}};var A1=t.version;if(A1!=="19.1.0")throw Error(a(527,A1,"19.1.0"));Q.findDOMNode=function(s){var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(a(188)):(s=Object.keys(s).join(","),Error(a(268,s)));return s=f(i),s=s!==null?x(s):null,s=s===null?null:s.stateNode,s};var nS={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ee,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hu.isDisabled&&Hu.supportsFiber)try{Ea=Hu.inject(nS),fn=Hu}catch{}}return bo.createRoot=function(s,i){if(!r(s))throw Error(a(299));var c=!1,d="",m=Gm,v=Xm,N=Ym,R=null;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onUncaughtError!==void 0&&(m=i.onUncaughtError),i.onCaughtError!==void 0&&(v=i.onCaughtError),i.onRecoverableError!==void 0&&(N=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(R=i.unstable_transitionCallbacks)),i=b1(s,1,!1,null,null,c,d,m,v,N,R,null),s[Lr]=i.current,X0(s),new hd(i)},bo.hydrateRoot=function(s,i,c){if(!r(s))throw Error(a(299));var d=!1,m="",v=Gm,N=Xm,R=Ym,J=null,ce=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onUncaughtError!==void 0&&(v=c.onUncaughtError),c.onCaughtError!==void 0&&(N=c.onCaughtError),c.onRecoverableError!==void 0&&(R=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(J=c.unstable_transitionCallbacks),c.formState!==void 0&&(ce=c.formState)),i=b1(s,1,!0,i,c??null,d,m,v,N,R,J,ce),i.context=_1(null),c=i.current,d=ta(),d=Tl(d),m=zr(d),m.callback=null,Ur(c,m,d),c=d,i.current.lanes=c,Ts(i,c),Xa(i),s[Lr]=i.current,X0(s),new Bu(i)},bo.version="19.1.0",bo}var I1;function xS(){if(I1)return xd.exports;I1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),xd.exports=dS(),xd.exports}var gS=xS(),_o={},z1;function mS(){if(z1)return _o;z1=1,Object.defineProperty(_o,"__esModule",{value:!0}),_o.parse=o,_o.serialize=x;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,a=/^[\u0020-\u003A\u003D-\u007E]*$/,r=Object.prototype.toString,l=(()=>{const y=function(){};return y.prototype=Object.create(null),y})();function o(y,_){const w=new l,b=y.length;if(b<2)return w;const T=(_==null?void 0:_.decode)||g;let S=0;do{const E=y.indexOf("=",S);if(E===-1)break;const C=y.indexOf(";",S),A=C===-1?b:C;if(E>A){S=y.lastIndexOf(";",E-1)+1;continue}const F=h(y,S,E),K=f(y,E,F),O=y.slice(F,K);if(w[O]===void 0){let P=h(y,E+1,A),M=f(y,A,P);const B=T(y.slice(P,M));w[O]=B}S=A+1}while(S<b);return w}function h(y,_,w){do{const b=y.charCodeAt(_);if(b!==32&&b!==9)return _}while(++_<w);return w}function f(y,_,w){for(;_>w;){const b=y.charCodeAt(--_);if(b!==32&&b!==9)return _+1}return w}function x(y,_,w){const b=(w==null?void 0:w.encode)||encodeURIComponent;if(!e.test(y))throw new TypeError(`argument name is invalid: ${y}`);const T=b(_);if(!t.test(T))throw new TypeError(`argument val is invalid: ${_}`);let S=y+"="+T;if(!w)return S;if(w.maxAge!==void 0){if(!Number.isInteger(w.maxAge))throw new TypeError(`option maxAge is invalid: ${w.maxAge}`);S+="; Max-Age="+w.maxAge}if(w.domain){if(!n.test(w.domain))throw new TypeError(`option domain is invalid: ${w.domain}`);S+="; Domain="+w.domain}if(w.path){if(!a.test(w.path))throw new TypeError(`option path is invalid: ${w.path}`);S+="; Path="+w.path}if(w.expires){if(!p(w.expires)||!Number.isFinite(w.expires.valueOf()))throw new TypeError(`option expires is invalid: ${w.expires}`);S+="; Expires="+w.expires.toUTCString()}if(w.httpOnly&&(S+="; HttpOnly"),w.secure&&(S+="; Secure"),w.partitioned&&(S+="; Partitioned"),w.priority)switch(typeof w.priority=="string"?w.priority.toLowerCase():void 0){case"low":S+="; Priority=Low";break;case"medium":S+="; Priority=Medium";break;case"high":S+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${w.priority}`)}if(w.sameSite)switch(typeof w.sameSite=="string"?w.sameSite.toLowerCase():w.sameSite){case!0:case"strict":S+="; SameSite=Strict";break;case"lax":S+="; SameSite=Lax";break;case"none":S+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${w.sameSite}`)}return S}function g(y){if(y.indexOf("%")===-1)return y;try{return decodeURIComponent(y)}catch{return y}}function p(y){return r.call(y)==="[object Date]"}return _o}mS();var U1="popstate";function pS(e={}){function t(a,r){let{pathname:l,search:o,hash:h}=a.location;return Vd("",{pathname:l,search:o,hash:h},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(a,r){return typeof r=="string"?r:$o(r)}return vS(t,n,null,e)}function Ft(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Ba(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function yS(){return Math.random().toString(36).substring(2,10)}function V1(e,t){return{usr:e.state,key:e.key,idx:t}}function Vd(e,t,n=null,a){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?fl(t):t,state:n,key:t&&t.key||a||yS()}}function $o({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function fl(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let a=e.indexOf("?");a>=0&&(t.search=e.substring(a),e=e.substring(0,a)),e&&(t.pathname=e)}return t}function vS(e,t,n,a={}){let{window:r=document.defaultView,v5Compat:l=!1}=a,o=r.history,h="POP",f=null,x=g();x==null&&(x=0,o.replaceState({...o.state,idx:x},""));function g(){return(o.state||{idx:null}).idx}function p(){h="POP";let T=g(),S=T==null?null:T-x;x=T,f&&f({action:h,location:b.location,delta:S})}function y(T,S){h="PUSH";let E=Vd(b.location,T,S);x=g()+1;let C=V1(E,x),A=b.createHref(E);try{o.pushState(C,"",A)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;r.location.assign(A)}l&&f&&f({action:h,location:b.location,delta:1})}function _(T,S){h="REPLACE";let E=Vd(b.location,T,S);x=g();let C=V1(E,x),A=b.createHref(E);o.replaceState(C,"",A),l&&f&&f({action:h,location:b.location,delta:0})}function w(T){return bS(T)}let b={get action(){return h},get location(){return e(r,o)},listen(T){if(f)throw new Error("A history only accepts one active listener");return r.addEventListener(U1,p),f=T,()=>{r.removeEventListener(U1,p),f=null}},createHref(T){return t(r,T)},createURL:w,encodeLocation(T){let S=w(T);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:y,replace:_,go(T){return o.go(T)}};return b}function bS(e,t=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Ft(n,"No window.location.(origin|href) available to create URL");let a=typeof e=="string"?e:$o(e);return a=a.replace(/ $/,"%20"),!t&&a.startsWith("//")&&(a=n+a),new URL(a,n)}function n2(e,t,n="/"){return _S(e,t,n,!1)}function _S(e,t,n,a){let r=typeof t=="string"?fl(t):t,l=Dr(r.pathname||"/",n);if(l==null)return null;let o=a2(e);wS(o);let h=null;for(let f=0;h==null&&f<o.length;++f){let x=MS(l);h=DS(o[f],x,a)}return h}function a2(e,t=[],n=[],a=""){let r=(l,o,h)=>{let f={relativePath:h===void 0?l.path||"":h,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};f.relativePath.startsWith("/")&&(Ft(f.relativePath.startsWith(a),`Absolute route path "${f.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(a.length));let x=Er([a,f.relativePath]),g=n.concat(f);l.children&&l.children.length>0&&(Ft(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),a2(l.children,t,g,x)),!(l.path==null&&!l.index)&&t.push({path:x,score:kS(x,l.index),routesMeta:g})};return e.forEach((l,o)=>{var h;if(l.path===""||!((h=l.path)!=null&&h.includes("?")))r(l,o);else for(let f of r2(l.path))r(l,o,f)}),t}function r2(e){let t=e.split("/");if(t.length===0)return[];let[n,...a]=t,r=n.endsWith("?"),l=n.replace(/\?$/,"");if(a.length===0)return r?[l,""]:[l];let o=r2(a.join("/")),h=[];return h.push(...o.map(f=>f===""?l:[l,f].join("/"))),r&&h.push(...o),h.map(f=>e.startsWith("/")&&f===""?"/":f)}function wS(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:AS(t.routesMeta.map(a=>a.childrenIndex),n.routesMeta.map(a=>a.childrenIndex)))}var TS=/^:[\w-]+$/,SS=3,NS=2,ES=1,CS=10,jS=-2,K1=e=>e==="*";function kS(e,t){let n=e.split("/"),a=n.length;return n.some(K1)&&(a+=jS),t&&(a+=NS),n.filter(r=>!K1(r)).reduce((r,l)=>r+(TS.test(l)?SS:l===""?ES:CS),a)}function AS(e,t){return e.length===t.length&&e.slice(0,-1).every((a,r)=>a===t[r])?e[e.length-1]-t[t.length-1]:0}function DS(e,t,n=!1){let{routesMeta:a}=e,r={},l="/",o=[];for(let h=0;h<a.length;++h){let f=a[h],x=h===a.length-1,g=l==="/"?t:t.slice(l.length)||"/",p=vh({path:f.relativePath,caseSensitive:f.caseSensitive,end:x},g),y=f.route;if(!p&&x&&n&&!a[a.length-1].route.index&&(p=vh({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},g)),!p)return null;Object.assign(r,p.params),o.push({params:r,pathname:Er([l,p.pathname]),pathnameBase:BS(Er([l,p.pathnameBase])),route:y}),p.pathnameBase!=="/"&&(l=Er([l,p.pathnameBase]))}return o}function vh(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,a]=OS(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let l=r[0],o=l.replace(/(.)\/+$/,"$1"),h=r.slice(1);return{params:a.reduce((x,{paramName:g,isOptional:p},y)=>{if(g==="*"){let w=h[y]||"";o=l.slice(0,l.length-w.length).replace(/(.)\/+$/,"$1")}const _=h[y];return p&&!_?x[g]=void 0:x[g]=(_||"").replace(/%2F/g,"/"),x},{}),pathname:l,pathnameBase:o,pattern:e}}function OS(e,t=!1,n=!0){Ba(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let a=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,h,f)=>(a.push({paramName:h,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(a.push({paramName:"*"}),r+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":e!==""&&e!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),a]}function MS(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Ba(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Dr(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,a=e.charAt(n);return a&&a!=="/"?null:e.slice(n)||"/"}function RS(e,t="/"){let{pathname:n,search:a="",hash:r=""}=typeof e=="string"?fl(e):e;return{pathname:n?n.startsWith("/")?n:FS(n,t):t,search:HS(a),hash:PS(r)}}function FS(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function yd(e,t,n,a){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function LS(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function ix(e){let t=LS(e);return t.map((n,a)=>a===t.length-1?n.pathname:n.pathnameBase)}function lx(e,t,n,a=!1){let r;typeof e=="string"?r=fl(e):(r={...e},Ft(!r.pathname||!r.pathname.includes("?"),yd("?","pathname","search",r)),Ft(!r.pathname||!r.pathname.includes("#"),yd("#","pathname","hash",r)),Ft(!r.search||!r.search.includes("#"),yd("#","search","hash",r)));let l=e===""||r.pathname==="",o=l?"/":r.pathname,h;if(o==null)h=n;else{let p=t.length-1;if(!a&&o.startsWith("..")){let y=o.split("/");for(;y[0]==="..";)y.shift(),p-=1;r.pathname=y.join("/")}h=p>=0?t[p]:"/"}let f=RS(r,h),x=o&&o!=="/"&&o.endsWith("/"),g=(l||o===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(x||g)&&(f.pathname+="/"),f}var Er=e=>e.join("/").replace(/\/\/+/g,"/"),BS=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),HS=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,PS=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function IS(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var s2=["POST","PUT","PATCH","DELETE"];new Set(s2);var zS=["GET",...s2];new Set(zS);var dl=k.createContext(null);dl.displayName="DataRouter";var Vh=k.createContext(null);Vh.displayName="DataRouterState";var i2=k.createContext({isTransitioning:!1});i2.displayName="ViewTransition";var US=k.createContext(new Map);US.displayName="Fetchers";var VS=k.createContext(null);VS.displayName="Await";var Ia=k.createContext(null);Ia.displayName="Navigation";var gc=k.createContext(null);gc.displayName="Location";var nr=k.createContext({outlet:null,matches:[],isDataRoute:!1});nr.displayName="Route";var ox=k.createContext(null);ox.displayName="RouteError";function KS(e,{relative:t}={}){Ft(xl(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:a}=k.useContext(Ia),{hash:r,pathname:l,search:o}=mc(e,{relative:t}),h=l;return n!=="/"&&(h=l==="/"?n:Er([n,l])),a.createHref({pathname:h,search:o,hash:r})}function xl(){return k.useContext(gc)!=null}function Rr(){return Ft(xl(),"useLocation() may be used only in the context of a <Router> component."),k.useContext(gc).location}var l2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function o2(e){k.useContext(Ia).static||k.useLayoutEffect(e)}function Kh(){let{isDataRoute:e}=k.useContext(nr);return e?a4():WS()}function WS(){Ft(xl(),"useNavigate() may be used only in the context of a <Router> component.");let e=k.useContext(dl),{basename:t,navigator:n}=k.useContext(Ia),{matches:a}=k.useContext(nr),{pathname:r}=Rr(),l=JSON.stringify(ix(a)),o=k.useRef(!1);return o2(()=>{o.current=!0}),k.useCallback((f,x={})=>{if(Ba(o.current,l2),!o.current)return;if(typeof f=="number"){n.go(f);return}let g=lx(f,JSON.parse(l),r,x.relative==="path");e==null&&t!=="/"&&(g.pathname=g.pathname==="/"?t:Er([t,g.pathname])),(x.replace?n.replace:n.push)(g,x.state,x)},[t,n,l,r,e])}k.createContext(null);function mc(e,{relative:t}={}){let{matches:n}=k.useContext(nr),{pathname:a}=Rr(),r=JSON.stringify(ix(n));return k.useMemo(()=>lx(e,JSON.parse(r),a,t==="path"),[e,r,a,t])}function GS(e,t){return c2(e,t)}function c2(e,t,n,a){var S;Ft(xl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r}=k.useContext(Ia),{matches:l}=k.useContext(nr),o=l[l.length-1],h=o?o.params:{},f=o?o.pathname:"/",x=o?o.pathnameBase:"/",g=o&&o.route;{let E=g&&g.path||"";u2(f,!g||E.endsWith("*")||E.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${E}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${E}"> to <Route path="${E==="/"?"*":`${E}/*`}">.`)}let p=Rr(),y;if(t){let E=typeof t=="string"?fl(t):t;Ft(x==="/"||((S=E.pathname)==null?void 0:S.startsWith(x)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${E.pathname}" was given in the \`location\` prop.`),y=E}else y=p;let _=y.pathname||"/",w=_;if(x!=="/"){let E=x.replace(/^\//,"").split("/");w="/"+_.replace(/^\//,"").split("/").slice(E.length).join("/")}let b=n2(e,{pathname:w});Ba(g||b!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),Ba(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=QS(b&&b.map(E=>Object.assign({},E,{params:Object.assign({},h,E.params),pathname:Er([x,r.encodeLocation?r.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?x:Er([x,r.encodeLocation?r.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),l,n,a);return t&&T?k.createElement(gc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},T):T}function XS(){let e=n4(),t=IS(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:a},l={padding:"2px 4px",backgroundColor:a},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=k.createElement(k.Fragment,null,k.createElement("p",null,"💿 Hey developer 👋"),k.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",k.createElement("code",{style:l},"ErrorBoundary")," or"," ",k.createElement("code",{style:l},"errorElement")," prop on your route.")),k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},t),n?k.createElement("pre",{style:r},n):null,o)}var YS=k.createElement(XS,null),qS=class extends k.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?k.createElement(nr.Provider,{value:this.props.routeContext},k.createElement(ox.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function $S({routeContext:e,match:t,children:n}){let a=k.useContext(dl);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),k.createElement(nr.Provider,{value:e},n)}function QS(e,t=[],n=null,a=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let r=e,l=n==null?void 0:n.errors;if(l!=null){let f=r.findIndex(x=>x.route.id&&(l==null?void 0:l[x.route.id])!==void 0);Ft(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),r=r.slice(0,Math.min(r.length,f+1))}let o=!1,h=-1;if(n)for(let f=0;f<r.length;f++){let x=r[f];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(h=f),x.route.id){let{loaderData:g,errors:p}=n,y=x.route.loader&&!g.hasOwnProperty(x.route.id)&&(!p||p[x.route.id]===void 0);if(x.route.lazy||y){o=!0,h>=0?r=r.slice(0,h+1):r=[r[0]];break}}}return r.reduceRight((f,x,g)=>{let p,y=!1,_=null,w=null;n&&(p=l&&x.route.id?l[x.route.id]:void 0,_=x.route.errorElement||YS,o&&(h<0&&g===0?(u2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,w=null):h===g&&(y=!0,w=x.route.hydrateFallbackElement||null)));let b=t.concat(r.slice(0,g+1)),T=()=>{let S;return p?S=_:y?S=w:x.route.Component?S=k.createElement(x.route.Component,null):x.route.element?S=x.route.element:S=f,k.createElement($S,{match:x,routeContext:{outlet:f,matches:b,isDataRoute:n!=null},children:S})};return n&&(x.route.ErrorBoundary||x.route.errorElement||g===0)?k.createElement(qS,{location:n.location,revalidation:n.revalidation,component:_,error:p,children:T(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):T()},null)}function cx(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ZS(e){let t=k.useContext(dl);return Ft(t,cx(e)),t}function JS(e){let t=k.useContext(Vh);return Ft(t,cx(e)),t}function e4(e){let t=k.useContext(nr);return Ft(t,cx(e)),t}function ux(e){let t=e4(e),n=t.matches[t.matches.length-1];return Ft(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function t4(){return ux("useRouteId")}function n4(){var a;let e=k.useContext(ox),t=JS("useRouteError"),n=ux("useRouteError");return e!==void 0?e:(a=t.errors)==null?void 0:a[n]}function a4(){let{router:e}=ZS("useNavigate"),t=ux("useNavigate"),n=k.useRef(!1);return o2(()=>{n.current=!0}),k.useCallback(async(r,l={})=>{Ba(n.current,l2),n.current&&(typeof r=="number"?e.navigate(r):await e.navigate(r,{fromRouteId:t,...l}))},[e,t])}var W1={};function u2(e,t,n){!t&&!W1[e]&&(W1[e]=!0,Ba(!1,n))}k.memo(r4);function r4({routes:e,future:t,state:n}){return c2(e,void 0,n,t)}function Ji({to:e,replace:t,state:n,relative:a}){Ft(xl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:r}=k.useContext(Ia);Ba(!r,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=k.useContext(nr),{pathname:o}=Rr(),h=Kh(),f=lx(e,ix(l),o,a==="path"),x=JSON.stringify(f);return k.useEffect(()=>{h(JSON.parse(x),{replace:t,state:n,relative:a})},[h,x,a,t,n]),null}function mn(e){Ft(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function s4({basename:e="/",children:t=null,location:n,navigationType:a="POP",navigator:r,static:l=!1}){Ft(!xl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),h=k.useMemo(()=>({basename:o,navigator:r,static:l,future:{}}),[o,r,l]);typeof n=="string"&&(n=fl(n));let{pathname:f="/",search:x="",hash:g="",state:p=null,key:y="default"}=n,_=k.useMemo(()=>{let w=Dr(f,o);return w==null?null:{location:{pathname:w,search:x,hash:g,state:p,key:y},navigationType:a}},[o,f,x,g,p,y,a]);return Ba(_!=null,`<Router basename="${o}"> is not able to match the URL "${f}${x}${g}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:k.createElement(Ia.Provider,{value:h},k.createElement(gc.Provider,{children:t,value:_}))}function i4({children:e,location:t}){return GS(Kd(e),t)}function Kd(e,t=[]){let n=[];return k.Children.forEach(e,(a,r)=>{if(!k.isValidElement(a))return;let l=[...t,r];if(a.type===k.Fragment){n.push.apply(n,Kd(a.props.children,l));return}Ft(a.type===mn,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ft(!a.props.index||!a.props.children,"An index route cannot have child routes.");let o={id:a.props.id||l.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(o.children=Kd(a.props.children,l)),n.push(o)}),n}var dh="get",xh="application/x-www-form-urlencoded";function Wh(e){return e!=null&&typeof e.tagName=="string"}function l4(e){return Wh(e)&&e.tagName.toLowerCase()==="button"}function o4(e){return Wh(e)&&e.tagName.toLowerCase()==="form"}function c4(e){return Wh(e)&&e.tagName.toLowerCase()==="input"}function u4(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function h4(e,t){return e.button===0&&(!t||t==="_self")&&!u4(e)}var Pu=null;function f4(){if(Pu===null)try{new FormData(document.createElement("form"),0),Pu=!1}catch{Pu=!0}return Pu}var d4=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function vd(e){return e!=null&&!d4.has(e)?(Ba(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${xh}"`),null):e}function x4(e,t){let n,a,r,l,o;if(o4(e)){let h=e.getAttribute("action");a=h?Dr(h,t):null,n=e.getAttribute("method")||dh,r=vd(e.getAttribute("enctype"))||xh,l=new FormData(e)}else if(l4(e)||c4(e)&&(e.type==="submit"||e.type==="image")){let h=e.form;if(h==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=e.getAttribute("formaction")||h.getAttribute("action");if(a=f?Dr(f,t):null,n=e.getAttribute("formmethod")||h.getAttribute("method")||dh,r=vd(e.getAttribute("formenctype"))||vd(h.getAttribute("enctype"))||xh,l=new FormData(h,e),!f4()){let{name:x,type:g,value:p}=e;if(g==="image"){let y=x?`${x}.`:"";l.append(`${y}x`,"0"),l.append(`${y}y`,"0")}else x&&l.append(x,p)}}else{if(Wh(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=dh,a=null,r=xh,o=e}return l&&r==="text/plain"&&(o=l,l=void 0),{action:a,method:n.toLowerCase(),encType:r,formData:l,body:o}}function hx(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function g4(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function m4(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function p4(e,t,n){let a=await Promise.all(e.map(async r=>{let l=t.routes[r.route.id];if(l){let o=await g4(l,n);return o.links?o.links():[]}return[]}));return _4(a.flat(1).filter(m4).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function G1(e,t,n,a,r,l){let o=(f,x)=>n[x]?f.route.id!==n[x].route.id:!0,h=(f,x)=>{var g;return n[x].pathname!==f.pathname||((g=n[x].route.path)==null?void 0:g.endsWith("*"))&&n[x].params["*"]!==f.params["*"]};return l==="assets"?t.filter((f,x)=>o(f,x)||h(f,x)):l==="data"?t.filter((f,x)=>{var p;let g=a.routes[f.route.id];if(!g||!g.hasLoader)return!1;if(o(f,x)||h(f,x))return!0;if(f.route.shouldRevalidate){let y=f.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((p=n[0])==null?void 0:p.params)||{},nextUrl:new URL(e,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function y4(e,t,{includeHydrateFallback:n}={}){return v4(e.map(a=>{let r=t.routes[a.route.id];if(!r)return[];let l=[r.module];return r.clientActionModule&&(l=l.concat(r.clientActionModule)),r.clientLoaderModule&&(l=l.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(l=l.concat(r.hydrateFallbackModule)),r.imports&&(l=l.concat(r.imports)),l}).flat(1))}function v4(e){return[...new Set(e)]}function b4(e){let t={},n=Object.keys(e).sort();for(let a of n)t[a]=e[a];return t}function _4(e,t){let n=new Set;return new Set(t),e.reduce((a,r)=>{let l=JSON.stringify(b4(r));return n.has(l)||(n.add(l),a.push({key:l,link:r})),a},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var w4=new Set([100,101,204,205]);function T4(e,t){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname="_root.data":t&&Dr(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function h2(){let e=k.useContext(dl);return hx(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function S4(){let e=k.useContext(Vh);return hx(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var fx=k.createContext(void 0);fx.displayName="FrameworkContext";function f2(){let e=k.useContext(fx);return hx(e,"You must render this element inside a <HydratedRouter> element"),e}function N4(e,t){let n=k.useContext(fx),[a,r]=k.useState(!1),[l,o]=k.useState(!1),{onFocus:h,onBlur:f,onMouseEnter:x,onMouseLeave:g,onTouchStart:p}=t,y=k.useRef(null);k.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let b=S=>{S.forEach(E=>{o(E.isIntersecting)})},T=new IntersectionObserver(b,{threshold:.5});return y.current&&T.observe(y.current),()=>{T.disconnect()}}},[e]),k.useEffect(()=>{if(a){let b=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(b)}}},[a]);let _=()=>{r(!0)},w=()=>{r(!1),o(!1)};return n?e!=="intent"?[l,y,{}]:[l,y,{onFocus:wo(h,_),onBlur:wo(f,w),onMouseEnter:wo(x,_),onMouseLeave:wo(g,w),onTouchStart:wo(p,_)}]:[!1,y,{}]}function wo(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function E4({page:e,...t}){let{router:n}=h2(),a=k.useMemo(()=>n2(n.routes,e,n.basename),[n.routes,e,n.basename]);return a?k.createElement(j4,{page:e,matches:a,...t}):null}function C4(e){let{manifest:t,routeModules:n}=f2(),[a,r]=k.useState([]);return k.useEffect(()=>{let l=!1;return p4(e,t,n).then(o=>{l||r(o)}),()=>{l=!0}},[e,t,n]),a}function j4({page:e,matches:t,...n}){let a=Rr(),{manifest:r,routeModules:l}=f2(),{basename:o}=h2(),{loaderData:h,matches:f}=S4(),x=k.useMemo(()=>G1(e,t,f,r,a,"data"),[e,t,f,r,a]),g=k.useMemo(()=>G1(e,t,f,r,a,"assets"),[e,t,f,r,a]),p=k.useMemo(()=>{if(e===a.pathname+a.search+a.hash)return[];let w=new Set,b=!1;if(t.forEach(S=>{var C;let E=r.routes[S.route.id];!E||!E.hasLoader||(!x.some(A=>A.route.id===S.route.id)&&S.route.id in h&&((C=l[S.route.id])!=null&&C.shouldRevalidate)||E.hasClientLoader?b=!0:w.add(S.route.id))}),w.size===0)return[];let T=T4(e,o);return b&&w.size>0&&T.searchParams.set("_routes",t.filter(S=>w.has(S.route.id)).map(S=>S.route.id).join(",")),[T.pathname+T.search]},[o,h,a,r,x,t,e,l]),y=k.useMemo(()=>y4(g,r),[g,r]),_=C4(g);return k.createElement(k.Fragment,null,p.map(w=>k.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...n})),y.map(w=>k.createElement("link",{key:w,rel:"modulepreload",href:w,...n})),_.map(({key:w,link:b})=>k.createElement("link",{key:w,...b})))}function k4(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var d2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{d2&&(window.__reactRouterVersion="7.6.1")}catch{}function A4({basename:e,children:t,window:n}){let a=k.useRef();a.current==null&&(a.current=pS({window:n,v5Compat:!0}));let r=a.current,[l,o]=k.useState({action:r.action,location:r.location}),h=k.useCallback(f=>{k.startTransition(()=>o(f))},[o]);return k.useLayoutEffect(()=>r.listen(h),[r,h]),k.createElement(s4,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:r})}var x2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Gh=k.forwardRef(function({onClick:t,discover:n="render",prefetch:a="none",relative:r,reloadDocument:l,replace:o,state:h,target:f,to:x,preventScrollReset:g,viewTransition:p,...y},_){let{basename:w}=k.useContext(Ia),b=typeof x=="string"&&x2.test(x),T,S=!1;if(typeof x=="string"&&b&&(T=x,d2))try{let M=new URL(window.location.href),B=x.startsWith("//")?new URL(M.protocol+x):new URL(x),I=Dr(B.pathname,w);B.origin===M.origin&&I!=null?x=I+B.search+B.hash:S=!0}catch{Ba(!1,`<Link to="${x}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=KS(x,{relative:r}),[C,A,F]=N4(a,y),K=R4(x,{replace:o,state:h,target:f,preventScrollReset:g,relative:r,viewTransition:p});function O(M){t&&t(M),M.defaultPrevented||K(M)}let P=k.createElement("a",{...y,...F,href:T||E,onClick:S||l?t:O,ref:k4(_,A),target:f,"data-discover":!b&&n==="render"?"true":void 0});return C&&!b?k.createElement(k.Fragment,null,P,k.createElement(E4,{page:E})):P});Gh.displayName="Link";var D4=k.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:a="",end:r=!1,style:l,to:o,viewTransition:h,children:f,...x},g){let p=mc(o,{relative:x.relative}),y=Rr(),_=k.useContext(Vh),{navigator:w,basename:b}=k.useContext(Ia),T=_!=null&&P4(p)&&h===!0,S=w.encodeLocation?w.encodeLocation(p).pathname:p.pathname,E=y.pathname,C=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;n||(E=E.toLowerCase(),C=C?C.toLowerCase():null,S=S.toLowerCase()),C&&b&&(C=Dr(C,b)||C);const A=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let F=E===S||!r&&E.startsWith(S)&&E.charAt(A)==="/",K=C!=null&&(C===S||!r&&C.startsWith(S)&&C.charAt(S.length)==="/"),O={isActive:F,isPending:K,isTransitioning:T},P=F?t:void 0,M;typeof a=="function"?M=a(O):M=[a,F?"active":null,K?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let B=typeof l=="function"?l(O):l;return k.createElement(Gh,{...x,"aria-current":P,className:M,ref:g,style:B,to:o,viewTransition:h},typeof f=="function"?f(O):f)});D4.displayName="NavLink";var O4=k.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:a,replace:r,state:l,method:o=dh,action:h,onSubmit:f,relative:x,preventScrollReset:g,viewTransition:p,...y},_)=>{let w=B4(),b=H4(h,{relative:x}),T=o.toLowerCase()==="get"?"get":"post",S=typeof h=="string"&&x2.test(h),E=C=>{if(f&&f(C),C.defaultPrevented)return;C.preventDefault();let A=C.nativeEvent.submitter,F=(A==null?void 0:A.getAttribute("formmethod"))||o;w(A||C.currentTarget,{fetcherKey:t,method:F,navigate:n,replace:r,state:l,relative:x,preventScrollReset:g,viewTransition:p})};return k.createElement("form",{ref:_,method:T,action:b,onSubmit:a?f:E,...y,"data-discover":!S&&e==="render"?"true":void 0})});O4.displayName="Form";function M4(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function g2(e){let t=k.useContext(dl);return Ft(t,M4(e)),t}function R4(e,{target:t,replace:n,state:a,preventScrollReset:r,relative:l,viewTransition:o}={}){let h=Kh(),f=Rr(),x=mc(e,{relative:l});return k.useCallback(g=>{if(h4(g,t)){g.preventDefault();let p=n!==void 0?n:$o(f)===$o(x);h(e,{replace:p,state:a,preventScrollReset:r,relative:l,viewTransition:o})}},[f,h,x,n,a,t,e,r,l,o])}var F4=0,L4=()=>`__${String(++F4)}__`;function B4(){let{router:e}=g2("useSubmit"),{basename:t}=k.useContext(Ia),n=t4();return k.useCallback(async(a,r={})=>{let{action:l,method:o,encType:h,formData:f,body:x}=x4(a,t);if(r.navigate===!1){let g=r.fetcherKey||L4();await e.fetch(g,n,r.action||l,{preventScrollReset:r.preventScrollReset,formData:f,body:x,formMethod:r.method||o,formEncType:r.encType||h,flushSync:r.flushSync})}else await e.navigate(r.action||l,{preventScrollReset:r.preventScrollReset,formData:f,body:x,formMethod:r.method||o,formEncType:r.encType||h,replace:r.replace,state:r.state,fromRouteId:n,flushSync:r.flushSync,viewTransition:r.viewTransition})},[e,t,n])}function H4(e,{relative:t}={}){let{basename:n}=k.useContext(Ia),a=k.useContext(nr);Ft(a,"useFormAction must be used inside a RouteContext");let[r]=a.matches.slice(-1),l={...mc(e||".",{relative:t})},o=Rr();if(e==null){l.search=o.search;let h=new URLSearchParams(l.search),f=h.getAll("index");if(f.some(g=>g==="")){h.delete("index"),f.filter(p=>p).forEach(p=>h.append("index",p));let g=h.toString();l.search=g?`?${g}`:""}}return(!e||e===".")&&r.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:Er([n,l.pathname])),$o(l)}function P4(e,t={}){let n=k.useContext(i2);Ft(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=g2("useViewTransitionState"),r=mc(e,{relative:t.relative});if(!n.isTransitioning)return!1;let l=Dr(n.currentLocation.pathname,a)||n.currentLocation.pathname,o=Dr(n.nextLocation.pathname,a)||n.nextLocation.pathname;return vh(r.pathname,o)!=null||vh(r.pathname,l)!=null}[...w4];var I4=t2();const m2="/KTPM_FE/assets/logo-BqDv4dgE.png",z4="http://localhost:8000/api",U4=e=>{try{const t=JSON.parse(atob(e.split(".")[1])),n=Date.now()/1e3;return t.exp<n}catch(t){return console.error("Error parsing token:",t),!0}},V4=()=>{const e=localStorage.getItem("authToken");return e?U4(e)?(console.log("🔑 Token expired, clearing storage"),localStorage.removeItem("authToken"),localStorage.removeItem("user"),null):e:(console.log("🔑 No token found"),null)},p2=e=>{localStorage.setItem("authToken",e)},K4=()=>{localStorage.removeItem("authToken")},Re=async(e,t={})=>{var o;const n=`${z4}${e}`,a=V4(),r={"Content-Type":"application/json"};a?(r.Authorization=`Bearer ${a}`,console.log("🔑 Using valid token for request:",a.substring(0,20)+"...")):console.log("⚠️  No valid token available");const l={headers:{...r,...t.headers},...t};try{console.log("Making API request to:",n),console.log("Request headers:",l.headers);const h=await fetch(n,l);console.log("Response status:",h.status),console.log("Response OK:",h.ok);const f=await h.json();if(console.log("Response data:",f),!h.ok){if(console.error("API Response not OK:",{status:h.status,statusText:h.statusText,data:f}),h.status===401&&((o=f.message)!=null&&o.includes("Token"))){console.log("🔑 Token invalid, clearing auth data"),localStorage.removeItem("authToken"),localStorage.removeItem("user"),window.location.href="/login";return}if(h.status===400||h.status===422)return console.log("Business logic error, returning data with error info"),f;throw new Error(f.message||`HTTP error! status: ${h.status}`)}return console.log("API request successful, returning data:",f),f}catch(h){throw console.error("API Request Error Details:"),console.error("Error type:",typeof h),console.error("Error message:",h.message),console.error("Error stack:",h.stack),console.error("Full error object:",h),h}},W4={login:async(e,t)=>{const n=await Re("/auth/login",{method:"POST",body:JSON.stringify({username:e,password:t})});return n.token&&p2(n.token),n},logout:async()=>{try{await Re("/auth/logout",{method:"POST"})}finally{K4()}},register:async(e,t)=>Re("/auth/register",{method:"POST",body:JSON.stringify({username:e,password:t})})},G4={getAll:async()=>Re("/vehicles"),getById:async e=>Re(`/vehicles/${e}`),getTypes:async()=>Re("/vehicles/types"),getStatistics:async()=>Re("/vehicles/statistics"),create:async e=>Re("/vehicles",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>Re(`/vehicles/${e}`,{method:"PUT",body:JSON.stringify(t)}),delete:async e=>Re(`/vehicles/${e}`,{method:"DELETE"})},Ha={getAll:async e=>{const t=e?new URLSearchParams(e).toString():"";return Re(`/households${t?`?${t}`:""}`)},getById:async e=>Re(`/households/${e}`),getAvailable:async()=>Re("/households/available"),create:async e=>Re("/households",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>Re(`/households/${e}`,{method:"PUT",body:JSON.stringify(t)}),assignHead:async(e,t)=>Re("/households/assign-head",{method:"POST",body:JSON.stringify({householdId:e,newHeadId:t})})},Gn={getAll:async e=>{const t=e?new URLSearchParams(e).toString():"";return Re(`/residents${t?`?${t}`:""}`)},getAvailable:async e=>{const t=e?new URLSearchParams({search:e}).toString():"";return Re(`/residents/available${t?`?${t}`:""}`)},getById:async e=>Re(`/residents/${e}`),create:async e=>Re("/residents",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>Re(`/residents/${e}`,{method:"PUT",body:JSON.stringify(t)}),delete:async e=>Re(`/residents/${e}`,{method:"DELETE"}),addToHousehold:async e=>Re("/residents/add-to-household",{method:"POST",body:JSON.stringify(e)}),separateHousehold:async e=>Re("/residents/separate-household",{method:"POST",body:JSON.stringify(e)}),getHouseholdInfo:async e=>Re(`/residents/${e}/household-info`),getHouseholdChangeHistory:async e=>{const t={};e&&(e.page!==void 0&&(t.page=e.page.toString()),e.limit!==void 0&&(t.limit=e.limit.toString()),e.fromDate!==void 0&&e.fromDate&&(t.fromDate=e.fromDate),e.toDate!==void 0&&e.toDate&&(t.toDate=e.toDate),e.changeType!==void 0&&(t.changeType=e.changeType.toString()));const n=Object.keys(t).length?new URLSearchParams(t).toString():"";return Re(`/residents/household-changes${n?`?${n}`:""}`)}},Do={getGenderStatistics:async()=>Re("/population/gender"),getAgeStatistics:async e=>{const t=e?new URLSearchParams({customAgeGroups:e}).toString():"";return Re(`/population/age${t?`?${t}`:""}`)},getPopulationMovement:async(e,t)=>{const n={};e&&(n.fromDate=e),t&&(n.toDate=t);const a=Object.keys(n).length?new URLSearchParams(n).toString():"";return Re(`/population/movement${a?`?${a}`:""}`)},getTotalResidents:async()=>Re("/residents?limit=1"),getTemporaryStatusStatistics:async()=>Re("/population/temporary-status")},X4={getAll:async e=>{const t=new URLSearchParams;(e==null?void 0:e.page)!==void 0&&t.append("page",e.page.toString()),(e==null?void 0:e.size)!==void 0&&t.append("size",e.size.toString()),e!=null&&e.sortBy&&t.append("sortBy",e.sortBy),e!=null&&e.sortDir&&t.append("sortDir",e.sortDir),e!=null&&e.search&&t.append("search",e.search);const n=t.toString(),a=`/dot-thu${n?`?${n}`:""}`;return await Re(a)},getAllWithKhoanThu:async e=>{const t=new URLSearchParams;(e==null?void 0:e.page)!==void 0&&t.append("page",e.page.toString()),(e==null?void 0:e.size)!==void 0&&t.append("size",e.size.toString()),e!=null&&e.sortBy&&t.append("sortBy",e.sortBy),e!=null&&e.sortDir&&t.append("sortDir",e.sortDir),e!=null&&e.search&&t.append("search",e.search);const n=t.toString(),a=`/dot-thu/with-khoan-thu${n?`?${n}`:""}`;return await Re(a)},getById:async e=>await Re(`/dot-thu/${e}`),create:async e=>await Re("/dot-thu",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await Re(`/dot-thu/${e}`,{method:"PUT",body:JSON.stringify(t)}),delete:async e=>await Re(`/dot-thu/${e}`,{method:"DELETE"}),getStatistics:async()=>await Re("/dot-thu/statistics"),getPaymentStatistics:async e=>await Re(`/dot-thu/${e}/payment-statistics`),getPaymentInfo:async(e,t)=>await Re(`/dot-thu/${e}/payment-info/${t}`),recordPayment:async e=>await Re("/dot-thu/record-payment",{method:"POST",body:JSON.stringify(e)})},y2={getAll:async()=>await Re("/khoan-thu"),getById:async e=>await Re(`/khoan-thu/${e}`),create:async e=>await Re("/khoan-thu",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await Re(`/khoan-thu/${e}`,{method:"PUT",body:JSON.stringify(t)}),delete:async e=>await Re(`/khoan-thu/${e}`,{method:"DELETE"})},Y4={create:async e=>await Re("/payments",{method:"POST",body:JSON.stringify(e)}),getAll:async e=>{const t=e?new URLSearchParams(e).toString():"";return await Re(`/payments${t?`?${t}`:""}`)},getById:async e=>await Re(`/payments/${e}`),update:async(e,t)=>await Re(`/payments/${e}`,{method:"PUT",body:JSON.stringify(t)}),delete:async e=>await Re(`/payments/${e}`,{method:"DELETE"}),restore:async(e,t)=>await Re(`/payments/${e}/restore`,{method:"POST",body:JSON.stringify({restoreReason:t})}),getStatistics:async e=>{const t=e?new URLSearchParams(e).toString():"";return await Re(`/payments/statistics${t?`?${t}`:""}`)}},Kn={auth:W4,vehicles:G4,households:Ha,residents:Gn,population:Do,dotThu:X4,khoanThu:y2,payment:Y4},q4=e=>{try{const t=JSON.parse(atob(e.split(".")[1])),n=Date.now()/1e3;return t.exp<n}catch(t){return console.error("Error parsing token:",t),!0}},qs={async login(e){const t=await fetch("http://localhost:8000/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await t.json();if(!t.ok)throw new Error(n.message||`HTTP error! status: ${t.status}`);return n.token&&(p2(n.token),localStorage.setItem("user",JSON.stringify(n.user))),n},logout(){localStorage.removeItem("authToken"),localStorage.removeItem("user")},getCurrentUser(){const e=localStorage.getItem("user");return e?JSON.parse(e):null},isAuthenticated(){const e=localStorage.getItem("authToken");return e?q4(e)?(localStorage.removeItem("authToken"),localStorage.removeItem("user"),!1):!0:!1},hasRole(e){const t=this.getCurrentUser();return t?e.includes(t.role):!1}},X1=[{label:"Kế toán",value:"ketoan"},{label:"Tổ trưởng/Tổ phó",value:"totruong"}],$4=()=>{const[e,t]=k.useState(""),[n,a]=k.useState(""),[r,l]=k.useState(X1[0].value),[o,h]=k.useState(""),[f,x]=k.useState(!1),[g,p]=k.useState(!1),[y,_]=k.useState(!1),w=Kh();k.useEffect(()=>{if(qs.isAuthenticated()){const S=qs.getCurrentUser();(S==null?void 0:S.role)==="admin"||(S==null?void 0:S.role)==="accountant"?w("/homepage-ketoan",{replace:!0}):(S==null?void 0:S.role)==="manager"&&w("/homepage-totruong",{replace:!0})}const T=localStorage.getItem("loginInfo");if(T){const{username:S,role:E}=JSON.parse(T);t(S),l(E),p(!0)}},[w]);const b=async T=>{if(T.preventDefault(),!e||!n||!r){h("Vui lòng nhập đầy đủ thông tin và chọn vai trò.");return}h(""),_(!0);try{const E=(await qs.login({username:e,password:n})).user.role;if(!(r==="ketoan"&&(E==="admin"||E==="accountant")||r==="totruong"&&(E==="admin"||E==="manager"))){h("Vai trò được chọn không phù hợp với tài khoản.");return}g?localStorage.setItem("loginInfo",JSON.stringify({username:e,role:r})):localStorage.removeItem("loginInfo"),w(r==="ketoan"?"/homepage-ketoan":"/homepage-totruong")}catch(S){console.error("Login error:",S),h(S.message||"Đăng nhập thất bại. Vui lòng kiểm tra thông tin đăng nhập.")}finally{_(!1)}};return u.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-[#f6f7fa] py-8 px-2",children:[u.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-black/10 w-full max-w-[600px] p-8 flex flex-col gap-3",children:[u.jsxs("div",{className:"flex flex-col items-center mb-2",children:[u.jsx("img",{src:m2,alt:"Bluemoon Logo",className:"w-16 h-16 mb-2"}),u.jsx("h1",{className:"text-center text-[22px] font-bold text-[#000000] leading-tight font-['Roboto'] tracking-wide uppercase mb-1",children:"Đăng nhập"}),u.jsx("span",{className:"text-center text-[16px] font-semibold text-[#1976D2] font-['Roboto'] mb-2",children:"HỆ THỐNG QUẢN LÝ THU PHÍ CHUNG CƯ"})]}),u.jsxs("form",{className:"flex flex-col gap-3",onSubmit:b,children:[u.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-end",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-[14px] font-bold text-black mb-1 font-['Roboto']",htmlFor:"username",children:"Tên đăng nhập"}),u.jsx("input",{id:"username",name:"username",type:"text",className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#2196F3] text-[16px] placeholder-gray-400 shadow-sm font-['Roboto'] font-normal",autoComplete:"username",value:e,onChange:T=>t(T.target.value),placeholder:"Nhập tên đăng nhập",required:!0})]}),u.jsxs("div",{className:"flex-1 sm:max-w-[220px]",children:[u.jsx("label",{className:"block text-[14px] font-bold text-black mb-1 font-['Roboto']",htmlFor:"role",children:"Vai trò"}),u.jsxs("select",{id:"role",name:"role",className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#2196F3] text-[16px] shadow-sm font-['Roboto'] font-normal",value:r,onChange:T=>l(T.target.value),required:!0,children:[u.jsx("option",{value:"",disabled:!0,children:"Chọn vai trò"}),X1.map(T=>u.jsx("option",{value:T.value,children:T.label},T.value))]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-[14px] font-bold text-black mb-1 font-['Roboto']",htmlFor:"password",children:"Mật khẩu"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{id:"password",name:"password",type:f?"text":"password",className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#2196F3] text-[16px] placeholder-gray-400 shadow-sm font-['Roboto'] font-normal",autoComplete:"current-password",value:n,onChange:T=>a(T.target.value),placeholder:"Nhập mật khẩu",required:!0}),u.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-[#1976D2] text-xs font-semibold focus:outline-none",onClick:()=>x(T=>!T),tabIndex:-1,children:f?"Ẩn":"Hiện"})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{id:"rememberMe",type:"checkbox",checked:g,onChange:T=>p(T.target.checked),className:"h-4 w-4 text-[#2196F3] border-gray-300 rounded focus:ring-[#2196F3]"}),u.jsx("label",{htmlFor:"rememberMe",className:"text-[14px] font-normal text-black font-['Roboto'] cursor-pointer",children:"Ghi nhớ đăng nhập"})]}),o&&u.jsx("div",{className:"text-red-500 text-sm",children:o}),u.jsx("button",{type:"submit",disabled:y,className:"w-full bg-[#2196F3] text-white font-medium text-[14px] py-2 rounded-lg shadow-md hover:bg-[#1976D2] transition uppercase tracking-wider font-['Roboto'] disabled:opacity-50 disabled:cursor-not-allowed",children:y?"Đang đăng nhập...":"Đăng nhập"}),u.jsx("div",{className:"flex items-center justify-between",children:u.jsx(Gh,{to:"/forget-password",className:"text-[15px] font-bold text-[#2196F3] hover:underline font-['Roboto']",children:"Quên mật khẩu?"})})]})]}),u.jsx("footer",{className:"mt-6 text-[#746565] text-[16px] text-center font-['Roboto'] font-normal",children:"@2025 Hệ thống Quản lý Thu phí Chung cư BlueMoon"})]})},kn=({children:e,role:t})=>{const n=Rr(),a=Kh(),[r,l]=Uh.useState(!1),o=()=>{qs.logout(),l(!1),a("/login")},h=t==="ketoan"?[{path:"/homepage-ketoan",label:"Trang chủ"},{path:"/quan-ly-khoan-thu",label:"Quản lý Khoản thu"},{path:"/quan-ly-dot-thu-phi",label:"Quản lý Đợt thu phí"},{path:"/thong-ke-khoan-thu",label:"Thống kê Thu phí"}]:[{path:"/homepage-totruong",label:"Trang chủ"},{path:"/quan-ly-ho-khau",label:"Quản lý Hộ khẩu"},{path:"/quan-ly-nhan-khau",label:"Quản lý Nhân khẩu"},{path:"/quan-ly-phong",label:"Quản lý Phòng"},{path:"/quan-ly-xe",label:"Quản lý Xe"},{path:"/quan-ly-tam-tru",label:"Quản lý Tạm trú/ Tạm vắng"},{path:"/lich-su-thay-doi-nhan-khau",label:"Lịch sử thay đổi Nhân khẩu"},{path:"/thong-ke-nhan-khau",label:"Thống kê Nhân khẩu"}];return u.jsxs("div",{className:"flex flex-col min-h-screen bg-[#f3f4f6]",children:[u.jsx("header",{className:"bg-gradient-to-r from-blue-600 to-blue-700 shadow-lg border-b border-blue-800 fixed top-0 left-0 right-0 z-10",children:u.jsxs("div",{className:"px-6 py-4 flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("img",{src:m2,alt:"Bluemoon Logo",className:"w-10 h-10 rounded-lg shadow-sm"}),u.jsxs("div",{className:"flex flex-col",children:[u.jsx("h1",{className:"text-white font-bold text-lg tracking-wide",children:"CHUNG CƯ BLUEMOON"}),u.jsx("p",{className:"text-blue-100 text-sm font-medium",children:"Hệ thống quản lý cư dân"})]})]}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{className:"bg-white/10 backdrop-blur-sm text-white font-medium py-2 px-4 rounded-lg border border-white/20 hover:bg-white/20 transition-all duration-200 flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-white/30",onClick:()=>l(f=>!f),children:[u.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:u.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),u.jsxs("div",{className:"text-left",children:[u.jsxs("div",{className:"text-sm font-semibold",children:["Xin chào, ",u.jsx("span",{className:"text-blue-100",children:"totruong"})]}),u.jsxs("div",{className:"text-xs text-blue-200",children:["(",t==="ketoan"?"Kế toán viên":"Tổ trưởng",")"]})]}),u.jsx("svg",{className:`w-4 h-4 text-white transition-transform duration-200 ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r&&u.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white border border-gray-200 rounded-lg shadow-xl z-20 overflow-hidden",children:[u.jsxs("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:[u.jsx("p",{className:"text-sm font-medium text-gray-900",children:"totruong"}),u.jsx("p",{className:"text-xs text-gray-500",children:t==="ketoan"?"Kế toán viên":"Tổ trưởng"})]}),u.jsxs("button",{className:"block w-full text-left px-4 py-3 text-sm text-red-600 font-medium hover:bg-red-50 transition-colors duration-150 flex items-center gap-2",onClick:o,children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Đăng xuất"]})]})]})]})}),u.jsxs("div",{className:"flex flex-1 pt-20",children:[u.jsx("div",{className:"w-64 bg-white shadow-lg flex flex-col fixed top-20 bottom-0 border-r border-gray-200",children:u.jsx("nav",{className:"mt-2 flex-1 overflow-y-auto",children:u.jsxs("ul",{className:"flex flex-col h-full",children:[h.map(f=>{const x=n.pathname===f.path;return u.jsx("li",{children:u.jsx(Gh,{to:f.path,className:`block text-sm transition-all duration-200 border-l-4 ${x?"border-blue-500 bg-blue-50 text-blue-700 font-semibold":"border-transparent text-gray-700 hover:bg-gray-50 hover:text-blue-600 font-medium"}`,style:{padding:"14px 20px"},children:f.label})},f.path)}),u.jsx("li",{className:"mt-auto border-t border-gray-200",children:u.jsxs("button",{onClick:o,className:"block w-full text-left text-sm text-red-600 font-medium hover:bg-red-50 transition-all duration-200 flex items-center gap-2",style:{padding:"14px 20px"},children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Đăng xuất"]})})]})})}),u.jsx("div",{className:"flex-1 flex flex-col pl-64",children:u.jsx("main",{className:"flex-1 p-4 overflow-y-auto",children:e})})]})]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function pc(e){return e+.5|0}const cs=(e,t,n)=>Math.max(Math.min(e,n),t);function Oo(e){return cs(pc(e*2.55),0,255)}function xs(e){return cs(pc(e*255),0,255)}function wr(e){return cs(pc(e/2.55)/100,0,1)}function Y1(e){return cs(pc(e*100),0,100)}const va={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Wd=[..."0123456789ABCDEF"],Q4=e=>Wd[e&15],Z4=e=>Wd[(e&240)>>4]+Wd[e&15],Iu=e=>(e&240)>>4===(e&15),J4=e=>Iu(e.r)&&Iu(e.g)&&Iu(e.b)&&Iu(e.a);function eN(e){var t=e.length,n;return e[0]==="#"&&(t===4||t===5?n={r:255&va[e[1]]*17,g:255&va[e[2]]*17,b:255&va[e[3]]*17,a:t===5?va[e[4]]*17:255}:(t===7||t===9)&&(n={r:va[e[1]]<<4|va[e[2]],g:va[e[3]]<<4|va[e[4]],b:va[e[5]]<<4|va[e[6]],a:t===9?va[e[7]]<<4|va[e[8]]:255})),n}const tN=(e,t)=>e<255?t(e):"";function nN(e){var t=J4(e)?Q4:Z4;return e?"#"+t(e.r)+t(e.g)+t(e.b)+tN(e.a,t):void 0}const aN=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function v2(e,t,n){const a=t*Math.min(n,1-n),r=(l,o=(l+e/30)%12)=>n-a*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function rN(e,t,n){const a=(r,l=(r+e/60)%6)=>n-n*t*Math.max(Math.min(l,4-l,1),0);return[a(5),a(3),a(1)]}function sN(e,t,n){const a=v2(e,1,.5);let r;for(t+n>1&&(r=1/(t+n),t*=r,n*=r),r=0;r<3;r++)a[r]*=1-t-n,a[r]+=t;return a}function iN(e,t,n,a,r){return e===r?(t-n)/a+(t<n?6:0):t===r?(n-e)/a+2:(e-t)/a+4}function dx(e){const n=e.r/255,a=e.g/255,r=e.b/255,l=Math.max(n,a,r),o=Math.min(n,a,r),h=(l+o)/2;let f,x,g;return l!==o&&(g=l-o,x=h>.5?g/(2-l-o):g/(l+o),f=iN(n,a,r,g,l),f=f*60+.5),[f|0,x||0,h]}function xx(e,t,n,a){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,a)).map(xs)}function gx(e,t,n){return xx(v2,e,t,n)}function lN(e,t,n){return xx(sN,e,t,n)}function oN(e,t,n){return xx(rN,e,t,n)}function b2(e){return(e%360+360)%360}function cN(e){const t=aN.exec(e);let n=255,a;if(!t)return;t[5]!==a&&(n=t[6]?Oo(+t[5]):xs(+t[5]));const r=b2(+t[2]),l=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?a=lN(r,l,o):t[1]==="hsv"?a=oN(r,l,o):a=gx(r,l,o),{r:a[0],g:a[1],b:a[2],a:n}}function uN(e,t){var n=dx(e);n[0]=b2(n[0]+t),n=gx(n),e.r=n[0],e.g=n[1],e.b=n[2]}function hN(e){if(!e)return;const t=dx(e),n=t[0],a=Y1(t[1]),r=Y1(t[2]);return e.a<255?`hsla(${n}, ${a}%, ${r}%, ${wr(e.a)})`:`hsl(${n}, ${a}%, ${r}%)`}const q1={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},$1={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function fN(){const e={},t=Object.keys($1),n=Object.keys(q1);let a,r,l,o,h;for(a=0;a<t.length;a++){for(o=h=t[a],r=0;r<n.length;r++)l=n[r],h=h.replace(l,q1[l]);l=parseInt($1[o],16),e[h]=[l>>16&255,l>>8&255,l&255]}return e}let zu;function dN(e){zu||(zu=fN(),zu.transparent=[0,0,0,0]);const t=zu[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const xN=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function gN(e){const t=xN.exec(e);let n=255,a,r,l;if(t){if(t[7]!==a){const o=+t[7];n=t[8]?Oo(o):cs(o*255,0,255)}return a=+t[1],r=+t[3],l=+t[5],a=255&(t[2]?Oo(a):cs(a,0,255)),r=255&(t[4]?Oo(r):cs(r,0,255)),l=255&(t[6]?Oo(l):cs(l,0,255)),{r:a,g:r,b:l,a:n}}}function mN(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${wr(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const bd=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,Xi=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function pN(e,t,n){const a=Xi(wr(e.r)),r=Xi(wr(e.g)),l=Xi(wr(e.b));return{r:xs(bd(a+n*(Xi(wr(t.r))-a))),g:xs(bd(r+n*(Xi(wr(t.g))-r))),b:xs(bd(l+n*(Xi(wr(t.b))-l))),a:e.a+n*(t.a-e.a)}}function Uu(e,t,n){if(e){let a=dx(e);a[t]=Math.max(0,Math.min(a[t]+a[t]*n,t===0?360:1)),a=gx(a),e.r=a[0],e.g=a[1],e.b=a[2]}}function _2(e,t){return e&&Object.assign(t||{},e)}function Q1(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=xs(e[3]))):(t=_2(e,{r:0,g:0,b:0,a:1}),t.a=xs(t.a)),t}function yN(e){return e.charAt(0)==="r"?gN(e):cN(e)}class Qo{constructor(t){if(t instanceof Qo)return t;const n=typeof t;let a;n==="object"?a=Q1(t):n==="string"&&(a=eN(t)||dN(t)||yN(t)),this._rgb=a,this._valid=!!a}get valid(){return this._valid}get rgb(){var t=_2(this._rgb);return t&&(t.a=wr(t.a)),t}set rgb(t){this._rgb=Q1(t)}rgbString(){return this._valid?mN(this._rgb):void 0}hexString(){return this._valid?nN(this._rgb):void 0}hslString(){return this._valid?hN(this._rgb):void 0}mix(t,n){if(t){const a=this.rgb,r=t.rgb;let l;const o=n===l?.5:n,h=2*o-1,f=a.a-r.a,x=((h*f===-1?h:(h+f)/(1+h*f))+1)/2;l=1-x,a.r=255&x*a.r+l*r.r+.5,a.g=255&x*a.g+l*r.g+.5,a.b=255&x*a.b+l*r.b+.5,a.a=o*a.a+(1-o)*r.a,this.rgb=a}return this}interpolate(t,n){return t&&(this._rgb=pN(this._rgb,t._rgb,n)),this}clone(){return new Qo(this.rgb)}alpha(t){return this._rgb.a=xs(t),this}clearer(t){const n=this._rgb;return n.a*=1-t,this}greyscale(){const t=this._rgb,n=pc(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=n,this}opaquer(t){const n=this._rgb;return n.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Uu(this._rgb,2,t),this}darken(t){return Uu(this._rgb,2,-t),this}saturate(t){return Uu(this._rgb,1,t),this}desaturate(t){return Uu(this._rgb,1,-t),this}rotate(t){return uN(this._rgb,t),this}}/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function vr(){}const vN=(()=>{let e=0;return()=>e++})();function rt(e){return e==null}function qt(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function it(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function Sa(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function Ya(e,t){return Sa(e)?e:t}function Je(e,t){return typeof e>"u"?t:e}const bN=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:+e/t,w2=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function jt(e,t,n){if(e&&typeof e.call=="function")return e.apply(n,t)}function dt(e,t,n,a){let r,l,o;if(qt(e))for(l=e.length,r=0;r<l;r++)t.call(n,e[r],r);else if(it(e))for(o=Object.keys(e),l=o.length,r=0;r<l;r++)t.call(n,e[o[r]],o[r])}function bh(e,t){let n,a,r,l;if(!e||!t||e.length!==t.length)return!1;for(n=0,a=e.length;n<a;++n)if(r=e[n],l=t[n],r.datasetIndex!==l.datasetIndex||r.index!==l.index)return!1;return!0}function _h(e){if(qt(e))return e.map(_h);if(it(e)){const t=Object.create(null),n=Object.keys(e),a=n.length;let r=0;for(;r<a;++r)t[n[r]]=_h(e[n[r]]);return t}return e}function T2(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function _N(e,t,n,a){if(!T2(e))return;const r=t[e],l=n[e];it(r)&&it(l)?er(r,l,a):t[e]=_h(l)}function er(e,t,n){const a=qt(t)?t:[t],r=a.length;if(!it(e))return e;n=n||{};const l=n.merger||_N;let o;for(let h=0;h<r;++h){if(o=a[h],!it(o))continue;const f=Object.keys(o);for(let x=0,g=f.length;x<g;++x)l(f[x],e,o,n)}return e}function Ho(e,t){return er(e,t,{merger:wN})}function wN(e,t,n){if(!T2(e))return;const a=t[e],r=n[e];it(a)&&it(r)?Ho(a,r):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=_h(r))}const Z1={"":e=>e,x:e=>e.x,y:e=>e.y};function TN(e){const t=e.split("."),n=[];let a="";for(const r of t)a+=r,a.endsWith("\\")?a=a.slice(0,-1)+".":(n.push(a),a="");return n}function SN(e){const t=TN(e);return n=>{for(const a of t){if(a==="")break;n=n&&n[a]}return n}}function ei(e,t){return(Z1[t]||(Z1[t]=SN(t)))(e)}function mx(e){return e.charAt(0).toUpperCase()+e.slice(1)}const Zo=e=>typeof e<"u",gs=e=>typeof e=="function",J1=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};function NN(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const Ut=Math.PI,It=2*Ut,EN=It+Ut,wh=Number.POSITIVE_INFINITY,CN=Ut/180,tn=Ut/2,zs=Ut/4,ey=Ut*2/3,S2=Math.log10,Ja=Math.sign;function Po(e,t,n){return Math.abs(e-t)<n}function ty(e){const t=Math.round(e);e=Po(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(S2(e))),a=e/n;return(a<=1?1:a<=2?2:a<=5?5:10)*n}function jN(e){const t=[],n=Math.sqrt(e);let a;for(a=1;a<n;a++)e%a===0&&(t.push(a),t.push(e/a));return n===(n|0)&&t.push(n),t.sort((r,l)=>r-l).pop(),t}function kN(e){return typeof e=="symbol"||typeof e=="object"&&e!==null&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}function Jo(e){return!kN(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function AN(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}function DN(e,t,n){let a,r,l;for(a=0,r=e.length;a<r;a++)l=e[a][n],isNaN(l)||(t.min=Math.min(t.min,l),t.max=Math.max(t.max,l))}function Tr(e){return e*(Ut/180)}function ON(e){return e*(180/Ut)}function ny(e){if(!Sa(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function N2(e,t){const n=t.x-e.x,a=t.y-e.y,r=Math.sqrt(n*n+a*a);let l=Math.atan2(a,n);return l<-.5*Ut&&(l+=It),{angle:l,distance:r}}function Gd(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function MN(e,t){return(e-t+EN)%It-Ut}function os(e){return(e%It+It)%It}function ec(e,t,n,a){const r=os(e),l=os(t),o=os(n),h=os(l-r),f=os(o-r),x=os(r-l),g=os(r-o);return r===l||r===o||a&&l===o||h>f&&x<g}function jn(e,t,n){return Math.max(t,Math.min(n,e))}function RN(e){return jn(e,-32768,32767)}function us(e,t,n,a=1e-6){return e>=Math.min(t,n)-a&&e<=Math.max(t,n)+a}function px(e,t,n){n=n||(o=>e[o]<t);let a=e.length-1,r=0,l;for(;a-r>1;)l=r+a>>1,n(l)?r=l:a=l;return{lo:r,hi:a}}const Ys=(e,t,n,a)=>px(e,n,a?r=>{const l=e[r][t];return l<n||l===n&&e[r+1][t]===n}:r=>e[r][t]<n),FN=(e,t,n)=>px(e,n,a=>e[a][t]>=n);function LN(e,t,n){let a=0,r=e.length;for(;a<r&&e[a]<t;)a++;for(;r>a&&e[r-1]>n;)r--;return a>0||r<e.length?e.slice(a,r):e}const E2=["push","pop","shift","splice","unshift"];function BN(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),E2.forEach(n=>{const a="_onData"+mx(n),r=e[n];Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value(...l){const o=r.apply(this,l);return e._chartjs.listeners.forEach(h=>{typeof h[a]=="function"&&h[a](...l)}),o}})})}function ay(e,t){const n=e._chartjs;if(!n)return;const a=n.listeners,r=a.indexOf(t);r!==-1&&a.splice(r,1),!(a.length>0)&&(E2.forEach(l=>{delete e[l]}),delete e._chartjs)}function C2(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const j2=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function k2(e,t){let n=[],a=!1;return function(...r){n=r,a||(a=!0,j2.call(window,()=>{a=!1,e.apply(t,n)}))}}function HN(e,t){let n;return function(...a){return t?(clearTimeout(n),n=setTimeout(e,t,a)):e.apply(this,a),t}}const yx=e=>e==="start"?"left":e==="end"?"right":"center",Cn=(e,t,n)=>e==="start"?t:e==="end"?n:(t+n)/2,PN=(e,t,n,a)=>e===(a?"left":"right")?n:e==="center"?(t+n)/2:t;function IN(e,t,n){const a=t.length;let r=0,l=a;if(e._sorted){const{iScale:o,vScale:h,_parsed:f}=e,x=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,g=o.axis,{min:p,max:y,minDefined:_,maxDefined:w}=o.getUserBounds();if(_){if(r=Math.min(Ys(f,g,p).lo,n?a:Ys(t,g,o.getPixelForValue(p)).lo),x){const b=f.slice(0,r+1).reverse().findIndex(T=>!rt(T[h.axis]));r-=Math.max(0,b)}r=jn(r,0,a-1)}if(w){let b=Math.max(Ys(f,o.axis,y,!0).hi+1,n?0:Ys(t,g,o.getPixelForValue(y),!0).hi+1);if(x){const T=f.slice(b-1).findIndex(S=>!rt(S[h.axis]));b+=Math.max(0,T)}l=jn(b,r,a)-r}else l=a-r}return{start:r,count:l}}function zN(e){const{xScale:t,yScale:n,_scaleRanges:a}=e,r={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!a)return e._scaleRanges=r,!0;const l=a.xmin!==t.min||a.xmax!==t.max||a.ymin!==n.min||a.ymax!==n.max;return Object.assign(a,r),l}const Vu=e=>e===0||e===1,ry=(e,t,n)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*It/n)),sy=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*It/n)+1,Io={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*tn)+1,easeOutSine:e=>Math.sin(e*tn),easeInOutSine:e=>-.5*(Math.cos(Ut*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>Vu(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>Vu(e)?e:ry(e,.075,.3),easeOutElastic:e=>Vu(e)?e:sy(e,.075,.3),easeInOutElastic(e){return Vu(e)?e:e<.5?.5*ry(e*2,.1125,.45):.5+.5*sy(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-Io.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?Io.easeInBounce(e*2)*.5:Io.easeOutBounce(e*2-1)*.5+.5};function vx(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function iy(e){return vx(e)?e:new Qo(e)}function _d(e){return vx(e)?e:new Qo(e).saturate(.5).darken(.1).hexString()}const UN=["x","y","borderWidth","radius","tension"],VN=["color","borderColor","backgroundColor"];function KN(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:VN},numbers:{type:"number",properties:UN}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function WN(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const ly=new Map;function GN(e,t){t=t||{};const n=e+JSON.stringify(t);let a=ly.get(n);return a||(a=new Intl.NumberFormat(e,t),ly.set(n,a)),a}function bx(e,t,n){return GN(t,n).format(e)}const XN={values(e){return qt(e)?e:""+e},numeric(e,t,n){if(e===0)return"0";const a=this.chart.options.locale;let r,l=e;if(n.length>1){const x=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(x<1e-4||x>1e15)&&(r="scientific"),l=YN(e,n)}const o=S2(Math.abs(l)),h=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),f={notation:r,minimumFractionDigits:h,maximumFractionDigits:h};return Object.assign(f,this.options.ticks.format),bx(e,a,f)}};function YN(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e)),n}var A2={formatters:XN};function qN(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,n)=>n.lineWidth,tickColor:(t,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:A2.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const ti=Object.create(null),Xd=Object.create(null);function zo(e,t){if(!t)return e;const n=t.split(".");for(let a=0,r=n.length;a<r;++a){const l=n[a];e=e[l]||(e[l]=Object.create(null))}return e}function wd(e,t,n){return typeof t=="string"?er(zo(e,t),n):er(zo(e,""),t)}class $N{constructor(t,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=a=>a.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(a,r)=>_d(r.backgroundColor),this.hoverBorderColor=(a,r)=>_d(r.borderColor),this.hoverColor=(a,r)=>_d(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(n)}set(t,n){return wd(this,t,n)}get(t){return zo(this,t)}describe(t,n){return wd(Xd,t,n)}override(t,n){return wd(ti,t,n)}route(t,n,a,r){const l=zo(this,t),o=zo(this,a),h="_"+n;Object.defineProperties(l,{[h]:{value:l[n],writable:!0},[n]:{enumerable:!0,get(){const f=this[h],x=o[r];return it(f)?Object.assign({},x,f):Je(f,x)},set(f){this[h]=f}}})}apply(t){t.forEach(n=>n(this))}}var zt=new $N({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[KN,WN,qN]);function QN(e){return!e||rt(e.size)||rt(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function oy(e,t,n,a,r){let l=t[r];return l||(l=t[r]=e.measureText(r).width,n.push(r)),l>a&&(a=l),a}function Us(e,t,n){const a=e.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((t-r)*a)/a+r}function cy(e,t){!t&&!e||(t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function Yd(e,t,n,a){D2(e,t,n,a,null)}function D2(e,t,n,a,r){let l,o,h,f,x,g,p,y;const _=t.pointStyle,w=t.rotation,b=t.radius;let T=(w||0)*CN;if(_&&typeof _=="object"&&(l=_.toString(),l==="[object HTMLImageElement]"||l==="[object HTMLCanvasElement]")){e.save(),e.translate(n,a),e.rotate(T),e.drawImage(_,-_.width/2,-_.height/2,_.width,_.height),e.restore();return}if(!(isNaN(b)||b<=0)){switch(e.beginPath(),_){default:r?e.ellipse(n,a,r/2,b,0,0,It):e.arc(n,a,b,0,It),e.closePath();break;case"triangle":g=r?r/2:b,e.moveTo(n+Math.sin(T)*g,a-Math.cos(T)*b),T+=ey,e.lineTo(n+Math.sin(T)*g,a-Math.cos(T)*b),T+=ey,e.lineTo(n+Math.sin(T)*g,a-Math.cos(T)*b),e.closePath();break;case"rectRounded":x=b*.516,f=b-x,o=Math.cos(T+zs)*f,p=Math.cos(T+zs)*(r?r/2-x:f),h=Math.sin(T+zs)*f,y=Math.sin(T+zs)*(r?r/2-x:f),e.arc(n-p,a-h,x,T-Ut,T-tn),e.arc(n+y,a-o,x,T-tn,T),e.arc(n+p,a+h,x,T,T+tn),e.arc(n-y,a+o,x,T+tn,T+Ut),e.closePath();break;case"rect":if(!w){f=Math.SQRT1_2*b,g=r?r/2:f,e.rect(n-g,a-f,2*g,2*f);break}T+=zs;case"rectRot":p=Math.cos(T)*(r?r/2:b),o=Math.cos(T)*b,h=Math.sin(T)*b,y=Math.sin(T)*(r?r/2:b),e.moveTo(n-p,a-h),e.lineTo(n+y,a-o),e.lineTo(n+p,a+h),e.lineTo(n-y,a+o),e.closePath();break;case"crossRot":T+=zs;case"cross":p=Math.cos(T)*(r?r/2:b),o=Math.cos(T)*b,h=Math.sin(T)*b,y=Math.sin(T)*(r?r/2:b),e.moveTo(n-p,a-h),e.lineTo(n+p,a+h),e.moveTo(n+y,a-o),e.lineTo(n-y,a+o);break;case"star":p=Math.cos(T)*(r?r/2:b),o=Math.cos(T)*b,h=Math.sin(T)*b,y=Math.sin(T)*(r?r/2:b),e.moveTo(n-p,a-h),e.lineTo(n+p,a+h),e.moveTo(n+y,a-o),e.lineTo(n-y,a+o),T+=zs,p=Math.cos(T)*(r?r/2:b),o=Math.cos(T)*b,h=Math.sin(T)*b,y=Math.sin(T)*(r?r/2:b),e.moveTo(n-p,a-h),e.lineTo(n+p,a+h),e.moveTo(n+y,a-o),e.lineTo(n-y,a+o);break;case"line":o=r?r/2:Math.cos(T)*b,h=Math.sin(T)*b,e.moveTo(n-o,a-h),e.lineTo(n+o,a+h);break;case"dash":e.moveTo(n,a),e.lineTo(n+Math.cos(T)*(r?r/2:b),a+Math.sin(T)*b);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function tc(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function _x(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function wx(e){e.restore()}function ZN(e,t,n,a,r){if(!t)return e.lineTo(n.x,n.y);if(r==="middle"){const l=(t.x+n.x)/2;e.lineTo(l,t.y),e.lineTo(l,n.y)}else r==="after"!=!!a?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function JN(e,t,n,a){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(a?t.cp1x:t.cp2x,a?t.cp1y:t.cp2y,a?n.cp2x:n.cp1x,a?n.cp2y:n.cp1y,n.x,n.y)}function eE(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),rt(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function tE(e,t,n,a,r){if(r.strikethrough||r.underline){const l=e.measureText(a),o=t-l.actualBoundingBoxLeft,h=t+l.actualBoundingBoxRight,f=n-l.actualBoundingBoxAscent,x=n+l.actualBoundingBoxDescent,g=r.strikethrough?(f+x)/2:x;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=r.decorationWidth||2,e.moveTo(o,g),e.lineTo(h,g),e.stroke()}}function nE(e,t){const n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function nc(e,t,n,a,r,l={}){const o=qt(t)?t:[t],h=l.strokeWidth>0&&l.strokeColor!=="";let f,x;for(e.save(),e.font=r.string,eE(e,l),f=0;f<o.length;++f)x=o[f],l.backdrop&&nE(e,l.backdrop),h&&(l.strokeColor&&(e.strokeStyle=l.strokeColor),rt(l.strokeWidth)||(e.lineWidth=l.strokeWidth),e.strokeText(x,n,a,l.maxWidth)),e.fillText(x,n,a,l.maxWidth),tE(e,n,a,x,l),a+=Number(r.lineHeight);e.restore()}function Th(e,t){const{x:n,y:a,w:r,h:l,radius:o}=t;e.arc(n+o.topLeft,a+o.topLeft,o.topLeft,1.5*Ut,Ut,!0),e.lineTo(n,a+l-o.bottomLeft),e.arc(n+o.bottomLeft,a+l-o.bottomLeft,o.bottomLeft,Ut,tn,!0),e.lineTo(n+r-o.bottomRight,a+l),e.arc(n+r-o.bottomRight,a+l-o.bottomRight,o.bottomRight,tn,0,!0),e.lineTo(n+r,a+o.topRight),e.arc(n+r-o.topRight,a+o.topRight,o.topRight,0,-tn,!0),e.lineTo(n+o.topLeft,a)}const aE=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,rE=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function sE(e,t){const n=(""+e).match(aE);if(!n||n[1]==="normal")return t*1.2;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100;break}return t*e}const iE=e=>+e||0;function Tx(e,t){const n={},a=it(t),r=a?Object.keys(t):t,l=it(e)?a?o=>Je(e[o],e[t[o]]):o=>e[o]:()=>e;for(const o of r)n[o]=iE(l(o));return n}function O2(e){return Tx(e,{top:"y",right:"x",bottom:"y",left:"x"})}function nl(e){return Tx(e,["topLeft","topRight","bottomLeft","bottomRight"])}function la(e){const t=O2(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function _n(e,t){e=e||{},t=t||zt.font;let n=Je(e.size,t.size);typeof n=="string"&&(n=parseInt(n,10));let a=Je(e.style,t.style);a&&!(""+a).match(rE)&&(console.warn('Invalid font style specified: "'+a+'"'),a=void 0);const r={family:Je(e.family,t.family),lineHeight:sE(Je(e.lineHeight,t.lineHeight),n),size:n,style:a,weight:Je(e.weight,t.weight),string:""};return r.string=QN(r),r}function Rt(e,t,n,a){let r,l,o;for(r=0,l=e.length;r<l;++r)if(o=e[r],o!==void 0&&(t!==void 0&&typeof o=="function"&&(o=o(t)),n!==void 0&&qt(o)&&(o=o[n%o.length]),o!==void 0))return o}function lE(e,t,n){const{min:a,max:r}=e,l=w2(t,(r-a)/2),o=(h,f)=>n&&h===0?0:h+f;return{min:o(a,-Math.abs(l)),max:o(r,l)}}function si(e,t){return Object.assign(Object.create(e),t)}function Sx(e,t=[""],n,a,r=()=>e[0]){const l=n||e;typeof a>"u"&&(a=L2("_fallback",e));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:l,_fallback:a,_getTarget:r,override:h=>Sx([h,...e],t,l,a)};return new Proxy(o,{deleteProperty(h,f){return delete h[f],delete h._keys,delete e[0][f],!0},get(h,f){return R2(h,f,()=>gE(f,t,e,h))},getOwnPropertyDescriptor(h,f){return Reflect.getOwnPropertyDescriptor(h._scopes[0],f)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(h,f){return hy(h).includes(f)},ownKeys(h){return hy(h)},set(h,f,x){const g=h._storage||(h._storage=r());return h[f]=g[f]=x,delete h._keys,!0}})}function cl(e,t,n,a){const r={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:M2(e,a),setContext:l=>cl(e,l,n,a),override:l=>cl(e.override(l),t,n,a)};return new Proxy(r,{deleteProperty(l,o){return delete l[o],delete e[o],!0},get(l,o,h){return R2(l,o,()=>cE(l,o,h))},getOwnPropertyDescriptor(l,o){return l._descriptors.allKeys?Reflect.has(e,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,o)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(l,o){return Reflect.has(e,o)},ownKeys(){return Reflect.ownKeys(e)},set(l,o,h){return e[o]=h,delete l[o],!0}})}function M2(e,t={scriptable:!0,indexable:!0}){const{_scriptable:n=t.scriptable,_indexable:a=t.indexable,_allKeys:r=t.allKeys}=e;return{allKeys:r,scriptable:n,indexable:a,isScriptable:gs(n)?n:()=>n,isIndexable:gs(a)?a:()=>a}}const oE=(e,t)=>e?e+mx(t):t,Nx=(e,t)=>it(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function R2(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||t==="constructor")return e[t];const a=n();return e[t]=a,a}function cE(e,t,n){const{_proxy:a,_context:r,_subProxy:l,_descriptors:o}=e;let h=a[t];return gs(h)&&o.isScriptable(t)&&(h=uE(t,h,e,n)),qt(h)&&h.length&&(h=hE(t,h,e,o.isIndexable)),Nx(t,h)&&(h=cl(h,r,l&&l[t],o)),h}function uE(e,t,n,a){const{_proxy:r,_context:l,_subProxy:o,_stack:h}=n;if(h.has(e))throw new Error("Recursion detected: "+Array.from(h).join("->")+"->"+e);h.add(e);let f=t(l,o||a);return h.delete(e),Nx(e,f)&&(f=Ex(r._scopes,r,e,f)),f}function hE(e,t,n,a){const{_proxy:r,_context:l,_subProxy:o,_descriptors:h}=n;if(typeof l.index<"u"&&a(e))return t[l.index%t.length];if(it(t[0])){const f=t,x=r._scopes.filter(g=>g!==f);t=[];for(const g of f){const p=Ex(x,r,e,g);t.push(cl(p,l,o&&o[e],h))}}return t}function F2(e,t,n){return gs(e)?e(t,n):e}const fE=(e,t)=>e===!0?t:typeof e=="string"?ei(t,e):void 0;function dE(e,t,n,a,r){for(const l of t){const o=fE(n,l);if(o){e.add(o);const h=F2(o._fallback,n,r);if(typeof h<"u"&&h!==n&&h!==a)return h}else if(o===!1&&typeof a<"u"&&n!==a)return null}return!1}function Ex(e,t,n,a){const r=t._rootScopes,l=F2(t._fallback,n,a),o=[...e,...r],h=new Set;h.add(a);let f=uy(h,o,n,l||n,a);return f===null||typeof l<"u"&&l!==n&&(f=uy(h,o,l,f,a),f===null)?!1:Sx(Array.from(h),[""],r,l,()=>xE(t,n,a))}function uy(e,t,n,a,r){for(;n;)n=dE(e,t,n,a,r);return n}function xE(e,t,n){const a=e._getTarget();t in a||(a[t]={});const r=a[t];return qt(r)&&it(n)?n:r||{}}function gE(e,t,n,a){let r;for(const l of t)if(r=L2(oE(l,e),n),typeof r<"u")return Nx(e,r)?Ex(n,a,e,r):r}function L2(e,t){for(const n of t){if(!n)continue;const a=n[e];if(typeof a<"u")return a}}function hy(e){let t=e._keys;return t||(t=e._keys=mE(e._scopes)),t}function mE(e){const t=new Set;for(const n of e)for(const a of Object.keys(n).filter(r=>!r.startsWith("_")))t.add(a);return Array.from(t)}const pE=Number.EPSILON||1e-14,ul=(e,t)=>t<e.length&&!e[t].skip&&e[t],B2=e=>e==="x"?"y":"x";function yE(e,t,n,a){const r=e.skip?t:e,l=t,o=n.skip?t:n,h=Gd(l,r),f=Gd(o,l);let x=h/(h+f),g=f/(h+f);x=isNaN(x)?0:x,g=isNaN(g)?0:g;const p=a*x,y=a*g;return{previous:{x:l.x-p*(o.x-r.x),y:l.y-p*(o.y-r.y)},next:{x:l.x+y*(o.x-r.x),y:l.y+y*(o.y-r.y)}}}function vE(e,t,n){const a=e.length;let r,l,o,h,f,x=ul(e,0);for(let g=0;g<a-1;++g)if(f=x,x=ul(e,g+1),!(!f||!x)){if(Po(t[g],0,pE)){n[g]=n[g+1]=0;continue}r=n[g]/t[g],l=n[g+1]/t[g],h=Math.pow(r,2)+Math.pow(l,2),!(h<=9)&&(o=3/Math.sqrt(h),n[g]=r*o*t[g],n[g+1]=l*o*t[g])}}function bE(e,t,n="x"){const a=B2(n),r=e.length;let l,o,h,f=ul(e,0);for(let x=0;x<r;++x){if(o=h,h=f,f=ul(e,x+1),!h)continue;const g=h[n],p=h[a];o&&(l=(g-o[n])/3,h[`cp1${n}`]=g-l,h[`cp1${a}`]=p-l*t[x]),f&&(l=(f[n]-g)/3,h[`cp2${n}`]=g+l,h[`cp2${a}`]=p+l*t[x])}}function _E(e,t="x"){const n=B2(t),a=e.length,r=Array(a).fill(0),l=Array(a);let o,h,f,x=ul(e,0);for(o=0;o<a;++o)if(h=f,f=x,x=ul(e,o+1),!!f){if(x){const g=x[t]-f[t];r[o]=g!==0?(x[n]-f[n])/g:0}l[o]=h?x?Ja(r[o-1])!==Ja(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}vE(e,r,l),bE(e,l,t)}function Ku(e,t,n){return Math.max(Math.min(e,n),t)}function wE(e,t){let n,a,r,l,o,h=tc(e[0],t);for(n=0,a=e.length;n<a;++n)o=l,l=h,h=n<a-1&&tc(e[n+1],t),l&&(r=e[n],o&&(r.cp1x=Ku(r.cp1x,t.left,t.right),r.cp1y=Ku(r.cp1y,t.top,t.bottom)),h&&(r.cp2x=Ku(r.cp2x,t.left,t.right),r.cp2y=Ku(r.cp2y,t.top,t.bottom)))}function TE(e,t,n,a,r){let l,o,h,f;if(t.spanGaps&&(e=e.filter(x=>!x.skip)),t.cubicInterpolationMode==="monotone")_E(e,r);else{let x=a?e[e.length-1]:e[0];for(l=0,o=e.length;l<o;++l)h=e[l],f=yE(x,h,e[Math.min(l+1,o-(a?0:1))%o],t.tension),h.cp1x=f.previous.x,h.cp1y=f.previous.y,h.cp2x=f.next.x,h.cp2y=f.next.y,x=h}t.capBezierPoints&&wE(e,n)}function Cx(){return typeof window<"u"&&typeof document<"u"}function jx(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function Sh(e,t,n){let a;return typeof e=="string"?(a=parseInt(e,10),e.indexOf("%")!==-1&&(a=a/100*t.parentNode[n])):a=e,a}const Xh=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function SE(e,t){return Xh(e).getPropertyValue(t)}const NE=["top","right","bottom","left"];function $s(e,t,n){const a={};n=n?"-"+n:"";for(let r=0;r<4;r++){const l=NE[r];a[l]=parseFloat(e[t+"-"+l+n])||0}return a.width=a.left+a.right,a.height=a.top+a.bottom,a}const EE=(e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot);function CE(e,t){const n=e.touches,a=n&&n.length?n[0]:e,{offsetX:r,offsetY:l}=a;let o=!1,h,f;if(EE(r,l,e.target))h=r,f=l;else{const x=t.getBoundingClientRect();h=a.clientX-x.left,f=a.clientY-x.top,o=!0}return{x:h,y:f,box:o}}function Ws(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:a}=t,r=Xh(n),l=r.boxSizing==="border-box",o=$s(r,"padding"),h=$s(r,"border","width"),{x:f,y:x,box:g}=CE(e,n),p=o.left+(g&&h.left),y=o.top+(g&&h.top);let{width:_,height:w}=t;return l&&(_-=o.width+h.width,w-=o.height+h.height),{x:Math.round((f-p)/_*n.width/a),y:Math.round((x-y)/w*n.height/a)}}function jE(e,t,n){let a,r;if(t===void 0||n===void 0){const l=e&&jx(e);if(!l)t=e.clientWidth,n=e.clientHeight;else{const o=l.getBoundingClientRect(),h=Xh(l),f=$s(h,"border","width"),x=$s(h,"padding");t=o.width-x.width-f.width,n=o.height-x.height-f.height,a=Sh(h.maxWidth,l,"clientWidth"),r=Sh(h.maxHeight,l,"clientHeight")}}return{width:t,height:n,maxWidth:a||wh,maxHeight:r||wh}}const Wu=e=>Math.round(e*10)/10;function kE(e,t,n,a){const r=Xh(e),l=$s(r,"margin"),o=Sh(r.maxWidth,e,"clientWidth")||wh,h=Sh(r.maxHeight,e,"clientHeight")||wh,f=jE(e,t,n);let{width:x,height:g}=f;if(r.boxSizing==="content-box"){const y=$s(r,"border","width"),_=$s(r,"padding");x-=_.width+y.width,g-=_.height+y.height}return x=Math.max(0,x-l.width),g=Math.max(0,a?x/a:g-l.height),x=Wu(Math.min(x,o,f.maxWidth)),g=Wu(Math.min(g,h,f.maxHeight)),x&&!g&&(g=Wu(x/2)),(t!==void 0||n!==void 0)&&a&&f.height&&g>f.height&&(g=f.height,x=Wu(Math.floor(g*a))),{width:x,height:g}}function fy(e,t,n){const a=t||1,r=Math.floor(e.height*a),l=Math.floor(e.width*a);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const o=e.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${e.height}px`,o.style.width=`${e.width}px`),e.currentDevicePixelRatio!==a||o.height!==r||o.width!==l?(e.currentDevicePixelRatio=a,o.height=r,o.width=l,e.ctx.setTransform(a,0,0,a,0,0),!0):!1}const AE=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};Cx()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e}();function dy(e,t){const n=SE(e,t),a=n&&n.match(/^(\d+)(\.\d+)?px$/);return a?+a[1]:void 0}function Gs(e,t,n,a){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function DE(e,t,n,a){return{x:e.x+n*(t.x-e.x),y:a==="middle"?n<.5?e.y:t.y:a==="after"?n<1?e.y:t.y:n>0?t.y:e.y}}function OE(e,t,n,a){const r={x:e.cp2x,y:e.cp2y},l={x:t.cp1x,y:t.cp1y},o=Gs(e,r,n),h=Gs(r,l,n),f=Gs(l,t,n),x=Gs(o,h,n),g=Gs(h,f,n);return Gs(x,g,n)}const ME=function(e,t){return{x(n){return e+e+t-n},setWidth(n){t=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,a){return n-a},leftForLtr(n,a){return n-a}}},RE=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function al(e,t,n){return e?ME(t,n):RE()}function H2(e,t){let n,a;(t==="ltr"||t==="rtl")&&(n=e.canvas.style,a=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=a)}function P2(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function I2(e){return e==="angle"?{between:ec,compare:MN,normalize:os}:{between:us,compare:(t,n)=>t-n,normalize:t=>t}}function xy({start:e,end:t,count:n,loop:a,style:r}){return{start:e%n,end:t%n,loop:a&&(t-e+1)%n===0,style:r}}function FE(e,t,n){const{property:a,start:r,end:l}=n,{between:o,normalize:h}=I2(a),f=t.length;let{start:x,end:g,loop:p}=e,y,_;if(p){for(x+=f,g+=f,y=0,_=f;y<_&&o(h(t[x%f][a]),r,l);++y)x--,g--;x%=f,g%=f}return g<x&&(g+=f),{start:x,end:g,loop:p,style:e.style}}function LE(e,t,n){if(!n)return[e];const{property:a,start:r,end:l}=n,o=t.length,{compare:h,between:f,normalize:x}=I2(a),{start:g,end:p,loop:y,style:_}=FE(e,t,n),w=[];let b=!1,T=null,S,E,C;const A=()=>f(r,C,S)&&h(r,C)!==0,F=()=>h(l,S)===0||f(l,C,S),K=()=>b||A(),O=()=>!b||F();for(let P=g,M=g;P<=p;++P)E=t[P%o],!E.skip&&(S=x(E[a]),S!==C&&(b=f(S,r,l),T===null&&K()&&(T=h(S,r)===0?P:M),T!==null&&O()&&(w.push(xy({start:T,end:P,loop:y,count:o,style:_})),T=null),M=P,C=S));return T!==null&&w.push(xy({start:T,end:p,loop:y,count:o,style:_})),w}function BE(e,t){const n=[],a=e.segments;for(let r=0;r<a.length;r++){const l=LE(a[r],e.points,t);l.length&&n.push(...l)}return n}function HE(e,t,n,a){let r=0,l=t-1;if(n&&!a)for(;r<t&&!e[r].skip;)r++;for(;r<t&&e[r].skip;)r++;for(r%=t,n&&(l+=r);l>r&&e[l%t].skip;)l--;return l%=t,{start:r,end:l}}function PE(e,t,n,a){const r=e.length,l=[];let o=t,h=e[t],f;for(f=t+1;f<=n;++f){const x=e[f%r];x.skip||x.stop?h.skip||(a=!1,l.push({start:t%r,end:(f-1)%r,loop:a}),t=o=x.stop?f:null):(o=f,h.skip&&(t=f)),h=x}return o!==null&&l.push({start:t%r,end:o%r,loop:a}),l}function IE(e,t){const n=e.points,a=e.options.spanGaps,r=n.length;if(!r)return[];const l=!!e._loop,{start:o,end:h}=HE(n,r,l,a);if(a===!0)return gy(e,[{start:o,end:h,loop:l}],n,t);const f=h<o?h+r:h,x=!!e._fullLoop&&o===0&&h===r-1;return gy(e,PE(n,o,f,x),n,t)}function gy(e,t,n,a){return!a||!a.setContext||!n?t:zE(e,t,n,a)}function zE(e,t,n,a){const r=e._chart.getContext(),l=my(e.options),{_datasetIndex:o,options:{spanGaps:h}}=e,f=n.length,x=[];let g=l,p=t[0].start,y=p;function _(w,b,T,S){const E=h?-1:1;if(w!==b){for(w+=f;n[w%f].skip;)w-=E;for(;n[b%f].skip;)b+=E;w%f!==b%f&&(x.push({start:w%f,end:b%f,loop:T,style:S}),g=S,p=b%f)}}for(const w of t){p=h?p:w.start;let b=n[p%f],T;for(y=p+1;y<=w.end;y++){const S=n[y%f];T=my(a.setContext(si(r,{type:"segment",p0:b,p1:S,p0DataIndex:(y-1)%f,p1DataIndex:y%f,datasetIndex:o}))),UE(T,g)&&_(p,y-1,w.loop,g),b=S,g=T}p<y-1&&_(p,y-1,w.loop,g)}return x}function my(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function UE(e,t){if(!t)return!1;const n=[],a=function(r,l){return vx(l)?(n.includes(l)||n.push(l),n.indexOf(l)):l};return JSON.stringify(e,a)!==JSON.stringify(t,a)}function Gu(e,t,n){return e.options.clip?e[n]:t[n]}function VE(e,t){const{xScale:n,yScale:a}=e;return n&&a?{left:Gu(n,t,"left"),right:Gu(n,t,"right"),top:Gu(a,t,"top"),bottom:Gu(a,t,"bottom")}:t}function KE(e,t){const n=t._clip;if(n.disabled)return!1;const a=VE(t,e.chartArea);return{left:n.left===!1?0:a.left-(n.left===!0?0:n.left),right:n.right===!1?e.width:a.right+(n.right===!0?0:n.right),top:n.top===!1?0:a.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?e.height:a.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class WE{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,n,a,r){const l=n.listeners[r],o=n.duration;l.forEach(h=>h({chart:t,initial:n.initial,numSteps:o,currentStep:Math.min(a-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=j2.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let n=0;this._charts.forEach((a,r)=>{if(!a.running||!a.items.length)return;const l=a.items;let o=l.length-1,h=!1,f;for(;o>=0;--o)f=l[o],f._active?(f._total>a.duration&&(a.duration=f._total),f.tick(t),h=!0):(l[o]=l[l.length-1],l.pop());h&&(r.draw(),this._notify(r,a,t,"progress")),l.length||(a.running=!1,this._notify(r,a,t,"complete"),a.initial=!1),n+=l.length}),this._lastDate=t,n===0&&(this._running=!1)}_getAnims(t){const n=this._charts;let a=n.get(t);return a||(a={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(t,a)),a}listen(t,n,a){this._getAnims(t).listeners[n].push(a)}add(t,n){!n||!n.length||this._getAnims(t).items.push(...n)}has(t){return this._getAnims(t).items.length>0}start(t){const n=this._charts.get(t);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((a,r)=>Math.max(a,r._duration),0),this._refresh())}running(t){if(!this._running)return!1;const n=this._charts.get(t);return!(!n||!n.running||!n.items.length)}stop(t){const n=this._charts.get(t);if(!n||!n.items.length)return;const a=n.items;let r=a.length-1;for(;r>=0;--r)a[r].cancel();n.items=[],this._notify(t,n,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var br=new WE;const py="transparent",GE={boolean(e,t,n){return n>.5?t:e},color(e,t,n){const a=iy(e||py),r=a.valid&&iy(t||py);return r&&r.valid?r.mix(a,n).hexString():t},number(e,t,n){return e+(t-e)*n}};class XE{constructor(t,n,a,r){const l=n[a];r=Rt([t.to,r,l,t.from]);const o=Rt([t.from,l,r]);this._active=!0,this._fn=t.fn||GE[t.type||typeof o],this._easing=Io[t.easing]||Io.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=a,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(t,n,a){if(this._active){this._notify(!1);const r=this._target[this._prop],l=a-this._start,o=this._duration-l;this._start=a,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=l,this._loop=!!t.loop,this._to=Rt([t.to,n,r,t.from]),this._from=Rt([t.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const n=t-this._start,a=this._duration,r=this._prop,l=this._from,o=this._loop,h=this._to;let f;if(this._active=l!==h&&(o||n<a),!this._active){this._target[r]=h,this._notify(!0);return}if(n<0){this._target[r]=l;return}f=n/a%2,f=o&&f>1?2-f:f,f=this._easing(Math.min(1,Math.max(0,f))),this._target[r]=this._fn(l,h,f)}wait(){const t=this._promises||(this._promises=[]);return new Promise((n,a)=>{t.push({res:n,rej:a})})}_notify(t){const n=t?"res":"rej",a=this._promises||[];for(let r=0;r<a.length;r++)a[r][n]()}}class z2{constructor(t,n){this._chart=t,this._properties=new Map,this.configure(n)}configure(t){if(!it(t))return;const n=Object.keys(zt.animation),a=this._properties;Object.getOwnPropertyNames(t).forEach(r=>{const l=t[r];if(!it(l))return;const o={};for(const h of n)o[h]=l[h];(qt(l.properties)&&l.properties||[r]).forEach(h=>{(h===r||!a.has(h))&&a.set(h,o)})})}_animateOptions(t,n){const a=n.options,r=qE(t,a);if(!r)return[];const l=this._createAnimations(r,a);return a.$shared&&YE(t.options.$animations,a).then(()=>{t.options=a},()=>{}),l}_createAnimations(t,n){const a=this._properties,r=[],l=t.$animations||(t.$animations={}),o=Object.keys(n),h=Date.now();let f;for(f=o.length-1;f>=0;--f){const x=o[f];if(x.charAt(0)==="$")continue;if(x==="options"){r.push(...this._animateOptions(t,n));continue}const g=n[x];let p=l[x];const y=a.get(x);if(p)if(y&&p.active()){p.update(y,g,h);continue}else p.cancel();if(!y||!y.duration){t[x]=g;continue}l[x]=p=new XE(y,t,x,g),r.push(p)}return r}update(t,n){if(this._properties.size===0){Object.assign(t,n);return}const a=this._createAnimations(t,n);if(a.length)return br.add(this._chart,a),!0}}function YE(e,t){const n=[],a=Object.keys(t);for(let r=0;r<a.length;r++){const l=e[a[r]];l&&l.active()&&n.push(l.wait())}return Promise.all(n)}function qE(e,t){if(!t)return;let n=e.options;if(!n){e.options=t;return}return n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function yy(e,t){const n=e&&e.options||{},a=n.reverse,r=n.min===void 0?t:0,l=n.max===void 0?t:0;return{start:a?l:r,end:a?r:l}}function $E(e,t,n){if(n===!1)return!1;const a=yy(e,n),r=yy(t,n);return{top:r.end,right:a.end,bottom:r.start,left:a.start}}function QE(e){let t,n,a,r;return it(e)?(t=e.top,n=e.right,a=e.bottom,r=e.left):t=n=a=r=e,{top:t,right:n,bottom:a,left:r,disabled:e===!1}}function U2(e,t){const n=[],a=e._getSortedDatasetMetas(t);let r,l;for(r=0,l=a.length;r<l;++r)n.push(a[r].index);return n}function vy(e,t,n,a={}){const r=e.keys,l=a.mode==="single";let o,h,f,x;if(t===null)return;let g=!1;for(o=0,h=r.length;o<h;++o){if(f=+r[o],f===n){if(g=!0,a.all)continue;break}x=e.values[f],Sa(x)&&(l||t===0||Ja(t)===Ja(x))&&(t+=x)}return!g&&!a.all?0:t}function ZE(e,t){const{iScale:n,vScale:a}=t,r=n.axis==="x"?"x":"y",l=a.axis==="x"?"x":"y",o=Object.keys(e),h=new Array(o.length);let f,x,g;for(f=0,x=o.length;f<x;++f)g=o[f],h[f]={[r]:g,[l]:e[g]};return h}function Td(e,t){const n=e&&e.options.stacked;return n||n===void 0&&t.stack!==void 0}function JE(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}function e3(e){const{min:t,max:n,minDefined:a,maxDefined:r}=e.getUserBounds();return{min:a?t:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function t3(e,t,n){const a=e[t]||(e[t]={});return a[n]||(a[n]={})}function by(e,t,n,a){for(const r of t.getMatchingVisibleMetas(a).reverse()){const l=e[r.index];if(n&&l>0||!n&&l<0)return r.index}return null}function _y(e,t){const{chart:n,_cachedMeta:a}=e,r=n._stacks||(n._stacks={}),{iScale:l,vScale:o,index:h}=a,f=l.axis,x=o.axis,g=JE(l,o,a),p=t.length;let y;for(let _=0;_<p;++_){const w=t[_],{[f]:b,[x]:T}=w,S=w._stacks||(w._stacks={});y=S[x]=t3(r,g,b),y[h]=T,y._top=by(y,o,!0,a.type),y._bottom=by(y,o,!1,a.type);const E=y._visualValues||(y._visualValues={});E[h]=T}}function Sd(e,t){const n=e.scales;return Object.keys(n).filter(a=>n[a].axis===t).shift()}function n3(e,t){return si(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function a3(e,t,n){return si(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}function To(e,t){const n=e.controller.index,a=e.vScale&&e.vScale.axis;if(a){t=t||e._parsed;for(const r of t){const l=r._stacks;if(!l||l[a]===void 0||l[a][n]===void 0)return;delete l[a][n],l[a]._visualValues!==void 0&&l[a]._visualValues[n]!==void 0&&delete l[a]._visualValues[n]}}}const Nd=e=>e==="reset"||e==="none",wy=(e,t)=>t?e:Object.assign({},e),r3=(e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:U2(n,!0),values:null};class Qs{constructor(t,n){this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Td(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&To(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,n=this._cachedMeta,a=this.getDataset(),r=(p,y,_,w)=>p==="x"?y:p==="r"?w:_,l=n.xAxisID=Je(a.xAxisID,Sd(t,"x")),o=n.yAxisID=Je(a.yAxisID,Sd(t,"y")),h=n.rAxisID=Je(a.rAxisID,Sd(t,"r")),f=n.indexAxis,x=n.iAxisID=r(f,l,o,h),g=n.vAxisID=r(f,o,l,h);n.xScale=this.getScaleForId(l),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(h),n.iScale=this.getScaleForId(x),n.vScale=this.getScaleForId(g)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const n=this._cachedMeta;return t===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&ay(this._data,this),t._stacked&&To(t)}_dataCheck(){const t=this.getDataset(),n=t.data||(t.data=[]),a=this._data;if(it(n)){const r=this._cachedMeta;this._data=ZE(n,r)}else if(a!==n){if(a){ay(a,this);const r=this._cachedMeta;To(r),r._parsed=[]}n&&Object.isExtensible(n)&&BN(n,this),this._syncList=[],this._data=n}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const n=this._cachedMeta,a=this.getDataset();let r=!1;this._dataCheck();const l=n._stacked;n._stacked=Td(n.vScale,n),n.stack!==a.stack&&(r=!0,To(n),n.stack=a.stack),this._resyncElements(t),(r||l!==n._stacked)&&(_y(this,n._parsed),n._stacked=Td(n.vScale,n))}configure(){const t=this.chart.config,n=t.datasetScopeKeys(this._type),a=t.getOptionScopes(this.getDataset(),n,!0);this.options=t.createResolver(a,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,n){const{_cachedMeta:a,_data:r}=this,{iScale:l,_stacked:o}=a,h=l.axis;let f=t===0&&n===r.length?!0:a._sorted,x=t>0&&a._parsed[t-1],g,p,y;if(this._parsing===!1)a._parsed=r,a._sorted=!0,y=r;else{qt(r[t])?y=this.parseArrayData(a,r,t,n):it(r[t])?y=this.parseObjectData(a,r,t,n):y=this.parsePrimitiveData(a,r,t,n);const _=()=>p[h]===null||x&&p[h]<x[h];for(g=0;g<n;++g)a._parsed[g+t]=p=y[g],f&&(_()&&(f=!1),x=p);a._sorted=f}o&&_y(this,y)}parsePrimitiveData(t,n,a,r){const{iScale:l,vScale:o}=t,h=l.axis,f=o.axis,x=l.getLabels(),g=l===o,p=new Array(r);let y,_,w;for(y=0,_=r;y<_;++y)w=y+a,p[y]={[h]:g||l.parse(x[w],w),[f]:o.parse(n[w],w)};return p}parseArrayData(t,n,a,r){const{xScale:l,yScale:o}=t,h=new Array(r);let f,x,g,p;for(f=0,x=r;f<x;++f)g=f+a,p=n[g],h[f]={x:l.parse(p[0],g),y:o.parse(p[1],g)};return h}parseObjectData(t,n,a,r){const{xScale:l,yScale:o}=t,{xAxisKey:h="x",yAxisKey:f="y"}=this._parsing,x=new Array(r);let g,p,y,_;for(g=0,p=r;g<p;++g)y=g+a,_=n[y],x[g]={x:l.parse(ei(_,h),y),y:o.parse(ei(_,f),y)};return x}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,n,a){const r=this.chart,l=this._cachedMeta,o=n[t.axis],h={keys:U2(r,!0),values:n._stacks[t.axis]._visualValues};return vy(h,o,l.index,{mode:a})}updateRangeFromParsed(t,n,a,r){const l=a[n.axis];let o=l===null?NaN:l;const h=r&&a._stacks[n.axis];r&&h&&(r.values=h,o=vy(r,l,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,n){const a=this._cachedMeta,r=a._parsed,l=a._sorted&&t===a.iScale,o=r.length,h=this._getOtherScale(t),f=r3(n,a,this.chart),x={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:g,max:p}=e3(h);let y,_;function w(){_=r[y];const b=_[h.axis];return!Sa(_[t.axis])||g>b||p<b}for(y=0;y<o&&!(!w()&&(this.updateRangeFromParsed(x,t,_,f),l));++y);if(l){for(y=o-1;y>=0;--y)if(!w()){this.updateRangeFromParsed(x,t,_,f);break}}return x}getAllParsedValues(t){const n=this._cachedMeta._parsed,a=[];let r,l,o;for(r=0,l=n.length;r<l;++r)o=n[r][t.axis],Sa(o)&&a.push(o);return a}getMaxOverflow(){return!1}getLabelAndValue(t){const n=this._cachedMeta,a=n.iScale,r=n.vScale,l=this.getParsed(t);return{label:a?""+a.getLabelForValue(l[a.axis]):"",value:r?""+r.getLabelForValue(l[r.axis]):""}}_update(t){const n=this._cachedMeta;this.update(t||"default"),n._clip=QE(Je(this.options.clip,$E(n.xScale,n.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,n=this.chart,a=this._cachedMeta,r=a.data||[],l=n.chartArea,o=[],h=this._drawStart||0,f=this._drawCount||r.length-h,x=this.options.drawActiveElementsOnTop;let g;for(a.dataset&&a.dataset.draw(t,l,h,f),g=h;g<h+f;++g){const p=r[g];p.hidden||(p.active&&x?o.push(p):p.draw(t,l))}for(g=0;g<o.length;++g)o[g].draw(t,l)}getStyle(t,n){const a=n?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(a):this.resolveDataElementOptions(t||0,a)}getContext(t,n,a){const r=this.getDataset();let l;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];l=o.$context||(o.$context=a3(this.getContext(),t,o)),l.parsed=this.getParsed(t),l.raw=r.data[t],l.index=l.dataIndex=t}else l=this.$context||(this.$context=n3(this.chart.getContext(),this.index)),l.dataset=r,l.index=l.datasetIndex=this.index;return l.active=!!n,l.mode=a,l}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,n){return this._resolveElementOptions(this.dataElementType.id,n,t)}_resolveElementOptions(t,n="default",a){const r=n==="active",l=this._cachedDataOpts,o=t+"-"+n,h=l[o],f=this.enableOptionSharing&&Zo(a);if(h)return wy(h,f);const x=this.chart.config,g=x.datasetElementScopeKeys(this._type,t),p=r?[`${t}Hover`,"hover",t,""]:[t,""],y=x.getOptionScopes(this.getDataset(),g),_=Object.keys(zt.elements[t]),w=()=>this.getContext(a,r,n),b=x.resolveNamedOptions(y,_,w,p);return b.$shared&&(b.$shared=f,l[o]=Object.freeze(wy(b,f))),b}_resolveAnimations(t,n,a){const r=this.chart,l=this._cachedDataOpts,o=`animation-${n}`,h=l[o];if(h)return h;let f;if(r.options.animation!==!1){const g=this.chart.config,p=g.datasetAnimationScopeKeys(this._type,n),y=g.getOptionScopes(this.getDataset(),p);f=g.createResolver(y,this.getContext(t,a,n))}const x=new z2(r,f&&f.animations);return f&&f._cacheable&&(l[o]=Object.freeze(x)),x}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,n){return!n||Nd(t)||this.chart._animationsDisabled}_getSharedOptions(t,n){const a=this.resolveDataElementOptions(t,n),r=this._sharedOptions,l=this.getSharedOptions(a),o=this.includeOptions(n,l)||l!==r;return this.updateSharedOptions(l,n,a),{sharedOptions:l,includeOptions:o}}updateElement(t,n,a,r){Nd(r)?Object.assign(t,a):this._resolveAnimations(n,r).update(t,a)}updateSharedOptions(t,n,a){t&&!Nd(n)&&this._resolveAnimations(void 0,n).update(t,a)}_setStyle(t,n,a,r){t.active=r;const l=this.getStyle(n,r);this._resolveAnimations(n,a,r).update(t,{options:!r&&this.getSharedOptions(l)||l})}removeHoverStyle(t,n,a){this._setStyle(t,a,"active",!1)}setHoverStyle(t,n,a){this._setStyle(t,a,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const n=this._data,a=this._cachedMeta.data;for(const[h,f,x]of this._syncList)this[h](f,x);this._syncList=[];const r=a.length,l=n.length,o=Math.min(l,r);o&&this.parse(0,o),l>r?this._insertElements(r,l-r,t):l<r&&this._removeElements(l,r-l)}_insertElements(t,n,a=!0){const r=this._cachedMeta,l=r.data,o=t+n;let h;const f=x=>{for(x.length+=n,h=x.length-1;h>=o;h--)x[h]=x[h-n]};for(f(l),h=t;h<o;++h)l[h]=new this.dataElementType;this._parsing&&f(r._parsed),this.parse(t,n),a&&this.updateElements(l,t,n,"reset")}updateElements(t,n,a,r){}_removeElements(t,n){const a=this._cachedMeta;if(this._parsing){const r=a._parsed.splice(t,n);a._stacked&&To(a,r)}a.data.splice(t,n)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[n,a,r]=t;this[n](a,r)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,n){n&&this._sync(["_removeElements",t,n]);const a=arguments.length-2;a&&this._sync(["_insertElements",t,a])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Pe(Qs,"defaults",{}),Pe(Qs,"datasetElementType",null),Pe(Qs,"dataElementType",null);function s3(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let a=[];for(let r=0,l=n.length;r<l;r++)a=a.concat(n[r].controller.getAllParsedValues(e));e._cache.$bar=C2(a.sort((r,l)=>r-l))}return e._cache.$bar}function i3(e){const t=e.iScale,n=s3(t,e.type);let a=t._length,r,l,o,h;const f=()=>{o===32767||o===-32768||(Zo(h)&&(a=Math.min(a,Math.abs(o-h)||a)),h=o)};for(r=0,l=n.length;r<l;++r)o=t.getPixelForValue(n[r]),f();for(h=void 0,r=0,l=t.ticks.length;r<l;++r)o=t.getPixelForTick(r),f();return a}function l3(e,t,n,a){const r=n.barThickness;let l,o;return rt(r)?(l=t.min*n.categoryPercentage,o=n.barPercentage):(l=r*a,o=1),{chunk:l/a,ratio:o,start:t.pixels[e]-l/2}}function o3(e,t,n,a){const r=t.pixels,l=r[e];let o=e>0?r[e-1]:null,h=e<r.length-1?r[e+1]:null;const f=n.categoryPercentage;o===null&&(o=l-(h===null?t.end-t.start:h-l)),h===null&&(h=l+l-o);const x=l-(l-Math.min(o,h))/2*f;return{chunk:Math.abs(h-o)/2*f/a,ratio:n.barPercentage,start:x}}function c3(e,t,n,a){const r=n.parse(e[0],a),l=n.parse(e[1],a),o=Math.min(r,l),h=Math.max(r,l);let f=o,x=h;Math.abs(o)>Math.abs(h)&&(f=h,x=o),t[n.axis]=x,t._custom={barStart:f,barEnd:x,start:r,end:l,min:o,max:h}}function V2(e,t,n,a){return qt(e)?c3(e,t,n,a):t[n.axis]=n.parse(e,a),t}function Ty(e,t,n,a){const r=e.iScale,l=e.vScale,o=r.getLabels(),h=r===l,f=[];let x,g,p,y;for(x=n,g=n+a;x<g;++x)y=t[x],p={},p[r.axis]=h||r.parse(o[x],x),f.push(V2(y,p,l,x));return f}function Ed(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function u3(e,t,n){return e!==0?Ja(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}function h3(e){let t,n,a,r,l;return e.horizontal?(t=e.base>e.x,n="left",a="right"):(t=e.base<e.y,n="bottom",a="top"),t?(r="end",l="start"):(r="start",l="end"),{start:n,end:a,reverse:t,top:r,bottom:l}}function f3(e,t,n,a){let r=t.borderSkipped;const l={};if(!r){e.borderSkipped=l;return}if(r===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:h,reverse:f,top:x,bottom:g}=h3(e);r==="middle"&&n&&(e.enableBorderRadius=!0,(n._top||0)===a?r=x:(n._bottom||0)===a?r=g:(l[Sy(g,o,h,f)]=!0,r=x)),l[Sy(r,o,h,f)]=!0,e.borderSkipped=l}function Sy(e,t,n,a){return a?(e=d3(e,t,n),e=Ny(e,n,t)):e=Ny(e,t,n),e}function d3(e,t,n){return e===t?n:e===n?t:e}function Ny(e,t,n){return e==="start"?t:e==="end"?n:e}function x3(e,{inflateAmount:t},n){e.inflateAmount=t==="auto"?n===1?.33:0:t}class gh extends Qs{parsePrimitiveData(t,n,a,r){return Ty(t,n,a,r)}parseArrayData(t,n,a,r){return Ty(t,n,a,r)}parseObjectData(t,n,a,r){const{iScale:l,vScale:o}=t,{xAxisKey:h="x",yAxisKey:f="y"}=this._parsing,x=l.axis==="x"?h:f,g=o.axis==="x"?h:f,p=[];let y,_,w,b;for(y=a,_=a+r;y<_;++y)b=n[y],w={},w[l.axis]=l.parse(ei(b,x),y),p.push(V2(ei(b,g),w,o,y));return p}updateRangeFromParsed(t,n,a,r){super.updateRangeFromParsed(t,n,a,r);const l=a._custom;l&&n===this._cachedMeta.vScale&&(t.min=Math.min(t.min,l.min),t.max=Math.max(t.max,l.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const n=this._cachedMeta,{iScale:a,vScale:r}=n,l=this.getParsed(t),o=l._custom,h=Ed(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(l[r.axis]);return{label:""+a.getLabelForValue(l[a.axis]),value:h}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,t)}updateElements(t,n,a,r){const l=r==="reset",{index:o,_cachedMeta:{vScale:h}}=this,f=h.getBasePixel(),x=h.isHorizontal(),g=this._getRuler(),{sharedOptions:p,includeOptions:y}=this._getSharedOptions(n,r);for(let _=n;_<n+a;_++){const w=this.getParsed(_),b=l||rt(w[h.axis])?{base:f,head:f}:this._calculateBarValuePixels(_),T=this._calculateBarIndexPixels(_,g),S=(w._stacks||{})[h.axis],E={horizontal:x,base:b.base,enableBorderRadius:!S||Ed(w._custom)||o===S._top||o===S._bottom,x:x?b.head:T.center,y:x?T.center:b.head,height:x?T.size:Math.abs(b.size),width:x?Math.abs(b.size):T.size};y&&(E.options=p||this.resolveDataElementOptions(_,t[_].active?"active":r));const C=E.options||t[_].options;f3(E,C,S,o),x3(E,C,g.ratio),this.updateElement(t[_],_,E,r)}}_getStacks(t,n){const{iScale:a}=this._cachedMeta,r=a.getMatchingVisibleMetas(this._type).filter(g=>g.controller.options.grouped),l=a.options.stacked,o=[],h=this._cachedMeta.controller.getParsed(n),f=h&&h[a.axis],x=g=>{const p=g._parsed.find(_=>_[a.axis]===f),y=p&&p[g.vScale.axis];if(rt(y)||isNaN(y))return!0};for(const g of r)if(!(n!==void 0&&x(g))&&((l===!1||o.indexOf(g.stack)===-1||l===void 0&&g.stack===void 0)&&o.push(g.stack),g.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,n,a){const r=this._getStacks(t,a),l=n!==void 0?r.indexOf(n):-1;return l===-1?r.length-1:l}_getRuler(){const t=this.options,n=this._cachedMeta,a=n.iScale,r=[];let l,o;for(l=0,o=n.data.length;l<o;++l)r.push(a.getPixelForValue(this.getParsed(l)[a.axis],l));const h=t.barThickness;return{min:h||i3(n),pixels:r,start:a._startPixel,end:a._endPixel,stackCount:this._getStackCount(),scale:a,grouped:t.grouped,ratio:h?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:n,_stacked:a,index:r},options:{base:l,minBarLength:o}}=this,h=l||0,f=this.getParsed(t),x=f._custom,g=Ed(x);let p=f[n.axis],y=0,_=a?this.applyStack(n,f,a):p,w,b;_!==p&&(y=_-p,_=p),g&&(p=x.barStart,_=x.barEnd-x.barStart,p!==0&&Ja(p)!==Ja(x.barEnd)&&(y=0),y+=p);const T=!rt(l)&&!g?l:y;let S=n.getPixelForValue(T);if(this.chart.getDataVisibility(t)?w=n.getPixelForValue(y+_):w=S,b=w-S,Math.abs(b)<o){b=u3(b,n,h)*o,p===h&&(S-=b/2);const E=n.getPixelForDecimal(0),C=n.getPixelForDecimal(1),A=Math.min(E,C),F=Math.max(E,C);S=Math.max(Math.min(S,F),A),w=S+b,a&&!g&&(f._stacks[n.axis]._visualValues[r]=n.getValueForPixel(w)-n.getValueForPixel(S))}if(S===n.getPixelForValue(h)){const E=Ja(b)*n.getLineWidthForValue(h)/2;S+=E,b-=E}return{size:b,base:S,head:w,center:w+b/2}}_calculateBarIndexPixels(t,n){const a=n.scale,r=this.options,l=r.skipNull,o=Je(r.maxBarThickness,1/0);let h,f;if(n.grouped){const x=l?this._getStackCount(t):n.stackCount,g=r.barThickness==="flex"?o3(t,n,r,x):l3(t,n,r,x),p=this._getStackIndex(this.index,this._cachedMeta.stack,l?t:void 0);h=g.start+g.chunk*p+g.chunk/2,f=Math.min(o,g.chunk*g.ratio)}else h=a.getPixelForValue(this.getParsed(t)[a.axis],t),f=Math.min(o,n.min*n.ratio);return{base:h-f/2,head:h+f/2,center:h,size:f}}draw(){const t=this._cachedMeta,n=t.vScale,a=t.data,r=a.length;let l=0;for(;l<r;++l)this.getParsed(l)[n.axis]!==null&&!a[l].hidden&&a[l].draw(this._ctx)}}Pe(gh,"id","bar"),Pe(gh,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Pe(gh,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function g3(e,t,n){let a=1,r=1,l=0,o=0;if(t<It){const h=e,f=h+t,x=Math.cos(h),g=Math.sin(h),p=Math.cos(f),y=Math.sin(f),_=(C,A,F)=>ec(C,h,f,!0)?1:Math.max(A,A*n,F,F*n),w=(C,A,F)=>ec(C,h,f,!0)?-1:Math.min(A,A*n,F,F*n),b=_(0,x,p),T=_(tn,g,y),S=w(Ut,x,p),E=w(Ut+tn,g,y);a=(b-S)/2,r=(T-E)/2,l=-(b+S)/2,o=-(T+E)/2}return{ratioX:a,ratioY:r,offsetX:l,offsetY:o}}class Mo extends Qs{constructor(t,n){super(t,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,n){const a=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=a;else{let l=f=>+a[f];if(it(a[t])){const{key:f="value"}=this._parsing;l=x=>+ei(a[x],f)}let o,h;for(o=t,h=t+n;o<h;++o)r._parsed[o]=l(o)}}_getRotation(){return Tr(this.options.rotation-90)}_getCircumference(){return Tr(this.options.circumference)}_getRotationExtents(){let t=It,n=-It;for(let a=0;a<this.chart.data.datasets.length;++a)if(this.chart.isDatasetVisible(a)&&this.chart.getDatasetMeta(a).type===this._type){const r=this.chart.getDatasetMeta(a).controller,l=r._getRotation(),o=r._getCircumference();t=Math.min(t,l),n=Math.max(n,l+o)}return{rotation:t,circumference:n-t}}update(t){const n=this.chart,{chartArea:a}=n,r=this._cachedMeta,l=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(l)+this.options.spacing,h=Math.max((Math.min(a.width,a.height)-o)/2,0),f=Math.min(bN(this.options.cutout,h),1),x=this._getRingWeight(this.index),{circumference:g,rotation:p}=this._getRotationExtents(),{ratioX:y,ratioY:_,offsetX:w,offsetY:b}=g3(p,g,f),T=(a.width-o)/y,S=(a.height-o)/_,E=Math.max(Math.min(T,S)/2,0),C=w2(this.options.radius,E),A=Math.max(C*f,0),F=(C-A)/this._getVisibleDatasetWeightTotal();this.offsetX=w*C,this.offsetY=b*C,r.total=this.calculateTotal(),this.outerRadius=C-F*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-F*x,0),this.updateElements(l,0,l.length,t)}_circumference(t,n){const a=this.options,r=this._cachedMeta,l=this._getCircumference();return n&&a.animation.animateRotate||!this.chart.getDataVisibility(t)||r._parsed[t]===null||r.data[t].hidden?0:this.calculateCircumference(r._parsed[t]*l/It)}updateElements(t,n,a,r){const l=r==="reset",o=this.chart,h=o.chartArea,x=o.options.animation,g=(h.left+h.right)/2,p=(h.top+h.bottom)/2,y=l&&x.animateScale,_=y?0:this.innerRadius,w=y?0:this.outerRadius,{sharedOptions:b,includeOptions:T}=this._getSharedOptions(n,r);let S=this._getRotation(),E;for(E=0;E<n;++E)S+=this._circumference(E,l);for(E=n;E<n+a;++E){const C=this._circumference(E,l),A=t[E],F={x:g+this.offsetX,y:p+this.offsetY,startAngle:S,endAngle:S+C,circumference:C,outerRadius:w,innerRadius:_};T&&(F.options=b||this.resolveDataElementOptions(E,A.active?"active":r)),S+=C,this.updateElement(A,E,F,r)}}calculateTotal(){const t=this._cachedMeta,n=t.data;let a=0,r;for(r=0;r<n.length;r++){const l=t._parsed[r];l!==null&&!isNaN(l)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(a+=Math.abs(l))}return a}calculateCircumference(t){const n=this._cachedMeta.total;return n>0&&!isNaN(t)?It*(Math.abs(t)/n):0}getLabelAndValue(t){const n=this._cachedMeta,a=this.chart,r=a.data.labels||[],l=bx(n._parsed[t],a.options.locale);return{label:r[t]||"",value:l}}getMaxBorderWidth(t){let n=0;const a=this.chart;let r,l,o,h,f;if(!t){for(r=0,l=a.data.datasets.length;r<l;++r)if(a.isDatasetVisible(r)){o=a.getDatasetMeta(r),t=o.data,h=o.controller;break}}if(!t)return 0;for(r=0,l=t.length;r<l;++r)f=h.resolveDataElementOptions(r),f.borderAlign!=="inner"&&(n=Math.max(n,f.borderWidth||0,f.hoverBorderWidth||0));return n}getMaxOffset(t){let n=0;for(let a=0,r=t.length;a<r;++a){const l=this.resolveDataElementOptions(a);n=Math.max(n,l.offset||0,l.hoverOffset||0)}return n}_getRingWeightOffset(t){let n=0;for(let a=0;a<t;++a)this.chart.isDatasetVisible(a)&&(n+=this._getRingWeight(a));return n}_getRingWeight(t){return Math.max(Je(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Pe(Mo,"id","doughnut"),Pe(Mo,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Pe(Mo,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),Pe(Mo,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const n=t.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:a,color:r}}=t.legend.options;return n.labels.map((l,o)=>{const f=t.getDatasetMeta(0).controller.getStyle(o);return{text:l,fillStyle:f.backgroundColor,strokeStyle:f.borderColor,fontColor:r,lineWidth:f.borderWidth,pointStyle:a,hidden:!t.getDataVisibility(o),index:o}})}return[]}},onClick(t,n,a){a.chart.toggleDataVisibility(n.index),a.chart.update()}}}});class mh extends Qs{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const n=this._cachedMeta,{dataset:a,data:r=[],_dataset:l}=n,o=this.chart._animationsDisabled;let{start:h,count:f}=IN(n,r,o);this._drawStart=h,this._drawCount=f,zN(n)&&(h=0,f=r.length),a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!l._decimated,a.points=r;const x=this.resolveDatasetElementOptions(t);this.options.showLine||(x.borderWidth=0),x.segment=this.options.segment,this.updateElement(a,void 0,{animated:!o,options:x},t),this.updateElements(r,h,f,t)}updateElements(t,n,a,r){const l=r==="reset",{iScale:o,vScale:h,_stacked:f,_dataset:x}=this._cachedMeta,{sharedOptions:g,includeOptions:p}=this._getSharedOptions(n,r),y=o.axis,_=h.axis,{spanGaps:w,segment:b}=this.options,T=Jo(w)?w:Number.POSITIVE_INFINITY,S=this.chart._animationsDisabled||l||r==="none",E=n+a,C=t.length;let A=n>0&&this.getParsed(n-1);for(let F=0;F<C;++F){const K=t[F],O=S?K:{};if(F<n||F>=E){O.skip=!0;continue}const P=this.getParsed(F),M=rt(P[_]),B=O[y]=o.getPixelForValue(P[y],F),I=O[_]=l||M?h.getBasePixel():h.getPixelForValue(f?this.applyStack(h,P,f):P[_],F);O.skip=isNaN(B)||isNaN(I)||M,O.stop=F>0&&Math.abs(P[y]-A[y])>T,b&&(O.parsed=P,O.raw=x.data[F]),p&&(O.options=g||this.resolveDataElementOptions(F,K.active?"active":r)),S||this.updateElement(K,F,O,r),A=P}}getMaxOverflow(){const t=this._cachedMeta,n=t.dataset,a=n.options&&n.options.borderWidth||0,r=t.data||[];if(!r.length)return a;const l=r[0].size(this.resolveDataElementOptions(0)),o=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(a,l,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}Pe(mh,"id","line"),Pe(mh,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Pe(mh,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class qd extends Mo{}Pe(qd,"id","pie"),Pe(qd,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});function Vs(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class kx{constructor(t){Pe(this,"options");this.options=t||{}}static override(t){Object.assign(kx.prototype,t)}init(){}formats(){return Vs()}parse(){return Vs()}format(){return Vs()}add(){return Vs()}diff(){return Vs()}startOf(){return Vs()}endOf(){return Vs()}}var m3={_date:kx};function p3(e,t,n,a){const{controller:r,data:l,_sorted:o}=e,h=r._cachedMeta.iScale,f=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(h&&t===h.axis&&t!=="r"&&o&&l.length){const x=h._reversePixels?FN:Ys;if(a){if(r._sharedOptions){const g=l[0],p=typeof g.getRange=="function"&&g.getRange(t);if(p){const y=x(l,t,n-p),_=x(l,t,n+p);return{lo:y.lo,hi:_.hi}}}}else{const g=x(l,t,n);if(f){const{vScale:p}=r._cachedMeta,{_parsed:y}=e,_=y.slice(0,g.lo+1).reverse().findIndex(b=>!rt(b[p.axis]));g.lo-=Math.max(0,_);const w=y.slice(g.hi).findIndex(b=>!rt(b[p.axis]));g.hi+=Math.max(0,w)}return g}}return{lo:0,hi:l.length-1}}function Yh(e,t,n,a,r){const l=e.getSortedVisibleDatasetMetas(),o=n[t];for(let h=0,f=l.length;h<f;++h){const{index:x,data:g}=l[h],{lo:p,hi:y}=p3(l[h],t,o,r);for(let _=p;_<=y;++_){const w=g[_];w.skip||a(w,x,_)}}}function y3(e){const t=e.indexOf("x")!==-1,n=e.indexOf("y")!==-1;return function(a,r){const l=t?Math.abs(a.x-r.x):0,o=n?Math.abs(a.y-r.y):0;return Math.sqrt(Math.pow(l,2)+Math.pow(o,2))}}function Cd(e,t,n,a,r){const l=[];return!r&&!e.isPointInArea(t)||Yh(e,n,t,function(h,f,x){!r&&!tc(h,e.chartArea,0)||h.inRange(t.x,t.y,a)&&l.push({element:h,datasetIndex:f,index:x})},!0),l}function v3(e,t,n,a){let r=[];function l(o,h,f){const{startAngle:x,endAngle:g}=o.getProps(["startAngle","endAngle"],a),{angle:p}=N2(o,{x:t.x,y:t.y});ec(p,x,g)&&r.push({element:o,datasetIndex:h,index:f})}return Yh(e,n,t,l),r}function b3(e,t,n,a,r,l){let o=[];const h=y3(n);let f=Number.POSITIVE_INFINITY;function x(g,p,y){const _=g.inRange(t.x,t.y,r);if(a&&!_)return;const w=g.getCenterPoint(r);if(!(!!l||e.isPointInArea(w))&&!_)return;const T=h(t,w);T<f?(o=[{element:g,datasetIndex:p,index:y}],f=T):T===f&&o.push({element:g,datasetIndex:p,index:y})}return Yh(e,n,t,x),o}function jd(e,t,n,a,r,l){return!l&&!e.isPointInArea(t)?[]:n==="r"&&!a?v3(e,t,n,r):b3(e,t,n,a,r,l)}function Ey(e,t,n,a,r){const l=[],o=n==="x"?"inXRange":"inYRange";let h=!1;return Yh(e,n,t,(f,x,g)=>{f[o]&&f[o](t[n],r)&&(l.push({element:f,datasetIndex:x,index:g}),h=h||f.inRange(t.x,t.y,r))}),a&&!h?[]:l}var _3={modes:{index(e,t,n,a){const r=Ws(t,e),l=n.axis||"x",o=n.includeInvisible||!1,h=n.intersect?Cd(e,r,l,a,o):jd(e,r,l,!1,a,o),f=[];return h.length?(e.getSortedVisibleDatasetMetas().forEach(x=>{const g=h[0].index,p=x.data[g];p&&!p.skip&&f.push({element:p,datasetIndex:x.index,index:g})}),f):[]},dataset(e,t,n,a){const r=Ws(t,e),l=n.axis||"xy",o=n.includeInvisible||!1;let h=n.intersect?Cd(e,r,l,a,o):jd(e,r,l,!1,a,o);if(h.length>0){const f=h[0].datasetIndex,x=e.getDatasetMeta(f).data;h=[];for(let g=0;g<x.length;++g)h.push({element:x[g],datasetIndex:f,index:g})}return h},point(e,t,n,a){const r=Ws(t,e),l=n.axis||"xy",o=n.includeInvisible||!1;return Cd(e,r,l,a,o)},nearest(e,t,n,a){const r=Ws(t,e),l=n.axis||"xy",o=n.includeInvisible||!1;return jd(e,r,l,n.intersect,a,o)},x(e,t,n,a){const r=Ws(t,e);return Ey(e,r,"x",n.intersect,a)},y(e,t,n,a){const r=Ws(t,e);return Ey(e,r,"y",n.intersect,a)}}};const K2=["left","top","right","bottom"];function So(e,t){return e.filter(n=>n.pos===t)}function Cy(e,t){return e.filter(n=>K2.indexOf(n.pos)===-1&&n.box.axis===t)}function No(e,t){return e.sort((n,a)=>{const r=t?a:n,l=t?n:a;return r.weight===l.weight?r.index-l.index:r.weight-l.weight})}function w3(e){const t=[];let n,a,r,l,o,h;for(n=0,a=(e||[]).length;n<a;++n)r=e[n],{position:l,options:{stack:o,stackWeight:h=1}}=r,t.push({index:n,box:r,pos:l,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&l+o,stackWeight:h});return t}function T3(e){const t={};for(const n of e){const{stack:a,pos:r,stackWeight:l}=n;if(!a||!K2.includes(r))continue;const o=t[a]||(t[a]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=l}return t}function S3(e,t){const n=T3(e),{vBoxMaxWidth:a,hBoxMaxHeight:r}=t;let l,o,h;for(l=0,o=e.length;l<o;++l){h=e[l];const{fullSize:f}=h.box,x=n[h.stack],g=x&&h.stackWeight/x.weight;h.horizontal?(h.width=g?g*a:f&&t.availableWidth,h.height=r):(h.width=a,h.height=g?g*r:f&&t.availableHeight)}return n}function N3(e){const t=w3(e),n=No(t.filter(x=>x.box.fullSize),!0),a=No(So(t,"left"),!0),r=No(So(t,"right")),l=No(So(t,"top"),!0),o=No(So(t,"bottom")),h=Cy(t,"x"),f=Cy(t,"y");return{fullSize:n,leftAndTop:a.concat(l),rightAndBottom:r.concat(f).concat(o).concat(h),chartArea:So(t,"chartArea"),vertical:a.concat(r).concat(f),horizontal:l.concat(o).concat(h)}}function jy(e,t,n,a){return Math.max(e[n],t[n])+Math.max(e[a],t[a])}function W2(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function E3(e,t,n,a){const{pos:r,box:l}=n,o=e.maxPadding;if(!it(r)){n.size&&(e[r]-=n.size);const p=a[n.stack]||{size:0,count:1};p.size=Math.max(p.size,n.horizontal?l.height:l.width),n.size=p.size/p.count,e[r]+=n.size}l.getPadding&&W2(o,l.getPadding());const h=Math.max(0,t.outerWidth-jy(o,e,"left","right")),f=Math.max(0,t.outerHeight-jy(o,e,"top","bottom")),x=h!==e.w,g=f!==e.h;return e.w=h,e.h=f,n.horizontal?{same:x,other:g}:{same:g,other:x}}function C3(e){const t=e.maxPadding;function n(a){const r=Math.max(t[a]-e[a],0);return e[a]+=r,r}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}function j3(e,t){const n=t.maxPadding;function a(r){const l={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{l[o]=Math.max(t[o],n[o])}),l}return a(e?["left","right"]:["top","bottom"])}function Ro(e,t,n,a){const r=[];let l,o,h,f,x,g;for(l=0,o=e.length,x=0;l<o;++l){h=e[l],f=h.box,f.update(h.width||t.w,h.height||t.h,j3(h.horizontal,t));const{same:p,other:y}=E3(t,n,h,a);x|=p&&r.length,g=g||y,f.fullSize||r.push(h)}return x&&Ro(r,t,n,a)||g}function Xu(e,t,n,a,r){e.top=n,e.left=t,e.right=t+a,e.bottom=n+r,e.width=a,e.height=r}function ky(e,t,n,a){const r=n.padding;let{x:l,y:o}=t;for(const h of e){const f=h.box,x=a[h.stack]||{placed:0,weight:1},g=h.stackWeight/x.weight||1;if(h.horizontal){const p=t.w*g,y=x.size||f.height;Zo(x.start)&&(o=x.start),f.fullSize?Xu(f,r.left,o,n.outerWidth-r.right-r.left,y):Xu(f,t.left+x.placed,o,p,y),x.start=o,x.placed+=p,o=f.bottom}else{const p=t.h*g,y=x.size||f.width;Zo(x.start)&&(l=x.start),f.fullSize?Xu(f,l,r.top,y,n.outerHeight-r.bottom-r.top):Xu(f,l,t.top+x.placed,y,p),x.start=l,x.placed+=p,l=f.right}}t.x=l,t.y=o}var Ta={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(n){t.draw(n)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;n!==-1&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,a){if(!e)return;const r=la(e.options.layout.padding),l=Math.max(t-r.width,0),o=Math.max(n-r.height,0),h=N3(e.boxes),f=h.vertical,x=h.horizontal;dt(e.boxes,b=>{typeof b.beforeLayout=="function"&&b.beforeLayout()});const g=f.reduce((b,T)=>T.box.options&&T.box.options.display===!1?b:b+1,0)||1,p=Object.freeze({outerWidth:t,outerHeight:n,padding:r,availableWidth:l,availableHeight:o,vBoxMaxWidth:l/2/g,hBoxMaxHeight:o/2}),y=Object.assign({},r);W2(y,la(a));const _=Object.assign({maxPadding:y,w:l,h:o,x:r.left,y:r.top},r),w=S3(f.concat(x),p);Ro(h.fullSize,_,p,w),Ro(f,_,p,w),Ro(x,_,p,w)&&Ro(f,_,p,w),C3(_),ky(h.leftAndTop,_,p,w),_.x+=_.w,_.y+=_.h,ky(h.rightAndBottom,_,p,w),e.chartArea={left:_.left,top:_.top,right:_.left+_.w,bottom:_.top+_.h,height:_.h,width:_.w},dt(h.chartArea,b=>{const T=b.box;Object.assign(T,e.chartArea),T.update(_.w,_.h,{left:0,top:0,right:0,bottom:0})})}};class G2{acquireContext(t,n){}releaseContext(t){return!1}addEventListener(t,n,a){}removeEventListener(t,n,a){}getDevicePixelRatio(){return 1}getMaximumSize(t,n,a,r){return n=Math.max(0,n||t.width),a=a||t.height,{width:n,height:Math.max(0,r?Math.floor(n/r):a)}}isAttached(t){return!0}updateConfig(t){}}class k3 extends G2{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const ph="$chartjs",A3={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Ay=e=>e===null||e==="";function D3(e,t){const n=e.style,a=e.getAttribute("height"),r=e.getAttribute("width");if(e[ph]={initial:{height:a,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",Ay(r)){const l=dy(e,"width");l!==void 0&&(e.width=l)}if(Ay(a))if(e.style.height==="")e.height=e.width/(t||2);else{const l=dy(e,"height");l!==void 0&&(e.height=l)}return e}const X2=AE?{passive:!0}:!1;function O3(e,t,n){e&&e.addEventListener(t,n,X2)}function M3(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,X2)}function R3(e,t){const n=A3[e.type]||e.type,{x:a,y:r}=Ws(e,t);return{type:n,chart:t,native:e,x:a!==void 0?a:null,y:r!==void 0?r:null}}function Nh(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function F3(e,t,n){const a=e.canvas,r=new MutationObserver(l=>{let o=!1;for(const h of l)o=o||Nh(h.addedNodes,a),o=o&&!Nh(h.removedNodes,a);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function L3(e,t,n){const a=e.canvas,r=new MutationObserver(l=>{let o=!1;for(const h of l)o=o||Nh(h.removedNodes,a),o=o&&!Nh(h.addedNodes,a);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const ac=new Map;let Dy=0;function Y2(){const e=window.devicePixelRatio;e!==Dy&&(Dy=e,ac.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function B3(e,t){ac.size||window.addEventListener("resize",Y2),ac.set(e,t)}function H3(e){ac.delete(e),ac.size||window.removeEventListener("resize",Y2)}function P3(e,t,n){const a=e.canvas,r=a&&jx(a);if(!r)return;const l=k2((h,f)=>{const x=r.clientWidth;n(h,f),x<r.clientWidth&&n()},window),o=new ResizeObserver(h=>{const f=h[0],x=f.contentRect.width,g=f.contentRect.height;x===0&&g===0||l(x,g)});return o.observe(r),B3(e,l),o}function kd(e,t,n){n&&n.disconnect(),t==="resize"&&H3(e)}function I3(e,t,n){const a=e.canvas,r=k2(l=>{e.ctx!==null&&n(R3(l,e))},e);return O3(a,t,r),r}class z3 extends G2{acquireContext(t,n){const a=t&&t.getContext&&t.getContext("2d");return a&&a.canvas===t?(D3(t,n),a):null}releaseContext(t){const n=t.canvas;if(!n[ph])return!1;const a=n[ph].initial;["height","width"].forEach(l=>{const o=a[l];rt(o)?n.removeAttribute(l):n.setAttribute(l,o)});const r=a.style||{};return Object.keys(r).forEach(l=>{n.style[l]=r[l]}),n.width=n.width,delete n[ph],!0}addEventListener(t,n,a){this.removeEventListener(t,n);const r=t.$proxies||(t.$proxies={}),o={attach:F3,detach:L3,resize:P3}[n]||I3;r[n]=o(t,n,a)}removeEventListener(t,n){const a=t.$proxies||(t.$proxies={}),r=a[n];if(!r)return;({attach:kd,detach:kd,resize:kd}[n]||M3)(t,n,r),a[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,n,a,r){return kE(t,n,a,r)}isAttached(t){const n=t&&jx(t);return!!(n&&n.isConnected)}}function U3(e){return!Cx()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?k3:z3}class Pa{constructor(){Pe(this,"x");Pe(this,"y");Pe(this,"active",!1);Pe(this,"options");Pe(this,"$animations")}tooltipPosition(t){const{x:n,y:a}=this.getProps(["x","y"],t);return{x:n,y:a}}hasValue(){return Jo(this.x)&&Jo(this.y)}getProps(t,n){const a=this.$animations;if(!n||!a)return this;const r={};return t.forEach(l=>{r[l]=a[l]&&a[l].active()?a[l]._to:this[l]}),r}}Pe(Pa,"defaults",{}),Pe(Pa,"defaultRoutes");function V3(e,t){const n=e.options.ticks,a=K3(e),r=Math.min(n.maxTicksLimit||a,a),l=n.major.enabled?G3(t):[],o=l.length,h=l[0],f=l[o-1],x=[];if(o>r)return X3(t,x,l,o/r),x;const g=W3(l,t,r);if(o>0){let p,y;const _=o>1?Math.round((f-h)/(o-1)):null;for(Yu(t,x,g,rt(_)?0:h-_,h),p=0,y=o-1;p<y;p++)Yu(t,x,g,l[p],l[p+1]);return Yu(t,x,g,f,rt(_)?t.length:f+_),x}return Yu(t,x,g),x}function K3(e){const t=e.options.offset,n=e._tickSize(),a=e._length/n+(t?0:1),r=e._maxLength/n;return Math.floor(Math.min(a,r))}function W3(e,t,n){const a=Y3(e),r=t.length/n;if(!a)return Math.max(r,1);const l=jN(a);for(let o=0,h=l.length-1;o<h;o++){const f=l[o];if(f>r)return f}return Math.max(r,1)}function G3(e){const t=[];let n,a;for(n=0,a=e.length;n<a;n++)e[n].major&&t.push(n);return t}function X3(e,t,n,a){let r=0,l=n[0],o;for(a=Math.ceil(a),o=0;o<e.length;o++)o===l&&(t.push(e[o]),r++,l=n[r*a])}function Yu(e,t,n,a,r){const l=Je(a,0),o=Math.min(Je(r,e.length),e.length);let h=0,f,x,g;for(n=Math.ceil(n),r&&(f=r-a,n=f/Math.floor(f/n)),g=l;g<0;)h++,g=Math.round(l+h*n);for(x=Math.max(l,0);x<o;x++)x===g&&(t.push(e[x]),h++,g=Math.round(l+h*n))}function Y3(e){const t=e.length;let n,a;if(t<2)return!1;for(a=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==a)return!1;return a}const q3=e=>e==="left"?"right":e==="right"?"left":e,Oy=(e,t,n)=>t==="top"||t==="left"?e[t]+n:e[t]-n,My=(e,t)=>Math.min(t||e,e);function Ry(e,t){const n=[],a=e.length/t,r=e.length;let l=0;for(;l<r;l+=a)n.push(e[Math.floor(l)]);return n}function $3(e,t,n){const a=e.ticks.length,r=Math.min(t,a-1),l=e._startPixel,o=e._endPixel,h=1e-6;let f=e.getPixelForTick(r),x;if(!(n&&(a===1?x=Math.max(f-l,o-f):t===0?x=(e.getPixelForTick(1)-f)/2:x=(f-e.getPixelForTick(r-1))/2,f+=r<t?x:-x,f<l-h||f>o+h)))return f}function Q3(e,t){dt(e,n=>{const a=n.gc,r=a.length/2;let l;if(r>t){for(l=0;l<r;++l)delete n.data[a[l]];a.splice(0,r)}})}function Eo(e){return e.drawTicks?e.tickLength:0}function Fy(e,t){if(!e.display)return 0;const n=_n(e.font,t),a=la(e.padding);return(qt(e.text)?e.text.length:1)*n.lineHeight+a.height}function Z3(e,t){return si(e,{scale:t,type:"scale"})}function J3(e,t,n){return si(e,{tick:n,index:t,type:"tick"})}function eC(e,t,n){let a=yx(e);return(n&&t!=="right"||!n&&t==="right")&&(a=q3(a)),a}function tC(e,t,n,a){const{top:r,left:l,bottom:o,right:h,chart:f}=e,{chartArea:x,scales:g}=f;let p=0,y,_,w;const b=o-r,T=h-l;if(e.isHorizontal()){if(_=Cn(a,l,h),it(n)){const S=Object.keys(n)[0],E=n[S];w=g[S].getPixelForValue(E)+b-t}else n==="center"?w=(x.bottom+x.top)/2+b-t:w=Oy(e,n,t);y=h-l}else{if(it(n)){const S=Object.keys(n)[0],E=n[S];_=g[S].getPixelForValue(E)-T+t}else n==="center"?_=(x.left+x.right)/2-T+t:_=Oy(e,n,t);w=Cn(a,o,r),p=n==="left"?-tn:tn}return{titleX:_,titleY:w,maxWidth:y,rotation:p}}class gl extends Pa{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,n){return t}getUserBounds(){let{_userMin:t,_userMax:n,_suggestedMin:a,_suggestedMax:r}=this;return t=Ya(t,Number.POSITIVE_INFINITY),n=Ya(n,Number.NEGATIVE_INFINITY),a=Ya(a,Number.POSITIVE_INFINITY),r=Ya(r,Number.NEGATIVE_INFINITY),{min:Ya(t,a),max:Ya(n,r),minDefined:Sa(t),maxDefined:Sa(n)}}getMinMax(t){let{min:n,max:a,minDefined:r,maxDefined:l}=this.getUserBounds(),o;if(r&&l)return{min:n,max:a};const h=this.getMatchingVisibleMetas();for(let f=0,x=h.length;f<x;++f)o=h[f].controller.getMinMax(this,t),r||(n=Math.min(n,o.min)),l||(a=Math.max(a,o.max));return n=l&&n>a?a:n,a=r&&n>a?n:a,{min:Ya(n,Ya(a,n)),max:Ya(a,Ya(n,a))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){jt(this.options.beforeUpdate,[this])}update(t,n,a){const{beginAtZero:r,grace:l,ticks:o}=this.options,h=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=n,this._margins=a=Object.assign({left:0,right:0,top:0,bottom:0},a),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+a.left+a.right:this.height+a.top+a.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=lE(this,l,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const f=h<this.ticks.length;this._convertTicksToLabels(f?Ry(this.ticks,h):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=V3(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),f&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,n,a;this.isHorizontal()?(n=this.left,a=this.right):(n=this.top,a=this.bottom,t=!t),this._startPixel=n,this._endPixel=a,this._reversePixels=t,this._length=a-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){jt(this.options.afterUpdate,[this])}beforeSetDimensions(){jt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){jt(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),jt(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){jt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const n=this.options.ticks;let a,r,l;for(a=0,r=t.length;a<r;a++)l=t[a],l.label=jt(n.callback,[l.value,a,t],this)}afterTickToLabelConversion(){jt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){jt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,n=t.ticks,a=My(this.ticks.length,t.ticks.maxTicksLimit),r=n.minRotation||0,l=n.maxRotation;let o=r,h,f,x;if(!this._isVisible()||!n.display||r>=l||a<=1||!this.isHorizontal()){this.labelRotation=r;return}const g=this._getLabelSizes(),p=g.widest.width,y=g.highest.height,_=jn(this.chart.width-p,0,this.maxWidth);h=t.offset?this.maxWidth/a:_/(a-1),p+6>h&&(h=_/(a-(t.offset?.5:1)),f=this.maxHeight-Eo(t.grid)-n.padding-Fy(t.title,this.chart.options.font),x=Math.sqrt(p*p+y*y),o=ON(Math.min(Math.asin(jn((g.highest.height+6)/h,-1,1)),Math.asin(jn(f/x,-1,1))-Math.asin(jn(y/x,-1,1)))),o=Math.max(r,Math.min(l,o))),this.labelRotation=o}afterCalculateLabelRotation(){jt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){jt(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:n,options:{ticks:a,title:r,grid:l}}=this,o=this._isVisible(),h=this.isHorizontal();if(o){const f=Fy(r,n.options.font);if(h?(t.width=this.maxWidth,t.height=Eo(l)+f):(t.height=this.maxHeight,t.width=Eo(l)+f),a.display&&this.ticks.length){const{first:x,last:g,widest:p,highest:y}=this._getLabelSizes(),_=a.padding*2,w=Tr(this.labelRotation),b=Math.cos(w),T=Math.sin(w);if(h){const S=a.mirror?0:T*p.width+b*y.height;t.height=Math.min(this.maxHeight,t.height+S+_)}else{const S=a.mirror?0:b*p.width+T*y.height;t.width=Math.min(this.maxWidth,t.width+S+_)}this._calculatePadding(x,g,T,b)}}this._handleMargins(),h?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,n,a,r){const{ticks:{align:l,padding:o},position:h}=this.options,f=this.labelRotation!==0,x=h!=="top"&&this.axis==="x";if(this.isHorizontal()){const g=this.getPixelForTick(0)-this.left,p=this.right-this.getPixelForTick(this.ticks.length-1);let y=0,_=0;f?x?(y=r*t.width,_=a*n.height):(y=a*t.height,_=r*n.width):l==="start"?_=n.width:l==="end"?y=t.width:l!=="inner"&&(y=t.width/2,_=n.width/2),this.paddingLeft=Math.max((y-g+o)*this.width/(this.width-g),0),this.paddingRight=Math.max((_-p+o)*this.width/(this.width-p),0)}else{let g=n.height/2,p=t.height/2;l==="start"?(g=0,p=t.height):l==="end"&&(g=n.height,p=0),this.paddingTop=g+o,this.paddingBottom=p+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){jt(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:n}=this.options;return n==="top"||n==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let n,a;for(n=0,a=t.length;n<a;n++)rt(t[n].label)&&(t.splice(n,1),a--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const n=this.options.ticks.sampleSize;let a=this.ticks;n<a.length&&(a=Ry(a,n)),this._labelSizes=t=this._computeLabelSizes(a,a.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,n,a){const{ctx:r,_longestTextCache:l}=this,o=[],h=[],f=Math.floor(n/My(n,a));let x=0,g=0,p,y,_,w,b,T,S,E,C,A,F;for(p=0;p<n;p+=f){if(w=t[p].label,b=this._resolveTickFontOptions(p),r.font=T=b.string,S=l[T]=l[T]||{data:{},gc:[]},E=b.lineHeight,C=A=0,!rt(w)&&!qt(w))C=oy(r,S.data,S.gc,C,w),A=E;else if(qt(w))for(y=0,_=w.length;y<_;++y)F=w[y],!rt(F)&&!qt(F)&&(C=oy(r,S.data,S.gc,C,F),A+=E);o.push(C),h.push(A),x=Math.max(C,x),g=Math.max(A,g)}Q3(l,n);const K=o.indexOf(x),O=h.indexOf(g),P=M=>({width:o[M]||0,height:h[M]||0});return{first:P(0),last:P(n-1),widest:P(K),highest:P(O),widths:o,heights:h}}getLabelForValue(t){return t}getPixelForValue(t,n){return NaN}getValueForPixel(t){}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const n=this._startPixel+t*this._length;return RN(this._alignToPixels?Us(this.chart,n,0):n)}getDecimalForPixel(t){const n=(t-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:n}=this;return t<0&&n<0?n:t>0&&n>0?t:0}getContext(t){const n=this.ticks||[];if(t>=0&&t<n.length){const a=n[t];return a.$context||(a.$context=J3(this.getContext(),t,a))}return this.$context||(this.$context=Z3(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,n=Tr(this.labelRotation),a=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),l=this._getLabelSizes(),o=t.autoSkipPadding||0,h=l?l.widest.width+o:0,f=l?l.highest.height+o:0;return this.isHorizontal()?f*a>h*r?h/a:f/r:f*r<h*a?f/a:h/r}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const n=this.axis,a=this.chart,r=this.options,{grid:l,position:o,border:h}=r,f=l.offset,x=this.isHorizontal(),p=this.ticks.length+(f?1:0),y=Eo(l),_=[],w=h.setContext(this.getContext()),b=w.display?w.width:0,T=b/2,S=function(ee){return Us(a,ee,b)};let E,C,A,F,K,O,P,M,B,I,te,q;if(o==="top")E=S(this.bottom),O=this.bottom-y,M=E-T,I=S(t.top)+T,q=t.bottom;else if(o==="bottom")E=S(this.top),I=t.top,q=S(t.bottom)-T,O=E+T,M=this.top+y;else if(o==="left")E=S(this.right),K=this.right-y,P=E-T,B=S(t.left)+T,te=t.right;else if(o==="right")E=S(this.left),B=t.left,te=S(t.right)-T,K=E+T,P=this.left+y;else if(n==="x"){if(o==="center")E=S((t.top+t.bottom)/2+.5);else if(it(o)){const ee=Object.keys(o)[0],Q=o[ee];E=S(this.chart.scales[ee].getPixelForValue(Q))}I=t.top,q=t.bottom,O=E+T,M=O+y}else if(n==="y"){if(o==="center")E=S((t.left+t.right)/2);else if(it(o)){const ee=Object.keys(o)[0],Q=o[ee];E=S(this.chart.scales[ee].getPixelForValue(Q))}K=E-T,P=K-y,B=t.left,te=t.right}const ae=Je(r.ticks.maxTicksLimit,p),re=Math.max(1,Math.ceil(p/ae));for(C=0;C<p;C+=re){const ee=this.getContext(C),Q=l.setContext(ee),me=h.setContext(ee),ye=Q.lineWidth,Y=Q.color,de=me.dash||[],H=me.dashOffset,Z=Q.tickWidth,j=Q.tickColor,V=Q.tickBorderDash||[],U=Q.tickBorderDashOffset;A=$3(this,C,f),A!==void 0&&(F=Us(a,A,ye),x?K=P=B=te=F:O=M=I=q=F,_.push({tx1:K,ty1:O,tx2:P,ty2:M,x1:B,y1:I,x2:te,y2:q,width:ye,color:Y,borderDash:de,borderDashOffset:H,tickWidth:Z,tickColor:j,tickBorderDash:V,tickBorderDashOffset:U}))}return this._ticksLength=p,this._borderValue=E,_}_computeLabelItems(t){const n=this.axis,a=this.options,{position:r,ticks:l}=a,o=this.isHorizontal(),h=this.ticks,{align:f,crossAlign:x,padding:g,mirror:p}=l,y=Eo(a.grid),_=y+g,w=p?-g:_,b=-Tr(this.labelRotation),T=[];let S,E,C,A,F,K,O,P,M,B,I,te,q="middle";if(r==="top")K=this.bottom-w,O=this._getXAxisLabelAlignment();else if(r==="bottom")K=this.top+w,O=this._getXAxisLabelAlignment();else if(r==="left"){const re=this._getYAxisLabelAlignment(y);O=re.textAlign,F=re.x}else if(r==="right"){const re=this._getYAxisLabelAlignment(y);O=re.textAlign,F=re.x}else if(n==="x"){if(r==="center")K=(t.top+t.bottom)/2+_;else if(it(r)){const re=Object.keys(r)[0],ee=r[re];K=this.chart.scales[re].getPixelForValue(ee)+_}O=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")F=(t.left+t.right)/2-_;else if(it(r)){const re=Object.keys(r)[0],ee=r[re];F=this.chart.scales[re].getPixelForValue(ee)}O=this._getYAxisLabelAlignment(y).textAlign}n==="y"&&(f==="start"?q="top":f==="end"&&(q="bottom"));const ae=this._getLabelSizes();for(S=0,E=h.length;S<E;++S){C=h[S],A=C.label;const re=l.setContext(this.getContext(S));P=this.getPixelForTick(S)+l.labelOffset,M=this._resolveTickFontOptions(S),B=M.lineHeight,I=qt(A)?A.length:1;const ee=I/2,Q=re.color,me=re.textStrokeColor,ye=re.textStrokeWidth;let Y=O;o?(F=P,O==="inner"&&(S===E-1?Y=this.options.reverse?"left":"right":S===0?Y=this.options.reverse?"right":"left":Y="center"),r==="top"?x==="near"||b!==0?te=-I*B+B/2:x==="center"?te=-ae.highest.height/2-ee*B+B:te=-ae.highest.height+B/2:x==="near"||b!==0?te=B/2:x==="center"?te=ae.highest.height/2-ee*B:te=ae.highest.height-I*B,p&&(te*=-1),b!==0&&!re.showLabelBackdrop&&(F+=B/2*Math.sin(b))):(K=P,te=(1-I)*B/2);let de;if(re.showLabelBackdrop){const H=la(re.backdropPadding),Z=ae.heights[S],j=ae.widths[S];let V=te-H.top,U=0-H.left;switch(q){case"middle":V-=Z/2;break;case"bottom":V-=Z;break}switch(O){case"center":U-=j/2;break;case"right":U-=j;break;case"inner":S===E-1?U-=j:S>0&&(U-=j/2);break}de={left:U,top:V,width:j+H.width,height:Z+H.height,color:re.backdropColor}}T.push({label:A,font:M,textOffset:te,options:{rotation:b,color:Q,strokeColor:me,strokeWidth:ye,textAlign:Y,textBaseline:q,translation:[F,K],backdrop:de}})}return T}_getXAxisLabelAlignment(){const{position:t,ticks:n}=this.options;if(-Tr(this.labelRotation))return t==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(t){const{position:n,ticks:{crossAlign:a,mirror:r,padding:l}}=this.options,o=this._getLabelSizes(),h=t+l,f=o.widest.width;let x,g;return n==="left"?r?(g=this.right+l,a==="near"?x="left":a==="center"?(x="center",g+=f/2):(x="right",g+=f)):(g=this.right-h,a==="near"?x="right":a==="center"?(x="center",g-=f/2):(x="left",g=this.left)):n==="right"?r?(g=this.left+l,a==="near"?x="right":a==="center"?(x="center",g-=f/2):(x="left",g-=f)):(g=this.left+h,a==="near"?x="left":a==="center"?(x="center",g+=f/2):(x="right",g=this.right)):x="right",{textAlign:x,x:g}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:n},left:a,top:r,width:l,height:o}=this;n&&(t.save(),t.fillStyle=n,t.fillRect(a,r,l,o),t.restore())}getLineWidthForValue(t){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(l=>l.value===t);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(t){const n=this.options.grid,a=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let l,o;const h=(f,x,g)=>{!g.width||!g.color||(a.save(),a.lineWidth=g.width,a.strokeStyle=g.color,a.setLineDash(g.borderDash||[]),a.lineDashOffset=g.borderDashOffset,a.beginPath(),a.moveTo(f.x,f.y),a.lineTo(x.x,x.y),a.stroke(),a.restore())};if(n.display)for(l=0,o=r.length;l<o;++l){const f=r[l];n.drawOnChartArea&&h({x:f.x1,y:f.y1},{x:f.x2,y:f.y2},f),n.drawTicks&&h({x:f.tx1,y:f.ty1},{x:f.tx2,y:f.ty2},{color:f.tickColor,width:f.tickWidth,borderDash:f.tickBorderDash,borderDashOffset:f.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:n,options:{border:a,grid:r}}=this,l=a.setContext(this.getContext()),o=a.display?l.width:0;if(!o)return;const h=r.setContext(this.getContext(0)).lineWidth,f=this._borderValue;let x,g,p,y;this.isHorizontal()?(x=Us(t,this.left,o)-o/2,g=Us(t,this.right,h)+h/2,p=y=f):(p=Us(t,this.top,o)-o/2,y=Us(t,this.bottom,h)+h/2,x=g=f),n.save(),n.lineWidth=l.width,n.strokeStyle=l.color,n.beginPath(),n.moveTo(x,p),n.lineTo(g,y),n.stroke(),n.restore()}drawLabels(t){if(!this.options.ticks.display)return;const a=this.ctx,r=this._computeLabelArea();r&&_x(a,r);const l=this.getLabelItems(t);for(const o of l){const h=o.options,f=o.font,x=o.label,g=o.textOffset;nc(a,x,0,g,f,h)}r&&wx(a)}drawTitle(){const{ctx:t,options:{position:n,title:a,reverse:r}}=this;if(!a.display)return;const l=_n(a.font),o=la(a.padding),h=a.align;let f=l.lineHeight/2;n==="bottom"||n==="center"||it(n)?(f+=o.bottom,qt(a.text)&&(f+=l.lineHeight*(a.text.length-1))):f+=o.top;const{titleX:x,titleY:g,maxWidth:p,rotation:y}=tC(this,f,n,h);nc(t,a.text,0,0,l,{color:a.color,maxWidth:p,rotation:y,textAlign:eC(h,n,r),textBaseline:"middle",translation:[x,g]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,n=t.ticks&&t.ticks.z||0,a=Je(t.grid&&t.grid.z,-1),r=Je(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==gl.prototype.draw?[{z:n,draw:l=>{this.draw(l)}}]:[{z:a,draw:l=>{this.drawBackground(),this.drawGrid(l),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:l=>{this.drawLabels(l)}}]}getMatchingVisibleMetas(t){const n=this.chart.getSortedVisibleDatasetMetas(),a=this.axis+"AxisID",r=[];let l,o;for(l=0,o=n.length;l<o;++l){const h=n[l];h[a]===this.id&&(!t||h.type===t)&&r.push(h)}return r}_resolveTickFontOptions(t){const n=this.options.ticks.setContext(this.getContext(t));return _n(n.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class qu{constructor(t,n,a){this.type=t,this.scope=n,this.override=a,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const n=Object.getPrototypeOf(t);let a;rC(n)&&(a=this.register(n));const r=this.items,l=t.id,o=this.scope+"."+l;if(!l)throw new Error("class does not have id: "+t);return l in r||(r[l]=t,nC(t,o,a),this.override&&zt.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const n=this.items,a=t.id,r=this.scope;a in n&&delete n[a],r&&a in zt[r]&&(delete zt[r][a],this.override&&delete ti[a])}}function nC(e,t,n){const a=er(Object.create(null),[n?zt.get(n):{},zt.get(t),e.defaults]);zt.set(t,a),e.defaultRoutes&&aC(t,e.defaultRoutes),e.descriptors&&zt.describe(t,e.descriptors)}function aC(e,t){Object.keys(t).forEach(n=>{const a=n.split("."),r=a.pop(),l=[e].concat(a).join("."),o=t[n].split("."),h=o.pop(),f=o.join(".");zt.route(l,r,f,h)})}function rC(e){return"id"in e&&"defaults"in e}class sC{constructor(){this.controllers=new qu(Qs,"datasets",!0),this.elements=new qu(Pa,"elements"),this.plugins=new qu(Object,"plugins"),this.scales=new qu(gl,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,n,a){[...n].forEach(r=>{const l=a||this._getRegistryForType(r);a||l.isForType(r)||l===this.plugins&&r.id?this._exec(t,l,r):dt(r,o=>{const h=a||this._getRegistryForType(o);this._exec(t,h,o)})})}_exec(t,n,a){const r=mx(t);jt(a["before"+r],[],a),n[t](a),jt(a["after"+r],[],a)}_getRegistryForType(t){for(let n=0;n<this._typedRegistries.length;n++){const a=this._typedRegistries[n];if(a.isForType(t))return a}return this.plugins}_get(t,n,a){const r=n.get(t);if(r===void 0)throw new Error('"'+t+'" is not a registered '+a+".");return r}}var Za=new sC;class iC{constructor(){this._init=[]}notify(t,n,a,r){n==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const l=r?this._descriptors(t).filter(r):this._descriptors(t),o=this._notify(l,t,n,a);return n==="afterDestroy"&&(this._notify(l,t,"stop"),this._notify(this._init,t,"uninstall")),o}_notify(t,n,a,r){r=r||{};for(const l of t){const o=l.plugin,h=o[a],f=[n,r,l.options];if(jt(h,f,o)===!1&&r.cancelable)return!1}return!0}invalidate(){rt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),n}_createDescriptors(t,n){const a=t&&t.config,r=Je(a.options&&a.options.plugins,{}),l=lC(a);return r===!1&&!n?[]:cC(t,l,r,n)}_notifyStateChanges(t){const n=this._oldCache||[],a=this._cache,r=(l,o)=>l.filter(h=>!o.some(f=>h.plugin.id===f.plugin.id));this._notify(r(n,a),t,"stop"),this._notify(r(a,n),t,"start")}}function lC(e){const t={},n=[],a=Object.keys(Za.plugins.items);for(let l=0;l<a.length;l++)n.push(Za.getPlugin(a[l]));const r=e.plugins||[];for(let l=0;l<r.length;l++){const o=r[l];n.indexOf(o)===-1&&(n.push(o),t[o.id]=!0)}return{plugins:n,localIds:t}}function oC(e,t){return!t&&e===!1?null:e===!0?{}:e}function cC(e,{plugins:t,localIds:n},a,r){const l=[],o=e.getContext();for(const h of t){const f=h.id,x=oC(a[f],r);x!==null&&l.push({plugin:h,options:uC(e.config,{plugin:h,local:n[f]},x,o)})}return l}function uC(e,{plugin:t,local:n},a,r){const l=e.pluginScopeKeys(t),o=e.getOptionScopes(a,l);return n&&t.defaults&&o.push(t.defaults),e.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function $d(e,t){const n=zt.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function hC(e,t){let n=e;return e==="_index_"?n=t:e==="_value_"&&(n=t==="x"?"y":"x"),n}function fC(e,t){return e===t?"_index_":"_value_"}function Ly(e){if(e==="x"||e==="y"||e==="r")return e}function dC(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function Qd(e,...t){if(Ly(e))return e;for(const n of t){const a=n.axis||dC(n.position)||e.length>1&&Ly(e[0].toLowerCase());if(a)return a}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function By(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function xC(e,t){if(t.data&&t.data.datasets){const n=t.data.datasets.filter(a=>a.xAxisID===e||a.yAxisID===e);if(n.length)return By(e,"x",n[0])||By(e,"y",n[0])}return{}}function gC(e,t){const n=ti[e.type]||{scales:{}},a=t.scales||{},r=$d(e.type,t),l=Object.create(null);return Object.keys(a).forEach(o=>{const h=a[o];if(!it(h))return console.error(`Invalid scale configuration for scale: ${o}`);if(h._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const f=Qd(o,h,xC(o,e),zt.scales[h.type]),x=fC(f,r),g=n.scales||{};l[o]=Ho(Object.create(null),[{axis:f},h,g[f],g[x]])}),e.data.datasets.forEach(o=>{const h=o.type||e.type,f=o.indexAxis||$d(h,t),g=(ti[h]||{}).scales||{};Object.keys(g).forEach(p=>{const y=hC(p,f),_=o[y+"AxisID"]||y;l[_]=l[_]||Object.create(null),Ho(l[_],[{axis:y},a[_],g[p]])})}),Object.keys(l).forEach(o=>{const h=l[o];Ho(h,[zt.scales[h.type],zt.scale])}),l}function q2(e){const t=e.options||(e.options={});t.plugins=Je(t.plugins,{}),t.scales=gC(e,t)}function $2(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function mC(e){return e=e||{},e.data=$2(e.data),q2(e),e}const Hy=new Map,Q2=new Set;function $u(e,t){let n=Hy.get(e);return n||(n=t(),Hy.set(e,n),Q2.add(n)),n}const Co=(e,t,n)=>{const a=ei(t,n);a!==void 0&&e.add(a)};class pC{constructor(t){this._config=mC(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=$2(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),q2(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return $u(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,n){return $u(`${t}.transition.${n}`,()=>[[`datasets.${t}.transitions.${n}`,`transitions.${n}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,n){return $u(`${t}-${n}`,()=>[[`datasets.${t}.elements.${n}`,`datasets.${t}`,`elements.${n}`,""]])}pluginScopeKeys(t){const n=t.id,a=this.type;return $u(`${a}-plugin-${n}`,()=>[[`plugins.${n}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,n){const a=this._scopeCache;let r=a.get(t);return(!r||n)&&(r=new Map,a.set(t,r)),r}getOptionScopes(t,n,a){const{options:r,type:l}=this,o=this._cachedScopes(t,a),h=o.get(n);if(h)return h;const f=new Set;n.forEach(g=>{t&&(f.add(t),g.forEach(p=>Co(f,t,p))),g.forEach(p=>Co(f,r,p)),g.forEach(p=>Co(f,ti[l]||{},p)),g.forEach(p=>Co(f,zt,p)),g.forEach(p=>Co(f,Xd,p))});const x=Array.from(f);return x.length===0&&x.push(Object.create(null)),Q2.has(n)&&o.set(n,x),x}chartOptionScopes(){const{options:t,type:n}=this;return[t,ti[n]||{},zt.datasets[n]||{},{type:n},zt,Xd]}resolveNamedOptions(t,n,a,r=[""]){const l={$shared:!0},{resolver:o,subPrefixes:h}=Py(this._resolverCache,t,r);let f=o;if(vC(o,n)){l.$shared=!1,a=gs(a)?a():a;const x=this.createResolver(t,a,h);f=cl(o,a,x)}for(const x of n)l[x]=f[x];return l}createResolver(t,n,a=[""],r){const{resolver:l}=Py(this._resolverCache,t,a);return it(n)?cl(l,n,void 0,r):l}}function Py(e,t,n){let a=e.get(t);a||(a=new Map,e.set(t,a));const r=n.join();let l=a.get(r);return l||(l={resolver:Sx(t,n),subPrefixes:n.filter(h=>!h.toLowerCase().includes("hover"))},a.set(r,l)),l}const yC=e=>it(e)&&Object.getOwnPropertyNames(e).some(t=>gs(e[t]));function vC(e,t){const{isScriptable:n,isIndexable:a}=M2(e);for(const r of t){const l=n(r),o=a(r),h=(o||l)&&e[r];if(l&&(gs(h)||yC(h))||o&&qt(h))return!0}return!1}var bC="4.4.9";const _C=["top","bottom","left","right","chartArea"];function Iy(e,t){return e==="top"||e==="bottom"||_C.indexOf(e)===-1&&t==="x"}function zy(e,t){return function(n,a){return n[e]===a[e]?n[t]-a[t]:n[e]-a[e]}}function Uy(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),jt(n&&n.onComplete,[e],t)}function wC(e){const t=e.chart,n=t.options.animation;jt(n&&n.onProgress,[e],t)}function Z2(e){return Cx()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const yh={},Vy=e=>{const t=Z2(e);return Object.values(yh).filter(n=>n.canvas===t).pop()};function TC(e,t,n){const a=Object.keys(e);for(const r of a){const l=+r;if(l>=t){const o=e[r];delete e[r],(n>0||l>t)&&(e[l+n]=o)}}}function SC(e,t,n,a){return!n||e.type==="mouseout"?null:a?t:e}var ls;let ii=(ls=class{static register(...t){Za.add(...t),Ky()}static unregister(...t){Za.remove(...t),Ky()}constructor(t,n){const a=this.config=new pC(n),r=Z2(t),l=Vy(r);if(l)throw new Error("Canvas is already in use. Chart with ID '"+l.id+"' must be destroyed before the canvas with ID '"+l.canvas.id+"' can be reused.");const o=a.createResolver(a.chartOptionScopes(),this.getContext());this.platform=new(a.platform||U3(r)),this.platform.updateConfig(a);const h=this.platform.acquireContext(r,o.aspectRatio),f=h&&h.canvas,x=f&&f.height,g=f&&f.width;if(this.id=vN(),this.ctx=h,this.canvas=f,this.width=g,this.height=x,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new iC,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=HN(p=>this.update(p),o.resizeDelay||0),this._dataChanges=[],yh[this.id]=this,!h||!f){console.error("Failed to create chart: can't acquire context from the given item");return}br.listen(this,"complete",Uy),br.listen(this,"progress",wC),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:n},width:a,height:r,_aspectRatio:l}=this;return rt(t)?n&&l?l:r?a/r:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return Za}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():fy(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return cy(this.canvas,this.ctx),this}stop(){return br.stop(this),this}resize(t,n){br.running(this)?this._resizeBeforeDraw={width:t,height:n}:this._resize(t,n)}_resize(t,n){const a=this.options,r=this.canvas,l=a.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,t,n,l),h=a.devicePixelRatio||this.platform.getDevicePixelRatio(),f=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,fy(this,h,!0)&&(this.notifyPlugins("resize",{size:o}),jt(a.onResize,[this,o],this),this.attached&&this._doResize(f)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};dt(n,(a,r)=>{a.id=r})}buildOrUpdateScales(){const t=this.options,n=t.scales,a=this.scales,r=Object.keys(a).reduce((o,h)=>(o[h]=!1,o),{});let l=[];n&&(l=l.concat(Object.keys(n).map(o=>{const h=n[o],f=Qd(o,h),x=f==="r",g=f==="x";return{options:h,dposition:x?"chartArea":g?"bottom":"left",dtype:x?"radialLinear":g?"category":"linear"}}))),dt(l,o=>{const h=o.options,f=h.id,x=Qd(f,h),g=Je(h.type,o.dtype);(h.position===void 0||Iy(h.position,x)!==Iy(o.dposition))&&(h.position=o.dposition),r[f]=!0;let p=null;if(f in a&&a[f].type===g)p=a[f];else{const y=Za.getScale(g);p=new y({id:f,type:g,ctx:this.ctx,chart:this}),a[p.id]=p}p.init(h,t)}),dt(r,(o,h)=>{o||delete a[h]}),dt(a,o=>{Ta.configure(this,o,o.options),Ta.addBox(this,o)})}_updateMetasets(){const t=this._metasets,n=this.data.datasets.length,a=t.length;if(t.sort((r,l)=>r.index-l.index),a>n){for(let r=n;r<a;++r)this._destroyDatasetMeta(r);t.splice(n,a-n)}this._sortedMetasets=t.slice(0).sort(zy("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:n}}=this;t.length>n.length&&delete this._stacks,t.forEach((a,r)=>{n.filter(l=>l===a._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const t=[],n=this.data.datasets;let a,r;for(this._removeUnreferencedMetasets(),a=0,r=n.length;a<r;a++){const l=n[a];let o=this.getDatasetMeta(a);const h=l.type||this.config.type;if(o.type&&o.type!==h&&(this._destroyDatasetMeta(a),o=this.getDatasetMeta(a)),o.type=h,o.indexAxis=l.indexAxis||$d(h,this.options),o.order=l.order||0,o.index=a,o.label=""+l.label,o.visible=this.isDatasetVisible(a),o.controller)o.controller.updateIndex(a),o.controller.linkScales();else{const f=Za.getController(h),{datasetElementType:x,dataElementType:g}=zt.datasets[h];Object.assign(f,{dataElementType:Za.getElement(g),datasetElementType:x&&Za.getElement(x)}),o.controller=new f(this,a),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){dt(this.data.datasets,(t,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const n=this.config;n.update();const a=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!a.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const l=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let x=0,g=this.data.datasets.length;x<g;x++){const{controller:p}=this.getDatasetMeta(x),y=!r&&l.indexOf(p)===-1;p.buildOrUpdateElements(y),o=Math.max(+p.getMaxOverflow(),o)}o=this._minPadding=a.layout.autoPadding?o:0,this._updateLayout(o),r||dt(l,x=>{x.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(zy("z","_idx"));const{_active:h,_lastEvent:f}=this;f?this._eventHandler(f,!0):h.length&&this._updateHoverStyles(h,h,!0),this.render()}_updateScales(){dt(this.scales,t=>{Ta.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,n=new Set(Object.keys(this._listeners)),a=new Set(t.events);(!J1(n,a)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,n=this._getUniformDataChanges()||[];for(const{method:a,start:r,count:l}of n){const o=a==="_removeElements"?-l:l;TC(t,r,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const n=this.data.datasets.length,a=l=>new Set(t.filter(o=>o[0]===l).map((o,h)=>h+","+o.splice(1).join(","))),r=a(0);for(let l=1;l<n;l++)if(!J1(r,a(l)))return;return Array.from(r).map(l=>l.split(",")).map(l=>({method:l[1],start:+l[2],count:+l[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Ta.update(this,this.width,this.height,t);const n=this.chartArea,a=n.width<=0||n.height<=0;this._layers=[],dt(this.boxes,r=>{a&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,l)=>{r._idx=l}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let n=0,a=this.data.datasets.length;n<a;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,a=this.data.datasets.length;n<a;++n)this._updateDataset(n,gs(t)?t({datasetIndex:n}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,n){const a=this.getDatasetMeta(t),r={meta:a,index:t,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(a.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(br.has(this)?this.attached&&!br.running(this)&&br.start(this):(this.draw(),Uy({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:a,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(a,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(this.chartArea);for(this._drawDatasets();t<n.length;++t)n[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const n=this._sortedMetasets,a=[];let r,l;for(r=0,l=n.length;r<l;++r){const o=n[r];(!t||o.visible)&&a.push(o)}return a}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let n=t.length-1;n>=0;--n)this._drawDataset(t[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const n=this.ctx,a={meta:t,index:t.index,cancelable:!0},r=KE(this,t);this.notifyPlugins("beforeDatasetDraw",a)!==!1&&(r&&_x(n,r),t.controller.draw(),r&&wx(n),a.cancelable=!1,this.notifyPlugins("afterDatasetDraw",a))}isPointInArea(t){return tc(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,n,a,r){const l=_3.modes[n];return typeof l=="function"?l(this,t,a,r):[]}getDatasetMeta(t){const n=this.data.datasets[t],a=this._metasets;let r=a.filter(l=>l&&l._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:t,_dataset:n,_parsed:[],_sorted:!1},a.push(r)),r}getContext(){return this.$context||(this.$context=si(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const n=this.data.datasets[t];if(!n)return!1;const a=this.getDatasetMeta(t);return typeof a.hidden=="boolean"?!a.hidden:!n.hidden}setDatasetVisibility(t,n){const a=this.getDatasetMeta(t);a.hidden=!n}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,n,a){const r=a?"show":"hide",l=this.getDatasetMeta(t),o=l.controller._resolveAnimations(void 0,r);Zo(n)?(l.data[n].hidden=!a,this.update()):(this.setDatasetVisibility(t,a),o.update(l,{visible:a}),this.update(h=>h.datasetIndex===t?r:void 0))}hide(t,n){this._updateVisibility(t,n,!1)}show(t,n){this._updateVisibility(t,n,!0)}_destroyDatasetMeta(t){const n=this._metasets[t];n&&n.controller&&n.controller._destroy(),delete this._metasets[t]}_stop(){let t,n;for(this.stop(),br.remove(this),t=0,n=this.data.datasets.length;t<n;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:n}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),cy(t,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete yh[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,n=this.platform,a=(l,o)=>{n.addEventListener(this,l,o),t[l]=o},r=(l,o,h)=>{l.offsetX=o,l.offsetY=h,this._eventHandler(l)};dt(this.options.events,l=>a(l,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,n=this.platform,a=(f,x)=>{n.addEventListener(this,f,x),t[f]=x},r=(f,x)=>{t[f]&&(n.removeEventListener(this,f,x),delete t[f])},l=(f,x)=>{this.canvas&&this.resize(f,x)};let o;const h=()=>{r("attach",h),this.attached=!0,this.resize(),a("resize",l),a("detach",o)};o=()=>{this.attached=!1,r("resize",l),this._stop(),this._resize(0,0),a("attach",h)},n.isAttached(this.canvas)?h():o()}unbindEvents(){dt(this._listeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._listeners={},dt(this._responsiveListeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,n,a){const r=a?"set":"remove";let l,o,h,f;for(n==="dataset"&&(l=this.getDatasetMeta(t[0].datasetIndex),l.controller["_"+r+"DatasetHoverStyle"]()),h=0,f=t.length;h<f;++h){o=t[h];const x=o&&this.getDatasetMeta(o.datasetIndex).controller;x&&x[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const n=this._active||[],a=t.map(({datasetIndex:l,index:o})=>{const h=this.getDatasetMeta(l);if(!h)throw new Error("No dataset found at index "+l);return{datasetIndex:l,element:h.data[o],index:o}});!bh(a,n)&&(this._active=a,this._lastEvent=null,this._updateHoverStyles(a,n))}notifyPlugins(t,n,a){return this._plugins.notify(this,t,n,a)}isPluginEnabled(t){return this._plugins._cache.filter(n=>n.plugin.id===t).length===1}_updateHoverStyles(t,n,a){const r=this.options.hover,l=(f,x)=>f.filter(g=>!x.some(p=>g.datasetIndex===p.datasetIndex&&g.index===p.index)),o=l(n,t),h=a?t:l(t,n);o.length&&this.updateHoverStyle(o,r.mode,!1),h.length&&r.mode&&this.updateHoverStyle(h,r.mode,!0)}_eventHandler(t,n){const a={event:t,replay:n,cancelable:!0,inChartArea:this.isPointInArea(t)},r=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",a,r)===!1)return;const l=this._handleEvent(t,n,a.inChartArea);return a.cancelable=!1,this.notifyPlugins("afterEvent",a,r),(l||a.changed)&&this.render(),this}_handleEvent(t,n,a){const{_active:r=[],options:l}=this,o=n,h=this._getActiveElements(t,r,a,o),f=NN(t),x=SC(t,this._lastEvent,a,f);a&&(this._lastEvent=null,jt(l.onHover,[t,h,this],this),f&&jt(l.onClick,[t,h,this],this));const g=!bh(h,r);return(g||n)&&(this._active=h,this._updateHoverStyles(h,r,n)),this._lastEvent=x,g}_getActiveElements(t,n,a,r){if(t.type==="mouseout")return[];if(!a)return n;const l=this.options.hover;return this.getElementsAtEventForMode(t,l.mode,l,r)}},Pe(ls,"defaults",zt),Pe(ls,"instances",yh),Pe(ls,"overrides",ti),Pe(ls,"registry",Za),Pe(ls,"version",bC),Pe(ls,"getChart",Vy),ls);function Ky(){return dt(ii.instances,e=>e._plugins.invalidate())}function NC(e,t,n){const{startAngle:a,pixelMargin:r,x:l,y:o,outerRadius:h,innerRadius:f}=t;let x=r/h;e.beginPath(),e.arc(l,o,h,a-x,n+x),f>r?(x=r/f,e.arc(l,o,f,n+x,a-x,!0)):e.arc(l,o,r,n+tn,a-tn),e.closePath(),e.clip()}function EC(e){return Tx(e,["outerStart","outerEnd","innerStart","innerEnd"])}function CC(e,t,n,a){const r=EC(e.options.borderRadius),l=(n-t)/2,o=Math.min(l,a*t/2),h=f=>{const x=(n-Math.min(l,f))*a/2;return jn(f,0,Math.min(l,x))};return{outerStart:h(r.outerStart),outerEnd:h(r.outerEnd),innerStart:jn(r.innerStart,0,o),innerEnd:jn(r.innerEnd,0,o)}}function Yi(e,t,n,a){return{x:n+e*Math.cos(t),y:a+e*Math.sin(t)}}function Eh(e,t,n,a,r,l){const{x:o,y:h,startAngle:f,pixelMargin:x,innerRadius:g}=t,p=Math.max(t.outerRadius+a+n-x,0),y=g>0?g+a+n+x:0;let _=0;const w=r-f;if(a){const re=g>0?g-a:0,ee=p>0?p-a:0,Q=(re+ee)/2,me=Q!==0?w*Q/(Q+a):w;_=(w-me)/2}const b=Math.max(.001,w*p-n/Ut)/p,T=(w-b)/2,S=f+T+_,E=r-T-_,{outerStart:C,outerEnd:A,innerStart:F,innerEnd:K}=CC(t,y,p,E-S),O=p-C,P=p-A,M=S+C/O,B=E-A/P,I=y+F,te=y+K,q=S+F/I,ae=E-K/te;if(e.beginPath(),l){const re=(M+B)/2;if(e.arc(o,h,p,M,re),e.arc(o,h,p,re,B),A>0){const ye=Yi(P,B,o,h);e.arc(ye.x,ye.y,A,B,E+tn)}const ee=Yi(te,E,o,h);if(e.lineTo(ee.x,ee.y),K>0){const ye=Yi(te,ae,o,h);e.arc(ye.x,ye.y,K,E+tn,ae+Math.PI)}const Q=(E-K/y+(S+F/y))/2;if(e.arc(o,h,y,E-K/y,Q,!0),e.arc(o,h,y,Q,S+F/y,!0),F>0){const ye=Yi(I,q,o,h);e.arc(ye.x,ye.y,F,q+Math.PI,S-tn)}const me=Yi(O,S,o,h);if(e.lineTo(me.x,me.y),C>0){const ye=Yi(O,M,o,h);e.arc(ye.x,ye.y,C,S-tn,M)}}else{e.moveTo(o,h);const re=Math.cos(M)*p+o,ee=Math.sin(M)*p+h;e.lineTo(re,ee);const Q=Math.cos(B)*p+o,me=Math.sin(B)*p+h;e.lineTo(Q,me)}e.closePath()}function jC(e,t,n,a,r){const{fullCircles:l,startAngle:o,circumference:h}=t;let f=t.endAngle;if(l){Eh(e,t,n,a,f,r);for(let x=0;x<l;++x)e.fill();isNaN(h)||(f=o+(h%It||It))}return Eh(e,t,n,a,f,r),e.fill(),f}function kC(e,t,n,a,r){const{fullCircles:l,startAngle:o,circumference:h,options:f}=t,{borderWidth:x,borderJoinStyle:g,borderDash:p,borderDashOffset:y}=f,_=f.borderAlign==="inner";if(!x)return;e.setLineDash(p||[]),e.lineDashOffset=y,_?(e.lineWidth=x*2,e.lineJoin=g||"round"):(e.lineWidth=x,e.lineJoin=g||"bevel");let w=t.endAngle;if(l){Eh(e,t,n,a,w,r);for(let b=0;b<l;++b)e.stroke();isNaN(h)||(w=o+(h%It||It))}_&&NC(e,t,w),l||(Eh(e,t,n,a,w,r),e.stroke())}class Sr extends Pa{constructor(n){super();Pe(this,"circumference");Pe(this,"endAngle");Pe(this,"fullCircles");Pe(this,"innerRadius");Pe(this,"outerRadius");Pe(this,"pixelMargin");Pe(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,a,r){const l=this.getProps(["x","y"],r),{angle:o,distance:h}=N2(l,{x:n,y:a}),{startAngle:f,endAngle:x,innerRadius:g,outerRadius:p,circumference:y}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),_=(this.options.spacing+this.options.borderWidth)/2,w=Je(y,x-f),b=ec(o,f,x)&&f!==x,T=w>=It||b,S=us(h,g+_,p+_);return T&&S}getCenterPoint(n){const{x:a,y:r,startAngle:l,endAngle:o,innerRadius:h,outerRadius:f}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:x,spacing:g}=this.options,p=(l+o)/2,y=(h+f+g+x)/2;return{x:a+Math.cos(p)*y,y:r+Math.sin(p)*y}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:a,circumference:r}=this,l=(a.offset||0)/4,o=(a.spacing||0)/2,h=a.circular;if(this.pixelMargin=a.borderAlign==="inner"?.33:0,this.fullCircles=r>It?Math.floor(r/It):0,r===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const f=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(f)*l,Math.sin(f)*l);const x=1-Math.sin(Math.min(Ut,r||0)),g=l*x;n.fillStyle=a.backgroundColor,n.strokeStyle=a.borderColor,jC(n,this,g,o,h),kC(n,this,g,o,h),n.restore()}}Pe(Sr,"id","arc"),Pe(Sr,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),Pe(Sr,"defaultRoutes",{backgroundColor:"backgroundColor"}),Pe(Sr,"descriptors",{_scriptable:!0,_indexable:n=>n!=="borderDash"});function J2(e,t,n=t){e.lineCap=Je(n.borderCapStyle,t.borderCapStyle),e.setLineDash(Je(n.borderDash,t.borderDash)),e.lineDashOffset=Je(n.borderDashOffset,t.borderDashOffset),e.lineJoin=Je(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=Je(n.borderWidth,t.borderWidth),e.strokeStyle=Je(n.borderColor,t.borderColor)}function AC(e,t,n){e.lineTo(n.x,n.y)}function DC(e){return e.stepped?ZN:e.tension||e.cubicInterpolationMode==="monotone"?JN:AC}function eb(e,t,n={}){const a=e.length,{start:r=0,end:l=a-1}=n,{start:o,end:h}=t,f=Math.max(r,o),x=Math.min(l,h),g=r<o&&l<o||r>h&&l>h;return{count:a,start:f,loop:t.loop,ilen:x<f&&!g?a+x-f:x-f}}function OC(e,t,n,a){const{points:r,options:l}=t,{count:o,start:h,loop:f,ilen:x}=eb(r,n,a),g=DC(l);let{move:p=!0,reverse:y}=a||{},_,w,b;for(_=0;_<=x;++_)w=r[(h+(y?x-_:_))%o],!w.skip&&(p?(e.moveTo(w.x,w.y),p=!1):g(e,b,w,y,l.stepped),b=w);return f&&(w=r[(h+(y?x:0))%o],g(e,b,w,y,l.stepped)),!!f}function MC(e,t,n,a){const r=t.points,{count:l,start:o,ilen:h}=eb(r,n,a),{move:f=!0,reverse:x}=a||{};let g=0,p=0,y,_,w,b,T,S;const E=A=>(o+(x?h-A:A))%l,C=()=>{b!==T&&(e.lineTo(g,T),e.lineTo(g,b),e.lineTo(g,S))};for(f&&(_=r[E(0)],e.moveTo(_.x,_.y)),y=0;y<=h;++y){if(_=r[E(y)],_.skip)continue;const A=_.x,F=_.y,K=A|0;K===w?(F<b?b=F:F>T&&(T=F),g=(p*g+A)/++p):(C(),e.lineTo(A,F),w=K,p=0,b=T=F),S=F}C()}function Zd(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!n?MC:OC}function RC(e){return e.stepped?DE:e.tension||e.cubicInterpolationMode==="monotone"?OE:Gs}function FC(e,t,n,a){let r=t._path;r||(r=t._path=new Path2D,t.path(r,n,a)&&r.closePath()),J2(e,t.options),e.stroke(r)}function LC(e,t,n,a){const{segments:r,options:l}=t,o=Zd(t);for(const h of r)J2(e,l,h.style),e.beginPath(),o(e,t,h,{start:n,end:n+a-1})&&e.closePath(),e.stroke()}const BC=typeof Path2D=="function";function HC(e,t,n,a){BC&&!t.options.segment?FC(e,t,n,a):LC(e,t,n,a)}class el extends Pa{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,n){const a=this.options;if((a.tension||a.cubicInterpolationMode==="monotone")&&!a.stepped&&!this._pointsUpdated){const r=a.spanGaps?this._loop:this._fullLoop;TE(this._points,a,t,r,n),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=IE(this,this.options.segment))}first(){const t=this.segments,n=this.points;return t.length&&n[t[0].start]}last(){const t=this.segments,n=this.points,a=t.length;return a&&n[t[a-1].end]}interpolate(t,n){const a=this.options,r=t[n],l=this.points,o=BE(this,{property:n,start:r,end:r});if(!o.length)return;const h=[],f=RC(a);let x,g;for(x=0,g=o.length;x<g;++x){const{start:p,end:y}=o[x],_=l[p],w=l[y];if(_===w){h.push(_);continue}const b=Math.abs((r-_[n])/(w[n]-_[n])),T=f(_,w,b,a.stepped);T[n]=t[n],h.push(T)}return h.length===1?h[0]:h}pathSegment(t,n,a){return Zd(this)(t,this,n,a)}path(t,n,a){const r=this.segments,l=Zd(this);let o=this._loop;n=n||0,a=a||this.points.length-n;for(const h of r)o&=l(t,this,h,{start:n,end:n+a-1});return!!o}draw(t,n,a,r){const l=this.options||{};(this.points||[]).length&&l.borderWidth&&(t.save(),HC(t,this,a,r),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Pe(el,"id","line"),Pe(el,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Pe(el,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Pe(el,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function Wy(e,t,n,a){const r=e.options,{[n]:l}=e.getProps([n],a);return Math.abs(t-l)<r.radius+r.hitRadius}class rl extends Pa{constructor(n){super();Pe(this,"parsed");Pe(this,"skip");Pe(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,a,r){const l=this.options,{x:o,y:h}=this.getProps(["x","y"],r);return Math.pow(n-o,2)+Math.pow(a-h,2)<Math.pow(l.hitRadius+l.radius,2)}inXRange(n,a){return Wy(this,n,"x",a)}inYRange(n,a){return Wy(this,n,"y",a)}getCenterPoint(n){const{x:a,y:r}=this.getProps(["x","y"],n);return{x:a,y:r}}size(n){n=n||this.options||{};let a=n.radius||0;a=Math.max(a,a&&n.hoverRadius||0);const r=a&&n.borderWidth||0;return(a+r)*2}draw(n,a){const r=this.options;this.skip||r.radius<.1||!tc(this,a,this.size(r)/2)||(n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.fillStyle=r.backgroundColor,Yd(n,r,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}Pe(rl,"id","point"),Pe(rl,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Pe(rl,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function tb(e,t){const{x:n,y:a,base:r,width:l,height:o}=e.getProps(["x","y","base","width","height"],t);let h,f,x,g,p;return e.horizontal?(p=o/2,h=Math.min(n,r),f=Math.max(n,r),x=a-p,g=a+p):(p=l/2,h=n-p,f=n+p,x=Math.min(a,r),g=Math.max(a,r)),{left:h,top:x,right:f,bottom:g}}function hs(e,t,n,a){return e?0:jn(t,n,a)}function PC(e,t,n){const a=e.options.borderWidth,r=e.borderSkipped,l=O2(a);return{t:hs(r.top,l.top,0,n),r:hs(r.right,l.right,0,t),b:hs(r.bottom,l.bottom,0,n),l:hs(r.left,l.left,0,t)}}function IC(e,t,n){const{enableBorderRadius:a}=e.getProps(["enableBorderRadius"]),r=e.options.borderRadius,l=nl(r),o=Math.min(t,n),h=e.borderSkipped,f=a||it(r);return{topLeft:hs(!f||h.top||h.left,l.topLeft,0,o),topRight:hs(!f||h.top||h.right,l.topRight,0,o),bottomLeft:hs(!f||h.bottom||h.left,l.bottomLeft,0,o),bottomRight:hs(!f||h.bottom||h.right,l.bottomRight,0,o)}}function zC(e){const t=tb(e),n=t.right-t.left,a=t.bottom-t.top,r=PC(e,n/2,a/2),l=IC(e,n/2,a/2);return{outer:{x:t.left,y:t.top,w:n,h:a,radius:l},inner:{x:t.left+r.l,y:t.top+r.t,w:n-r.l-r.r,h:a-r.t-r.b,radius:{topLeft:Math.max(0,l.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,l.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,l.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,l.bottomRight-Math.max(r.b,r.r))}}}}function Ad(e,t,n,a){const r=t===null,l=n===null,h=e&&!(r&&l)&&tb(e,a);return h&&(r||us(t,h.left,h.right))&&(l||us(n,h.top,h.bottom))}function UC(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function VC(e,t){e.rect(t.x,t.y,t.w,t.h)}function Dd(e,t,n={}){const a=e.x!==n.x?-t:0,r=e.y!==n.y?-t:0,l=(e.x+e.w!==n.x+n.w?t:0)-a,o=(e.y+e.h!==n.y+n.h?t:0)-r;return{x:e.x+a,y:e.y+r,w:e.w+l,h:e.h+o,radius:e.radius}}class Zs extends Pa{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:n,options:{borderColor:a,backgroundColor:r}}=this,{inner:l,outer:o}=zC(this),h=UC(o.radius)?Th:VC;t.save(),(o.w!==l.w||o.h!==l.h)&&(t.beginPath(),h(t,Dd(o,n,l)),t.clip(),h(t,Dd(l,-n,o)),t.fillStyle=a,t.fill("evenodd")),t.beginPath(),h(t,Dd(l,n)),t.fillStyle=r,t.fill(),t.restore()}inRange(t,n,a){return Ad(this,t,n,a)}inXRange(t,n){return Ad(this,t,null,n)}inYRange(t,n){return Ad(this,null,t,n)}getCenterPoint(t){const{x:n,y:a,base:r,horizontal:l}=this.getProps(["x","y","base","horizontal"],t);return{x:l?(n+r)/2:n,y:l?a:(a+r)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}Pe(Zs,"id","bar"),Pe(Zs,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Pe(Zs,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const Gy=(e,t)=>{let{boxHeight:n=t,boxWidth:a=t}=e;return e.usePointStyle&&(n=Math.min(n,t),a=e.pointStyleWidth||Math.min(a,t)),{boxWidth:a,boxHeight:n,itemHeight:Math.max(t,n)}},KC=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class Xy extends Pa{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n,a){this.maxWidth=t,this.maxHeight=n,this._margins=a,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let n=jt(t.generateLabels,[this.chart],this)||[];t.filter&&(n=n.filter(a=>t.filter(a,this.chart.data))),t.sort&&(n=n.sort((a,r)=>t.sort(a,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:t,ctx:n}=this;if(!t.display){this.width=this.height=0;return}const a=t.labels,r=_n(a.font),l=r.size,o=this._computeTitleHeight(),{boxWidth:h,itemHeight:f}=Gy(a,l);let x,g;n.font=r.string,this.isHorizontal()?(x=this.maxWidth,g=this._fitRows(o,l,h,f)+10):(g=this.maxHeight,x=this._fitCols(o,r,h,f)+10),this.width=Math.min(x,t.maxWidth||this.maxWidth),this.height=Math.min(g,t.maxHeight||this.maxHeight)}_fitRows(t,n,a,r){const{ctx:l,maxWidth:o,options:{labels:{padding:h}}}=this,f=this.legendHitBoxes=[],x=this.lineWidths=[0],g=r+h;let p=t;l.textAlign="left",l.textBaseline="middle";let y=-1,_=-g;return this.legendItems.forEach((w,b)=>{const T=a+n/2+l.measureText(w.text).width;(b===0||x[x.length-1]+T+2*h>o)&&(p+=g,x[x.length-(b>0?0:1)]=0,_+=g,y++),f[b]={left:0,top:_,row:y,width:T,height:r},x[x.length-1]+=T+h}),p}_fitCols(t,n,a,r){const{ctx:l,maxHeight:o,options:{labels:{padding:h}}}=this,f=this.legendHitBoxes=[],x=this.columnSizes=[],g=o-t;let p=h,y=0,_=0,w=0,b=0;return this.legendItems.forEach((T,S)=>{const{itemWidth:E,itemHeight:C}=WC(a,n,l,T,r);S>0&&_+C+2*h>g&&(p+=y+h,x.push({width:y,height:_}),w+=y+h,b++,y=_=0),f[S]={left:w,top:_,col:b,width:E,height:C},y=Math.max(y,E),_+=C+h}),p+=y,x.push({width:y,height:_}),p}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:a,labels:{padding:r},rtl:l}}=this,o=al(l,this.left,this.width);if(this.isHorizontal()){let h=0,f=Cn(a,this.left+r,this.right-this.lineWidths[h]);for(const x of n)h!==x.row&&(h=x.row,f=Cn(a,this.left+r,this.right-this.lineWidths[h])),x.top+=this.top+t+r,x.left=o.leftForLtr(o.x(f),x.width),f+=x.width+r}else{let h=0,f=Cn(a,this.top+t+r,this.bottom-this.columnSizes[h].height);for(const x of n)x.col!==h&&(h=x.col,f=Cn(a,this.top+t+r,this.bottom-this.columnSizes[h].height)),x.top=f,x.left+=this.left+r,x.left=o.leftForLtr(o.x(x.left),x.width),f+=x.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;_x(t,this),this._draw(),wx(t)}}_draw(){const{options:t,columnSizes:n,lineWidths:a,ctx:r}=this,{align:l,labels:o}=t,h=zt.color,f=al(t.rtl,this.left,this.width),x=_n(o.font),{padding:g}=o,p=x.size,y=p/2;let _;this.drawTitle(),r.textAlign=f.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=x.string;const{boxWidth:w,boxHeight:b,itemHeight:T}=Gy(o,p),S=function(K,O,P){if(isNaN(w)||w<=0||isNaN(b)||b<0)return;r.save();const M=Je(P.lineWidth,1);if(r.fillStyle=Je(P.fillStyle,h),r.lineCap=Je(P.lineCap,"butt"),r.lineDashOffset=Je(P.lineDashOffset,0),r.lineJoin=Je(P.lineJoin,"miter"),r.lineWidth=M,r.strokeStyle=Je(P.strokeStyle,h),r.setLineDash(Je(P.lineDash,[])),o.usePointStyle){const B={radius:b*Math.SQRT2/2,pointStyle:P.pointStyle,rotation:P.rotation,borderWidth:M},I=f.xPlus(K,w/2),te=O+y;D2(r,B,I,te,o.pointStyleWidth&&w)}else{const B=O+Math.max((p-b)/2,0),I=f.leftForLtr(K,w),te=nl(P.borderRadius);r.beginPath(),Object.values(te).some(q=>q!==0)?Th(r,{x:I,y:B,w,h:b,radius:te}):r.rect(I,B,w,b),r.fill(),M!==0&&r.stroke()}r.restore()},E=function(K,O,P){nc(r,P.text,K,O+T/2,x,{strikethrough:P.hidden,textAlign:f.textAlign(P.textAlign)})},C=this.isHorizontal(),A=this._computeTitleHeight();C?_={x:Cn(l,this.left+g,this.right-a[0]),y:this.top+g+A,line:0}:_={x:this.left+g,y:Cn(l,this.top+A+g,this.bottom-n[0].height),line:0},H2(this.ctx,t.textDirection);const F=T+g;this.legendItems.forEach((K,O)=>{r.strokeStyle=K.fontColor,r.fillStyle=K.fontColor;const P=r.measureText(K.text).width,M=f.textAlign(K.textAlign||(K.textAlign=o.textAlign)),B=w+y+P;let I=_.x,te=_.y;f.setWidth(this.width),C?O>0&&I+B+g>this.right&&(te=_.y+=F,_.line++,I=_.x=Cn(l,this.left+g,this.right-a[_.line])):O>0&&te+F>this.bottom&&(I=_.x=I+n[_.line].width+g,_.line++,te=_.y=Cn(l,this.top+A+g,this.bottom-n[_.line].height));const q=f.x(I);if(S(q,te,K),I=PN(M,I+w+y,C?I+B:this.right,t.rtl),E(f.x(I),te,K),C)_.x+=B+g;else if(typeof K.text!="string"){const ae=x.lineHeight;_.y+=nb(K,ae)+g}else _.y+=F}),P2(this.ctx,t.textDirection)}drawTitle(){const t=this.options,n=t.title,a=_n(n.font),r=la(n.padding);if(!n.display)return;const l=al(t.rtl,this.left,this.width),o=this.ctx,h=n.position,f=a.size/2,x=r.top+f;let g,p=this.left,y=this.width;if(this.isHorizontal())y=Math.max(...this.lineWidths),g=this.top+x,p=Cn(t.align,p,this.right-y);else{const w=this.columnSizes.reduce((b,T)=>Math.max(b,T.height),0);g=x+Cn(t.align,this.top,this.bottom-w-t.labels.padding-this._computeTitleHeight())}const _=Cn(h,p,p+y);o.textAlign=l.textAlign(yx(h)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=a.string,nc(o,n.text,_,g,a)}_computeTitleHeight(){const t=this.options.title,n=_n(t.font),a=la(t.padding);return t.display?n.lineHeight+a.height:0}_getLegendItemAt(t,n){let a,r,l;if(us(t,this.left,this.right)&&us(n,this.top,this.bottom)){for(l=this.legendHitBoxes,a=0;a<l.length;++a)if(r=l[a],us(t,r.left,r.left+r.width)&&us(n,r.top,r.top+r.height))return this.legendItems[a]}return null}handleEvent(t){const n=this.options;if(!YC(t.type,n))return;const a=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const r=this._hoveredItem,l=KC(r,a);r&&!l&&jt(n.onLeave,[t,r,this],this),this._hoveredItem=a,a&&!l&&jt(n.onHover,[t,a,this],this)}else a&&jt(n.onClick,[t,a,this],this)}}function WC(e,t,n,a,r){const l=GC(a,e,t,n),o=XC(r,a,t.lineHeight);return{itemWidth:l,itemHeight:o}}function GC(e,t,n,a){let r=e.text;return r&&typeof r!="string"&&(r=r.reduce((l,o)=>l.length>o.length?l:o)),t+n.size/2+a.measureText(r).width}function XC(e,t,n){let a=e;return typeof t.text!="string"&&(a=nb(t,n)),a}function nb(e,t){const n=e.text?e.text.length:0;return t*n}function YC(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var qh={id:"legend",_element:Xy,start(e,t,n){const a=e.legend=new Xy({ctx:e.ctx,options:n,chart:e});Ta.configure(e,a,n),Ta.addBox(e,a)},stop(e){Ta.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const a=e.legend;Ta.configure(e,a,n),a.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const a=t.datasetIndex,r=n.chart;r.isDatasetVisible(a)?(r.hide(a),t.hidden=!0):(r.show(a),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:a,textAlign:r,color:l,useBorderRadius:o,borderRadius:h}}=e.legend.options;return e._getSortedDatasetMetas().map(f=>{const x=f.controller.getStyle(n?0:void 0),g=la(x.borderWidth);return{text:t[f.index].label,fillStyle:x.backgroundColor,fontColor:l,hidden:!f.visible,lineCap:x.borderCapStyle,lineDash:x.borderDash,lineDashOffset:x.borderDashOffset,lineJoin:x.borderJoinStyle,lineWidth:(g.width+g.height)/4,strokeStyle:x.borderColor,pointStyle:a||x.pointStyle,rotation:x.rotation,textAlign:r||x.textAlign,borderRadius:o&&(h||x.borderRadius),datasetIndex:f.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class ab extends Pa{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n){const a=this.options;if(this.left=0,this.top=0,!a.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=n;const r=qt(a.text)?a.text.length:1;this._padding=la(a.padding);const l=r*_n(a.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=l:this.width=l}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:n,left:a,bottom:r,right:l,options:o}=this,h=o.align;let f=0,x,g,p;return this.isHorizontal()?(g=Cn(h,a,l),p=n+t,x=l-a):(o.position==="left"?(g=a+t,p=Cn(h,r,n),f=Ut*-.5):(g=l-t,p=Cn(h,n,r),f=Ut*.5),x=r-n),{titleX:g,titleY:p,maxWidth:x,rotation:f}}draw(){const t=this.ctx,n=this.options;if(!n.display)return;const a=_n(n.font),l=a.lineHeight/2+this._padding.top,{titleX:o,titleY:h,maxWidth:f,rotation:x}=this._drawArgs(l);nc(t,n.text,0,0,a,{color:n.color,maxWidth:f,rotation:x,textAlign:yx(n.align),textBaseline:"middle",translation:[o,h]})}}function qC(e,t){const n=new ab({ctx:e.ctx,options:t,chart:e});Ta.configure(e,n,t),Ta.addBox(e,n),e.titleBlock=n}var $C={id:"title",_element:ab,start(e,t,n){qC(e,n)},stop(e){const t=e.titleBlock;Ta.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const a=e.titleBlock;Ta.configure(e,a,n),a.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Fo={average(e){if(!e.length)return!1;let t,n,a=new Set,r=0,l=0;for(t=0,n=e.length;t<n;++t){const h=e[t].element;if(h&&h.hasValue()){const f=h.tooltipPosition();a.add(f.x),r+=f.y,++l}}return l===0||a.size===0?!1:{x:[...a].reduce((h,f)=>h+f)/a.size,y:r/l}},nearest(e,t){if(!e.length)return!1;let n=t.x,a=t.y,r=Number.POSITIVE_INFINITY,l,o,h;for(l=0,o=e.length;l<o;++l){const f=e[l].element;if(f&&f.hasValue()){const x=f.getCenterPoint(),g=Gd(t,x);g<r&&(r=g,h=f)}}if(h){const f=h.tooltipPosition();n=f.x,a=f.y}return{x:n,y:a}}};function qa(e,t){return t&&(qt(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function _r(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function QC(e,t){const{element:n,datasetIndex:a,index:r}=t,l=e.getDatasetMeta(a).controller,{label:o,value:h}=l.getLabelAndValue(r);return{chart:e,label:o,parsed:l.getParsed(r),raw:e.data.datasets[a].data[r],formattedValue:h,dataset:l.getDataset(),dataIndex:r,datasetIndex:a,element:n}}function Yy(e,t){const n=e.chart.ctx,{body:a,footer:r,title:l}=e,{boxWidth:o,boxHeight:h}=t,f=_n(t.bodyFont),x=_n(t.titleFont),g=_n(t.footerFont),p=l.length,y=r.length,_=a.length,w=la(t.padding);let b=w.height,T=0,S=a.reduce((A,F)=>A+F.before.length+F.lines.length+F.after.length,0);if(S+=e.beforeBody.length+e.afterBody.length,p&&(b+=p*x.lineHeight+(p-1)*t.titleSpacing+t.titleMarginBottom),S){const A=t.displayColors?Math.max(h,f.lineHeight):f.lineHeight;b+=_*A+(S-_)*f.lineHeight+(S-1)*t.bodySpacing}y&&(b+=t.footerMarginTop+y*g.lineHeight+(y-1)*t.footerSpacing);let E=0;const C=function(A){T=Math.max(T,n.measureText(A).width+E)};return n.save(),n.font=x.string,dt(e.title,C),n.font=f.string,dt(e.beforeBody.concat(e.afterBody),C),E=t.displayColors?o+2+t.boxPadding:0,dt(a,A=>{dt(A.before,C),dt(A.lines,C),dt(A.after,C)}),E=0,n.font=g.string,dt(e.footer,C),n.restore(),T+=w.width,{width:T,height:b}}function ZC(e,t){const{y:n,height:a}=t;return n<a/2?"top":n>e.height-a/2?"bottom":"center"}function JC(e,t,n,a){const{x:r,width:l}=a,o=n.caretSize+n.caretPadding;if(e==="left"&&r+l+o>t.width||e==="right"&&r-l-o<0)return!0}function ej(e,t,n,a){const{x:r,width:l}=n,{width:o,chartArea:{left:h,right:f}}=e;let x="center";return a==="center"?x=r<=(h+f)/2?"left":"right":r<=l/2?x="left":r>=o-l/2&&(x="right"),JC(x,e,t,n)&&(x="center"),x}function qy(e,t,n){const a=n.yAlign||t.yAlign||ZC(e,n);return{xAlign:n.xAlign||t.xAlign||ej(e,t,n,a),yAlign:a}}function tj(e,t){let{x:n,width:a}=e;return t==="right"?n-=a:t==="center"&&(n-=a/2),n}function nj(e,t,n){let{y:a,height:r}=e;return t==="top"?a+=n:t==="bottom"?a-=r+n:a-=r/2,a}function $y(e,t,n,a){const{caretSize:r,caretPadding:l,cornerRadius:o}=e,{xAlign:h,yAlign:f}=n,x=r+l,{topLeft:g,topRight:p,bottomLeft:y,bottomRight:_}=nl(o);let w=tj(t,h);const b=nj(t,f,x);return f==="center"?h==="left"?w+=x:h==="right"&&(w-=x):h==="left"?w-=Math.max(g,y)+r:h==="right"&&(w+=Math.max(p,_)+r),{x:jn(w,0,a.width-t.width),y:jn(b,0,a.height-t.height)}}function Qu(e,t,n){const a=la(n.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-a.right:e.x+a.left}function Qy(e){return qa([],_r(e))}function aj(e,t,n){return si(e,{tooltip:t,tooltipItems:n,type:"tooltip"})}function Zy(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}const rb={beforeTitle:vr,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,a=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(a>0&&t.dataIndex<a)return n[t.dataIndex]}return""},afterTitle:vr,beforeBody:vr,beforeLabel:vr,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return rt(n)||(t+=n),t},labelColor(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:vr,afterBody:vr,beforeFooter:vr,footer:vr,afterFooter:vr};function Un(e,t,n,a){const r=e[t].call(n,a);return typeof r>"u"?rb[t].call(n,a):r}class Jd extends Pa{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const n=this.chart,a=this.options.setContext(this.getContext()),r=a.enabled&&n.options.animation&&a.animations,l=new z2(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(l)),l}getContext(){return this.$context||(this.$context=aj(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,n){const{callbacks:a}=n,r=Un(a,"beforeTitle",this,t),l=Un(a,"title",this,t),o=Un(a,"afterTitle",this,t);let h=[];return h=qa(h,_r(r)),h=qa(h,_r(l)),h=qa(h,_r(o)),h}getBeforeBody(t,n){return Qy(Un(n.callbacks,"beforeBody",this,t))}getBody(t,n){const{callbacks:a}=n,r=[];return dt(t,l=>{const o={before:[],lines:[],after:[]},h=Zy(a,l);qa(o.before,_r(Un(h,"beforeLabel",this,l))),qa(o.lines,Un(h,"label",this,l)),qa(o.after,_r(Un(h,"afterLabel",this,l))),r.push(o)}),r}getAfterBody(t,n){return Qy(Un(n.callbacks,"afterBody",this,t))}getFooter(t,n){const{callbacks:a}=n,r=Un(a,"beforeFooter",this,t),l=Un(a,"footer",this,t),o=Un(a,"afterFooter",this,t);let h=[];return h=qa(h,_r(r)),h=qa(h,_r(l)),h=qa(h,_r(o)),h}_createItems(t){const n=this._active,a=this.chart.data,r=[],l=[],o=[];let h=[],f,x;for(f=0,x=n.length;f<x;++f)h.push(QC(this.chart,n[f]));return t.filter&&(h=h.filter((g,p,y)=>t.filter(g,p,y,a))),t.itemSort&&(h=h.sort((g,p)=>t.itemSort(g,p,a))),dt(h,g=>{const p=Zy(t.callbacks,g);r.push(Un(p,"labelColor",this,g)),l.push(Un(p,"labelPointStyle",this,g)),o.push(Un(p,"labelTextColor",this,g))}),this.labelColors=r,this.labelPointStyles=l,this.labelTextColors=o,this.dataPoints=h,h}update(t,n){const a=this.options.setContext(this.getContext()),r=this._active;let l,o=[];if(!r.length)this.opacity!==0&&(l={opacity:0});else{const h=Fo[a.position].call(this,r,this._eventPosition);o=this._createItems(a),this.title=this.getTitle(o,a),this.beforeBody=this.getBeforeBody(o,a),this.body=this.getBody(o,a),this.afterBody=this.getAfterBody(o,a),this.footer=this.getFooter(o,a);const f=this._size=Yy(this,a),x=Object.assign({},h,f),g=qy(this.chart,a,x),p=$y(a,x,g,this.chart);this.xAlign=g.xAlign,this.yAlign=g.yAlign,l={opacity:1,x:p.x,y:p.y,width:f.width,height:f.height,caretX:h.x,caretY:h.y}}this._tooltipItems=o,this.$context=void 0,l&&this._resolveAnimations().update(this,l),t&&a.external&&a.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(t,n,a,r){const l=this.getCaretPosition(t,a,r);n.lineTo(l.x1,l.y1),n.lineTo(l.x2,l.y2),n.lineTo(l.x3,l.y3)}getCaretPosition(t,n,a){const{xAlign:r,yAlign:l}=this,{caretSize:o,cornerRadius:h}=a,{topLeft:f,topRight:x,bottomLeft:g,bottomRight:p}=nl(h),{x:y,y:_}=t,{width:w,height:b}=n;let T,S,E,C,A,F;return l==="center"?(A=_+b/2,r==="left"?(T=y,S=T-o,C=A+o,F=A-o):(T=y+w,S=T+o,C=A-o,F=A+o),E=T):(r==="left"?S=y+Math.max(f,g)+o:r==="right"?S=y+w-Math.max(x,p)-o:S=this.caretX,l==="top"?(C=_,A=C-o,T=S-o,E=S+o):(C=_+b,A=C+o,T=S+o,E=S-o),F=C),{x1:T,x2:S,x3:E,y1:C,y2:A,y3:F}}drawTitle(t,n,a){const r=this.title,l=r.length;let o,h,f;if(l){const x=al(a.rtl,this.x,this.width);for(t.x=Qu(this,a.titleAlign,a),n.textAlign=x.textAlign(a.titleAlign),n.textBaseline="middle",o=_n(a.titleFont),h=a.titleSpacing,n.fillStyle=a.titleColor,n.font=o.string,f=0;f<l;++f)n.fillText(r[f],x.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+h,f+1===l&&(t.y+=a.titleMarginBottom-h)}}_drawColorBox(t,n,a,r,l){const o=this.labelColors[a],h=this.labelPointStyles[a],{boxHeight:f,boxWidth:x}=l,g=_n(l.bodyFont),p=Qu(this,"left",l),y=r.x(p),_=f<g.lineHeight?(g.lineHeight-f)/2:0,w=n.y+_;if(l.usePointStyle){const b={radius:Math.min(x,f)/2,pointStyle:h.pointStyle,rotation:h.rotation,borderWidth:1},T=r.leftForLtr(y,x)+x/2,S=w+f/2;t.strokeStyle=l.multiKeyBackground,t.fillStyle=l.multiKeyBackground,Yd(t,b,T,S),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,Yd(t,b,T,S)}else{t.lineWidth=it(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const b=r.leftForLtr(y,x),T=r.leftForLtr(r.xPlus(y,1),x-2),S=nl(o.borderRadius);Object.values(S).some(E=>E!==0)?(t.beginPath(),t.fillStyle=l.multiKeyBackground,Th(t,{x:b,y:w,w:x,h:f,radius:S}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),Th(t,{x:T,y:w+1,w:x-2,h:f-2,radius:S}),t.fill()):(t.fillStyle=l.multiKeyBackground,t.fillRect(b,w,x,f),t.strokeRect(b,w,x,f),t.fillStyle=o.backgroundColor,t.fillRect(T,w+1,x-2,f-2))}t.fillStyle=this.labelTextColors[a]}drawBody(t,n,a){const{body:r}=this,{bodySpacing:l,bodyAlign:o,displayColors:h,boxHeight:f,boxWidth:x,boxPadding:g}=a,p=_n(a.bodyFont);let y=p.lineHeight,_=0;const w=al(a.rtl,this.x,this.width),b=function(P){n.fillText(P,w.x(t.x+_),t.y+y/2),t.y+=y+l},T=w.textAlign(o);let S,E,C,A,F,K,O;for(n.textAlign=o,n.textBaseline="middle",n.font=p.string,t.x=Qu(this,T,a),n.fillStyle=a.bodyColor,dt(this.beforeBody,b),_=h&&T!=="right"?o==="center"?x/2+g:x+2+g:0,A=0,K=r.length;A<K;++A){for(S=r[A],E=this.labelTextColors[A],n.fillStyle=E,dt(S.before,b),C=S.lines,h&&C.length&&(this._drawColorBox(n,t,A,w,a),y=Math.max(p.lineHeight,f)),F=0,O=C.length;F<O;++F)b(C[F]),y=p.lineHeight;dt(S.after,b)}_=0,y=p.lineHeight,dt(this.afterBody,b),t.y-=l}drawFooter(t,n,a){const r=this.footer,l=r.length;let o,h;if(l){const f=al(a.rtl,this.x,this.width);for(t.x=Qu(this,a.footerAlign,a),t.y+=a.footerMarginTop,n.textAlign=f.textAlign(a.footerAlign),n.textBaseline="middle",o=_n(a.footerFont),n.fillStyle=a.footerColor,n.font=o.string,h=0;h<l;++h)n.fillText(r[h],f.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+a.footerSpacing}}drawBackground(t,n,a,r){const{xAlign:l,yAlign:o}=this,{x:h,y:f}=t,{width:x,height:g}=a,{topLeft:p,topRight:y,bottomLeft:_,bottomRight:w}=nl(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(h+p,f),o==="top"&&this.drawCaret(t,n,a,r),n.lineTo(h+x-y,f),n.quadraticCurveTo(h+x,f,h+x,f+y),o==="center"&&l==="right"&&this.drawCaret(t,n,a,r),n.lineTo(h+x,f+g-w),n.quadraticCurveTo(h+x,f+g,h+x-w,f+g),o==="bottom"&&this.drawCaret(t,n,a,r),n.lineTo(h+_,f+g),n.quadraticCurveTo(h,f+g,h,f+g-_),o==="center"&&l==="left"&&this.drawCaret(t,n,a,r),n.lineTo(h,f+p),n.quadraticCurveTo(h,f,h+p,f),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(t){const n=this.chart,a=this.$animations,r=a&&a.x,l=a&&a.y;if(r||l){const o=Fo[t.position].call(this,this._active,this._eventPosition);if(!o)return;const h=this._size=Yy(this,t),f=Object.assign({},o,this._size),x=qy(n,t,f),g=$y(t,f,x,n);(r._to!==g.x||l._to!==g.y)&&(this.xAlign=x.xAlign,this.yAlign=x.yAlign,this.width=h.width,this.height=h.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,g))}}_willRender(){return!!this.opacity}draw(t){const n=this.options.setContext(this.getContext());let a=this.opacity;if(!a)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},l={x:this.x,y:this.y};a=Math.abs(a)<.001?0:a;const o=la(n.padding),h=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&h&&(t.save(),t.globalAlpha=a,this.drawBackground(l,t,r,n),H2(t,n.textDirection),l.y+=o.top,this.drawTitle(l,t,n),this.drawBody(l,t,n),this.drawFooter(l,t,n),P2(t,n.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,n){const a=this._active,r=t.map(({datasetIndex:h,index:f})=>{const x=this.chart.getDatasetMeta(h);if(!x)throw new Error("Cannot find a dataset at index "+h);return{datasetIndex:h,element:x.data[f],index:f}}),l=!bh(a,r),o=this._positionChanged(r,n);(l||o)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,n,a=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,l=this._active||[],o=this._getActiveElements(t,l,n,a),h=this._positionChanged(o,t),f=n||!bh(o,l)||h;return f&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,n))),f}_getActiveElements(t,n,a,r){const l=this.options;if(t.type==="mouseout")return[];if(!r)return n.filter(h=>this.chart.data.datasets[h.datasetIndex]&&this.chart.getDatasetMeta(h.datasetIndex).controller.getParsed(h.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,l.mode,l,a);return l.reverse&&o.reverse(),o}_positionChanged(t,n){const{caretX:a,caretY:r,options:l}=this,o=Fo[l.position].call(this,t,n);return o!==!1&&(a!==o.x||r!==o.y)}}Pe(Jd,"positioners",Fo);var $h={id:"tooltip",_element:Jd,positioners:Fo,afterInit(e,t,n){n&&(e.tooltip=new Jd({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:rb},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const rj=(e,t,n,a)=>(typeof t=="string"?(n=e.push(t)-1,a.unshift({index:n,label:t})):isNaN(t)&&(n=null),n);function sj(e,t,n,a){const r=e.indexOf(t);if(r===-1)return rj(e,t,n,a);const l=e.lastIndexOf(t);return r!==l?n:r}const ij=(e,t)=>e===null?null:jn(Math.round(e),0,t);function Jy(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class rc extends gl{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const n=this._addedLabels;if(n.length){const a=this.getLabels();for(const{index:r,label:l}of n)a[r]===l&&a.splice(r,1);this._addedLabels=[]}super.init(t)}parse(t,n){if(rt(t))return null;const a=this.getLabels();return n=isFinite(n)&&a[n]===t?n:sj(a,t,Je(n,t),this._addedLabels),ij(n,a.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:a,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(a=0),n||(r=this.getLabels().length-1)),this.min=a,this.max=r}buildTicks(){const t=this.min,n=this.max,a=this.options.offset,r=[];let l=this.getLabels();l=t===0&&n===l.length-1?l:l.slice(t,n+1),this._valueRange=Math.max(l.length-(a?0:1),1),this._startValue=this.min-(a?.5:0);for(let o=t;o<=n;o++)r.push({value:o});return r}getLabelForValue(t){return Jy.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}Pe(rc,"id","category"),Pe(rc,"defaults",{ticks:{callback:Jy}});function lj(e,t){const n=[],{bounds:r,step:l,min:o,max:h,precision:f,count:x,maxTicks:g,maxDigits:p,includeBounds:y}=e,_=l||1,w=g-1,{min:b,max:T}=t,S=!rt(o),E=!rt(h),C=!rt(x),A=(T-b)/(p+1);let F=ty((T-b)/w/_)*_,K,O,P,M;if(F<1e-14&&!S&&!E)return[{value:b},{value:T}];M=Math.ceil(T/F)-Math.floor(b/F),M>w&&(F=ty(M*F/w/_)*_),rt(f)||(K=Math.pow(10,f),F=Math.ceil(F*K)/K),r==="ticks"?(O=Math.floor(b/F)*F,P=Math.ceil(T/F)*F):(O=b,P=T),S&&E&&l&&AN((h-o)/l,F/1e3)?(M=Math.round(Math.min((h-o)/F,g)),F=(h-o)/M,O=o,P=h):C?(O=S?o:O,P=E?h:P,M=x-1,F=(P-O)/M):(M=(P-O)/F,Po(M,Math.round(M),F/1e3)?M=Math.round(M):M=Math.ceil(M));const B=Math.max(ny(F),ny(O));K=Math.pow(10,rt(f)?B:f),O=Math.round(O*K)/K,P=Math.round(P*K)/K;let I=0;for(S&&(y&&O!==o?(n.push({value:o}),O<o&&I++,Po(Math.round((O+I*F)*K)/K,o,ev(o,A,e))&&I++):O<o&&I++);I<M;++I){const te=Math.round((O+I*F)*K)/K;if(E&&te>h)break;n.push({value:te})}return E&&y&&P!==h?n.length&&Po(n[n.length-1].value,h,ev(h,A,e))?n[n.length-1].value=h:n.push({value:h}):(!E||P===h)&&n.push({value:P}),n}function ev(e,t,{horizontal:n,minRotation:a}){const r=Tr(a),l=(n?Math.sin(r):Math.cos(r))||.001,o=.75*t*(""+e).length;return Math.min(t/l,o)}class oj extends gl{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,n){return rt(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:n,maxDefined:a}=this.getUserBounds();let{min:r,max:l}=this;const o=f=>r=n?r:f,h=f=>l=a?l:f;if(t){const f=Ja(r),x=Ja(l);f<0&&x<0?h(0):f>0&&x>0&&o(0)}if(r===l){let f=l===0?1:Math.abs(l*.05);h(l+f),t||o(r-f)}this.min=r,this.max=l}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:n,stepSize:a}=t,r;return a?(r=Math.ceil(this.max/a)-Math.floor(this.min/a)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${a} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,n=t.ticks;let a=this.getTickLimit();a=Math.max(2,a);const r={maxTicks:a,bounds:t.bounds,min:t.min,max:t.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},l=this._range||this,o=lj(r,l);return t.bounds==="ticks"&&DN(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let n=this.min,a=this.max;if(super.configure(),this.options.offset&&t.length){const r=(a-n)/Math.max(t.length-1,1)/2;n-=r,a+=r}this._startValue=n,this._endValue=a,this._valueRange=a-n}getLabelForValue(t){return bx(t,this.chart.options.locale,this.options.ticks.format)}}class sc extends oj{determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=Sa(t)?t:0,this.max=Sa(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),n=t?this.width:this.height,a=Tr(this.options.ticks.minRotation),r=(t?Math.sin(a):Math.cos(a))||.001,l=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,l.lineHeight/r))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}Pe(sc,"id","linear"),Pe(sc,"defaults",{ticks:{callback:A2.formatters.numeric}});const Qh={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Wn=Object.keys(Qh);function tv(e,t){return e-t}function nv(e,t){if(rt(t))return null;const n=e._adapter,{parser:a,round:r,isoWeekday:l}=e._parseOpts;let o=t;return typeof a=="function"&&(o=a(o)),Sa(o)||(o=typeof a=="string"?n.parse(o,a):n.parse(o)),o===null?null:(r&&(o=r==="week"&&(Jo(l)||l===!0)?n.startOf(o,"isoWeek",l):n.startOf(o,r)),+o)}function av(e,t,n,a){const r=Wn.length;for(let l=Wn.indexOf(e);l<r-1;++l){const o=Qh[Wn[l]],h=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-t)/(h*o.size))<=a)return Wn[l]}return Wn[r-1]}function cj(e,t,n,a,r){for(let l=Wn.length-1;l>=Wn.indexOf(n);l--){const o=Wn[l];if(Qh[o].common&&e._adapter.diff(r,a,o)>=t-1)return o}return Wn[n?Wn.indexOf(n):0]}function uj(e){for(let t=Wn.indexOf(e)+1,n=Wn.length;t<n;++t)if(Qh[Wn[t]].common)return Wn[t]}function rv(e,t,n){if(!n)e[t]=!0;else if(n.length){const{lo:a,hi:r}=px(n,t),l=n[a]>=t?n[a]:n[r];e[l]=!0}}function hj(e,t,n,a){const r=e._adapter,l=+r.startOf(t[0].value,a),o=t[t.length-1].value;let h,f;for(h=l;h<=o;h=+r.add(h,1,a))f=n[h],f>=0&&(t[f].major=!0);return t}function sv(e,t,n){const a=[],r={},l=t.length;let o,h;for(o=0;o<l;++o)h=t[o],r[h]=o,a.push({value:h,major:!1});return l===0||!n?a:hj(e,a,r,n)}class Ch extends gl{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,n={}){const a=t.time||(t.time={}),r=this._adapter=new m3._date(t.adapters.date);r.init(n),Ho(a.displayFormats,r.formats()),this._parseOpts={parser:a.parser,round:a.round,isoWeekday:a.isoWeekday},super.init(t),this._normalized=n.normalized}parse(t,n){return t===void 0?null:nv(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,n=this._adapter,a=t.time.unit||"day";let{min:r,max:l,minDefined:o,maxDefined:h}=this.getUserBounds();function f(x){!o&&!isNaN(x.min)&&(r=Math.min(r,x.min)),!h&&!isNaN(x.max)&&(l=Math.max(l,x.max))}(!o||!h)&&(f(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&f(this.getMinMax(!1))),r=Sa(r)&&!isNaN(r)?r:+n.startOf(Date.now(),a),l=Sa(l)&&!isNaN(l)?l:+n.endOf(Date.now(),a)+1,this.min=Math.min(r,l-1),this.max=Math.max(r+1,l)}_getLabelBounds(){const t=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;return t.length&&(n=t[0],a=t[t.length-1]),{min:n,max:a}}buildTicks(){const t=this.options,n=t.time,a=t.ticks,r=a.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const l=this.min,o=this.max,h=LN(r,l,o);return this._unit=n.unit||(a.autoSkip?av(n.minUnit,this.min,this.max,this._getLabelCapacity(l)):cj(this,h.length,n.minUnit,this.min,this.max)),this._majorUnit=!a.major.enabled||this._unit==="year"?void 0:uj(this._unit),this.initOffsets(r),t.reverse&&h.reverse(),sv(this,h,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let n=0,a=0,r,l;this.options.offset&&t.length&&(r=this.getDecimalForValue(t[0]),t.length===1?n=1-r:n=(this.getDecimalForValue(t[1])-r)/2,l=this.getDecimalForValue(t[t.length-1]),t.length===1?a=l:a=(l-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;n=jn(n,0,o),a=jn(a,0,o),this._offsets={start:n,end:a,factor:1/(n+1+a)}}_generate(){const t=this._adapter,n=this.min,a=this.max,r=this.options,l=r.time,o=l.unit||av(l.minUnit,n,a,this._getLabelCapacity(n)),h=Je(r.ticks.stepSize,1),f=o==="week"?l.isoWeekday:!1,x=Jo(f)||f===!0,g={};let p=n,y,_;if(x&&(p=+t.startOf(p,"isoWeek",f)),p=+t.startOf(p,x?"day":o),t.diff(a,n,o)>1e5*h)throw new Error(n+" and "+a+" are too far apart with stepSize of "+h+" "+o);const w=r.ticks.source==="data"&&this.getDataTimestamps();for(y=p,_=0;y<a;y=+t.add(y,h,o),_++)rv(g,y,w);return(y===a||r.bounds==="ticks"||_===1)&&rv(g,y,w),Object.keys(g).sort(tv).map(b=>+b)}getLabelForValue(t){const n=this._adapter,a=this.options.time;return a.tooltipFormat?n.format(t,a.tooltipFormat):n.format(t,a.displayFormats.datetime)}format(t,n){const r=this.options.time.displayFormats,l=this._unit,o=n||r[l];return this._adapter.format(t,o)}_tickFormatFunction(t,n,a,r){const l=this.options,o=l.ticks.callback;if(o)return jt(o,[t,n,a],this);const h=l.time.displayFormats,f=this._unit,x=this._majorUnit,g=f&&h[f],p=x&&h[x],y=a[n],_=x&&p&&y&&y.major;return this._adapter.format(t,r||(_?p:g))}generateTickLabels(t){let n,a,r;for(n=0,a=t.length;n<a;++n)r=t[n],r.label=this._tickFormatFunction(r.value,n,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const n=this._offsets,a=this.getDecimalForValue(t);return this.getPixelForDecimal((n.start+a)*n.factor)}getValueForPixel(t){const n=this._offsets,a=this.getDecimalForPixel(t)/n.factor-n.end;return this.min+a*(this.max-this.min)}_getLabelSize(t){const n=this.options.ticks,a=this.ctx.measureText(t).width,r=Tr(this.isHorizontal()?n.maxRotation:n.minRotation),l=Math.cos(r),o=Math.sin(r),h=this._resolveTickFontOptions(0).size;return{w:a*l+h*o,h:a*o+h*l}}_getLabelCapacity(t){const n=this.options.time,a=n.displayFormats,r=a[n.unit]||a.millisecond,l=this._tickFormatFunction(t,0,sv(this,[t],this._majorUnit),r),o=this._getLabelSize(l),h=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return h>0?h:1}getDataTimestamps(){let t=this._cache.data||[],n,a;if(t.length)return t;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,a=r.length;n<a;++n)t=t.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let n,a;if(t.length)return t;const r=this.getLabels();for(n=0,a=r.length;n<a;++n)t.push(nv(this,r[n]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return C2(t.sort(tv))}}Pe(Ch,"id","time"),Pe(Ch,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Zu(e,t,n){let a=0,r=e.length-1,l,o,h,f;n?(t>=e[a].pos&&t<=e[r].pos&&({lo:a,hi:r}=Ys(e,"pos",t)),{pos:l,time:h}=e[a],{pos:o,time:f}=e[r]):(t>=e[a].time&&t<=e[r].time&&({lo:a,hi:r}=Ys(e,"time",t)),{time:l,pos:h}=e[a],{time:o,pos:f}=e[r]);const x=o-l;return x?h+(f-h)*(t-l)/x:h}class iv extends Ch{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(t);this._minPos=Zu(n,this.min),this._tableRange=Zu(n,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:n,max:a}=this,r=[],l=[];let o,h,f,x,g;for(o=0,h=t.length;o<h;++o)x=t[o],x>=n&&x<=a&&r.push(x);if(r.length<2)return[{time:n,pos:0},{time:a,pos:1}];for(o=0,h=r.length;o<h;++o)g=r[o+1],f=r[o-1],x=r[o],Math.round((g+f)/2)!==x&&l.push({time:x,pos:o/(h-1)});return l}_generate(){const t=this.min,n=this.max;let a=super.getDataTimestamps();return(!a.includes(t)||!a.length)&&a.splice(0,0,t),(!a.includes(n)||a.length===1)&&a.push(n),a.sort((r,l)=>r-l)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const n=this.getDataTimestamps(),a=this.getLabelTimestamps();return n.length&&a.length?t=this.normalize(n.concat(a)):t=n.length?n:a,t=this._cache.all=t,t}getDecimalForValue(t){return(Zu(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const n=this._offsets,a=this.getDecimalForPixel(t)/n.factor-n.end;return Zu(this._table,a*this._tableRange+this._minPos,!0)}}Pe(iv,"id","timeseries"),Pe(iv,"defaults",Ch.defaults);const sb="label";function lv(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function fj(e,t){const n=e.options;n&&t&&Object.assign(n,t)}function ib(e,t){e.labels=t}function lb(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:sb;const a=[];e.datasets=t.map(r=>{const l=e.datasets.find(o=>o[n]===r[n]);return!l||!r.data||a.includes(l)?{...r}:(a.push(l),Object.assign(l,r),l)})}function dj(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:sb;const n={labels:[],datasets:[]};return ib(n,e.labels),lb(n,e.datasets,t),n}function xj(e,t){const{height:n=150,width:a=300,redraw:r=!1,datasetIdKey:l,type:o,data:h,options:f,plugins:x=[],fallbackContent:g,updateMode:p,...y}=e,_=k.useRef(null),w=k.useRef(null),b=()=>{_.current&&(w.current=new ii(_.current,{type:o,data:dj(h,l),options:f&&{...f},plugins:x}),lv(t,w.current))},T=()=>{lv(t,null),w.current&&(w.current.destroy(),w.current=null)};return k.useEffect(()=>{!r&&w.current&&f&&fj(w.current,f)},[r,f]),k.useEffect(()=>{!r&&w.current&&ib(w.current.config.data,h.labels)},[r,h.labels]),k.useEffect(()=>{!r&&w.current&&h.datasets&&lb(w.current.config.data,h.datasets,l)},[r,h.datasets]),k.useEffect(()=>{w.current&&(r?(T(),setTimeout(b)):w.current.update(p))},[r,f,h.labels,h.datasets,p]),k.useEffect(()=>{w.current&&(T(),setTimeout(b))},[o]),k.useEffect(()=>(b(),()=>T()),[]),Uh.createElement("canvas",{ref:_,role:"img",height:n,width:a,...y},g)}const gj=k.forwardRef(xj);function Ax(e,t){return ii.register(t),k.forwardRef((n,a)=>Uh.createElement(gj,{...n,ref:a,type:e}))}const mj=Ax("line",mh),Dx=Ax("bar",gh),ic=Ax("pie",qd);/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var ov=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var e=window.screen;if(e)return(e.deviceXDPI||1)/(e.logicalXDPI||1)}return 1}(),Uo={toTextLines:function(e){var t=[],n;for(e=[].concat(e);e.length;)n=e.pop(),typeof n=="string"?t.unshift.apply(t,n.split(`
`)):Array.isArray(n)?e.push.apply(e,n):rt(e)||t.unshift(""+n);return t},textSize:function(e,t,n){var a=[].concat(t),r=a.length,l=e.font,o=0,h;for(e.font=n.string,h=0;h<r;++h)o=Math.max(e.measureText(a[h]).width,o);return e.font=l,{height:r*n.lineHeight,width:o}},bound:function(e,t,n){return Math.max(e,Math.min(t,n))},arrayDiff:function(e,t){var n=e.slice(),a=[],r,l,o,h;for(r=0,o=t.length;r<o;++r)h=t[r],l=n.indexOf(h),l===-1?a.push([h,1]):n.splice(l,1);for(r=0,o=n.length;r<o;++r)a.push([n[r],-1]);return a},rasterize:function(e){return Math.round(e*ov)/ov}};function Od(e,t){var n=t.x,a=t.y;if(n===null)return{x:0,y:-1};if(a===null)return{x:1,y:0};var r=e.x-n,l=e.y-a,o=Math.sqrt(r*r+l*l);return{x:o?r/o:0,y:o?l/o:-1}}function pj(e,t,n,a,r){switch(r){case"center":n=a=0;break;case"bottom":n=0,a=1;break;case"right":n=1,a=0;break;case"left":n=-1,a=0;break;case"top":n=0,a=-1;break;case"start":n=-n,a=-a;break;case"end":break;default:r*=Math.PI/180,n=Math.cos(r),a=Math.sin(r);break}return{x:e,y:t,vx:n,vy:a}}var yj=0,ob=1,cb=2,ub=4,hb=8;function Ju(e,t,n){var a=yj;return e<n.left?a|=ob:e>n.right&&(a|=cb),t<n.top?a|=hb:t>n.bottom&&(a|=ub),a}function vj(e,t){for(var n=e.x0,a=e.y0,r=e.x1,l=e.y1,o=Ju(n,a,t),h=Ju(r,l,t),f,x,g;!(!(o|h)||o&h);)f=o||h,f&hb?(x=n+(r-n)*(t.top-a)/(l-a),g=t.top):f&ub?(x=n+(r-n)*(t.bottom-a)/(l-a),g=t.bottom):f&cb?(g=a+(l-a)*(t.right-n)/(r-n),x=t.right):f&ob&&(g=a+(l-a)*(t.left-n)/(r-n),x=t.left),f===o?(n=x,a=g,o=Ju(n,a,t)):(r=x,l=g,h=Ju(r,l,t));return{x0:n,x1:r,y0:a,y1:l}}function eh(e,t){var n=t.anchor,a=e,r,l;return t.clamp&&(a=vj(a,t.area)),n==="start"?(r=a.x0,l=a.y0):n==="end"?(r=a.x1,l=a.y1):(r=(a.x0+a.x1)/2,l=(a.y0+a.y1)/2),pj(r,l,e.vx,e.vy,t.align)}var th={arc:function(e,t){var n=(e.startAngle+e.endAngle)/2,a=Math.cos(n),r=Math.sin(n),l=e.innerRadius,o=e.outerRadius;return eh({x0:e.x+a*l,y0:e.y+r*l,x1:e.x+a*o,y1:e.y+r*o,vx:a,vy:r},t)},point:function(e,t){var n=Od(e,t.origin),a=n.x*e.options.radius,r=n.y*e.options.radius;return eh({x0:e.x-a,y0:e.y-r,x1:e.x+a,y1:e.y+r,vx:n.x,vy:n.y},t)},bar:function(e,t){var n=Od(e,t.origin),a=e.x,r=e.y,l=0,o=0;return e.horizontal?(a=Math.min(e.x,e.base),l=Math.abs(e.base-e.x)):(r=Math.min(e.y,e.base),o=Math.abs(e.base-e.y)),eh({x0:a,y0:r+o,x1:a+l,y1:r,vx:n.x,vy:n.y},t)},fallback:function(e,t){var n=Od(e,t.origin);return eh({x0:e.x,y0:e.y,x1:e.x+(e.width||0),y1:e.y+(e.height||0),vx:n.x,vy:n.y},t)}},Nr=Uo.rasterize;function bj(e){var t=e.borderWidth||0,n=e.padding,a=e.size.height,r=e.size.width,l=-r/2,o=-a/2;return{frame:{x:l-n.left-t,y:o-n.top-t,w:r+n.width+t*2,h:a+n.height+t*2},text:{x:l,y:o,w:r,h:a}}}function _j(e,t){var n=t.chart.getDatasetMeta(t.datasetIndex).vScale;if(!n)return null;if(n.xCenter!==void 0&&n.yCenter!==void 0)return{x:n.xCenter,y:n.yCenter};var a=n.getBasePixel();return e.horizontal?{x:a,y:null}:{x:null,y:a}}function wj(e){return e instanceof Sr?th.arc:e instanceof rl?th.point:e instanceof Zs?th.bar:th.fallback}function Tj(e,t,n,a,r,l){var o=Math.PI/2;if(l){var h=Math.min(l,r/2,a/2),f=t+h,x=n+h,g=t+a-h,p=n+r-h;e.moveTo(t,x),f<g&&x<p?(e.arc(f,x,h,-Math.PI,-o),e.arc(g,x,h,-o,0),e.arc(g,p,h,0,o),e.arc(f,p,h,o,Math.PI)):f<g?(e.moveTo(f,n),e.arc(g,x,h,-o,o),e.arc(f,x,h,o,Math.PI+o)):x<p?(e.arc(f,x,h,-Math.PI,0),e.arc(f,p,h,0,Math.PI)):e.arc(f,x,h,-Math.PI,Math.PI),e.closePath(),e.moveTo(t,n)}else e.rect(t,n,a,r)}function Sj(e,t,n){var a=n.backgroundColor,r=n.borderColor,l=n.borderWidth;!a&&(!r||!l)||(e.beginPath(),Tj(e,Nr(t.x)+l/2,Nr(t.y)+l/2,Nr(t.w)-l,Nr(t.h)-l,n.borderRadius),e.closePath(),a&&(e.fillStyle=a,e.fill()),r&&l&&(e.strokeStyle=r,e.lineWidth=l,e.lineJoin="miter",e.stroke()))}function Nj(e,t,n){var a=n.lineHeight,r=e.w,l=e.x,o=e.y+a/2;return t==="center"?l+=r/2:(t==="end"||t==="right")&&(l+=r),{h:a,w:r,x:l,y:o}}function Ej(e,t,n){var a=e.shadowBlur,r=n.stroked,l=Nr(n.x),o=Nr(n.y),h=Nr(n.w);r&&e.strokeText(t,l,o,h),n.filled&&(a&&r&&(e.shadowBlur=0),e.fillText(t,l,o,h),a&&r&&(e.shadowBlur=a))}function Cj(e,t,n,a){var r=a.textAlign,l=a.color,o=!!l,h=a.font,f=t.length,x=a.textStrokeColor,g=a.textStrokeWidth,p=x&&g,y;if(!(!f||!o&&!p))for(n=Nj(n,r,h),e.font=h.string,e.textAlign=r,e.textBaseline="middle",e.shadowBlur=a.textShadowBlur,e.shadowColor=a.textShadowColor,o&&(e.fillStyle=l),p&&(e.lineJoin="round",e.lineWidth=g,e.strokeStyle=x),y=0,f=t.length;y<f;++y)Ej(e,t[y],{stroked:p,filled:o,w:n.w,x:n.x,y:n.y+n.h*y})}var fb=function(e,t,n,a){var r=this;r._config=e,r._index=a,r._model=null,r._rects=null,r._ctx=t,r._el=n};er(fb.prototype,{_modelize:function(e,t,n,a){var r=this,l=r._index,o=_n(Rt([n.font,{}],a,l)),h=Rt([n.color,zt.color],a,l);return{align:Rt([n.align,"center"],a,l),anchor:Rt([n.anchor,"center"],a,l),area:a.chart.chartArea,backgroundColor:Rt([n.backgroundColor,null],a,l),borderColor:Rt([n.borderColor,null],a,l),borderRadius:Rt([n.borderRadius,0],a,l),borderWidth:Rt([n.borderWidth,0],a,l),clamp:Rt([n.clamp,!1],a,l),clip:Rt([n.clip,!1],a,l),color:h,display:e,font:o,lines:t,offset:Rt([n.offset,4],a,l),opacity:Rt([n.opacity,1],a,l),origin:_j(r._el,a),padding:la(Rt([n.padding,4],a,l)),positioner:wj(r._el),rotation:Rt([n.rotation,0],a,l)*(Math.PI/180),size:Uo.textSize(r._ctx,t,o),textAlign:Rt([n.textAlign,"start"],a,l),textShadowBlur:Rt([n.textShadowBlur,0],a,l),textShadowColor:Rt([n.textShadowColor,h],a,l),textStrokeColor:Rt([n.textStrokeColor,h],a,l),textStrokeWidth:Rt([n.textStrokeWidth,0],a,l)}},update:function(e){var t=this,n=null,a=null,r=t._index,l=t._config,o,h,f,x=Rt([l.display,!0],e,r);x&&(o=e.dataset.data[r],h=Je(jt(l.formatter,[o,e]),o),f=rt(h)?[]:Uo.toTextLines(h),f.length&&(n=t._modelize(x,f,l,e),a=bj(n))),t._model=n,t._rects=a},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(e,t){var n=this,a=e.ctx,r=n._model,l=n._rects,o;this.visible()&&(a.save(),r.clip&&(o=r.area,a.beginPath(),a.rect(o.left,o.top,o.right-o.left,o.bottom-o.top),a.clip()),a.globalAlpha=Uo.bound(0,r.opacity,1),a.translate(Nr(t.x),Nr(t.y)),a.rotate(r.rotation),Sj(a,l.frame,r),Cj(a,r.lines,l.text,r),a.restore())}});var jj=Number.MIN_SAFE_INTEGER||-9007199254740991,kj=Number.MAX_SAFE_INTEGER||9007199254740991;function jo(e,t,n){var a=Math.cos(n),r=Math.sin(n),l=t.x,o=t.y;return{x:l+a*(e.x-l)-r*(e.y-o),y:o+r*(e.x-l)+a*(e.y-o)}}function cv(e,t){var n=kj,a=jj,r=t.origin,l,o,h,f,x;for(l=0;l<e.length;++l)o=e[l],h=o.x-r.x,f=o.y-r.y,x=t.vx*h+t.vy*f,n=Math.min(n,x),a=Math.max(a,x);return{min:n,max:a}}function nh(e,t){var n=t.x-e.x,a=t.y-e.y,r=Math.sqrt(n*n+a*a);return{vx:(t.x-e.x)/r,vy:(t.y-e.y)/r,origin:e,ln:r}}var db=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};er(db.prototype,{center:function(){var e=this._rect;return{x:e.x+e.w/2,y:e.y+e.h/2}},update:function(e,t,n){this._rotation=n,this._rect={x:t.x+e.x,y:t.y+e.y,w:t.w,h:t.h}},contains:function(e){var t=this,n=1,a=t._rect;return e=jo(e,t.center(),-t._rotation),!(e.x<a.x-n||e.y<a.y-n||e.x>a.x+a.w+n*2||e.y>a.y+a.h+n*2)},intersects:function(e){var t=this._points(),n=e._points(),a=[nh(t[0],t[1]),nh(t[0],t[3])],r,l,o;for(this._rotation!==e._rotation&&a.push(nh(n[0],n[1]),nh(n[0],n[3])),r=0;r<a.length;++r)if(l=cv(t,a[r]),o=cv(n,a[r]),l.max<o.min||o.max<l.min)return!1;return!0},_points:function(){var e=this,t=e._rect,n=e._rotation,a=e.center();return[jo({x:t.x,y:t.y},a,n),jo({x:t.x+t.w,y:t.y},a,n),jo({x:t.x+t.w,y:t.y+t.h},a,n),jo({x:t.x,y:t.y+t.h},a,n)]}});function xb(e,t,n){var a=t.positioner(e,t),r=a.vx,l=a.vy;if(!r&&!l)return{x:a.x,y:a.y};var o=n.w,h=n.h,f=t.rotation,x=Math.abs(o/2*Math.cos(f))+Math.abs(h/2*Math.sin(f)),g=Math.abs(o/2*Math.sin(f))+Math.abs(h/2*Math.cos(f)),p=1/Math.max(Math.abs(r),Math.abs(l));return x*=r*p,g*=l*p,x+=t.offset*r,g+=t.offset*l,{x:a.x+x,y:a.y+g}}function Aj(e,t){var n,a,r,l;for(n=e.length-1;n>=0;--n)for(r=e[n].$layout,a=n-1;a>=0&&r._visible;--a)l=e[a].$layout,l._visible&&r._box.intersects(l._box)&&t(r,l);return e}function Dj(e){var t,n,a,r,l,o,h;for(t=0,n=e.length;t<n;++t)a=e[t],r=a.$layout,r._visible&&(h=new Proxy(a._el,{get:(f,x)=>f.getProps([x],!0)[x]}),l=a.geometry(),o=xb(h,a.model(),l),r._box.update(o,l,a.rotation()));return Aj(e,function(f,x){var g=f._hidable,p=x._hidable;g&&p||p?x._visible=!1:g&&(f._visible=!1)})}var Vo={prepare:function(e){var t=[],n,a,r,l,o;for(n=0,r=e.length;n<r;++n)for(a=0,l=e[n].length;a<l;++a)o=e[n][a],t.push(o),o.$layout={_box:new db,_hidable:!1,_visible:!0,_set:n,_idx:o._index};return t.sort(function(h,f){var x=h.$layout,g=f.$layout;return x._idx===g._idx?g._set-x._set:g._idx-x._idx}),this.update(t),t},update:function(e){var t=!1,n,a,r,l,o;for(n=0,a=e.length;n<a;++n)r=e[n],l=r.model(),o=r.$layout,o._hidable=l&&l.display==="auto",o._visible=r.visible(),t|=o._hidable;t&&Dj(e)},lookup:function(e,t){var n,a;for(n=e.length-1;n>=0;--n)if(a=e[n].$layout,a&&a._visible&&a._box.contains(t))return e[n];return null},draw:function(e,t){var n,a,r,l,o,h;for(n=0,a=t.length;n<a;++n)r=t[n],l=r.$layout,l._visible&&(o=r.geometry(),h=xb(r._el,r.model(),o),l._box.update(h,o,r.rotation()),r.draw(e,h))}},Oj=function(e){if(rt(e))return null;var t=e,n,a,r;if(it(e))if(!rt(e.label))t=e.label;else if(!rt(e.r))t=e.r;else for(t="",n=Object.keys(e),r=0,a=n.length;r<a;++r)t+=(r!==0?", ":"")+n[r]+": "+e[n[r]];return""+t},Mj={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:Oj,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},Vn="$datalabels",gb="$default";function Rj(e,t){var n=e.datalabels,a={},r=[],l,o;return n===!1?null:(n===!0&&(n={}),t=er({},[t,n]),l=t.labels||{},o=Object.keys(l),delete t.labels,o.length?o.forEach(function(h){l[h]&&r.push(er({},[t,l[h],{_key:h}]))}):r.push(t),a=r.reduce(function(h,f){return dt(f.listeners||{},function(x,g){h[g]=h[g]||{},h[g][f._key||gb]=x}),delete f.listeners,h},{}),{labels:r,listeners:a})}function ex(e,t,n,a){if(t){var r=n.$context,l=n.$groups,o;t[l._set]&&(o=t[l._set][l._key],o&&jt(o,[r,a])===!0&&(e[Vn]._dirty=!0,n.update(r)))}}function Fj(e,t,n,a,r){var l,o;!n&&!a||(n?a?n!==a&&(o=l=!0):o=!0:l=!0,o&&ex(e,t.leave,n,r),l&&ex(e,t.enter,a,r))}function Lj(e,t){var n=e[Vn],a=n._listeners,r,l;if(!(!a.enter&&!a.leave)){if(t.type==="mousemove")l=Vo.lookup(n._labels,t);else if(t.type!=="mouseout")return;r=n._hovered,n._hovered=l,Fj(e,a,r,l,t)}}function Bj(e,t){var n=e[Vn],a=n._listeners.click,r=a&&Vo.lookup(n._labels,t);r&&ex(e,a,r,t)}var Cr={id:"datalabels",defaults:Mj,beforeInit:function(e){e[Vn]={_actives:[]}},beforeUpdate:function(e){var t=e[Vn];t._listened=!1,t._listeners={},t._datasets=[],t._labels=[]},afterDatasetUpdate:function(e,t,n){var a=t.index,r=e[Vn],l=r._datasets[a]=[],o=e.isDatasetVisible(a),h=e.data.datasets[a],f=Rj(h,n),x=t.meta.data||[],g=e.ctx,p,y,_,w,b,T,S,E;for(g.save(),p=0,_=x.length;p<_;++p)if(S=x[p],S[Vn]=[],o&&S&&e.getDataVisibility(p)&&!S.skip)for(y=0,w=f.labels.length;y<w;++y)b=f.labels[y],T=b._key,E=new fb(b,g,S,p),E.$groups={_set:a,_key:T||gb},E.$context={active:!1,chart:e,dataIndex:p,dataset:h,datasetIndex:a},E.update(E.$context),S[Vn].push(E),l.push(E);g.restore(),er(r._listeners,f.listeners,{merger:function(C,A,F){A[C]=A[C]||{},A[C][t.index]=F[C],r._listened=!0}})},afterUpdate:function(e){e[Vn]._labels=Vo.prepare(e[Vn]._datasets)},afterDatasetsDraw:function(e){Vo.draw(e,e[Vn]._labels)},beforeEvent:function(e,t){if(e[Vn]._listened){var n=t.event;switch(n.type){case"mousemove":case"mouseout":Lj(e,n);break;case"click":Bj(e,n);break}}},afterEvent:function(e){var t=e[Vn],n=t._actives,a=t._actives=e.getActiveElements(),r=Uo.arrayDiff(n,a),l,o,h,f,x,g,p;for(l=0,o=r.length;l<o;++l)if(x=r[l],x[1])for(p=x[0].element[Vn]||[],h=0,f=p.length;h<f;++h)g=p[h],g.$context.active=x[1]===1,g.update(g.$context);(t._dirty||r.length)&&(Vo.update(t._labels),e.render()),delete t._dirty}};ii.register(Sr,$h,qh,Cr);const Hj=()=>{const e={labels:["Số hộ đã nộp","Số hộ chưa nộp"],datasets:[{label:"Tỷ lệ hộ",data:[75,25],backgroundColor:["#2196F3","#E0E0E0"],borderColor:["#ffffff","#ffffff"],borderWidth:2}]},t={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"right",align:"center"},datalabels:{color:"#ffffff",formatter:(n,a)=>{const r=a.chart.data.datasets[0].data.reduce((o,h)=>o+h,0);return(n/r*100).toFixed(1)+"%"},font:{weight:"bold"}}},layout:{padding:{left:0,right:16,top:0,bottom:0}}};return u.jsx(kn,{role:"ketoan",children:u.jsxs("div",{className:"flex flex-col gap-8",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"TRANG CHỦ"}),u.jsx("p",{className:"text-base text-gray-600 mt-2",children:"Chào mừng đến với Hệ thống Quản lý Thu phí Chung cư"})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6 flex flex-col gap-4",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Tỷ lệ (%) hộ đã nộp / chưa nộp trong đợt thu tháng 5"}),u.jsx("div",{className:"w-full h-64 flex items-center justify-center",children:u.jsx(ic,{data:e,options:t})})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6 flex flex-col gap-4",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Doanh thu của đợt thu tháng 5"}),u.jsx("div",{className:"w-full overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tên khoản thu"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thời gian"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Đã thu"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tỷ lệ"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trạng thái"})]})}),u.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[u.jsxs("tr",{children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Phí chung cư tháng 5/2025"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"01/05 - 31/05/2025"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"102,650,234 VND"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"89,6%"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-green-600",children:"Đang thu"})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Phí chung cư tháng 4/2025"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"01/04 - 30/04/2025"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"123,654,259 VND"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"100%"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-red-600",children:"Đã thu xong"})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Phí chung cư tháng 3/2025"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"01/03 - 31/03/2025"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"113,276,093 VND"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"100%"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-red-600",children:"Đã thu xong"})]})]})]})})]})]})})};ii.register(rc,sc,Zs,Sr,$h,qh,Cr);const Pj=()=>{const[e,t]=k.useState(!0),[n,a]=k.useState(0),[r,l]=k.useState(0),[o,h]=k.useState({labels:["0-10","10-20","20-30","30-40","40-50","50-60","> 60"],datasets:[{label:"Số lượng",data:[0,0,0,0,0,0,0],backgroundColor:"#77A1EA",borderColor:"#1976D2",borderWidth:1,borderRadius:4}]}),[f,x]=k.useState({labels:["Nam","Nữ"],datasets:[{label:"Tỷ lệ",data:[50,50],backgroundColor:["#2196F3","#ffffff"],borderColor:["#2196F3","#cccccc"],borderWidth:2}]});k.useEffect(()=>{(async()=>{var w;try{t(!0);const[b,T,S,E]=await Promise.all([Do.getGenderStatistics(),Do.getAgeStatistics(),Do.getTotalResidents(),Do.getTemporaryStatusStatistics()]);if(S.success&&a(((w=S.data.pagination)==null?void 0:w.totalItems)||0),E.statistics){const C=E.statistics.temporaryStatus;l(C.total||0)}if(b.statistics){const C=b.statistics.byGender.find(F=>F.gender.toLowerCase().includes("nam")),A=b.statistics.byGender.find(F=>F.gender.toLowerCase().includes("nữ"));x({labels:["Nam","Nữ"],datasets:[{label:"Tỷ lệ",data:[(C==null?void 0:C.percentage)||0,(A==null?void 0:A.percentage)||0],backgroundColor:["#2196F3","#ffffff"],borderColor:["#2196F3","#cccccc"],borderWidth:2}]})}if(T.statistics){const C=T.statistics.byAgeGroup,A=C.map(K=>K.maxAge>=150?`${K.minAge}+`:`${K.minAge}-${K.maxAge}`),F=C.map(K=>K.count);h({labels:A,datasets:[{label:"Số lượng",data:F,backgroundColor:"#77A1EA",borderColor:"#1976D2",borderWidth:1,borderRadius:4}]})}}catch(b){console.error("Error fetching homepage data:",b)}finally{t(!1)}})()},[]);const g=Math.max(...o.datasets[0].data)+100,p={responsive:!0,plugins:{legend:{display:!1},datalabels:{anchor:"end",align:"top",clamp:!0,color:"#222",font:{weight:"bold",size:16},formatter:_=>_},title:{display:!1}},scales:{y:{beginAtZero:!0,max:g,ticks:{stepSize:100},title:{display:!1}},x:{title:{display:!1}}}},y={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},datalabels:{color:"#222",font:{weight:"bold",size:16},formatter:(_,w)=>{const b=w.chart.data.datasets[0].data.reduce((S,E)=>S+E,0);return(_/b*100).toFixed(0)+"%"}}}};return e?u.jsx(kn,{role:"totruong",children:u.jsxs("div",{className:"flex flex-col gap-8",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"TRANG CHỦ"}),u.jsx("p",{className:"text-base text-gray-600 mt-2",children:"Đang tải dữ liệu..."})]}),u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"text-gray-500",children:"Đang tải thống kê..."})})]})}):u.jsx(kn,{role:"totruong",children:u.jsxs("div",{className:"flex flex-col gap-8",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"TRANG CHỦ"}),u.jsx("p",{className:"text-base text-gray-600 mt-2",children:"Chào mừng đến với Hệ thống Quản lý Thu phí Chung cư"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6 flex flex-col gap-4",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Tổng số Nhân khẩu"}),u.jsxs("div",{className:"flex items-baseline gap-2",children:[u.jsx("span",{className:"text-5xl font-bold text-blue-600",children:n.toLocaleString()}),u.jsx("span",{className:"text-xl text-gray-700",children:"nhân khẩu"})]})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6 flex flex-col gap-4",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Đang tạm trú/tạm vắng"}),u.jsxs("div",{className:"flex items-baseline gap-2",children:[u.jsx("span",{className:"text-5xl font-bold text-blue-600",children:r}),u.jsx("span",{className:"text-xl text-gray-700",children:"nhân khẩu"})]})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6 flex flex-col gap-10",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Phân phối nhân khẩu theo độ tuổi"}),u.jsx("div",{className:"w-full h-64",children:u.jsx(Dx,{data:o,options:p,plugins:[Cr]})})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6 flex flex-col gap-4",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Tỷ lệ (%) nam/nữ trong toàn khu chung cư"}),u.jsx("div",{className:"w-full h-64 flex items-center justify-center",children:u.jsx(ic,{data:f,options:y,plugins:[Cr]})}),u.jsxs("div",{className:"flex gap-4 justify-center mt-2",children:[u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{className:"w-4 h-4 bg-blue-500 rounded-full inline-block"}),u.jsx("span",{className:"text-sm text-gray-700",children:"Nam"})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{className:"w-4 h-4 bg-white border border-gray-400 rounded-full inline-block"}),u.jsx("span",{className:"text-sm text-gray-700",children:"Nữ"})]})]})]})]})]})})},mb=({isOpen:e,onClose:t,onAdd:n,householdId:a})=>{const[r,l]=k.useState([]),[o,h]=k.useState(!1),[f,x]=k.useState(""),[g,p]=k.useState({selectedResidentId:"",quanHeVoiChuHo:"",ngayThem:""});k.useEffect(()=>{e&&y()},[e]);const y=async()=>{try{h(!0),x("");const b=await Gn.getAvailable();b.success?l(b.data):x("Không thể lấy danh sách nhân khẩu")}catch(b){console.error("Error fetching available residents:",b),x(b.message||"Có lỗi xảy ra khi lấy danh sách nhân khẩu")}finally{h(!1)}},_=b=>{const{name:T,value:S}=b.target;p(E=>({...E,[T]:S}))},w=async b=>{if(b.preventDefault(),x(""),!g.selectedResidentId||!g.quanHeVoiChuHo||!g.ngayThem){x("Vui lòng điền đầy đủ thông tin");return}const T=r.find(S=>S.id.toString()===g.selectedResidentId);if(!T){x("Nhân khẩu không hợp lệ");return}try{h(!0),a&&await Gn.addToHousehold({residentId:T.id,householdId:a,quanHeVoiChuHo:g.quanHeVoiChuHo,ngayThem:g.ngayThem}),n({residentId:T.id,tenNhanKhau:T.name,quanHeVoiChuHo:g.quanHeVoiChuHo,ngayThem:g.ngayThem}),p({selectedResidentId:"",quanHeVoiChuHo:"",ngayThem:""}),t()}catch(S){console.error("Error adding resident to household:",S),x(S.message||"Có lỗi xảy ra khi thêm nhân khẩu vào hộ khẩu")}finally{h(!1)}};return e?u.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md max-h-[90vh] overflow-y-auto relative",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Thêm Nhân khẩu vào Hộ khẩu"}),u.jsx("button",{onClick:t,className:"w-10 h-10 flex items-center justify-center rounded-full bg-gray-100 hover:bg-gray-200 transition",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("form",{onSubmit:w,className:"space-y-6",children:[f&&u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:u.jsx("p",{className:"text-red-700 text-sm",children:f})}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Nhân khẩu ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsxs("select",{name:"selectedResidentId",value:g.selectedResidentId,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none appearance-none",required:!0,disabled:o,children:[u.jsx("option",{value:"",children:o?"Đang tải...":"Chọn nhân khẩu"}),r.map(b=>u.jsxs("option",{value:b.id.toString(),children:[b.name," - ",b.cccd]},b.id)),r.length===0&&!o&&u.jsx("option",{value:"",disabled:!0,children:"Không có nhân khẩu khả dụng"})]}),r.length===0&&!o&&u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Tất cả nhân khẩu đã được phân bổ vào các hộ khẩu"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Quan hệ với chủ hộ ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsxs("select",{name:"quanHeVoiChuHo",value:g.quanHeVoiChuHo,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none appearance-none",required:!0,children:[u.jsx("option",{value:"",children:"Chọn quan hệ"}),u.jsx("option",{value:"con",children:"Con"}),u.jsx("option",{value:"vợ/chồng",children:"Vợ/Chồng"}),u.jsx("option",{value:"bố/mẹ",children:"Bố/Mẹ"}),u.jsx("option",{value:"khác",children:"Khác"})]})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Ngày thêm ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"date",name:"ngayThem",value:g.ngayThem,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-4 mt-8",children:[u.jsx("button",{type:"button",onClick:t,className:"px-5 py-2 border border-gray-300 rounded-xl text-gray-700 font-semibold bg-white hover:bg-gray-50 shadow-sm",children:"Hủy"}),u.jsx("button",{type:"submit",disabled:o||r.length===0,className:`px-5 py-2 rounded-xl font-semibold shadow transition ${o||r.length===0?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"}`,children:o?"Đang thêm...":"Thêm"})]})]})]})}):null},Ij=({isOpen:e,onClose:t,householdId:n})=>{var S,E,C,A,F;const[a,r]=k.useState(null),[l,o]=k.useState(!1),[h,f]=k.useState(null),[x,g]=k.useState(!1),[p,y]=k.useState({maHoKhau:"",diaChi:"",lyDoTao:""});k.useEffect(()=>{e&&n&&_()},[e,n]);const _=async()=>{if(n){o(!0),f(null);try{const K=await Ha.getById(n);if(K.success){const O=K.data;r(O),y({maHoKhau:O.maHoKhau,diaChi:O.diaChi,lyDoTao:O.lyDoTao})}}catch(K){f(K instanceof Error?K.message:"Lỗi khi tải thông tin hộ khẩu")}finally{o(!1)}}},w=K=>{const{name:O,value:P}=K.target;y(M=>({...M,[O]:P}))},b=async K=>{if(K.preventDefault(),!!n){o(!0),f(null);try{(await Ha.update(n,p)).success&&t()}catch(O){f(O instanceof Error?O.message:"Lỗi khi cập nhật hộ khẩu")}finally{o(!1)}}},T=K=>new Date(K).toLocaleDateString("vi-VN");return e?u.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-4xl max-h-[90vh] overflow-y-auto relative",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Chỉnh sửa Hộ khẩu"}),u.jsx("button",{onClick:t,className:"w-10 h-10 flex items-center justify-center rounded-full bg-gray-100 hover:bg-gray-200 transition",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l&&u.jsxs("div",{className:"flex items-center justify-center py-12",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"}),u.jsx("span",{className:"ml-3 text-gray-600",children:"Đang tải dữ liệu..."})]}),h&&u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:u.jsx("p",{className:"text-red-600",children:h})}),!l&&a&&u.jsxs("form",{onSubmit:b,className:"space-y-6",children:[u.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Thông tin cơ bản"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Mã hộ khẩu"}),u.jsx("input",{type:"text",name:"maHoKhau",value:p.maHoKhau,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Ngày lập"}),u.jsx("input",{type:"text",value:T(a.ngayLap),disabled:!0,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] bg-gray-100 text-gray-600"})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Địa chỉ"}),u.jsx("input",{type:"text",name:"diaChi",value:p.diaChi,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none"})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Lý do tạo"}),u.jsx("textarea",{name:"lyDoTao",value:p.lyDoTao,onChange:w,rows:3,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none"})]})]})]}),u.jsxs("div",{className:"bg-blue-50 rounded-xl p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Thông tin chủ hộ"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Họ tên"}),u.jsx("input",{type:"text",value:((S=a.chuHo)==null?void 0:S.hoTen)||"",disabled:!0,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] bg-gray-100 text-gray-600"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Ngày sinh"}),u.jsx("input",{type:"text",value:(E=a.chuHo)!=null&&E.ngaySinh?T(a.chuHo.ngaySinh):"",disabled:!0,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] bg-gray-100 text-gray-600"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Giới tính"}),u.jsx("input",{type:"text",value:((C=a.chuHo)==null?void 0:C.gioiTinh)||"",disabled:!0,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] bg-gray-100 text-gray-600"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Số CCCD"}),u.jsx("input",{type:"text",value:((A=a.chuHo)==null?void 0:A.soCCCD)||"",disabled:!0,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] bg-gray-100 text-gray-600"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Số điện thoại"}),u.jsx("input",{type:"text",value:((F=a.chuHo)==null?void 0:F.soDienThoai)||"",disabled:!0,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] bg-gray-100 text-gray-600"})]})]})]}),u.jsxs("div",{className:"bg-green-50 rounded-xl p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Danh sách thành viên (",a.thanhVien.length,")"]}),u.jsxs("button",{type:"button",onClick:()=>g(!0),className:"flex items-center gap-2 bg-green-500 text-white px-4 py-2 rounded-xl font-semibold shadow hover:bg-green-600 transition",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thêm thành viên"]})]}),a.thanhVien.length===0?u.jsx("p",{className:"text-gray-500 text-center py-8",children:"Chưa có thành viên nào trong hộ khẩu"}):u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase",children:"Họ tên"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase",children:"Quan hệ với chủ hộ"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase",children:"Ngày sinh"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase",children:"Giới tính"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase",children:"Ngày vào hộ"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase",children:"Trạng thái"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.thanhVien.map(K=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:K.nhanKhau.hoTen}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:K.quanHeVoiChuHo}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:T(K.nhanKhau.ngaySinh)}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:K.nhanKhau.gioiTinh}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:T(K.ngayVaoHo)}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${K.ngayRoiHo?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:K.ngayRoiHo?"Đã rời hộ":"Đang sinh sống"})})]},K.id))})]})})]}),u.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[u.jsx("button",{type:"button",onClick:t,className:"px-6 py-2 border border-gray-300 rounded-xl text-gray-700 font-semibold hover:bg-gray-50 transition",children:"Hủy"}),u.jsx("button",{type:"submit",disabled:l,className:"px-6 py-2 bg-blue-500 text-white rounded-xl font-semibold hover:bg-blue-600 transition disabled:opacity-50",children:l?"Đang cập nhật...":"Cập nhật"})]})]}),u.jsx(mb,{isOpen:x,onClose:()=>g(!1),onAdd:K=>{console.log("Adding member:",K),g(!1),_()},householdId:n})]})}):null},zj=({isOpen:e,onClose:t,onSuccess:n})=>{const[a,r]=k.useState({maHoKhau:"",soPhong:"",soNha:"",duong:"",phuong:"Nhân Chính",quan:"Thanh Xuân",thanhPho:"Hà Nội",chuHoId:"",ngayLap:new Date().toISOString().split("T")[0]}),[l,o]=k.useState([]),[h,f]=k.useState(!1),[x,g]=k.useState(!1),[p,y]=k.useState(""),[_,w]=k.useState({maHoKhau:!1,soPhong:!1,soNha:!1,duong:!1,chuHoId:!1});k.useEffect(()=>{e&&(S(),T(),b(),y(""))},[e]);const b=()=>{r({maHoKhau:"",soPhong:"",soNha:"",duong:"",phuong:"Nhân Chính",quan:"Thanh Xuân",thanhPho:"Hà Nội",chuHoId:"",ngayLap:new Date().toISOString().split("T")[0]}),w({maHoKhau:!1,soPhong:!1,soNha:!1,duong:!1,chuHoId:!1})},T=()=>{const F=new Date,K=F.getFullYear().toString().slice(-2),O=(F.getMonth()+1).toString().padStart(2,"0"),P=F.getDate().toString().padStart(2,"0"),M=F.getHours().toString().padStart(2,"0"),B=F.getMinutes().toString().padStart(2,"0"),I=`HK${K}${O}${P}${M}${B}`;r(te=>({...te,maHoKhau:I}))},S=async()=>{f(!0);try{const F=await Gn.getAll();F.success&&F.data&&o(F.data.residents||[])}catch(F){console.error("Lỗi khi tải danh sách nhân khẩu:",F),y("Không thể tải danh sách nhân khẩu")}finally{f(!1)}},E=F=>{const{name:K,value:O}=F.target;r(P=>({...P,[K]:O})),_[K]&&w(P=>({...P,[K]:!1}))},C=()=>{const F={maHoKhau:!a.maHoKhau.trim(),soPhong:!a.soPhong.trim(),soNha:!a.soNha.trim(),duong:!a.duong.trim(),chuHoId:!1};return w(F),!Object.values(F).some(K=>K)},A=async F=>{var K,O;if(F.preventDefault(),!C()){y("Vui lòng điền đầy đủ thông tin bắt buộc");return}g(!0),y("");try{const P=`${a.soNha}, ${a.duong}, ${a.phuong}, ${a.quan}, ${a.thanhPho}`,M={chuHoId:a.chuHoId||null,diaChi:P,ngayLap:a.ngayLap,soPhong:a.soPhong},B=await Ha.create(M);B.success?(n&&n(),t()):y(B.message||"Có lỗi xảy ra khi tạo hộ khẩu")}catch(P){console.error("Lỗi khi tạo hộ khẩu:",P),y(((O=(K=P.response)==null?void 0:K.data)==null?void 0:O.message)||"Có lỗi xảy ra khi tạo hộ khẩu")}finally{g(!1)}};return e?u.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-4xl max-h-[90vh] overflow-y-auto relative",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Thêm hộ khẩu mới"}),u.jsx("button",{onClick:t,className:"w-10 h-10 flex items-center justify-center rounded-full bg-gray-100 hover:bg-gray-200 transition",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),p&&u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:u.jsx("p",{className:"text-red-600",children:p})}),u.jsxs("form",{onSubmit:A,className:"space-y-6",children:[u.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Thông tin cơ bản"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Mã hộ khẩu ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",name:"maHoKhau",value:a.maHoKhau,onChange:E,className:`block w-full rounded-xl border px-4 py-2 text-[15px] shadow-sm focus:ring-2 focus:ring-blue-200 outline-none ${_.maHoKhau?"border-red-500":"border-gray-300 focus:border-blue-500"}`,placeholder:"Ví dụ: HK2501120830"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Số phòng ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",name:"soPhong",value:a.soPhong,onChange:E,className:`block w-full rounded-xl border px-4 py-2 text-[15px] shadow-sm focus:ring-2 focus:ring-blue-200 outline-none ${_.soPhong?"border-red-500":"border-gray-300 focus:border-blue-500"}`,placeholder:"Ví dụ: 101, 202, A301..."})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Ngày lập"}),u.jsx("input",{type:"date",name:"ngayLap",value:a.ngayLap,onChange:E,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none"})]})]})]}),u.jsxs("div",{className:"bg-blue-50 rounded-xl p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Thông tin địa chỉ"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Số nhà ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",name:"soNha",value:a.soNha,onChange:E,className:`block w-full rounded-xl border px-4 py-2 text-[15px] shadow-sm focus:ring-2 focus:ring-blue-200 outline-none ${_.soNha?"border-red-500":"border-gray-300 focus:border-blue-500"}`,placeholder:"Ví dụ: 123, 45A, số 67..."})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Đường ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",name:"duong",value:a.duong,onChange:E,className:`block w-full rounded-xl border px-4 py-2 text-[15px] shadow-sm focus:ring-2 focus:ring-blue-200 outline-none ${_.duong?"border-red-500":"border-gray-300 focus:border-blue-500"}`,placeholder:"Ví dụ: Nguyễn Trãi, Lê Lợi..."})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Phường"}),u.jsx("input",{type:"text",name:"phuong",value:a.phuong,onChange:E,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Quận"}),u.jsx("input",{type:"text",name:"quan",value:a.quan,onChange:E,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Thành phố"}),u.jsx("input",{type:"text",name:"thanhPho",value:a.thanhPho,onChange:E,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none"})]})]})]}),u.jsxs("div",{className:"bg-green-50 rounded-xl p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Chủ hộ (tùy chọn)"}),u.jsx("div",{className:"grid grid-cols-1 gap-4",children:u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Chọn chủ hộ"}),u.jsxs("select",{name:"chuHoId",value:a.chuHoId,onChange:E,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none appearance-none",disabled:h,children:[u.jsx("option",{value:"",children:h?"Đang tải...":"Để trống nếu chưa có chủ hộ"}),l.map(F=>u.jsxs("option",{value:F.id,children:[F.hoTen," - ",F.cccd]},F.id))]}),u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Lưu ý: Có thể để trống nếu căn hộ chưa có chủ hộ xác định"})]})})]}),u.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[u.jsx("button",{type:"button",onClick:t,className:"px-6 py-2 border border-gray-300 rounded-xl text-gray-700 font-semibold hover:bg-gray-50 transition",children:"Hủy"}),u.jsx("button",{type:"submit",disabled:x||h,className:"px-6 py-2 bg-blue-500 text-white rounded-xl font-semibold hover:bg-blue-600 transition disabled:opacity-50",children:x?"Đang tạo...":"Tạo hộ khẩu"})]})]})]})}):null},Uj=({isOpen:e,onClose:t,onSuccess:n,currentHousehold:a})=>{var M,B,I,te;const[r,l]=k.useState(null),[o,h]=k.useState(""),[f,x]=k.useState(null),[g,p]=k.useState([]),[y,_]=k.useState(!1),[w,b]=k.useState(!1),[T,S]=k.useState(""),E=a?parseInt(a.soHoKhau.replace("HK","")):null;k.useEffect(()=>{e&&E&&(A(),F()),e||C()},[e,E]);const C=()=>{l(null),h(""),x(null),p([]),S("")},A=async()=>{if(E)try{_(!0),S("");const q=await Ha.getById(E);q.success?x(q.data):S("Không thể tải thông tin hộ khẩu")}catch(q){console.error("Error fetching household data:",q),S("Có lỗi xảy ra khi tải thông tin hộ khẩu")}finally{_(!1)}},F=async()=>{try{const q=await Gn.getAvailable();q.success&&p(q.data||[])}catch(q){console.error("Error fetching available residents:",q)}},K=async()=>{var q,ae;if(!(!r||!E))try{b(!0),S("");const re=await Ha.assignHead(E,r);re.success?(n&&n(),t()):S(re.message||"Có lỗi xảy ra khi gán chủ hộ")}catch(re){console.error("Error assigning household head:",re),S(((ae=(q=re.response)==null?void 0:q.data)==null?void 0:ae.message)||"Có lỗi xảy ra khi gán chủ hộ")}finally{b(!1)}},P=[...((M=f==null?void 0:f.thanhVien)==null?void 0:M.map(q=>({...q.nhanKhau,quanHeVoiChuHo:q.quanHeVoiChuHo,isCurrentMember:!0})).filter(q=>q.hoTen&&q.cccd))||[],...g.map(q=>({...q,quanHeVoiChuHo:"Ngoài hộ",isCurrentMember:!1})).filter(q=>q.hoTen&&q.cccd)].filter(q=>{var ae,re;return((ae=q.hoTen)==null?void 0:ae.toLowerCase().includes(o.toLowerCase()))||!1||((re=q.cccd)==null?void 0:re.includes(o))||!1});return e?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] overflow-hidden",children:[u.jsxs("div",{className:"bg-blue-600 text-white p-4 flex justify-between items-center",children:[u.jsxs("h2",{className:"text-lg font-semibold",children:["Gán/Sửa Chủ Hộ - ",(a==null?void 0:a.soHoKhau)||"N/A"]}),u.jsx("button",{onClick:t,className:"text-white hover:text-gray-200 transition-colors",disabled:w,children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[u.jsx("h3",{className:"text-md font-semibold text-gray-800 mb-2",children:"Thông tin hộ khẩu:"}),u.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[u.jsxs("div",{children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Số hộ khẩu:"})," ",a==null?void 0:a.soHoKhau]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Chủ hộ hiện tại:"})," ",((B=f==null?void 0:f.chuHo)==null?void 0:B.hoTen)||"Chưa có"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"CCCD chủ hộ:"})," ",((I=f==null?void 0:f.chuHo)==null?void 0:I.cccd)||"N/A"]})]}),u.jsxs("div",{children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Địa chỉ:"})," ",(f==null?void 0:f.diaChi)||`${a==null?void 0:a.soNha}, ${a==null?void 0:a.duong}, ${a==null?void 0:a.phuong}`]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Số thành viên:"})," ",((te=f==null?void 0:f.thanhVien)==null?void 0:te.length)||0]})]})]})]}),T&&u.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:u.jsx("p",{className:"text-red-600 text-sm",children:T})}),y&&u.jsx("div",{className:"mb-4 p-4 text-center",children:u.jsx("p",{className:"text-gray-600",children:"Đang tải dữ liệu..."})}),u.jsx("div",{className:"mb-4",children:u.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md shadow-sm overflow-hidden",children:[u.jsx("div",{className:"p-2 text-gray-400",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),u.jsx("input",{type:"text",placeholder:"Tìm kiếm theo tên hoặc CCCD...",className:"flex-1 p-2 border-l border-gray-300 outline-none text-sm",value:o,onChange:q=>h(q.target.value),disabled:y||w})]})}),!y&&u.jsxs("div",{className:"mb-6",children:[u.jsxs("h3",{className:"text-md font-semibold text-gray-800 mb-3",children:["Chọn người làm chủ hộ mới (",P.length," người):"]}),u.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden max-h-96 overflow-y-auto",children:[u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Chọn"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Họ tên"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ngày sinh"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Giới tính"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CCCD"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trạng thái"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map(q=>u.jsxs("tr",{className:`hover:bg-blue-50 cursor-pointer ${r===q.id?"bg-blue-100":""}`,onClick:()=>l(q.id),children:[u.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:u.jsx("input",{type:"radio",name:"selectedMember",value:q.id,checked:r===q.id,onChange:ae=>l(parseInt(ae.target.value)),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300",disabled:w})}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:q.hoTen||"N/A"}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:q.ngaySinh?new Date(q.ngaySinh).toLocaleDateString("vi-VN"):"N/A"}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:q.gioiTinh||"N/A"}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:q.cccd||"N/A"}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:u.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${q.isCurrentMember?q.quanHeVoiChuHo==="chủ hộ"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:q.isCurrentMember?q.quanHeVoiChuHo:"Ngoài hộ"})})]},q.id))})]}),P.length===0&&!y&&u.jsx("div",{className:"p-4 text-center text-gray-500",children:"Không tìm thấy người nào phù hợp"})]})]}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",disabled:w,children:"Hủy"}),u.jsx("button",{onClick:K,disabled:!r||w||y,className:`px-4 py-2 rounded-md transition-colors ${r&&!w&&!y?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:w?"Đang xử lý...":"Gán làm chủ hộ"})]})]})]})}):null},Vj=()=>{var H,Z;const[e,t]=k.useState(!1),[n,a]=k.useState(!1),[r,l]=k.useState(!1),[o,h]=k.useState(!1),[f,x]=k.useState(null),[g,p]=k.useState(null),[y,_]=k.useState(""),[w,b]=k.useState("soHoKhau"),[T,S]=k.useState(!0),[E,C]=k.useState({isOpen:!1,hoKhau:null}),[A,F]=k.useState([]),[K,O]=k.useState(!1),[P,M]=k.useState(null);k.useEffect(()=>{B()},[]);const B=async()=>{O(!0),M(null);try{const j=await Ha.getAll();j.success&&j.data&&j.data.households&&F(j.data.households)}catch(j){M(j instanceof Error?j.message:"Lỗi khi tải danh sách hộ khẩu"),console.error("Error loading households:",j)}finally{O(!1)}},I=(j=void 0)=>{x(j||null),t(!0)},te=()=>{t(!1),x(null),B()},q=()=>{a(!0)},ae=()=>{a(!1),B()},re=j=>{p(j),h(!0)},ee=()=>{h(!1),p(null)},Q=j=>{console.log("Adding member:",j)},me=()=>{B(),ee()},ye=()=>{E.hoKhau&&(console.log("Đã xóa hộ khẩu:",E.hoKhau.soHoKhau),C({isOpen:!1,hoKhau:null}))},de=[...A.filter(j=>{var U;if(!y)return!0;const V=y.toLowerCase();return j.soHoKhau.toString().includes(V)||(((U=j.chuHoInfo)==null?void 0:U.hoTen)||"").toLowerCase().includes(V)||j.soNha.toLowerCase().includes(V)||j.duong.toLowerCase().includes(V)})].sort((j,V)=>{var ie,_e;let U,Te;return w==="chuHo"?(U=((ie=j.chuHoInfo)==null?void 0:ie.hoTen)||"",Te=((_e=V.chuHoInfo)==null?void 0:_e.hoTen)||""):(U=j[w],Te=V[w]),typeof U=="string"&&(U=U.toLowerCase(),Te=Te.toLowerCase()),U<Te?T?-1:1:U>Te?T?1:-1:0});return K?u.jsx(kn,{role:"totruong",children:u.jsx("div",{className:"p-6",children:u.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:u.jsx("div",{className:"text-lg text-gray-600",children:"Đang tải danh sách hộ khẩu..."})})})}):P?u.jsx(kn,{role:"totruong",children:u.jsx("div",{className:"p-6",children:u.jsxs("div",{className:"flex items-center justify-center min-h-[400px]",children:[u.jsxs("div",{className:"text-lg text-red-600",children:["Lỗi: ",P]}),u.jsx("button",{onClick:B,className:"ml-4 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600",children:"Thử lại"})]})})}):u.jsxs(u.Fragment,{children:[u.jsx(kn,{role:"totruong",children:u.jsxs("div",{className:"p-6",children:[u.jsx("div",{className:"flex items-center justify-between mb-6",children:u.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Quản lý hộ khẩu"})}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[u.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md shadow-sm overflow-hidden flex-1",children:[u.jsx("div",{className:"p-2 text-gray-400",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),u.jsx("input",{type:"text",placeholder:"Tìm theo số hộ khẩu, tên chủ hộ",className:"flex-1 p-2 border-l border-gray-300 outline-none text-sm",value:y,onChange:j=>_(j.target.value)})]}),u.jsxs("button",{onClick:q,className:"bg-blue-500 text-white px-4 py-2 rounded-md shadow-sm hover:bg-blue-600 flex items-center gap-2",children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thêm hộ khẩu"]})]}),u.jsxs("div",{className:"mt-6 bg-white rounded-md shadow-md overflow-hidden border border-gray-200",children:[u.jsx("div",{className:"p-4 bg-gray-100 border-b border-gray-200",children:u.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Danh sách hộ khẩu"})}),u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[[{key:"soHoKhau",label:"Sổ hộ khẩu"},{key:"chuHo",label:"Chủ hộ"},{key:"soNha",label:"Số nhà"},{key:"duong",label:"Đường"},{key:"phuong",label:"Phường"},{key:"quan",label:"Quận"},{key:"thanhPho",label:"Thành phố"},{key:"ngayLamHoKhau",label:"Ngày làm hộ khẩu"}].map(j=>u.jsxs("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider cursor-pointer select-none",onClick:()=>{w===j.key?S(!T):(b(j.key),S(!0))},children:[j.label," ",w===j.key?T?"▲":"▼":""]},j.key)),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Thao tác"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:de.map(j=>{var V;return u.jsxs("tr",{className:"hover:bg-blue-50 cursor-pointer",onClick:()=>I(j),children:[u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:["HK",j.soHoKhau.toString().padStart(3,"0")]}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((V=j.chuHoInfo)==null?void 0:V.hoTen)||"N/A"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:j.soNha}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:j.duong}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:j.phuong}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:j.quan}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:j.thanhPho}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:j.ngayLamHoKhau}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-600",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:U=>{U.stopPropagation(),I(j)},className:"p-1 hover:bg-blue-100 rounded transition-colors",title:"Chỉnh sửa hộ khẩu",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),u.jsx("button",{onClick:U=>{U.stopPropagation(),re(j)},className:"p-1 hover:bg-green-100 rounded transition-colors text-green-600",title:"Gán chủ hộ",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),u.jsx("button",{onClick:U=>{U.stopPropagation(),C({isOpen:!0,hoKhau:j})},className:"p-1 hover:bg-red-100 rounded text-red-600",title:"Xoá hộ khẩu",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},j.soHoKhau)})})]})]})]})}),u.jsx(Ij,{isOpen:e,onClose:te,householdId:f?f.soHoKhau:void 0}),u.jsx(zj,{isOpen:n,onClose:ae}),u.jsx(mb,{isOpen:r,onClose:()=>l(!1),onAdd:Q,householdId:f?f.soHoKhau:void 0}),u.jsx(Uj,{isOpen:o,onClose:ee,onSuccess:me,currentHousehold:g?{soHoKhau:`HK${g.soHoKhau.toString().padStart(3,"0")}`,chuHo:((H=g.chuHoInfo)==null?void 0:H.hoTen)||"",soNha:g.soNha,duong:g.duong,phuong:g.phuong,quan:g.quan,thanhPho:g.thanhPho,ngayLamHoKhau:g.ngayLamHoKhau}:null}),E.isOpen&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md shadow-md",children:[u.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-4",children:"Xác nhận xoá"}),u.jsxs("p",{className:"text-sm text-gray-700",children:["Bạn có chắc chắn muốn xoá hộ khẩu ",u.jsxs("strong",{children:["HK",(Z=E.hoKhau)==null?void 0:Z.soHoKhau.toString().padStart(3,"0")]})," không?"]}),u.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[u.jsx("button",{onClick:()=>C({isOpen:!1,hoKhau:null}),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300",children:"Huỷ"}),u.jsx("button",{onClick:ye,className:"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600",children:"Xoá"})]})]})})]})},Kj=({isOpen:e,onClose:t,onSuccess:n})=>{const[a,r]=k.useState({hoTen:"",ngaySinh:"",gioiTinh:"",danToc:"",tonGiao:"",cccd:"",ngayCap:"",noiCap:"",ngheNghiep:"",soDienThoai:"",selectedHouseholdId:"",quanHeVoiChuHo:""}),[l,o]=k.useState([]),[h,f]=k.useState(!1),[x,g]=k.useState(""),[p,y]=k.useState(!1);k.useEffect(()=>{e&&(_(),r({hoTen:"",ngaySinh:"",gioiTinh:"",danToc:"",tonGiao:"",cccd:"",ngayCap:"",noiCap:"",ngheNghiep:"",soDienThoai:"",selectedHouseholdId:"",quanHeVoiChuHo:""}),g(""))},[e]);const _=async()=>{try{f(!0);const T=await Ha.getAll();T.success&&T.data?o(T.data.households||[]):g("Không thể tải danh sách hộ khẩu")}catch(T){console.error("Error fetching households:",T),g(T.message||"Có lỗi xảy ra khi tải danh sách hộ khẩu")}finally{f(!1)}},w=T=>{const{name:S,value:E}=T.target;r(C=>({...C,[S]:E})),S==="selectedHouseholdId"&&r(C=>({...C,selectedHouseholdId:E,quanHeVoiChuHo:""}))},b=async T=>{if(T.preventDefault(),!a.hoTen.trim()){g("Vui lòng nhập họ tên");return}if(!a.ngaySinh){g("Vui lòng chọn ngày sinh");return}if(!a.gioiTinh){g("Vui lòng chọn giới tính");return}if(!a.cccd.trim()){g("Vui lòng nhập số CCCD");return}if(a.selectedHouseholdId&&!a.quanHeVoiChuHo){g("Vui lòng chọn quan hệ với chủ hộ");return}try{y(!0),g(""),console.log("Creating new resident:",a);const S=await Gn.create(a);if(S.success)console.log("Resident created successfully:",S.data),n&&n(),t();else throw new Error(S.message||"Không thể tạo nhân khẩu")}catch(S){console.error("Error creating resident:",S),g(S.message||"Có lỗi xảy ra khi tạo nhân khẩu")}finally{y(!1)}};return e?u.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-xl max-h-[90vh] overflow-y-auto relative",children:[u.jsx("div",{className:"mb-8 pb-4 border-b border-gray-300",children:u.jsx("h2",{className:"text-2xl font-bold text-gray-900 text-left",children:"Thêm Nhân khẩu "})}),u.jsxs("form",{onSubmit:b,className:"space-y-8",children:[x&&u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:u.jsx("p",{className:"text-red-600 text-sm",children:x})}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Họ tên ",u.jsx("span",{className:"text-red-500",children:"*"})," "]}),u.jsx("input",{type:"text",name:"hoTen",value:a.hoTen,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập họ tên",required:!0})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Ngày sinh ",u.jsx("span",{className:"text-red-500",children:"*"})," "]}),u.jsx("input",{type:"date",name:"ngaySinh",value:a.ngaySinh,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",required:!0})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Giới tính ",u.jsx("span",{className:"text-red-500",children:"*"})," "]}),u.jsxs("select",{name:"gioiTinh",value:a.gioiTinh,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none appearance-none",required:!0,children:[u.jsx("option",{value:"",children:"Chọn giới tính"}),u.jsx("option",{value:"Nam",children:"Nam"}),u.jsx("option",{value:"Nữ",children:"Nữ"}),u.jsx("option",{value:"Khác",children:"Khác"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Dân tộc "}),u.jsx("input",{type:"text",name:"danToc",value:a.danToc,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập dân tộc"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Tôn giáo"}),u.jsx("input",{type:"text",name:"tonGiao",value:a.tonGiao,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập tôn giáo"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["CCCD ",u.jsx("span",{className:"text-red-500",children:"*"})," "]}),u.jsx("input",{type:"text",name:"cccd",value:a.cccd,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập số CCCD",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Ngày cấp"}),u.jsx("input",{type:"date",name:"ngayCap",value:a.ngayCap,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Nơi cấp"}),u.jsx("input",{type:"text",name:"noiCap",value:a.noiCap,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập nơi cấp"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Nghề nghiệp"}),u.jsx("input",{type:"text",name:"ngheNghiep",value:a.ngheNghiep,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập nghề nghiệp"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Số điện thoại"}),u.jsx("input",{type:"tel",name:"soDienThoai",value:a.soDienThoai,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập số điện thoại"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Hộ khẩu (tùy chọn)"}),u.jsxs("select",{name:"selectedHouseholdId",value:a.selectedHouseholdId,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none appearance-none",disabled:h,children:[u.jsx("option",{value:"",children:h?"Đang tải...":"Chọn hộ khẩu (để trống nếu tạo hộ mới)"}),l.map(T=>u.jsxs("option",{value:T.id,children:["HK",T.soHoKhau.toString().padStart(3,"0")," - ",T.diaChi]},T.id))]})]}),a.selectedHouseholdId&&u.jsxs("div",{className:"md:col-span-2",children:[u.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Quan hệ với chủ hộ ",u.jsx("span",{className:"text-red-500",children:"*"})," "]}),u.jsxs("select",{name:"quanHeVoiChuHo",value:a.quanHeVoiChuHo,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none appearance-none",required:!0,children:[u.jsx("option",{value:"",children:"Chọn quan hệ"}),u.jsx("option",{value:"Con",children:"Con"}),u.jsx("option",{value:"Vợ/Chồng",children:"Vợ/Chồng"}),u.jsx("option",{value:"Cha/Mẹ",children:"Cha/Mẹ"}),u.jsx("option",{value:"Anh/Chị/Em",children:"Anh/Chị/Em"}),u.jsx("option",{value:"Khác",children:"Khác"})]}),u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Nhân khẩu sẽ được thêm vào hộ khẩu đã chọn"})]}),!a.selectedHouseholdId&&u.jsx("div",{className:"md:col-span-2",children:u.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:u.jsxs("p",{className:"text-blue-800 text-sm",children:[u.jsx("strong",{children:"Lưu ý:"})," Nếu không chọn hộ khẩu, nhân khẩu sẽ được tạo riêng lẻ và có thể tạo hộ khẩu mới sau."]})})})]}),u.jsxs("div",{className:"flex justify-between gap-4 mt-8",children:[u.jsx("button",{type:"button",onClick:t,disabled:p,className:"px-8 py-2 border border-gray-300 rounded-xl text-gray-700 font-bold bg-gray-100 hover:bg-gray-200 shadow-sm text-lg disabled:opacity-50",children:"Hủy"}),u.jsx("button",{type:"submit",disabled:p||h,className:"px-8 py-2 bg-blue-500 text-white rounded-xl font-bold shadow hover:bg-blue-600 transition text-lg disabled:opacity-50 disabled:cursor-not-allowed",children:p?u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Đang lưu..."]}):"Lưu"})]})]})]})}):null},Wj=({isOpen:e,onClose:t,onSuccess:n,residentId:a})=>{const[r,l]=k.useState({hoTen:"",ngaySinh:"",gioiTinh:"",danToc:"",tonGiao:"",cccd:"",ngayCap:"",noiCap:"",ngheNghiep:"",soDienThoai:"",ghiChu:""}),[o,h]=k.useState(!1),[f,x]=k.useState(""),[g,p]=k.useState(!1);k.useEffect(()=>{e&&a&&y()},[e,a]);const y=async()=>{try{h(!0);const b=await Gn.getById(a);if(b.success&&b.data){const T=b.data;l({hoTen:T.hoTen||"",ngaySinh:T.ngaySinh?new Date(T.ngaySinh).toISOString().split("T")[0]:"",gioiTinh:T.gioiTinh||"",danToc:T.danToc||"",tonGiao:T.tonGiao||"",cccd:T.cccd||"",ngayCap:T.ngayCap?new Date(T.ngayCap).toISOString().split("T")[0]:"",noiCap:T.noiCap||"",ngheNghiep:T.ngheNghiep||"",soDienThoai:T.soDienThoai||"",ghiChu:T.ghiChu||""})}else x("Không thể tải thông tin nhân khẩu")}catch(b){console.error("Error fetching resident data:",b),x(b.message||"Có lỗi xảy ra khi tải thông tin nhân khẩu")}finally{h(!1)}},_=b=>{const{name:T,value:S}=b.target;l(E=>({...E,[T]:S}))},w=async b=>{var T,S;if(b.preventDefault(),!r.hoTen.trim()){x("Vui lòng nhập họ tên");return}if(!r.ngaySinh){x("Vui lòng chọn ngày sinh");return}if(!r.gioiTinh){x("Vui lòng chọn giới tính");return}if(!r.cccd.trim()){x("Vui lòng nhập số CCCD");return}try{p(!0),x("");const E=await Gn.update(a,r);E.success?(n==null||n(),t()):x(E.message||"Có lỗi xảy ra khi cập nhật nhân khẩu")}catch(E){console.error("Error updating resident:",E),x(((S=(T=E.response)==null?void 0:T.data)==null?void 0:S.message)||E.message||"Có lỗi xảy ra khi cập nhật nhân khẩu")}finally{p(!1)}};return e?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[u.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 rounded-t-2xl",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Chỉnh sửa thông tin nhân khẩu"}),u.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 text-2xl font-bold",disabled:g,children:"×"})]})}),u.jsx("div",{className:"p-6",children:o?u.jsxs("div",{className:"text-center py-8",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),u.jsx("p",{className:"mt-4 text-gray-600",children:"Đang tải thông tin..."})]}):u.jsxs("form",{onSubmit:w,className:"space-y-6",children:[f&&u.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl",children:f}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Họ tên ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",name:"hoTen",value:r.hoTen,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập họ tên",required:!0})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Ngày sinh ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"date",name:"ngaySinh",value:r.ngaySinh,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",required:!0})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Giới tính ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsxs("select",{name:"gioiTinh",value:r.gioiTinh,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none appearance-none",required:!0,children:[u.jsx("option",{value:"",children:"Chọn giới tính"}),u.jsx("option",{value:"Nam",children:"Nam"}),u.jsx("option",{value:"Nữ",children:"Nữ"}),u.jsx("option",{value:"Khác",children:"Khác"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Dân tộc"}),u.jsx("input",{type:"text",name:"danToc",value:r.danToc,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập dân tộc"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Tôn giáo"}),u.jsx("input",{type:"text",name:"tonGiao",value:r.tonGiao,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập tôn giáo"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["CCCD ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",name:"cccd",value:r.cccd,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập số CCCD",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Ngày cấp"}),u.jsx("input",{type:"date",name:"ngayCap",value:r.ngayCap,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Nơi cấp"}),u.jsx("input",{type:"text",name:"noiCap",value:r.noiCap,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập nơi cấp"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Nghề nghiệp"}),u.jsx("input",{type:"text",name:"ngheNghiep",value:r.ngheNghiep,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập nghề nghiệp"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Số điện thoại"}),u.jsx("input",{type:"tel",name:"soDienThoai",value:r.soDienThoai,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập số điện thoại"})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Ghi chú"}),u.jsx("textarea",{name:"ghiChu",value:r.ghiChu,onChange:_,rows:3,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none resize-none",placeholder:"Nhập ghi chú (nếu có)"})]})]}),u.jsxs("div",{className:"flex gap-3 pt-6 border-t border-gray-200",children:[u.jsx("button",{type:"button",onClick:t,disabled:g,className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-xl font-medium hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-200 disabled:opacity-50",children:"Hủy"}),u.jsx("button",{type:"submit",disabled:g,className:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-xl font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-200 disabled:opacity-50 disabled:cursor-not-allowed",children:g?u.jsxs("span",{className:"flex items-center justify-center",children:[u.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Đang cập nhật..."]}):"Cập nhật"})]})]})})]})}):null},Gj=({isOpen:e,onClose:t,selectedResident:n})=>{var te,q;const[a,r]=k.useState(""),[l,o]=k.useState(""),[h,f]=k.useState(!1),[x,g]=k.useState(""),[p,y]=k.useState(""),[_,w]=k.useState([]),[b,T]=k.useState(null),[S,E]=k.useState(!1),[C,A]=k.useState(""),[F,K]=k.useState(!1);k.useEffect(()=>{e&&n&&(O(),P())},[e,n]);const O=async()=>{try{E(!0),A("");const ae=await Ha.getAvailable();ae.success&&ae.data?w(ae.data):A("Không thể tải danh sách hộ khẩu")}catch(ae){console.error("Error fetching households:",ae),A(ae.message||"Có lỗi xảy ra khi tải danh sách hộ khẩu")}finally{E(!1)}},P=async()=>{if(n)try{E(!0);const ae=await Gn.getHouseholdInfo(n.id);ae.success&&ae.data?T(ae.data):A("Không thể tải thông tin hộ khẩu hiện tại")}catch(ae){console.error("Error fetching household info:",ae),A(ae.message||"Có lỗi xảy ra khi tải thông tin hộ khẩu")}finally{E(!1)}},M=async ae=>{if(ae.preventDefault(),!!n){if(!h&&!a){A("Vui lòng chọn hộ gia đình đích");return}if(!h&&!p){A("Vui lòng chọn mối quan hệ với chủ hộ mới");return}if(h&&!l.trim()){A("Vui lòng nhập địa chỉ hộ gia đình mới");return}if(!x.trim()){A("Vui lòng nhập lý do tách hộ");return}try{K(!0),A("");let re=l;h&&re&&(re.includes(" - ")||re.includes(",")&&(re=re.split(",").map(ye=>ye.trim()).join(" - ")));const ee={residentId:n.id,targetType:h?"new":"existing",targetHouseholdId:h?void 0:parseInt(a),newHouseholdAddress:h?re:void 0,reason:x,quanHeVoiChuHoMoi:h?void 0:p},Q=await Gn.separateHousehold(ee);Q.success?(B(),t(),alert("Tách hộ thành công!")):A(Q.message||"Không thể tách hộ")}catch(re){console.error("Error separating household:",re);let ee="Có lỗi xảy ra khi tách hộ";re.message&&(re.message.includes("address")?ee="Lỗi định dạng địa chỉ. Vui lòng kiểm tra lại.":re.message.includes("Không tìm thấy")?ee=re.message:ee=`Lỗi: ${re.message}`),A(ee)}finally{K(!1)}}},B=()=>{r(""),o(""),f(!1),g(""),y("")},I=()=>{B(),t()};return e?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[u.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Tách hộ - Chuyển nhân khẩu"}),u.jsx("button",{onClick:I,className:"text-gray-400 hover:text-gray-600 transition-colors",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("form",{onSubmit:M,className:"p-6 space-y-6",children:[n&&u.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-blue-800 mb-3",children:"Thông tin nhân khẩu được chuyển:"}),u.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-700",children:"Họ tên:"}),u.jsx("span",{className:"ml-2 text-gray-900",children:n.hoTen})]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-700",children:"CCCD:"}),u.jsx("span",{className:"ml-2 text-gray-900",children:n.cccd})]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-700",children:"Giới tính:"}),u.jsx("span",{className:"ml-2 text-gray-900",children:n.gioiTinh})]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-700",children:"Ngày sinh:"}),u.jsx("span",{className:"ml-2 text-gray-900",children:n.ngaySinh})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("span",{className:"font-medium text-gray-700",children:"Nghề nghiệp:"}),u.jsx("span",{className:"ml-2 text-gray-900",children:n.ngheNghiep})]})]})]}),b&&b.householdStatus==="in_household"&&b.currentHousehold&&u.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-yellow-800 mb-3",children:"Hộ khẩu hiện tại:"}),u.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-700",children:"Mã hộ khẩu:"}),u.jsxs("span",{className:"ml-2 text-gray-900",children:["HK",((te=b.currentHousehold.soHoKhau)==null?void 0:te.toString().padStart(3,"0"))||"N/A"]})]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-700",children:"Chủ hộ:"}),u.jsx("span",{className:"ml-2 text-gray-900",children:b.currentHousehold.chuHo||"Chưa xác định"})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("span",{className:"font-medium text-gray-700",children:"Địa chỉ:"}),u.jsx("span",{className:"ml-2 text-gray-900",children:b.currentHousehold.diaChi||"Chưa có địa chỉ"})]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-700",children:"Vai trò:"}),u.jsx("span",{className:"ml-2 text-gray-900",children:b.isHeadOfHousehold?u.jsx("span",{className:"text-blue-600 font-semibold",children:"Chủ hộ"}):u.jsxs("span",{className:"text-green-600",children:["Thành viên (",b.currentHousehold.quanHeVoiChuHo,")"]})})]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-700",children:"Số thành viên khác:"}),u.jsxs("span",{className:"ml-2 text-gray-900",children:[((q=b.otherHouseholdMembers)==null?void 0:q.length)||0," người"]})]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-700",children:"Ngày gia nhập:"}),u.jsx("span",{className:"ml-2 text-gray-900",children:b.currentHousehold.ngayThemVaoHo?new Date(b.currentHousehold.ngayThemVaoHo).toLocaleDateString("vi-VN"):"Chưa xác định"})]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-700",children:"Ngày lập hộ:"}),u.jsx("span",{className:"ml-2 text-gray-900",children:b.currentHousehold.ngayLamHoKhau?new Date(b.currentHousehold.ngayLamHoKhau).toLocaleDateString("vi-VN"):"Chưa xác định"})]})]}),b.otherHouseholdMembers&&b.otherHouseholdMembers.length>0&&u.jsxs("div",{className:"mt-4 pt-3 border-t border-yellow-300",children:[u.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"Thành viên khác trong hộ:"}),u.jsxs("div",{className:"space-y-2",children:[b.otherHouseholdMembers.slice(0,3).map(ae=>u.jsxs("div",{className:"flex justify-between items-center text-sm",children:[u.jsx("span",{className:"text-gray-700",children:ae.hoTen}),u.jsxs("span",{className:"text-gray-500",children:["(",ae.quanHeVoiChuHo,")"]})]},ae.id)),b.otherHouseholdMembers.length>3&&u.jsxs("div",{className:"text-sm text-gray-500",children:["... và ",b.otherHouseholdMembers.length-3," thành viên khác"]})]})]}),u.jsxs("div",{className:"mt-3 p-3 bg-orange-100 border border-orange-300 rounded-md",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("svg",{className:"w-5 h-5 text-orange-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),u.jsx("span",{className:"text-orange-800 font-medium",children:"Lưu ý tách hộ:"})]}),u.jsx("p",{className:"text-orange-700 text-sm mt-1",children:b.separationNotes||"Cần kiểm tra điều kiện tách hộ."})]})]}),b&&b.householdStatus==="no_household"&&u.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("svg",{className:"w-5 h-5 text-gray-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),u.jsx("span",{className:"text-gray-700 font-medium",children:"Trạng thái hộ khẩu:"})]}),u.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Nhân khẩu này hiện không thuộc hộ khẩu nào. Bạn có thể tạo hộ khẩu mới với nhân khẩu này làm chủ hộ."})]}),S&&!b&&n&&u.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600 mr-3"}),u.jsx("span",{className:"text-gray-600",children:"Đang tải thông tin hộ khẩu hiện tại..."})]})}),!S&&!b&&n&&u.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("svg",{className:"w-5 h-5 text-red-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),u.jsx("span",{className:"text-red-700 font-medium",children:"Cảnh báo:"})]}),u.jsx("p",{className:"text-red-600 text-sm mt-1",children:"Không tìm thấy thông tin hộ khẩu hiện tại của nhân khẩu này. Có thể nhân khẩu chưa được gán vào hộ khẩu nào."})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:"Chọn hộ gia đình đích:"}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("label",{className:"flex items-center space-x-3",children:[u.jsx("input",{type:"radio",name:"householdType",checked:!h,onChange:()=>f(!1),className:"text-blue-600"}),u.jsx("span",{className:"text-gray-700",children:"Chuyển vào hộ gia đình có sẵn"})]}),u.jsxs("label",{className:"flex items-center space-x-3",children:[u.jsx("input",{type:"radio",name:"householdType",checked:h,onChange:()=>f(!0),className:"text-blue-600"}),u.jsx("span",{className:"text-gray-700",children:"Tạo hộ gia đình mới"})]})]}),!h&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chọn hộ gia đình:"}),u.jsxs("select",{value:a,onChange:ae=>r(ae.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!h,disabled:S,children:[u.jsx("option",{value:"",children:S?"-- Đang tải...":"-- Chọn hộ gia đình --"}),_.map(ae=>{var re;return u.jsxs("option",{value:ae.id,children:["HK",ae.soHoKhau.toString().padStart(3,"0")," - ",ae.diaChi," - Chủ hộ: ",((re=ae.chuHoInfo)==null?void 0:re.hoTen)||"Chưa có"]},ae.id)}),_.length===0&&!S&&u.jsx("option",{value:"",disabled:!0,children:"Không có hộ khẩu khả dụng"})]}),_.length===0&&!S&&u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Hiện tại không có hộ khẩu nào có thể chuyển đến"}),a&&u.jsxs("div",{className:"mt-4",children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Quan hệ với chủ hộ mới: ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsxs("select",{value:p,onChange:ae=>y(ae.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[u.jsx("option",{value:"",children:"-- Chọn quan hệ --"}),u.jsx("option",{value:"vợ/chồng",children:"Vợ/Chồng"}),u.jsx("option",{value:"con",children:"Con"}),u.jsx("option",{value:"bố/mẹ",children:"Bố/Mẹ"}),u.jsx("option",{value:"khác",children:"Khác"})]})]})]}),h&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Địa chỉ hộ gia đình mới:"}),u.jsx("input",{type:"text",value:l,onChange:ae=>o(ae.target.value),placeholder:"Ví dụ: Chung cư C, Tầng 10, Căn 1001, Thanh Xuân, Hà Nội",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:h}),u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Lưu ý: Nhân khẩu sẽ trở thành chủ hộ của hộ gia đình mới"}),u.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Định dạng địa chỉ: Số nhà/căn hộ, Đường/Tầng, Phường, Quận, Thành phố"})]})]}),C&&u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:u.jsx("p",{className:"text-red-600 text-sm",children:C})}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lý do tách hộ:"}),u.jsx("textarea",{value:x,onChange:ae=>g(ae.target.value),placeholder:"Nhập lý do tách hộ...",rows:3,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),u.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[u.jsx("button",{type:"button",onClick:I,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",children:"Hủy"}),u.jsx("button",{type:"submit",disabled:F||S,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:F?u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Đang xử lý..."]}):"Xác nhận tách hộ"})]})]})]})}):null},Xj=()=>{const[e,t]=k.useState(!1),[n,a]=k.useState(!1),[r,l]=k.useState(null),[o,h]=k.useState(!1),[f,x]=k.useState(null),[g,p]=k.useState(""),[y,_]=k.useState("id"),[w,b]=k.useState(!0),[T,S]=k.useState([]),[E,C]=k.useState(!0),[A,F]=k.useState(""),[K,O]=k.useState(1),[P,M]=k.useState(1),[B,I]=k.useState(0),te=10,q=()=>t(!0),ae=()=>{t(!1)},re=U=>{l(U),a(!0)},ee=()=>{a(!1),l(null)},Q=()=>{Z()},me=()=>{Z(),ee()},ye=async(U,Te)=>{if(window.confirm(`Bạn có chắc chắn muốn xóa nhân khẩu "${Te}" không? Thao tác này không thể hoàn tác.`))try{const ie=await Gn.delete(U);ie.success?(alert("Xóa nhân khẩu thành công!"),Z()):alert(ie.message||"Có lỗi xảy ra khi xóa nhân khẩu")}catch(ie){console.error("Error deleting resident:",ie),alert(ie.message||"Có lỗi xảy ra khi xóa nhân khẩu")}},Y=U=>{x(U),h(!0)},de=()=>{h(!1),x(null)},H=U=>{Y(U)},Z=async()=>{try{C(!0),F("");const U=await Gn.getAll({page:K,limit:te,search:g});if(U.success&&U.data){const Te=U.data.residents||[],ie=await Promise.all(Te.map(async _e=>{try{const Ne=await Gn.getHouseholdInfo(_e.id);if(console.log(`Household info for resident ${_e.id}:`,Ne),Ne.success&&Ne.data){const Ie=Ne.data;return console.log("Household data:",Ie),{..._e,householdStatus:Ie.householdStatus,currentHousehold:Ie.currentHousehold,laChuHo:Ie.isHeadOfHousehold}}return{..._e,householdStatus:"no_household",currentHousehold:null,laChuHo:!1}}catch(Ne){return console.warn(`Failed to get household info for resident ${_e.id}:`,Ne),{..._e,householdStatus:"no_household",currentHousehold:null,laChuHo:!1}}}));S(ie),M(U.data.totalPages||1),I(U.data.total||0)}else F("Không thể tải danh sách nhân khẩu")}catch(U){console.error("Error loading residents:",U),F(U.message||"Có lỗi xảy ra khi tải danh sách nhân khẩu")}finally{C(!1)}};k.useEffect(()=>{Z()},[K]),k.useEffect(()=>{const U=setTimeout(()=>{O(1),Z()},500);return()=>clearTimeout(U)},[g]);const V=[...T.filter(U=>U.hoTen.toLowerCase().includes(g.toLowerCase())||U.cccd.toLowerCase().includes(g.toLowerCase()))].sort((U,Te)=>{const ie=U[y],_e=Te[y];return ie==null&&_e==null?0:ie==null?w?1:-1:_e==null||ie<_e?w?-1:1:ie>_e?w?1:-1:0});return u.jsxs(u.Fragment,{children:[u.jsx(kn,{role:"totruong",children:u.jsxs("div",{className:"p-4 flex flex-col gap-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"QUẢN LÝ NHÂN KHẨU"}),u.jsxs("p",{className:"text-gray-600 text-sm mt-1",children:["Chào mừng đến với Hệ thống Quản lý Thu phí Chung cư",B>0&&u.jsxs("span",{className:"ml-2 text-blue-600 font-medium",children:["(Tổng: ",B," nhân khẩu)"]})]})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md shadow-sm overflow-hidden flex-1",children:[u.jsx("div",{className:"p-2 text-gray-400",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),u.jsx("input",{type:"text",placeholder:"Tìm theo họ tên, CCCD",className:"flex-1 p-2 border border-gray-300 outline-none text-sm",value:g,onChange:U=>p(U.target.value)})]}),u.jsxs("button",{className:"bg-blue-500 text-white px-4 py-2 rounded-md shadow-sm hover:bg-blue-600 flex items-center gap-2",onClick:q,children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thêm nhân khẩu"]})]}),u.jsxs("div",{className:"mt-6 bg-white rounded-md shadow-md overflow-hidden border border-gray-200",children:[u.jsx("div",{className:"p-4 bg-gray-100 border-b border-gray-200",children:u.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Danh sách nhân khẩu"})}),E&&u.jsxs("div",{className:"flex items-center justify-center py-12",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),u.jsx("span",{className:"ml-3 text-gray-600",children:"Đang tải dữ liệu..."})]}),A&&!E&&u.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 m-4",children:[u.jsx("p",{className:"text-red-600",children:A}),u.jsx("button",{onClick:Z,className:"mt-2 bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600",children:"Thử lại"})]}),!E&&!A&&u.jsxs(u.Fragment,{children:[u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[[{key:"id",label:"ID"},{key:"hoTen",label:"Họ tên"},{key:"gioiTinh",label:"Giới tính"},{key:"ngaySinh",label:"Ngày sinh"},{key:"cccd",label:"CCCD"},{key:"soDienThoai",label:"SĐT"},{key:"ngheNghiep",label:"Nghề nghiệp"},{key:"household",label:"Hộ khẩu"}].map(U=>u.jsxs("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider cursor-pointer select-none",onClick:()=>{U.key!=="household"&&(y===U.key?b(!w):(_(U.key),b(!0)))},children:[U.label," ",y===U.key?w?"▲":"▼":""]},U.key)),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Thao tác"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:V.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:9,className:"px-6 py-8 text-center text-gray-500",children:g?"Không tìm thấy nhân khẩu nào phù hợp":"Chưa có nhân khẩu nào"})}):V.map(U=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:U.id}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:u.jsxs("div",{className:"flex items-center",children:[U.hoTen,U.laChuHo&&u.jsx("span",{className:"ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:"Chủ hộ"})]})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:U.gioiTinh}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(U.ngaySinh).toLocaleDateString("vi-VN")}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:U.cccd}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:U.soDienThoai||"Chưa có"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:U.ngheNghiep}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:U.currentHousehold?u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsxs("span",{className:"font-medium text-blue-600",children:["HK",String(U.currentHousehold.soHoKhau).padStart(3,"0")]}),U.laChuHo&&u.jsx("span",{className:"ml-2 text-xs text-blue-600",children:"(Chủ hộ)"})]}),u.jsxs("div",{className:"text-xs text-gray-500",children:["Chủ hộ: ",U.currentHousehold.chuHo]}),U.currentHousehold.quanHeVoiChuHo&&!U.laChuHo&&u.jsxs("div",{className:"text-xs text-gray-500",children:["Quan hệ: ",U.currentHousehold.quanHeVoiChuHo]})]}):U.householdStatus==="no_household"?u.jsx("span",{className:"inline-flex px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-600",children:"Chưa có hộ khẩu"}):u.jsx("span",{className:"text-gray-400 text-xs",children:"Đang tải..."})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:u.jsxs("div",{className:"flex flex-wrap gap-2",children:[u.jsxs("button",{onClick:()=>re(U.id),className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",title:"Chỉnh sửa thông tin",children:[u.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Sửa"]}),u.jsxs("button",{onClick:()=>ye(U.id,U.hoTen),className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-red-100 text-red-800 hover:bg-red-200 transition-colors",title:"Xóa nhân khẩu",children:[u.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Xóa"]}),u.jsxs("button",{onClick:()=>H(U),className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-yellow-100 text-yellow-800 hover:bg-yellow-200 transition-colors",title:"Tách hộ",children:[u.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),"Tách hộ"]})]})})]},U.id))})]}),P>1&&u.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[u.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[u.jsx("button",{onClick:()=>O(U=>Math.max(1,U-1)),disabled:K===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Trước"}),u.jsx("button",{onClick:()=>O(U=>Math.min(P,U+1)),disabled:K===P,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Sau"})]}),u.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[u.jsx("div",{children:u.jsxs("p",{className:"text-sm text-gray-700",children:["Hiển thị ",u.jsx("span",{className:"font-medium",children:(K-1)*te+1})," đến"," ",u.jsx("span",{className:"font-medium",children:Math.min(K*te,B)})," ","trong tổng số ",u.jsx("span",{className:"font-medium",children:B})," kết quả"]})}),u.jsx("div",{children:u.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[u.jsx("button",{onClick:()=>O(U=>Math.max(1,U-1)),disabled:K===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Trước"}),Array.from({length:Math.min(5,P)},(U,Te)=>{const ie=Te+1;return u.jsx("button",{onClick:()=>O(ie),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${K===ie?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:ie},ie)}),u.jsx("button",{onClick:()=>O(U=>Math.min(P,U+1)),disabled:K===P,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Sau"})]})})]})]})]})]})]})}),u.jsx(Kj,{isOpen:e,onClose:ae,onSuccess:Q}),u.jsx(Wj,{isOpen:n,onClose:ee,onSuccess:me,residentId:r}),u.jsx(Gj,{isOpen:o,onClose:de,selectedResident:f})]})},Yj=({isOpen:e,onClose:t,onSave:n})=>{const[a,r]=k.useState(!1),[l,o]=k.useState(null),[h,f]=k.useState([]),[x,g]=k.useState([]),[p,y]=k.useState(null),[_,w]=k.useState(null),[b,T]=k.useState([]),[S,E]=k.useState({}),[C,A]=k.useState("");k.useEffect(()=>{e&&(F(),K(),y(null),w(null),T([]),E({}),A(""),o(null))},[e]),k.useEffect(()=>{p&&_&&O(p,_)},[p,_]);const F=async()=>{try{r(!0);const ae=await(await fetch("http://localhost:8000/api/dot-thu?page=0&size=20&sortBy=createdAt&sortDir=desc",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}})).json();ae.success&&ae.dotThus&&f(ae.dotThus)}catch(q){console.error("Error loading dot thu list:",q),o("Không thể tải danh sách đợt thu")}finally{r(!1)}},K=async()=>{var q;try{const re=await(await fetch("http://localhost:8000/api/households",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}})).json();if(re.success&&((q=re.data)!=null&&q.households)){const ee=re.data.households.map(Q=>{var me;return{id:Q.soHoKhau,soHoKhau:Q.soHoKhau,chuHo:((me=Q.chuHoInfo)==null?void 0:me.hoTen)||"Không xác định",diaChi:`${Q.soNha||""} ${Q.duong||""}, ${Q.phuong||""}`.trim()}});g(ee)}}catch(ae){console.error("Error loading household list:",ae),o("Không thể tải danh sách hộ khẩu")}},O=async(q,ae)=>{try{r(!0);const ee=await(await fetch(`http://localhost:8000/api/household-fees/ho-khau/${ae}/dot-thu/${q}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}})).json();if(ee.success&&ee.data){const Q=ee.data.map(ye=>{var Y;return{id:ye.id,tenKhoanThu:((Y=ye.khoanThu)==null?void 0:Y.tenkhoanthu)||"Không xác định",soTien:parseFloat(ye.soTien||"0"),soTienDaNop:parseFloat(ye.soTienDaNop||"0"),trangThai:ye.trangThai,ghiChu:ye.ghiChu||""}});T(Q);const me={};Q.forEach(ye=>{ye.soTien>ye.soTienDaNop&&(me[ye.id]=ye.soTien-ye.soTienDaNop)}),E(me)}else T([]),E({})}catch(re){console.error("Error loading khoan thu info:",re),o("Không thể tải thông tin khoản thu"),T([])}finally{r(!1)}},P=(q,ae)=>{const re=parseFloat(ae)||0;E(ee=>({...ee,[q]:re}))},M=async()=>{try{if(!p||!_){o("Vui lòng chọn đợt thu và hộ khẩu");return}const q=Object.entries(S).filter(([ee,Q])=>Q>0).map(([ee,Q])=>({householdFeeId:parseInt(ee),amount:Q}));if(q.length===0){o("Vui lòng nhập số tiền thanh toán");return}r(!0);for(const ee of q){const me=await(await fetch(`http://localhost:8000/api/household-fees/${ee.householdFeeId}/payment`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"},body:JSON.stringify({soTienThanhToan:ee.amount,ghiChu:C||"Thanh toán nhanh"})})).json();if(!me.success)throw new Error(me.message||"Có lỗi xảy ra khi thanh toán")}const ae=q.reduce((ee,Q)=>ee+Q.amount,0),re=document.createElement("div");re.className="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transition-all duration-300",re.innerHTML=`
        <div class="flex items-center space-x-2">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
          </svg>
          <span>Thanh toán thành công! Tổng số tiền: ${B(ae)}</span>
        </div>
      `,document.body.appendChild(re),setTimeout(()=>{re.style.opacity="0",setTimeout(()=>document.body.removeChild(re),300)},3e3),n&&n({dotThuId:p,hoKhauId:_,payments:q,totalAmount:ae,ghiChu:C}),I()}catch(q){console.error("Error processing payment:",q),o(q.message||"Có lỗi xảy ra khi xử lý thanh toán")}finally{r(!1)}},B=q=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(q),I=()=>{y(null),w(null),T([]),E({}),A(""),o(null),t()},te=q=>new Date(q).toLocaleDateString("vi-VN");return e?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[u.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Ghi nhận thanh toán nhanh"}),u.jsx("button",{onClick:I,className:"text-gray-400 hover:text-gray-600 transition-colors",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"p-6 max-h-[calc(90vh-180px)] overflow-y-auto",children:[l&&u.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-4",children:[l,u.jsx("button",{onClick:()=>o(null),className:"float-right text-red-500 hover:text-red-700",children:"×"})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chọn đợt thu phí"}),u.jsxs("select",{value:p||"",onChange:q=>y(parseInt(q.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"",children:"-- Chọn đợt thu --"}),h.map(q=>u.jsxs("option",{value:q.id,children:[q.tenDotThu," (",te(q.ngayTao)," - ",te(q.thoiHan),")"]},q.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chọn hộ khẩu"}),u.jsxs("select",{value:_||"",onChange:q=>w(parseInt(q.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!p,children:[u.jsx("option",{value:"",children:"-- Chọn hộ khẩu --"}),x.map(q=>u.jsxs("option",{value:q.id,children:["HK",q.soHoKhau.toString().padStart(3,"0")," - ",q.chuHo]},q.id))]})]}),b.length>0&&u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Danh sách khoản thu"}),u.jsx("div",{className:"space-y-3",children:b.map(q=>u.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[u.jsxs("div",{className:"flex justify-between items-start mb-3",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-gray-800",children:q.tenKhoanThu}),u.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[u.jsxs("p",{children:["Tổng tiền: ",u.jsx("span",{className:"font-medium",children:B(q.soTien)})]}),u.jsxs("p",{children:["Đã nộp: ",u.jsx("span",{className:"font-medium text-green-600",children:B(q.soTienDaNop)})]}),u.jsxs("p",{children:["Còn lại: ",u.jsx("span",{className:"font-medium text-red-600",children:B(q.soTien-q.soTienDaNop)})]})]})]}),u.jsx("div",{className:"text-right",children:u.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${q.trangThai==="da_nop_du"?"bg-green-100 text-green-600":q.trangThai==="nop_mot_phan"?"bg-yellow-100 text-yellow-600":"bg-red-100 text-red-600"}`,children:q.trangThai==="da_nop_du"?"Đã nộp đủ":q.trangThai==="nop_mot_phan"?"Nộp một phần":"Chưa nộp"})})]}),q.soTien>q.soTienDaNop&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Số tiền thanh toán"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"number",min:"0",max:q.soTien-q.soTienDaNop,step:"1000",value:S[q.id]||"",onChange:ae=>P(q.id,ae.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nhập số tiền"}),u.jsx("button",{type:"button",onClick:()=>P(q.id,(q.soTien-q.soTienDaNop).toString()),className:"px-3 py-2 text-sm bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200",children:"Toàn bộ"})]})]})]},q.id))}),u.jsxs("div",{className:"mt-4",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi chú"}),u.jsx("textarea",{value:C,onChange:q=>A(q.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ghi chú về thanh toán (tùy chọn)"})]}),u.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"font-medium text-gray-800",children:"Tổng tiền thanh toán:"}),u.jsx("span",{className:"text-xl font-bold text-blue-600",children:B(Object.values(S).reduce((q,ae)=>q+ae,0))})]})})]}),a&&u.jsxs("div",{className:"flex items-center justify-center py-4",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),u.jsx("span",{className:"ml-2 text-gray-600",children:"Đang xử lý..."})]})]})]}),u.jsxs("div",{className:"flex justify-end gap-3 p-6 border-t border-gray-200",children:[u.jsx("button",{onClick:I,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",disabled:a,children:"Hủy"}),u.jsx("button",{onClick:M,disabled:a||!p||!_||b.length===0||Object.values(S).every(q=>q===0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:a?"Đang xử lý...":"Xác nhận thanh toán"})]})]})}):null},qj=({isOpen:e,onClose:t,onSave:n})=>{const[a,r]=k.useState(!1),[l,o]=k.useState(null),[h,f]=k.useState([]),[x,g]=k.useState(null),[p,y]=k.useState([]),[_,w]=k.useState(new Set),[b,T]=k.useState(""),[S,E]=k.useState("");k.useEffect(()=>{e&&(C(),g(null),y([]),w(new Set),T(""),E(""),o(null))},[e]),k.useEffect(()=>{x&&A(x)},[x]);const C=async()=>{try{r(!0);const re=await(await fetch("http://localhost:8000/api/dot-thu?page=0&size=20&sortBy=createdAt&sortDir=desc",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}})).json();re.success&&re.dotThus&&f(re.dotThus)}catch(ae){console.error("Error loading dot thu list:",ae),o("Không thể tải danh sách đợt thu")}finally{r(!1)}},A=async ae=>{var re,ee,Q;try{r(!0);const ye=await(await fetch("http://localhost:8000/api/households",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}})).json();if(!ye.success||!((re=ye.data)!=null&&re.households))throw new Error("Không thể lấy danh sách hộ khẩu");const Y=ye.data.households,de=[];for(const H of Y)try{const j=await(await fetch(`http://localhost:8000/api/household-fees/ho-khau/${H.soHoKhau}/dot-thu/${ae}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}})).json();if(j.success&&((ee=j.data)==null?void 0:ee.length)>0){const V=j.data;let U=0,Te=0;const ie=V.map(Ne=>{var at;const Ie=parseFloat(Ne.soTien||"0"),Ue=parseFloat(Ne.soTienDaNop||"0");return U+=Ie,Te+=Ue,{id:Ne.id,tenKhoanThu:((at=Ne.khoanThu)==null?void 0:at.tenkhoanthu)||"Không xác định",soTien:Ie,soTienDaNop:Ue,remaining:Ie-Ue}}),_e=U-Te;_e>0&&de.push({hoKhauId:H.soHoKhau,hoKhau:{id:H.soHoKhau,soHoKhau:H.soHoKhau,chuHo:((Q=H.chuHoInfo)==null?void 0:Q.hoTen)||"Không xác định",diaChi:`${H.soNha||""} ${H.duong||""}, ${H.phuong||""}`.trim()},totalAmount:U,paidAmount:Te,remainingAmount:_e,feeDetails:ie.filter(Ne=>Ne.remaining>0)})}}catch(Z){console.error(`Error loading fees for household ${H.soHoKhau}:`,Z)}y(de)}catch(me){console.error("Error loading household fees:",me),o("Không thể tải thông tin khoản thu: "+me.message)}finally{r(!1)}},F=ae=>{const re=new Set(_);re.has(ae)?re.delete(ae):re.add(ae),w(re)},K=()=>{const ae=O();_.size===ae.length?w(new Set):w(new Set(ae.map(re=>re.hoKhauId)))},O=()=>p.filter(ae=>ae.hoKhau.chuHo.toLowerCase().includes(b.toLowerCase())||ae.hoKhau.soHoKhau.toString().includes(b)),P=async()=>{try{if(!x||_.size===0){o("Vui lòng chọn đợt thu và ít nhất một hộ khẩu");return}r(!0);let ae=0,re=0;for(const Q of _){const me=p.find(ye=>ye.hoKhauId===Q);if(me){for(const ye of me.feeDetails)if(ye.remaining>0){const de=await(await fetch(`http://localhost:8000/api/household-fees/${ye.id}/payment`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"},body:JSON.stringify({soTienThanhToan:ye.remaining,ghiChu:S||`Thanh toán nhanh cho ${me.hoKhau.chuHo}`})})).json();de.success?(re+=ye.remaining,ae++):console.error(`Failed to pay fee ${ye.id}:`,de.message)}}}const ee=document.createElement("div");ee.className="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transition-all duration-300",ee.innerHTML=`
        <div class="flex items-center space-x-2">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
          </svg>
          <div>
            <div class="font-medium">Thanh toán thành công!</div>
            <div class="text-sm">Đã thanh toán cho ${_.size} hộ khẩu</div>
            <div class="text-sm">Tổng số tiền: ${M(re)}</div>
          </div>
        </div>
      `,document.body.appendChild(ee),setTimeout(()=>{ee.style.opacity="0",setTimeout(()=>document.body.removeChild(ee),300)},5e3),n&&n({dotThuId:x,householdIds:Array.from(_),totalHouseholds:_.size,totalAmount:re,totalProcessed:ae,ghiChu:S}),I()}catch(ae){console.error("Error processing payments:",ae),o(ae.message||"Có lỗi xảy ra khi xử lý thanh toán")}finally{r(!1)}},M=ae=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(ae),B=ae=>new Date(ae).toLocaleDateString("vi-VN"),I=()=>{g(null),y([]),w(new Set),T(""),E(""),o(null),t()};if(!e)return null;const te=O(),q=Array.from(_).reduce((ae,re)=>{const ee=p.find(Q=>Q.hoKhauId===re);return ae+((ee==null?void 0:ee.remainingAmount)||0)},0);return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[u.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Thanh toán nhanh - Chọn nhiều hộ"}),u.jsx("button",{onClick:I,className:"text-gray-400 hover:text-gray-600 transition-colors",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"p-6 space-y-6",children:[l&&u.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:[l,u.jsx("button",{onClick:()=>o(null),className:"float-right text-red-500 hover:text-red-700",children:"×"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chọn đợt thu phí"}),u.jsxs("select",{value:x||"",onChange:ae=>g(parseInt(ae.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"",children:"-- Chọn đợt thu --"}),h.map(ae=>u.jsxs("option",{value:ae.id,children:[ae.tenDotThu," (",B(ae.ngayTao)," - ",B(ae.thoiHan),")"]},ae.id))]})]}),x&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("div",{className:"flex-1 max-w-md",children:u.jsx("input",{type:"text",placeholder:"Tìm kiếm hộ khẩu theo tên chủ hộ hoặc số hộ khẩu...",value:b,onChange:ae=>T(ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})}),u.jsxs("div",{className:"text-sm text-gray-600",children:["Đã chọn: ",_.size,"/",te.length," hộ",_.size>0&&u.jsxs("span",{className:"ml-2 font-medium text-green-600",children:["(",M(q),")"]})]})]}),a?u.jsxs("div",{className:"text-center py-8",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),u.jsx("p",{className:"mt-2 text-gray-600",children:"Đang tải dữ liệu hộ khẩu..."})]}):te.length>0?u.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[u.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{type:"checkbox",checked:_.size===te.length&&te.length>0,onChange:K,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),u.jsxs("label",{className:"ml-2 text-sm font-medium text-gray-700",children:["Chọn tất cả (",te.length," hộ có khoản phí chưa thanh toán)"]})]})}),u.jsx("div",{className:"max-h-96 overflow-y-auto",children:te.map(ae=>u.jsx("div",{className:`border-b border-gray-100 hover:bg-gray-50 transition-colors ${_.has(ae.hoKhauId)?"bg-blue-50":""}`,children:u.jsx("div",{className:"px-4 py-3",children:u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx("input",{type:"checkbox",checked:_.has(ae.hoKhauId),onChange:()=>F(ae.hoKhauId),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded mt-1"}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsxs("h4",{className:"text-sm font-medium text-gray-900",children:["HK",ae.hoKhau.soHoKhau.toString().padStart(3,"0")," - ",ae.hoKhau.chuHo]}),u.jsx("p",{className:"text-xs text-gray-500",children:ae.hoKhau.diaChi})]}),u.jsxs("div",{className:"text-right",children:[u.jsx("p",{className:"text-sm font-medium text-red-600",children:M(ae.remainingAmount)}),u.jsxs("p",{className:"text-xs text-gray-500",children:[ae.feeDetails.length," khoản chưa nộp"]})]})]}),u.jsx("div",{className:"mt-2 space-y-1",children:ae.feeDetails.map(re=>u.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[u.jsxs("span",{children:["• ",re.tenKhoanThu]}),u.jsx("span",{children:M(re.remaining)})]},re.id))})]})]})})},ae.hoKhauId))})]}):u.jsx("div",{className:"text-center py-8 text-gray-500",children:p.length===0?"Không có hộ khẩu nào có khoản phí chưa thanh toán trong đợt thu này":"Không tìm thấy hộ khẩu nào phù hợp với từ khóa tìm kiếm"}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ghi chú chung"}),u.jsx("textarea",{value:S,onChange:ae=>E(ae.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ghi chú cho tất cả các thanh toán (tùy chọn)"})]}),u.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[u.jsx("div",{className:"text-sm text-gray-600",children:_.size>0&&u.jsxs(u.Fragment,{children:["Sẽ thanh toán cho ",u.jsx("strong",{children:_.size})," hộ khẩu",u.jsx("br",{}),"Tổng số tiền: ",u.jsx("strong",{className:"text-green-600",children:M(q)})]})}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{onClick:I,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",disabled:a,children:"Hủy"}),u.jsx("button",{onClick:P,disabled:_.size===0||a,className:`px-4 py-2 rounded-md transition-colors ${_.size>0&&!a?"bg-green-600 text-white hover:bg-green-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:a?"Đang xử lý...":`Thanh toán ${_.size} hộ`})]})]})]})]})]})})},$j=()=>{var ee;const[e,t]=k.useState([]),[n,a]=k.useState(null),[r,l]=k.useState(null),[o,h]=k.useState(null),[f,x]=k.useState([]),[g,p]=k.useState(null),[y,_]=k.useState(!0),[w,b]=k.useState(null),[T,S]=k.useState(!1),[E,C]=k.useState(!1),[A,F]=k.useState({show:!1,type:"info",message:""}),K=(Q,me)=>{F({show:!0,type:Q,message:me}),setTimeout(()=>{F(ye=>({...ye,show:!1}))},4e3)};k.useEffect(()=>{O()},[]),k.useEffect(()=>{n&&P(n)},[n]),k.useEffect(()=>{n&&o&&B(n,o)},[n,o]);const O=async()=>{try{_(!0);const Q=await Kn.dotThu.getAll({page:0,size:20,sortBy:"createdAt",sortDir:"desc"});Q.success&&Q.dotThus&&(t(Q.dotThus),Q.dotThus.length>0&&a(Q.dotThus[0].id))}catch(Q){console.error("Error loading dot thu list:",Q),b("Không thể tải danh sách đợt thu phí")}finally{_(!1)}},P=async Q=>{try{_(!0);const ye=await(await fetch(`http://localhost:8000/api/household-fees/dashboard/${Q}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}})).json();if(ye.success)l(ye.data),h(null),x([]);else throw new Error(ye.message||"Không thể tải dashboard")}catch(me){console.error("Error loading dashboard:",me),b("Không thể tải dashboard khoản thu")}finally{_(!1)}},M=async Q=>{try{const ye=await(await fetch(`http://localhost:8000/api/household-fees/dashboard/${Q}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}})).json();if(ye.success)l(ye.data);else throw new Error(ye.message||"Không thể tải dashboard")}catch(me){console.error("Error reloading dashboard:",me),K("error","Không thể cập nhật dữ liệu dashboard")}},B=async(Q,me)=>{try{_(!0);const Y=await(await fetch(`http://localhost:8000/api/household-fees/dot-thu/${Q}/khoan-thu/${me}/households`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}})).json();if(Y.success)x(Y.data.households);else throw new Error(Y.message||"Không thể tải danh sách hộ gia đình")}catch(ye){console.error("Error loading household fees:",ye),b("Không thể tải danh sách hộ gia đình")}finally{_(!1)}},I=Q=>{h(Q)},te=async(Q,me,ye)=>{try{if(isNaN(me)||me<0){K("error","Số tiền thanh toán không hợp lệ. Vui lòng nhập số tiền >= 0");return}const de=await(await fetch(`http://localhost:8000/api/household-fees/${Q}/payment`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"},body:JSON.stringify({soTienThanhToan:me,ghiChu:ye})})).json();if(de.success)p(null),K("success",`Cập nhật thanh toán thành công! Đã nộp ${q(me)}`),n&&await M(n),n&&o&&await B(n,o);else throw new Error(de.message||"Không thể cập nhật thanh toán")}catch(Y){console.error("Error updating payment:",Y);const de=Y instanceof Error?Y.message:"Có lỗi xảy ra khi cập nhật thanh toán";K("error",de)}},q=Q=>{const me=typeof Q=="string"?parseFloat(Q):Q;return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(me)},ae=Q=>new Date(Q).toLocaleDateString("vi-VN"),re=Q=>{switch(Q){case"da_nop_du":return"text-green-600 bg-green-100";case"nop_mot_phan":return"text-yellow-600 bg-yellow-100";case"chua_nop":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}};return y&&!r?u.jsx(kn,{role:"ketoan",children:u.jsx("div",{className:"p-6 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),u.jsx("p",{className:"mt-4 text-gray-600",children:"Đang tải dữ liệu..."})]})})}):u.jsx(kn,{role:"ketoan",children:u.jsxs("div",{className:"p-6",children:[u.jsx("div",{className:"mb-6",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Quản lý khoản thu"}),u.jsx("p",{className:"text-gray-600 mt-1",children:"Theo dõi tình hình thu phí từng khoản"})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsxs("button",{onClick:()=>S(!0),className:"bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 flex items-center gap-2",children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Nộp nhanh (1 hộ)"]}),u.jsxs("button",{onClick:()=>C(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 flex items-center gap-2",children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),"Thanh toán nhiều hộ"]})]})]})}),w&&u.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:[w,u.jsx("button",{onClick:()=>b(null),className:"float-right text-red-500 hover:text-red-700",children:"×"})]}),A.show&&u.jsx("div",{className:`fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg border-l-4 ${A.type==="success"?"bg-green-50 border-green-400 text-green-700":A.type==="error"?"bg-red-50 border-red-400 text-red-700":"bg-blue-50 border-blue-400 text-blue-700"} transform transition-all duration-300 ${A.show?"translate-x-0 opacity-100":"translate-x-full opacity-0"}`,children:u.jsxs("div",{className:"flex items-center",children:[u.jsxs("div",{className:"flex-shrink-0",children:[A.type==="success"&&u.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),A.type==="error"&&u.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),A.type==="info"&&u.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})]}),u.jsx("div",{className:"ml-3 flex-1",children:u.jsx("p",{className:"text-sm font-medium",children:A.message})}),u.jsx("div",{className:"ml-4 flex-shrink-0",children:u.jsx("button",{onClick:()=>F(Q=>({...Q,show:!1})),className:"inline-flex text-gray-400 hover:text-gray-600",children:u.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]})}),u.jsxs("div",{className:"mb-6",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chọn đợt thu phí:"}),u.jsxs("select",{value:n||"",onChange:Q=>a(parseInt(Q.target.value)),className:"w-full max-w-md px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"",children:"-- Chọn đợt thu --"}),e.map(Q=>u.jsxs("option",{value:Q.id,children:[Q.tenDotThu," (",ae(Q.ngayTao)," - ",ae(Q.thoiHan),")"]},Q.id))]})]}),r&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[u.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:["Tổng quan: ",r.dotThu.tenDotThu]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[u.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[u.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Tổng hộ khẩu"}),u.jsx("p",{className:"text-2xl font-bold text-blue-800",children:r.tongKet.tongHoKhau})]}),u.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[u.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Đã thu"}),u.jsx("p",{className:"text-2xl font-bold text-green-800",children:q(r.tongKet.tongTienDaThu)})]}),u.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[u.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"Dự kiến"}),u.jsx("p",{className:"text-2xl font-bold text-orange-800",children:q(r.tongKet.tongTienDuKien)})]}),u.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[u.jsx("p",{className:"text-sm text-purple-600 font-medium",children:"Tỷ lệ thu"}),u.jsxs("p",{className:"text-2xl font-bold text-purple-800",children:[r.tongKet.tyLeThuTienTongQuat,"%"]})]})]})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Danh sách khoản thu"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.khoanThuList.map(Q=>u.jsxs("div",{onClick:()=>I(Q.khoanThuId),className:`p-4 border rounded-lg cursor-pointer transition-colors ${o===Q.khoanThuId?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[u.jsxs("div",{className:"flex justify-between items-start mb-2",children:[u.jsx("h4",{className:"font-medium text-gray-800",children:Q.tenKhoanThu}),Q.batBuoc&&u.jsx("span",{className:"text-xs bg-red-100 text-red-600 px-2 py-1 rounded",children:"Bắt buộc"})]}),u.jsxs("div",{className:"space-y-2 text-sm",children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-600",children:"Tỷ lệ hoàn thành:"}),u.jsxs("span",{className:"font-medium",children:[Q.thongKe.tyLeHoanThanh,"%"]})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-600",children:"Đã thu:"}),u.jsx("span",{className:"font-medium text-green-600",children:q(Q.taiChinh.tongTienDaThu)})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-600",children:"Dự kiến:"}),u.jsx("span",{className:"font-medium",children:q(Q.taiChinh.tongTienDuKien)})]}),u.jsxs("div",{className:"text-xs text-gray-500",children:[Q.thongKe.hoDaNop,"/",Q.thongKe.tongHoKhau," hộ đã nộp"]})]})]},Q.khoanThuId))})]}),o&&f.length>0&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Chi tiết hộ gia đình - ",(ee=r.khoanThuList.find(Q=>Q.khoanThuId===o))==null?void 0:ee.tenKhoanThu]}),u.jsx("button",{onClick:()=>h(null),className:"text-gray-500 hover:text-gray-700",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hộ khẩu"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Chủ hộ"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Số tiền"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Đã nộp"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trạng thái"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thao tác"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.map(Q=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["HK",Q.hoKhau.soHoKhau.toString().padStart(3,"0")]}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Q.hoKhau.chuHo}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:q(Q.soTien)}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600",children:q(Q.soTienDaNop)}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${re(Q.trangThai)}`,children:Q.trangThaiText})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:u.jsx("button",{onClick:()=>p(Q),className:"text-blue-600 hover:text-blue-800 font-medium",children:"Cập nhật"})})]},Q.id))})]})})]})]}),g&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Cập nhật thanh toán"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"bg-gray-50 p-3 rounded-md",children:[u.jsxs("p",{className:"text-sm text-gray-600",children:["Hộ khẩu: ",u.jsxs("span",{className:"font-medium",children:["HK",g.hoKhau.soHoKhau.toString().padStart(3,"0")]})]}),u.jsxs("p",{className:"text-sm text-gray-600",children:["Chủ hộ: ",u.jsx("span",{className:"font-medium",children:g.hoKhau.chuHo})]}),u.jsxs("p",{className:"text-sm text-gray-600",children:["Số tiền phải nộp: ",u.jsx("span",{className:"font-medium text-blue-600",children:q(parseFloat(g.soTien))})]}),u.jsxs("p",{className:"text-sm text-gray-600",children:["Đã nộp: ",u.jsx("span",{className:"font-medium text-green-600",children:q(parseFloat(g.soTienDaNop))})]}),u.jsxs("p",{className:"text-sm text-gray-600",children:["Còn lại: ",u.jsx("span",{className:"font-medium text-red-600",children:q(parseFloat(g.soTien)-parseFloat(g.soTienDaNop))})]}),g.chiTietTinhPhi&&g.chiTietTinhPhi.vehicle&&u.jsxs("div",{className:"mt-3 p-2 bg-blue-50 rounded",children:[u.jsx("p",{className:"text-xs font-semibold text-blue-700 mb-1",children:"Chi tiết phí phương tiện:"}),Array.isArray(g.chiTietTinhPhi.vehicle)?u.jsx("ul",{className:"text-xs text-blue-800 list-disc ml-4",children:g.chiTietTinhPhi.vehicle.map((Q,me)=>u.jsxs("li",{children:[Q.loaiXe?`${Q.loaiXe}: `:"",q(Q.phiThue),Q.bienSo?` (Biển số: ${Q.bienSo})`:""]},me))}):u.jsx("span",{className:"text-xs text-blue-800",children:q(g.chiTietTinhPhi.vehicle)})]})]}),u.jsxs("form",{onSubmit:Q=>{Q.preventDefault();const me=new FormData(Q.target),ye=me.get("soTienNop"),Y=parseFloat(ye),de=me.get("ghiChu");if(!ye||isNaN(Y)||Y<0){alert("Vui lòng nhập số tiền hợp lệ (>= 0)");return}te(g.id,Y,de)},children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Số tiền nộp"}),u.jsx("input",{type:"number",name:"soTienNop",min:"0",step:"1000",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nhập số tiền nộp",required:!0}),u.jsxs("div",{className:"flex gap-2 mt-2",children:[u.jsxs("button",{type:"button",onClick:Q=>{var ye;const me=(ye=Q.target.closest("form"))==null?void 0:ye.querySelector('input[name="soTienNop"]');me&&(me.value=(parseFloat(g.soTien)-parseFloat(g.soTienDaNop)).toString())},className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:["Số tiền còn lại (",q(parseFloat(g.soTien)-parseFloat(g.soTienDaNop)),")"]}),u.jsxs("button",{type:"button",onClick:Q=>{var ye;const me=(ye=Q.target.closest("form"))==null?void 0:ye.querySelector('input[name="soTienNop"]');me&&(me.value=g.soTien.toString())},className:"px-2 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200",children:["Toàn bộ (",q(parseFloat(g.soTien)),")"]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi chú"}),u.jsx("textarea",{name:"ghiChu",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ghi chú về thanh toán (tùy chọn)"})]}),u.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[u.jsx("button",{type:"button",onClick:()=>p(null),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Hủy"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Cập nhật thanh toán"})]})]})]})]})}),T&&u.jsx(Yj,{isOpen:T,onClose:()=>S(!1),onSave:Q=>{console.log("Payment data:",Q),S(!1),K("success","Thanh toán nhanh thành công!"),n&&M(n),n&&o&&B(n,o)}}),E&&u.jsx(qj,{isOpen:E,onClose:()=>C(!1),onSave:Q=>{console.log("Multiple payment data:",Q),C(!1),K("success",`Thanh toán thành công cho ${Q.totalHouseholds} hộ khẩu! Tổng số tiền: ${q(Q.totalAmount)}`),n&&M(n),n&&o&&B(n,o)}})]})})},Qj=({isOpen:e,onClose:t,onSave:n})=>{const a=new Date().toISOString().slice(0,10),[r,l]=k.useState(""),[o,h]=k.useState(""),[f,x]=k.useState(a),[g,p]=k.useState(""),[y,_]=k.useState({}),[w,b]=k.useState(!1),[T,S]=k.useState(!1),[E,C]=k.useState(null);if(!e)return null;const A=r||o||f!==a||g,F=()=>{const I={};return r.trim()||(I.maDot="Vui lòng nhập mã đợt"),o.trim()||(I.tenDot="Vui lòng nhập tên đợt thu"),f||(I.ngayTao="Vui lòng chọn ngày tạo"),g||(I.hanThu="Vui lòng chọn hạn thu"),f&&g&&g<f&&(I.hanThu="Hạn thu phải lớn hơn hoặc bằng ngày tạo"),_(I),Object.keys(I).length===0},K=()=>{A?(b(!0),C("close")):O()},O=()=>{_({}),l(""),h(""),x(a),p(""),b(!1),S(!1),C(null),t()},P=()=>{F()&&(S(!0),C("save"))},M=()=>{n&&n({maDot:r,tenDot:o,ngayTao:f,hanThu:g}),O()},B=I=>{I.target===I.currentTarget&&K()};return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",onClick:B,children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md max-h-[90vh] overflow-y-auto relative",children:[u.jsx("button",{className:"absolute top-3 right-3 text-gray-400 hover:text-gray-700 text-2xl font-bold focus:outline-none",onClick:K,"aria-label":"Đóng",children:"×"}),u.jsx("h3",{className:"text-2xl font-bold text-center mb-6",children:"Thêm Đợt thu phí"}),u.jsxs("div",{className:"mb-4",children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Mã đợt ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",className:`mt-1 block w-full px-3 py-2 border ${y.maDot?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,placeholder:"Ví dụ: D004",value:r,onChange:I=>l(I.target.value)}),y.maDot&&u.jsx("p",{className:"text-xs text-red-500 mt-1",children:y.maDot})]}),u.jsxs("div",{className:"mb-4",children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tên đợt thu ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",className:`mt-1 block w-full px-3 py-2 border ${y.tenDot?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,placeholder:"Ví dụ: Tháng 6/2025",value:o,onChange:I=>h(I.target.value)}),y.tenDot&&u.jsx("p",{className:"text-xs text-red-500 mt-1",children:y.tenDot})]}),u.jsxs("div",{className:"mb-4",children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Ngày tạo ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"date",className:`mt-1 block w-full px-3 py-2 border ${y.ngayTao?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,value:f,onChange:I=>x(I.target.value)}),y.ngayTao&&u.jsx("p",{className:"text-xs text-red-500 mt-1",children:y.ngayTao})]}),u.jsxs("div",{className:"mb-8",children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Hạn thu ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"date",className:`mt-1 block w-full px-3 py-2 border ${y.hanThu?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,value:g,onChange:I=>p(I.target.value)}),y.hanThu&&u.jsx("p",{className:"text-xs text-red-500 mt-1",children:y.hanThu})]}),u.jsxs("div",{className:"flex gap-4",children:[u.jsx("button",{className:"flex-1 px-4 py-3 bg-gray-500 text-white text-base font-semibold rounded-md shadow-sm hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all",onClick:K,children:"Hủy"}),u.jsx("button",{className:"flex-1 px-4 py-3 bg-blue-500 text-white text-base font-semibold rounded-md shadow-sm hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all",onClick:P,children:"Lưu"})]})]})}),(w||T)&&u.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60]",onClick:()=>{b(!1),S(!1),C(null)},children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl px-8 py-7 max-w-sm w-full relative",onClick:I=>I.stopPropagation(),children:[u.jsxs("p",{className:"text-base text-gray-800 mb-6 text-center font-medium",children:[w&&"Những thay đổi hiện tại sẽ không được lưu lại. Bạn vẫn muốn thoát?",T&&"Bạn xác nhận tạo đợt thu phí mới này?"]}),u.jsxs("div",{className:"flex gap-4 w-full",children:[u.jsx("button",{className:"flex-1 px-4 py-2.5 bg-gray-400 text-white rounded hover:bg-gray-500 font-medium transition-colors",onClick:()=>{b(!1),S(!1),C(null)},children:w?"Chỉnh sửa tiếp":"Hủy"}),u.jsx("button",{className:"flex-1 px-4 py-2.5 bg-blue-500 text-white rounded hover:bg-blue-600 font-medium transition-colors",onClick:()=>{E==="close"&&O(),E==="save"&&M()},children:w?"Thoát":"Xác nhận"})]})]})})]})},Zj=({isOpen:e,onClose:t,onSave:n,batch:a})=>{var H,Z;const r=new Date().toISOString().slice(0,10),[l,o]=k.useState(""),[h,f]=k.useState(""),[x,g]=k.useState(r),[p,y]=k.useState(""),[_,w]=k.useState([]),[b,T]=k.useState([]),[S,E]=k.useState({}),[C,A]=k.useState(!1),[F,K]=k.useState(!1),[O,P]=k.useState(null),[M,B]=k.useState(!1),I=j=>{if(!j)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(j))return j;const V=j.split("/");return V.length!==3?"":`${V[2]}-${V[1]}-${V[0]}`},te=j=>{if(!j)return"";const V=j.split("-");return V.length!==3?j:`${V[2]}/${V[1]}/${V[0]}`};k.useEffect(()=>{var j;if(a&&(o(a.maDot||""),f(a.tenDot||""),g(I(a.ngayTao)||r),y(I(a.hanCuoi)||""),(j=a.details)!=null&&j.khoanThu)){const V=a.details.khoanThu.map(U=>({khoanThuId:U.id,soTien:U.soTienMacDinh||0}));T(V)}},[a,r]),k.useEffect(()=>{(async()=>{if(e)try{B(!0);const V=await y2.getAll();V.success&&w(V.data)}catch(V){console.error("Error loading KhoanThu:",V)}finally{B(!1)}})()},[e]);const q=(j,V)=>{T(V?U=>[...U,{khoanThuId:j,soTien:0}]:U=>U.filter(Te=>Te.khoanThuId!==j))},ae=(j,V)=>{T(U=>U.map(Te=>Te.khoanThuId===j?{...Te,soTien:V}:Te))};if(!e)return null;const re=a&&(l!==a.maDot||h!==a.tenDot||te(x)!==a.ngayTao||te(p)!==a.hanCuoi||JSON.stringify(b)!==JSON.stringify(((Z=(H=a.details)==null?void 0:H.khoanThu)==null?void 0:Z.map(j=>({khoanThuId:j.id,soTien:j.soTienMacDinh||0})))||[])),ee=()=>{const j={};return l.trim()||(j.maDot="Vui lòng nhập mã đợt"),h.trim()||(j.tenDot="Vui lòng nhập tên đợt thu"),x||(j.ngayTao="Vui lòng chọn ngày tạo"),p||(j.hanThu="Vui lòng chọn hạn thu"),x&&p&&p<x&&(j.hanThu="Hạn thu phải lớn hơn hoặc bằng ngày tạo"),E(j),Object.keys(j).length===0},Q=()=>{re?(A(!0),P("close")):me()},me=()=>{E({}),o(""),f(""),g(r),y(""),T([]),A(!1),K(!1),P(null),t()},ye=()=>{ee()&&(K(!0),P("save"))},Y=()=>{const j=b.reduce((V,U)=>V+(U.soTien||0),0);n&&n({maDot:l,tenDot:h,ngayTao:te(x),hanThu:te(p),khoanThu:b,soTien:j}),me()},de=j=>{j.target===j.currentTarget&&Q()};return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",onClick:de,children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md max-h-[90vh] overflow-y-auto relative",onClick:j=>j.stopPropagation(),children:[u.jsx("button",{className:"absolute top-3 right-3 text-gray-400 hover:text-gray-700 text-2xl font-bold focus:outline-none",onClick:Q,"aria-label":"Đóng",children:"×"}),u.jsx("h3",{className:"text-2xl font-bold text-center mb-6",children:"Chỉnh sửa đợt thu phí"}),u.jsxs("div",{className:"mb-4",children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Mã đợt ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",className:`mt-1 block w-full px-3 py-2 border ${S.maDot?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,placeholder:"Ví dụ: D004",value:l,onChange:j=>o(j.target.value)}),S.maDot&&u.jsx("p",{className:"text-xs text-red-500 mt-1",children:S.maDot})]}),u.jsxs("div",{className:"mb-4",children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tên đợt thu ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",className:`mt-1 block w-full px-3 py-2 border ${S.tenDot?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,placeholder:"Ví dụ: Tháng 6/2025",value:h,onChange:j=>f(j.target.value)}),S.tenDot&&u.jsx("p",{className:"text-xs text-red-500 mt-1",children:S.tenDot})]}),u.jsxs("div",{className:"mb-4",children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Ngày tạo ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"date",className:`mt-1 block w-full px-3 py-2 border ${S.ngayTao?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,value:x,onChange:j=>g(j.target.value)}),S.ngayTao&&u.jsx("p",{className:"text-xs text-red-500 mt-1",children:S.ngayTao})]}),u.jsxs("div",{className:"mb-8",children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Hạn thu ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"date",className:`mt-1 block w-full px-3 py-2 border ${S.hanThu?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,value:p,onChange:j=>y(j.target.value)}),S.hanThu&&u.jsx("p",{className:"text-xs text-red-500 mt-1",children:S.hanThu})]}),u.jsxs("div",{className:"mb-8",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Chọn khoản thu cho đợt này"}),M?u.jsx("div",{className:"text-center py-4 text-gray-500",children:"Đang tải khoản thu..."}):u.jsx("div",{className:"space-y-3 max-h-48 overflow-y-auto border border-gray-200 rounded-md p-3",children:_.length===0?u.jsx("div",{className:"text-center py-4 text-gray-500",children:"Không có khoản thu nào"}):_.map(j=>{const V=b.some(Te=>Te.khoanThuId===j.id),U=b.find(Te=>Te.khoanThuId===j.id);return u.jsxs("div",{className:"flex items-center space-x-3 p-2 border border-gray-100 rounded",children:[u.jsx("input",{type:"checkbox",checked:V,onChange:Te=>q(j.id,Te.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("span",{className:"text-sm font-medium text-gray-900",children:j.tenKhoan}),j.batBuoc&&u.jsx("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Bắt buộc"}),j.ghiChu&&u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:j.ghiChu})]}),V&&u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("span",{className:"text-xs text-gray-500",children:"Số tiền:"}),u.jsx("input",{type:"number",value:(U==null?void 0:U.soTien)||0,onChange:Te=>ae(j.id,parseInt(Te.target.value)||0),className:"w-24 px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"0",min:"0"}),u.jsx("span",{className:"text-xs text-gray-500",children:"VND"})]})]},j.id)})})]}),u.jsxs("div",{className:"flex gap-4",children:[u.jsx("button",{className:"flex-1 px-4 py-3 bg-gray-500 text-white text-base font-semibold rounded-md shadow-sm hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all",onClick:Q,children:"Hủy"}),u.jsx("button",{className:"flex-1 px-4 py-3 bg-blue-500 text-white text-base font-semibold rounded-md shadow-sm hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all",onClick:ye,children:"Lưu"})]})]})}),(C||F)&&u.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60]",onClick:()=>{A(!1),K(!1),P(null)},children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl px-8 py-7 max-w-sm w-full relative",onClick:j=>j.stopPropagation(),children:[u.jsxs("p",{className:"text-base text-gray-800 mb-6 text-center font-medium",children:[C&&"Những thay đổi hiện tại sẽ không được lưu lại. Bạn vẫn muốn thoát?",F&&"Bạn xác nhận lưu các thay đổi cho đợt thu phí này?"]}),u.jsxs("div",{className:"flex gap-4 w-full",children:[u.jsx("button",{className:"flex-1 px-4 py-2.5 bg-gray-400 text-white rounded hover:bg-gray-500 font-medium transition-colors",onClick:()=>{A(!1),K(!1),P(null)},children:C?"Chỉnh sửa tiếp":"Hủy"}),u.jsx("button",{className:"flex-1 px-4 py-2.5 bg-blue-500 text-white rounded hover:bg-blue-600 font-medium transition-colors",onClick:()=>{O==="close"&&me(),O==="save"&&Y()},children:C?"Thoát":"Xác nhận"})]})]})})]})},Lo={PHI_DICH_VU:{id:"PHI_DICH_VU",name:"Phí dịch vụ chung cư",rate:1e4,mandatory:!0,calculateByArea:!0},PHI_QUAN_LY:{id:"PHI_QUAN_LY",name:"Phí quản lý chung cư",rate:7e3,mandatory:!0,calculateByArea:!0},PHI_GUI_XE:{id:"PHI_GUI_XE",name:"Phí gửi xe",rateMotorbike:7e4,rateCar:12e5,mandatory:!0,calculateByVehicle:!0},PHI_DIEN:{id:"PHI_DIEN",name:"Phí điện",mandatory:!0,importable:!0},PHI_NUOC:{id:"PHI_NUOC",name:"Phí nước",mandatory:!0,importable:!0},PHI_INTERNET:{id:"PHI_INTERNET",name:"Phí internet",mandatory:!0,importable:!0},KHOAN_DONG_GOP:{id:"KHOAN_DONG_GOP",name:"Khoản đóng góp",mandatory:!1,voluntary:!0}},ko=[{id:"HK001",owner:"Nguyễn Văn A",area:75.5,vehicles:{motorbikes:2,cars:0}},{id:"HK002",owner:"Trần Thị B",area:100.2,vehicles:{motorbikes:1,cars:1}},{id:"HK003",owner:"Lê Văn C",area:60,vehicles:{motorbikes:3,cars:0}},{id:"HK004",owner:"Phạm Thị D",area:120.5,vehicles:{motorbikes:1,cars:1}},{id:"HK005",owner:"Hoàng Văn E",area:85,vehicles:{motorbikes:2,cars:1}}],uv=({isOpen:e,onClose:t,onSave:n,initialData:a,title:r="Thêm khoản thu"})=>{const[l,o]=k.useState(""),[h,f]=k.useState(""),[x,g]=k.useState({}),[p,y]=k.useState(null),[_,w]=k.useState(""),[b,T]=k.useState({}),[S,E]=k.useState(!1),[C,A]=k.useState(!1),[F,K]=k.useState(null),[O,P]=k.useState(null),M=!!a,B=Lo[l],I=B&&(B.calculateByArea||B.calculateByVehicle),te=B==null?void 0:B.importable,q=ie=>ie?new Intl.NumberFormat("vi-VN").format(ie):"",ae=ie=>{const _e=Lo[ie];if(!_e)return{};const Ne={};return ko.forEach(Ie=>{let Ue=0;"calculateByArea"in _e&&_e.calculateByArea?Ue=Math.round(Ie.area*_e.rate):"calculateByVehicle"in _e&&_e.calculateByVehicle?Ue=Ie.vehicles.motorbikes*_e.rateMotorbike+Ie.vehicles.cars*_e.rateCar:"voluntary"in _e&&_e.voluntary&&(Ue=0),Ne[Ie.id]={amount:Ue,auto:!0}}),Ne},re=ie=>{o(ie),ie==="PHI_DIEN"||ie==="PHI_NUOC"||ie==="PHI_INTERNET"?(g({}),y(null),P(null)):ie?(g(ae(ie)),y(null),P(null)):(g({}),y(null),P(null))},ee=(ie,_e)=>{const Ne=_e.replace(/[^\d]/g,"");g(Ie=>({...Ie,[ie]:{amount:parseInt(Ne)||0,auto:!1}}))},Q=async ie=>{const _e=ie.target.files;if(!_e||_e.length===0){y(null);return}const Ne=_e[0];if(!Ne.name.endsWith(".xlsx")&&!Ne.name.endsWith(".xls")&&!Ne.name.endsWith(".csv")){w("Vui lòng chọn file Excel (.xlsx, .xls) hoặc CSV (.csv)"),y(null);return}w(""),y(Ne),P(Ne.name);try{let Ie="";Ne.name.endsWith(".csv")?Ie=await Ne.text():Ie=await Ne.text();const Ue=Ie.split(/\r?\n/).filter(ft=>ft.trim()!=="");if(Ue.length<2)throw new Error("File phải có ít nhất 1 dòng dữ liệu");const at=Ue[0].split(",").map(ft=>ft.trim().toLowerCase()),Ye=at.findIndex(ft=>ft.includes("mã hộ")),nn=at.findIndex(ft=>ft.includes("chủ hộ")),xt=at.findIndex(ft=>ft.includes("số tiền"));if(Ye===-1||nn===-1||xt===-1)throw new Error("File phải có đủ 3 cột: Mã hộ, Chủ hộ, Số tiền");const Fe={};for(let ft=1;ft<Ue.length;++ft){const pe=Ue[ft].split(",");if(pe.length<3)continue;const ke=pe[Ye].trim(),ze=pe[nn].trim(),et=parseInt(pe[xt].replace(/[^\d]/g,""))||0;!ke||!ze||(Fe[ke]={amount:et,auto:!1,owner:ze})}if(Object.keys(Fe).length===0)throw new Error("Không có dữ liệu hợp lệ trong file");g(Fe),w("")}catch(Ie){w("Lỗi đọc file: "+(Ie.message||"Định dạng không hợp lệ"))}};k.useEffect(()=>{a?(o(a.type||""),f(a.chiTiet||""),a.householdFees?g(a.householdFees):a.type&&g(ae(a.type)),a.importedFileName&&P(a.importedFileName)):(o(""),f(""),g({}),y(null),w(""),P(null))},[a,e]);const me=l!==""||h!==""||Object.keys(x).length>0||p!==null,ye=()=>{const ie={};return l||(ie.feeType="Vui lòng chọn loại phí"),B&&"voluntary"in B&&B.voluntary&&!h.trim()&&(ie.chiTiet="Vui lòng nhập mô tả cho khoản đóng góp"),(I||te)&&Object.keys(x).length===0&&(ie.householdFees="Vui lòng nhập số tiền cho các hộ"),T(ie),Object.keys(ie).length===0},Y=()=>{me?(E(!0),K("close")):de()},de=()=>{T({}),o(""),f(""),g({}),y(null),w(""),E(!1),A(!1),K(null),P(null),t()},H=()=>{ye()&&(A(!0),K("save"))},Z=()=>{if(n){const ie=Lo[l],_e={type:l,tenKhoan:(ie==null?void 0:ie.name)||"",chiTiet:h,batBuoc:ie!=null&&ie.mandatory?"Bắt buộc":"Không bắt buộc",householdFees:x,importedFileName:O||void 0};n(_e)}de()},j=ie=>{ie.target===ie.currentTarget&&Y()},V=k.useMemo(()=>Object.values(x).reduce((ie,{amount:_e})=>ie+_e,0),[x]),U=l==="PHI_DIEN"||l==="PHI_NUOC"||l==="PHI_INTERNET",Te=!U;return u.jsxs(u.Fragment,{children:[e&&u.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",onClick:j,children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-3xl max-h-[90vh] overflow-y-auto relative",onClick:ie=>ie.stopPropagation(),children:[u.jsx("button",{className:"absolute top-3 right-3 text-gray-400 hover:text-gray-700 text-2xl font-bold focus:outline-none",onClick:Y,"aria-label":"Đóng",children:"×"}),u.jsx("h3",{className:"text-2xl font-bold text-center mb-6",children:r}),u.jsxs("div",{className:"mb-4",children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Loại khoản thu ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsxs("select",{className:`mt-1 block w-full px-3 py-2 border ${b.feeType?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,value:l,onChange:ie=>re(ie.target.value),disabled:M,children:[u.jsx("option",{value:"",children:"-- Chọn loại khoản thu --"}),Object.values(Lo).map(ie=>u.jsx("option",{value:ie.id,children:ie.name},ie.id))]}),b.feeType&&u.jsx("p",{className:"text-xs text-red-500 mt-1",children:b.feeType})]}),u.jsxs("div",{className:"mb-4",children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[B&&"voluntary"in B&&B.voluntary?"Mô tả khoản đóng góp":"Chi tiết"," ",B&&"voluntary"in B&&B.voluntary&&u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("textarea",{className:`mt-1 block w-full px-3 py-2 border ${b.chiTiet?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,placeholder:B&&"voluntary"in B&&B.voluntary?"Nhập mô tả chi tiết về mục đích đóng góp...":"Mô tả chi tiết về khoản thu...",rows:3,value:h,onChange:ie=>f(ie.target.value)}),b.chiTiet&&u.jsx("p",{className:"text-xs text-red-500 mt-1",children:b.chiTiet})]}),U&&!Object.keys(x).length&&u.jsxs("div",{className:"mb-6 p-4 border border-dashed border-gray-300 rounded-lg",children:[u.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Import dữ liệu từ Excel/CSV"}),u.jsxs("p",{className:"text-sm text-gray-500 mb-3",children:["Định dạng file mẫu:",u.jsx("br",{}),u.jsx("b",{children:"Cột 1"}),": Mã hộ (ví dụ: HK001, HK002, ...)",u.jsx("br",{}),u.jsx("b",{children:"Cột 2"}),": Chủ hộ (ví dụ: Nguyễn Văn A, ...)",u.jsx("br",{}),u.jsx("b",{children:"Cột 3"}),": Số tiền (chỉ số, không có chữ VND, ví dụ: 150000)",u.jsx("br",{})]}),u.jsxs("label",{className:"flex items-center justify-center w-full",children:[u.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",className:"hidden",onChange:Q}),u.jsx("div",{className:"px-4 py-2 bg-blue-500 text-white text-sm font-medium rounded hover:bg-blue-600 cursor-pointer",children:"Chọn file"})]}),_&&u.jsx("p",{className:"mt-2 text-sm text-red-500",children:_})]}),U&&Object.keys(x).length>0&&u.jsxs("div",{className:"mb-6",children:[u.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[u.jsxs("span",{className:"text-sm text-gray-700",children:["File đã chọn: ",u.jsx("b",{children:O})]}),u.jsxs("label",{children:[u.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",className:"hidden",onChange:Q}),u.jsx("span",{className:"ml-2 px-3 py-1 bg-blue-100 text-blue-700 rounded cursor-pointer hover:bg-blue-200 transition",children:"Đổi file"})]})]}),u.jsx("div",{className:"border border-gray-200 rounded-lg max-h-60 overflow-y-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50 sticky top-0",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Mã hộ"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Chủ hộ"}),B&&"calculateByArea"in B&&B.calculateByArea&&u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Diện tích (m²)"}),B&&"calculateByVehicle"in B&&B.calculateByVehicle&&u.jsxs(u.Fragment,{children:[u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Xe máy"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Ô tô"})]}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Số tiền (VND)"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Object.entries(x).map(([ie,_e])=>{var Ne,Ie,Ue;return u.jsxs("tr",{children:[u.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:ie}),u.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:_e.owner||""}),B&&"calculateByArea"in B&&B.calculateByArea&&u.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:((Ne=ko.find(at=>at.id===ie))==null?void 0:Ne.area)||""}),B&&"calculateByVehicle"in B&&B.calculateByVehicle&&u.jsxs(u.Fragment,{children:[u.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:((Ie=ko.find(at=>at.id===ie))==null?void 0:Ie.vehicles.motorbikes)||""}),u.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:((Ue=ko.find(at=>at.id===ie))==null?void 0:Ue.vehicles.cars)||""})]}),u.jsx("td",{className:"px-4 py-2 text-sm",children:u.jsx("input",{type:"text",className:"block w-28 px-2 py-1 border border-gray-300 rounded-md shadow-sm text-sm focus:ring-blue-500 focus:border-blue-500 text-right transition-all hover:border-blue-400 focus:bg-blue-50",placeholder:"0",value:_e.amount?q(_e.amount):"",onChange:at=>g(Ye=>({...Ye,[ie]:{...Ye[ie],amount:parseInt(at.target.value.replace(/[^\d]/g,""))||0,auto:!1}})),inputMode:"numeric"})})]},ie)})})]})}),_&&u.jsx("p",{className:"text-xs text-red-500 mt-2",children:_})]}),Te&&I&&u.jsxs("div",{className:"mb-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u.jsx("h4",{className:"font-medium text-gray-700",children:"Số tiền theo hộ"}),u.jsxs("p",{className:"text-sm text-gray-500",children:["Tổng thu: ",u.jsxs("span",{className:"font-semibold text-gray-700",children:[q(V)," VND"]})]})]}),u.jsx("div",{className:"border border-gray-200 rounded-lg max-h-60 overflow-y-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50 sticky top-0",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Mã hộ"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Chủ hộ"}),B&&"calculateByArea"in B&&B.calculateByArea&&u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Diện tích (m²)"}),B&&"calculateByVehicle"in B&&B.calculateByVehicle&&u.jsxs(u.Fragment,{children:[u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Xe máy"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Ô tô"})]}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Số tiền (VND)"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ko.map(ie=>{var _e;return u.jsxs("tr",{children:[u.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:ie.id}),u.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:ie.owner}),B&&"calculateByArea"in B&&B.calculateByArea&&u.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:ie.area}),B&&"calculateByVehicle"in B&&B.calculateByVehicle&&u.jsxs(u.Fragment,{children:[u.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:ie.vehicles.motorbikes}),u.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:ie.vehicles.cars})]}),u.jsx("td",{className:"px-4 py-2 text-sm",children:u.jsx("input",{type:"text",className:"block w-28 px-2 py-1 border border-gray-300 rounded-md shadow-sm text-sm focus:ring-blue-500 focus:border-blue-500 text-right transition-all hover:border-blue-400 focus:bg-blue-50",placeholder:"0",value:(_e=x[ie.id])!=null&&_e.amount?q(x[ie.id].amount):"",onChange:Ne=>ee(ie.id,Ne.target.value),inputMode:"numeric"})})]},ie.id)})})]})}),b.householdFees&&u.jsx("p",{className:"text-xs text-red-500 mt-1",children:b.householdFees})]}),u.jsxs("div",{className:"flex gap-4 mt-4",children:[u.jsx("button",{className:"flex-1 px-4 py-3 bg-gray-500 text-white text-base font-semibold rounded-md shadow-sm hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all",onClick:Y,children:"Hủy"}),u.jsx("button",{className:"flex-1 px-4 py-3 bg-blue-500 text-white text-base font-semibold rounded-md shadow-sm hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all",onClick:H,children:"Lưu"})]})]})}),(S||C)&&u.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60]",onClick:()=>{E(!1),A(!1),K(null)},children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl px-8 py-7 max-w-sm w-full relative",onClick:ie=>ie.stopPropagation(),children:[u.jsxs("p",{className:"text-base text-gray-800 mb-6 text-center font-medium",children:[S&&"Những thay đổi hiện tại sẽ không được lưu lại. Bạn vẫn muốn thoát?",C&&M&&"Bạn xác nhận lưu thay đổi cho khoản thu này?",C&&!M&&"Bạn xác nhận tạo khoản thu mới này?"]}),u.jsxs("div",{className:"flex gap-4 w-full",children:[u.jsx("button",{className:"flex-1 px-4 py-2.5 bg-gray-400 text-white rounded hover:bg-gray-500 font-medium transition-colors",onClick:()=>{E(!1),A(!1),K(null)},children:S?"Chỉnh sửa tiếp":"Hủy"}),u.jsx("button",{className:"flex-1 px-4 py-2.5 bg-blue-500 text-white rounded hover:bg-blue-600 font-medium transition-colors",onClick:()=>{F==="close"&&de(),F==="save"&&Z()},children:S?"Thoát":"Xác nhận"})]})]})})]})},Jj=e=>{const t=e.toLowerCase();return t.includes("dịch vụ")||t.includes("dich vu")?"PHI_DICH_VU":t.includes("quản lý")||t.includes("quan ly")?"PHI_QUAN_LY":t.includes("gửi xe")||t.includes("gui xe")||t.includes("xe")?"PHI_GUI_XE":t.includes("điện")||t.includes("dien")?"PHI_DIEN":t.includes("nước")||t.includes("nuoc")?"PHI_NUOC":t.includes("internet")||t.includes("mạng")?"PHI_INTERNET":t.includes("vệ sinh")||t.includes("ve sinh")?"PHI_VE_SINH":"PHI_DICH_VU"},ah=[{maDot:"D001",tenDot:"Tháng 05/2025",ngayTao:"01/05/2025",hanCuoi:"31/05/2025",trangThai:"Đang mở",details:{maDot:"D001",tenDot:"Tháng 05/2025",ngayTao:"01/05/2025",hanCuoi:"31/05/2025",khoanThu:[{id:"K001",type:"PHI_DICH_VU",tenKhoan:"Phí dịch vụ chung cư",chiTiet:"Phí dịch vụ tháng 5",batBuoc:"Bắt buộc",householdFees:{HK001:{amount:755e3,auto:!0},HK002:{amount:1002e3,auto:!0},HK003:{amount:6e5,auto:!0},HK004:{amount:1205e3,auto:!0},HK005:{amount:85e4,auto:!0}}},{id:"K002",type:"PHI_GUI_XE",tenKhoan:"Phí gửi xe",chiTiet:"Phí gửi xe tháng 5",batBuoc:"Bắt buộc",householdFees:{HK001:{amount:14e4,auto:!0},HK002:{amount:127e4,auto:!0},HK003:{amount:21e4,auto:!0},HK004:{amount:127e4,auto:!0},HK005:{amount:134e4,auto:!0}}}]},isExpanded:!1},{maDot:"D002",tenDot:"Tháng 04/2025",ngayTao:"01/04/2025",hanCuoi:"30/04/2025",trangThai:"Đã đóng",details:{maDot:"D002",tenDot:"Tháng 04/2025",ngayTao:"01/04/2025",hanCuoi:"30/04/2025",khoanThu:[{id:"K004",type:"PHI_DICH_VU",tenKhoan:"Phí dịch vụ chung cư",chiTiet:"Phí dịch vụ tháng 4",batBuoc:"Bắt buộc",householdFees:{HK001:{amount:7e5,auto:!0},HK002:{amount:95e4,auto:!0},HK003:{amount:6e5,auto:!0},HK004:{amount:12e5,auto:!0},HK005:{amount:8e5,auto:!0}}},{id:"K005",type:"PHI_GUI_XE",tenKhoan:"Phí gửi xe",chiTiet:"Phí gửi xe tháng 4",batBuoc:"Bắt buộc",householdFees:{HK001:{amount:7e4,auto:!0},HK002:{amount:127e4,auto:!0},HK003:{amount:21e4,auto:!0},HK004:{amount:127e4,auto:!0},HK005:{amount:134e4,auto:!0}}}]},isExpanded:!1},{maDot:"D003",tenDot:"Quý I /2025",ngayTao:"01/01/2025",hanCuoi:"31/03/2025",trangThai:"Đã đóng",details:{maDot:"D003",tenDot:"Quý I /2025",ngayTao:"01/01/2025",hanCuoi:"31/03/2025",khoanThu:[{id:"K006",type:"PHI_QUAN_LY",tenKhoan:"Phí quản lý",chiTiet:"Phí quản lý quý",batBuoc:"Bắt buộc",householdFees:{HK001:{amount:4e5,auto:!0},HK002:{amount:7e5,auto:!0},HK003:{amount:3e5,auto:!0},HK004:{amount:9e5,auto:!0},HK005:{amount:5e5,auto:!0}}},{id:"K007",type:"KHOAN_DONG_GOP",tenKhoan:"Phí sửa chữa chung",chiTiet:"Sửa chữa cơ sở vật chất",batBuoc:"Không bắt buộc",householdFees:{HK001:{amount:1e5,auto:!0},HK002:{amount:2e5,auto:!0},HK003:{amount:0,auto:!0},HK004:{amount:0,auto:!0},HK005:{amount:0,auto:!0}}}]},isExpanded:!1}],ek=()=>{const[e,t]=k.useState(!1),[n,a]=k.useState(!1),[r,l]=k.useState(null),[o,h]=k.useState(""),[f,x]=k.useState("Tất cả"),[g,p]=k.useState([]),[y,_]=k.useState(!0),[w,b]=k.useState(null),[T,S]=k.useState(!1),[E,C]=k.useState(!1),[A,F]=k.useState(!1),[K,O]=k.useState(!1),[P,M]=k.useState(null),[B,I]=k.useState(null),[te,q]=k.useState(null);k.useEffect(()=>{console.log("🚀 QuanLyDotThuPhi component mounted"),ae()},[]);const ae=async()=>{try{_(!0),b(null),console.log("🔄 Loading fee collection data from API..."),console.log("📊 Current batches state:",g),console.log("📊 Sample batches available:",ah),console.log("🔑 Checking authentication token...");const pe=localStorage.getItem("authToken");if(console.log("🔑 Auth token:",pe?"Present":"Missing"),!pe){console.warn("⚠️  No auth token found, using sample data"),b("Vui lòng đăng nhập để tải dữ liệu từ server."),p(ah);return}try{const ke=await Kn.dotThu.getAll({page:0,size:100,sortBy:"createdAt",sortDir:"desc"});if(console.log("📊 API Response:",ke),ke&&ke.success&&ke.dotThus){const ze=ke.dotThus.map(et=>{const Dt=(et.khoanThu||[]).map(lt=>({id:lt.id,type:Jj(lt.tenkhoanthu),tenKhoan:lt.tenkhoanthu,chiTiet:lt.ghichu||lt.tenkhoanthu,batBuoc:lt.batbuoc?"Bắt buộc":"Không bắt buộc",soTien:lt.DotThu_KhoanThu&&lt.DotThu_KhoanThu.soTien!==void 0&&lt.DotThu_KhoanThu.soTien!==null?Number(lt.DotThu_KhoanThu.soTien):void 0,householdFees:{}}));return console.log("🔄 Transformed khoanThu for dotThu",et.id,":",Dt),{maDot:et.id,tenDot:et.tenDotThu,ngayTao:re(et.ngayTao),hanCuoi:re(et.thoiHan),trangThai:ee(et.thoiHan)?"Đã đóng":"Đang mở",details:{maDot:et.id,tenDot:et.tenDotThu,ngayTao:re(et.ngayTao),hanCuoi:re(et.thoiHan),khoanThu:Dt},isExpanded:!1}});console.log("✅ Transformed batches:",ze),p(ze)}else console.log("⚠️  No data returned from API or invalid response structure:",ke),p([])}catch(ke){console.warn("⚠️  API call failed, using sample data as fallback:",ke),b("Không thể tải dữ liệu từ server. Đang hiển thị dữ liệu mẫu."),p(ah)}}catch(pe){console.error("❌ Error loading fee collection data:",pe),b("Không thể tải dữ liệu đợt thu phí. Đang sử dụng dữ liệu mẫu."),p(ah)}finally{_(!1)}},re=pe=>new Date(pe).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}),ee=pe=>{const ke=new Date;return new Date(pe)<ke},Q=pe=>{if(!pe)return;let ke;if(typeof pe=="string")if(pe.includes("/")){const ze=pe.split("/");ze.length===3?ke=new Date(parseInt(ze[2],10),parseInt(ze[1],10)-1,parseInt(ze[0],10)):ke=new Date(pe)}else ke=new Date(pe);else ke=pe;if(ke&&!isNaN(ke.getTime()))return ke.toISOString().split("T")[0];console.warn("Invalid date input for formatDateForAPI:",pe)},me=pe=>{const ke=new Date().toISOString().slice(0,10),ze=pe.hanCuoi;return ke>ze&&pe.trangThai==="Đang mở"?{...pe,trangThai:"Đã đóng"}:pe},ye=g.map(me).filter(pe=>{const ke=pe.tenDot.toLowerCase().includes(o.toLowerCase()),ze=f==="Tất cả"?!0:f==="Đang mở"?pe.trangThai==="Đang mở":pe.trangThai==="Đã đóng";return ke&&ze});console.log("🔍 Debug render state:"),console.log("- Batches:",g),console.log("- Filtered batches:",ye),console.log("- Loading:",y),console.log("- Error:",w),console.log("- Search:",o),console.log("- Filter:",f);const Y=pe=>{p(ke=>ke.map(ze=>ze.maDot===pe?{...ze,isExpanded:!ze.isExpanded}:ze))},de=()=>t(!0),H=()=>t(!1),Z=(pe,ke)=>{ke.stopPropagation(),l(pe),a(!0)},j=()=>{a(!1),l(null)},V=(pe,ke)=>{ke.stopPropagation(),l(pe),S(!0)},U=()=>{S(!1),l(null)},Te=async()=>{if(r)try{console.log("🔄 Deleting batch:",r.maDot);const pe=await Kn.dotThu.delete(r.maDot);if(pe.success)console.log("✅ Batch deleted successfully"),await ae(),U(),alert("Đã xóa đợt thu thành công!");else throw new Error(pe.message||"Không thể xóa đợt thu")}catch(pe){console.error("❌ Error deleting batch:",pe),alert("Có lỗi xảy ra khi xóa đợt thu: "+(pe.message||"Lỗi không xác định")),p(ke=>ke.filter(ze=>ze.maDot!==r.maDot)),U()}},ie=(pe,ke)=>{if(ke.stopPropagation(),pe.trangThai==="Đã đóng"){q("Không thể thêm khoản thu vào đợt thu đã đóng.");return}l(pe),I(pe),M(null),C(!0)},_e=()=>{C(!1)},Ne=async pe=>{if(B)try{const ke=await Kn.khoanThu.create({tenKhoan:pe.tenKhoan,batBuoc:pe.batBuoc==="Bắt buộc",ghiChu:pe.chiTiet||""});if(ke.success){const ze=ke.data.id,et=pe.householdFees?Object.values(pe.householdFees).reduce((Bn,Ea)=>Bn+(Ea.amount||0),0):0,Dt=[...B.details.khoanThu.map(Bn=>({khoanThuId:String(Bn.id),soTien:Bn.soTien!==void 0?parseFloat(Bn.soTien):0})),{khoanThuId:String(ze),soTien:et}],lt=await Kn.dotThu.update(B.maDot,{khoanThu:Dt});lt.success?(await ae(),_e(),alert("Đã tạo khoản thu thành công!")):alert("Có lỗi xảy ra khi gắn khoản thu vào đợt thu: "+(lt.message||"Lỗi không xác định"))}else alert("Có lỗi xảy ra khi tạo khoản thu: "+(ke.message||"Lỗi không xác định"))}catch(ke){console.error("Error creating fee type:",ke),alert("Có lỗi xảy ra khi tạo khoản thu: "+(ke.message||"Lỗi không xác định"))}},Ie=(pe,ke,ze)=>{ze.stopPropagation(),M(pe),I(ke),F(!0)},Ue=()=>{F(!1),M(null)},at=async pe=>{if(B&&P)try{if(P.id&&(P.tenKhoan!==pe.tenKhoan||P.batBuoc!==(pe.batBuoc==="Bắt buộc")||P.chiTiet!==pe.chiTiet)){const et=await Kn.khoanThu.update(P.id,{tenKhoan:pe.tenKhoan,batBuoc:pe.batBuoc==="Bắt buộc",ghiChu:pe.chiTiet||""});if(!et.success){alert("Có lỗi xảy ra khi cập nhật chi tiết khoản thu: "+(et.message||"Lỗi không xác định"));return}}const ke=B.details.khoanThu.map(et=>{if(et.id===P.id){const Dt=pe.householdFees?Object.values(pe.householdFees).reduce((lt,Bn)=>lt+(Bn.amount||0),0):pe.soTien?parseFloat(pe.soTien):0;return{khoanThuId:String(et.id),soTien:Dt}}return{khoanThuId:String(et.id),soTien:et.soTien!==void 0&&et.soTien!==null?parseFloat(et.soTien):0}}),ze=await Kn.dotThu.update(B.maDot,{khoanThu:ke});ze.success?(await ae(),Ue(),alert("Đã cập nhật khoản thu thành công!")):alert("Có lỗi xảy ra khi cập nhật số tiền khoản thu trong đợt thu: "+(ze.message||"Lỗi không xác định"))}catch(ke){console.error("Error updating fee type:",ke),alert("Có lỗi xảy ra khi cập nhật khoản thu: "+(ke.message||"Lỗi không xác định"))}},Ye=(pe,ke,ze)=>{ze.stopPropagation(),M(pe),I(ke),O(!0)},nn=()=>{O(!1),M(null)},xt=async()=>{if(B&&P)try{const pe=B.details.khoanThu.filter(ze=>ze.id!==P.id).map(ze=>({khoanThuId:String(ze.id),soTien:ze.soTien!==void 0&&ze.soTien!==null?parseFloat(ze.soTien):0})),ke=await Kn.dotThu.update(B.maDot,{khoanThu:pe});ke.success?(console.log("✅ Fee association removed successfully from DotThu"),await ae(),nn(),alert("Đã xóa khoản thu khỏi đợt thu thành công!")):alert("Có lỗi xảy ra khi xóa khoản thu khỏi đợt thu: "+(ke.message||"Lỗi không xác định"))}catch(pe){console.error("Error deleting fee from DotThu:",pe),alert("Có lỗi xảy ra khi xóa khoản thu: "+(pe.message||"Lỗi không xác định"))}},Fe=async pe=>{try{console.log("🔄 Creating new batch:",pe);const ke=await Kn.dotThu.create({tenDotThu:pe.tenDot,ngayTao:Q(pe.ngayTao)||pe.ngayTao,thoiHan:Q(pe.hanThu)||pe.hanThu});if(ke.success)console.log("✅ Batch created successfully:",ke.data),await ae(),alert("Đã tạo đợt thu mới thành công!");else throw new Error(ke.message||"Không thể tạo đợt thu")}catch(ke){console.error("❌ Error creating batch:",ke),alert("Có lỗi xảy ra khi tạo đợt thu: "+(ke.message||"Lỗi không xác định"));const ze=new Date().toISOString().slice(0,10),et=pe.hanThu>=ze?"Đang mở":"Đã đóng";p(Dt=>[{maDot:pe.maDot,tenDot:pe.tenDot,ngayTao:pe.ngayTao,hanCuoi:pe.hanThu,trangThai:et,details:{maDot:pe.maDot,tenDot:pe.tenDot,ngayTao:pe.ngayTao,hanCuoi:pe.hanThu,khoanThu:[]},isExpanded:!1},...Dt])}},ft=async pe=>{if(r&&r.maDot)try{const ke={tenDotThu:pe.tenDot,ngayTao:Q(pe.ngayTao),thoiHan:Q(pe.hanThu),khoanThu:Array.isArray(pe.khoanThu)?pe.khoanThu.map(Dt=>({khoanThuId:String(Dt.khoanThuId),soTien:Dt.soTien})):[]},ze=Object.fromEntries(Object.entries(ke).filter(([Dt,lt])=>lt!==void 0)),et=await Kn.dotThu.update(r.maDot,ze);et.success?(await ae(),j(),alert("Đã cập nhật đợt thu thành công!")):alert("Có lỗi xảy ra khi cập nhật đợt thu: "+(et.message||"Lỗi không xác định"))}catch(ke){console.error("Error updating batch:",ke),alert("Có lỗi xảy ra khi cập nhật đợt thu: "+(ke.message||"Lỗi không xác định"))}};return u.jsxs(u.Fragment,{children:[u.jsx(kn,{role:"ketoan",children:u.jsxs("div",{className:"p-4 flex flex-col gap-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"QUẢN LÝ ĐỢT THU PHÍ"}),u.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Chào mừng đến với Hệ thống Quản lý Thu phí Chung cư"})]}),w&&u.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),w,u.jsx("button",{onClick:()=>{b(null),ae()},className:"ml-auto text-sm underline hover:no-underline",children:"Thử lại"})]})}),y?u.jsx("div",{className:"flex items-center justify-center py-12",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),u.jsx("span",{className:"text-gray-600",children:"Đang tải dữ liệu..."})]})}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md shadow-sm overflow-hidden flex-1",children:[u.jsx("div",{className:"p-2 text-gray-400",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),u.jsx("input",{type:"text",placeholder:"Tìm đợt thu...",className:"flex-1 p-2 border-l border-gray-300 outline-none text-sm",autoFocus:!0,value:o,onChange:pe=>h(pe.target.value)})]}),u.jsx("div",{className:"border border-gray-300 rounded-md shadow-sm overflow-hidden bg-white",children:u.jsxs("select",{className:"p-2 text-sm bg-white outline-none",value:f,onChange:pe=>x(pe.target.value),children:[u.jsx("option",{value:"Tất cả",children:"Tất cả"}),u.jsx("option",{value:"Đang mở",children:"Đang mở"}),u.jsx("option",{value:"Đã đóng",children:"Đã đóng"})]})}),u.jsxs("button",{className:"bg-blue-500 text-white px-4 py-2 rounded-md shadow-sm hover:bg-blue-600 flex items-center gap-2",onClick:de,children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Tạo đợt thu mới"]})]}),u.jsxs("div",{className:"bg-white rounded-md shadow-md overflow-hidden border border-gray-200",children:[u.jsx("div",{className:"p-4 bg-gray-100 border-b border-gray-200",children:u.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Danh sách đợt thu"})}),u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Mã đợt"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Tên đợt"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Ngày tạo"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Hạn cuối"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Trạng thái"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Thao tác"})]})}),u.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[(console.log("🎯 Rendering table with filteredBatches:",ye),console.log("🎯 filteredBatches.length:",ye.length),null),ye.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500",children:"Không có đợt thu phí nào"})}):ye.map(pe=>u.jsxs(Uh.Fragment,{children:[u.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition-all",onClick:()=>Y(pe.maDot),children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:pe.maDot}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"mr-2",children:pe.tenDot}),pe.isExpanded?u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:pe.ngayTao}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:pe.hanCuoi}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${pe.trangThai==="Đang mở"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:pe.trangThai})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.jsxs("div",{className:"flex space-x-4",children:[u.jsx("button",{onClick:ke=>Z(pe,ke),className:"text-indigo-600 hover:text-indigo-900",title:"Chỉnh sửa",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),u.jsx("button",{onClick:ke=>V(pe,ke),className:"text-red-600 hover:text-red-800",title:"Xóa",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]}),pe.isExpanded&&u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-0 py-0 bg-gray-50",children:u.jsxs("div",{className:"p-4",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3",children:[u.jsx("h3",{className:"text-md font-semibold text-gray-800",children:"Danh sách khoản thu"}),u.jsxs("button",{className:"bg-blue-500 text-white px-3 py-1 rounded-md text-sm hover:bg-blue-600 flex items-center gap-1",onClick:ke=>ie(pe,ke),children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thêm khoản thu"]})]}),pe.details.khoanThu.length>0?u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-100",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Loại khoản thu"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Mô tả"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Tổng tiền"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Bắt buộc"}),u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Thao tác"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:pe.details.khoanThu.map(ke=>{const ze=Lo[ke.type],et=ke.soTien!==void 0&&ke.soTien!==null?parseFloat(ke.soTien):ke.householdFees?Object.values(ke.householdFees).reduce((Dt,lt)=>Dt+(lt.amount||0),0):0;return u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:(ze==null?void 0:ze.name)||ke.tenKhoan||"Không xác định"}),u.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:ke.chiTiet}),u.jsxs("td",{className:"px-4 py-3 text-sm text-blue-700 font-semibold",children:[et.toLocaleString("vi-VN")," VND"]}),u.jsx("td",{className:"px-4 py-3 text-sm",children:u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ke.batBuoc==="Bắt buộc"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:ke.batBuoc})}),u.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:u.jsxs("div",{className:"flex space-x-3",children:[u.jsx("button",{onClick:Dt=>Ie(ke,pe,Dt),className:"text-indigo-600 hover:text-indigo-900",title:"Chỉnh sửa",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),u.jsx("button",{onClick:Dt=>Ye(ke,pe,Dt),className:"text-red-600 hover:text-red-800",title:"Xóa",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},ke.id)})})]})}):u.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Chưa có khoản thu nào"})]})})})]},pe.maDot))]})]})]})]})]})}),u.jsx(Qj,{isOpen:e,onClose:H,onSave:Fe}),u.jsx(Zj,{isOpen:n,onClose:j,onSave:ft,batch:r}),u.jsx(uv,{isOpen:E,onClose:_e,onSave:Ne,title:"Thêm khoản thu"}),u.jsx(uv,{isOpen:A,onClose:Ue,onSave:at,initialData:P,title:"Chỉnh sửa khoản thu"}),T&&r&&u.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",onClick:U,children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-sm w-full relative",onClick:pe=>pe.stopPropagation(),children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Xác nhận xóa"}),u.jsxs("p",{className:"text-gray-700 mb-6",children:["Bạn có chắc chắn muốn xóa đợt thu ",u.jsxs("span",{className:"font-bold text-red-600",children:['"',r.tenDot,'"']})," không? ",u.jsx("br",{}),u.jsx("span",{className:"text-sm text-gray-500",children:"Thao tác này không thể hoàn tác."})]}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100 font-medium",onClick:U,children:"Hủy"}),u.jsx("button",{className:"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 font-medium",onClick:Te,children:"Xóa"})]})]})}),K&&P&&u.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",onClick:nn,children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-sm w-full relative",onClick:pe=>pe.stopPropagation(),children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Xác nhận xóa"}),u.jsxs("p",{className:"text-gray-700 mb-6",children:["Bạn có chắc chắn muốn xóa khoản thu ",u.jsxs("span",{className:"font-bold text-red-600",children:['"',P.tenKhoan,'"']})," không? ",u.jsx("br",{}),u.jsx("span",{className:"text-sm text-gray-500",children:"Thao tác này không thể hoàn tác."})]}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100 font-medium",onClick:nn,children:"Hủy"}),u.jsx("button",{className:"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 font-medium",onClick:xt,children:"Xóa"})]})]})}),te&&u.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",onClick:()=>q(null),children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full relative flex flex-col items-center",onClick:pe=>pe.stopPropagation(),children:[u.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Không thể thêm khoản thu"}),u.jsx("p",{className:"text-gray-700 mb-6 text-center",children:te}),u.jsx("div",{className:"flex justify-center w-full",children:u.jsx("button",{className:"px-6 py-2 bg-blue-500 text-white rounded-lg font-semibold shadow hover:bg-blue-600 transition-all focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>q(null),children:"Đóng"})})]})})]})},tk=({isOpen:e,onClose:t,editData:n,onSave:a})=>{const[r,l]=k.useState(""),[o,h]=k.useState(""),[f,x]=k.useState(""),[g,p]=k.useState(""),[y,_]=k.useState(""),[w,b]=k.useState(""),T=["Nguyễn Văn An","Trần Thị Bình","Lê Minh Công","Phạm Thị Dung","Hoàng Văn Em"],S=["Tạm trú","Tạm vắng"];k.useEffect(()=>{n?(l(n.hoTen),h(n.trangThai),x(n.diaChi),p(n.tuNgay),_(n.denNgay),b(n.noiDungDeNghi)):E()},[n]);const E=()=>{l(""),h(""),x(""),p(""),_(""),b("")},C=()=>{if(!r||!o||!f||!g||!y){alert("Vui lòng nhập đầy đủ thông tin bắt buộc!");return}a({hoTen:r,trangThai:o,diaChi:f,tuNgay:g,denNgay:y,noiDungDeNghi:w}),t()};return e?u.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto backdrop-blur-md bg-white/30",children:u.jsx("div",{className:"flex min-h-screen items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-lg shadow-xl",children:[u.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-gray-200",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:n?"Cập nhật tạm trú/tạm vắng":"Thêm mới tạm trú/tạm vắng"}),u.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),u.jsxs("div",{className:"p-6 space-y-5",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Nhân khẩu ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsxs("select",{value:r,onChange:A=>l(A.target.value),className:"w-full p-2 border border-gray-300 rounded-md",children:[u.jsx("option",{value:"",children:"-- Chọn nhân khẩu --"}),T.map(A=>u.jsx("option",{value:A,children:A},A))]})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Trạng thái ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsxs("select",{value:o,onChange:A=>h(A.target.value),className:"w-full p-2 border border-gray-300 rounded-md",children:[u.jsx("option",{value:"",children:"-- Chọn trạng thái --"}),S.map(A=>u.jsx("option",{value:A,children:A},A))]})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Địa chỉ ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{value:f,onChange:A=>x(A.target.value),type:"text",className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"Nhập địa chỉ tạm trú/tạm vắng"})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Từ ngày ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{value:g,onChange:A=>p(A.target.value),type:"date",className:"w-full p-2 border border-gray-300 rounded-md"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Đến ngày ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{value:y,onChange:A=>_(A.target.value),type:"date",className:"w-full p-2 border border-gray-300 rounded-md"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nội dung đề nghị"}),u.jsx("textarea",{value:w,onChange:A=>b(A.target.value),rows:4,className:"w-full p-2 border border-gray-300 rounded-md resize-none",placeholder:"Nhập nội dung đề nghị..."})]})]}),u.jsxs("div",{className:"flex justify-end gap-3 px-6 py-4 border-t border-gray-200",children:[u.jsx("button",{onClick:()=>{E(),t()},className:"px-4 py-2 rounded-md bg-gray-100 hover:bg-gray-200 text-gray-800",children:"Hủy"}),u.jsx("button",{onClick:C,className:"px-4 py-2 rounded-md bg-blue-600 hover:bg-blue-700 text-white",children:n?"Cập nhật":"Lưu"})]})]})})}):null},nk=()=>{const[e,t]=k.useState(!1),[n,a]=k.useState("Tất cả"),[r,l]=k.useState(!1),[o,h]=k.useState(null),[f,x]=k.useState(""),g=k.useRef(null),[p,y]=k.useState({top:0,left:0,width:0}),[_,w]=k.useState([{id:"1",hoTen:"Nguyễn Văn An",trangThai:"Tạm trú",diaChi:"123 Lê Lợi, Q.1, TP.HCM",tuNgay:"2025-05-01",denNgay:"2025-08-01",noiDungDeNghi:"Đăng ký tạm trú để thực tập tại công ty"},{id:"2",hoTen:"Trần Thị Bình",trangThai:"Tạm vắng",diaChi:"45 Nguyễn Du, Q.3, TP.HCM",tuNgay:"2025-06-10",denNgay:"2025-07-05",noiDungDeNghi:"Xin tạm vắng để về quê chăm người thân"},{id:"3",hoTen:"Lê Minh Công",trangThai:"Tạm trú",diaChi:"98 Phạm Văn Đồng, Q. Gò Vấp",tuNgay:"2025-05-15",denNgay:"2025-06-30",noiDungDeNghi:"Gia hạn tạm trú do chưa hoàn thành khóa học"}]),b=()=>{h(null),t(!0)},T=M=>{h(M),t(!0)},S=()=>{t(!1),h(null)},E=M=>{if(o)w(B=>B.map(I=>I.id===o.id?{...o,...M}:I));else{const B=Date.now().toString();w(I=>[...I,{id:B,...M}])}S()},C=M=>{const B=_.find(I=>I.id===M);B&&T(B)},A=M=>{window.confirm("Bạn có chắc chắn muốn xóa không?")&&w(B=>B.filter(I=>I.id!==M))},F=M=>{a(M),l(!1)},K=()=>{if(!r&&g.current){const M=g.current.getBoundingClientRect();y({top:M.bottom+window.scrollY,left:M.left+window.scrollX,width:M.width})}l(!r)};k.useEffect(()=>{const M=()=>{l(!1)};if(r)return document.addEventListener("click",M),()=>document.removeEventListener("click",M)},[r]);const O=M=>{x(M.target.value)},P=_.filter(M=>{const B=n==="Tất cả"||M.trangThai===n,I=f===""||M.hoTen.toLowerCase().includes(f.toLowerCase())||M.diaChi.toLowerCase().includes(f.toLowerCase())||M.noiDungDeNghi.toLowerCase().includes(f.toLowerCase());return B&&I});return u.jsxs(u.Fragment,{children:[u.jsx(kn,{role:"totruong",children:u.jsx("div",{className:"min-h-screen bg-gray-50",children:u.jsxs("div",{className:"p-4 flex flex-col gap-6",style:{fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, sans-serif'},children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-medium text-gray-900",style:{fontWeight:"500"},children:"QUẢN LÝ TẠM TRÚ/TẠM VẮNG"}),u.jsx("p",{className:"text-gray-500 text-sm mt-1",style:{fontWeight:"400"},children:"Chào mừng đến với Hệ thống Quản lý Thu phí Chung cư"})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("div",{children:u.jsxs("div",{ref:g,className:"flex items-center border border-gray-300 rounded-md shadow-sm overflow-hidden cursor-pointer",onClick:M=>{M.stopPropagation(),K()},children:[u.jsx("input",{type:"text",value:n,readOnly:!0,className:"flex-1 p-2 outline-none text-sm cursor-pointer bg-white",style:{fontWeight:"400",minWidth:"120px"}}),u.jsx("button",{className:"p-2 border-l border-gray-300 bg-gray-50 text-gray-600 hover:bg-gray-100",children:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})}),u.jsx("input",{type:"text",placeholder:"Tìm kiếm theo tên, địa chỉ hoặc nội dung",className:"flex-1 p-2 border rounded-md shadow-sm text-sm",style:{fontWeight:"400"},value:f,onChange:O}),u.jsxs("button",{className:"bg-blue-500 text-white px-4 py-2 rounded-md shadow-sm hover:bg-blue-600 flex items-center gap-2",style:{fontWeight:"500"},onClick:b,children:[u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thêm TT/TV"]})]}),u.jsxs("div",{className:"mt-6 bg-white rounded-md shadow-md overflow-hidden border border-gray-200",children:[u.jsx("div",{className:"p-4 bg-gray-100 border-b border-gray-200",children:u.jsxs("h2",{className:"text-lg font-medium text-gray-900",style:{fontWeight:"500"},children:["Danh sách tạm trú/tạm vắng",f&&u.jsxs("span",{className:"text-sm font-normal text-gray-600",children:["(",P.length,' kết quả cho "',f,'")']})]})}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",style:{fontWeight:"500"},children:"Họ tên"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",style:{fontWeight:"500"},children:"Trạng thái"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",style:{fontWeight:"500"},children:"Địa chỉ"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",style:{fontWeight:"500"},children:"Thời gian"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",style:{fontWeight:"500"},children:"Nội dung đề nghị"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",style:{fontWeight:"500"},children:"Thao tác"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-500 text-sm",children:f?`Không tìm thấy kết quả nào cho "${f}"`:"Không có dữ liệu"})}):P.map(M=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",style:{fontWeight:"500"},children:M.hoTen}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",style:{fontWeight:"400"},children:u.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${M.trangThai==="Tạm trú"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:M.trangThai})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",style:{fontWeight:"400"},children:M.diaChi}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",style:{fontWeight:"400"},children:[M.tuNgay," → ",M.denNgay]}),u.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 max-w-xs truncate",style:{fontWeight:"400"},title:M.noiDungDeNghi,children:M.noiDungDeNghi}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{onClick:()=>C(M.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-50 transition-colors",title:"Sửa",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),u.jsx("button",{onClick:()=>A(M.id),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-50 transition-colors",title:"Xóa",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},M.id))})]})})]})]})})}),r&&I4.createPortal(u.jsx("div",{className:"bg-white border border-gray-300 rounded-md shadow-lg",style:{position:"fixed",top:p.top,left:p.left,width:p.width,zIndex:9999,maxHeight:"200px",overflowY:"auto"},onClick:M=>M.stopPropagation(),children:["Tất cả","Tạm trú","Tạm vắng"].map(M=>u.jsx("div",{className:"p-2 hover:bg-gray-100 cursor-pointer text-sm",style:{fontWeight:"400"},onClick:()=>F(M),children:M},M))}),document.body),u.jsx(tk,{isOpen:e,onClose:S,editData:o,onSave:E})]})},ak=[{label:"Tất cả",value:""},{label:"Thêm vào hộ",value:"1"},{label:"Xóa khỏi hộ",value:"2"},{label:"Cập nhật thông tin",value:"3"},{label:"Tạm vắng",value:"4"},{label:"Tạm trú",value:"5"}],rk=()=>{const[e,t]=k.useState("2025-06-11"),[n,a]=k.useState("2025-06-11"),[r,l]=k.useState(""),[o,h]=k.useState("thoiGian"),[f,x]=k.useState(!1),[g,p]=k.useState(null),[y,_]=k.useState(!1),[w,b]=k.useState([]),T=async()=>{try{_(!0);const C=await Gn.getHouseholdChangeHistory({fromDate:e,toDate:n,changeType:r?parseInt(r):void 0,limit:100});C.success?b(C.data.history):(console.error("API returned error:",C),b([]))}catch(C){console.error("Error fetching history data:",C),b([])}finally{_(!1)}};k.useEffect(()=>{T()},[e,n,r]);const E=[...w.filter(C=>!r||C.loaiThayDoiCode.toString()===r)].sort((C,A)=>{const F=C[o],K=A[o];return F<K?f?-1:1:F>K?f?1:-1:0});return u.jsx(kn,{role:"totruong",children:u.jsxs("div",{className:"p-4 flex flex-col gap-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"LỊCH SỬ THAY ĐỔI HỘ KHẨU"}),u.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Chào mừng đến với Hệ thống Quản lý Thu phí Chung cư"})]}),u.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[u.jsx("label",{className:"font-semibold text-gray-700",children:"Khoảng thời gian:"}),u.jsx("input",{type:"date",className:"border border-gray-300 rounded-md px-2 py-1 text-sm",value:e,onChange:C=>t(C.target.value)}),u.jsx("span",{children:"-"}),u.jsx("input",{type:"date",className:"border border-gray-300 rounded-md px-2 py-1 text-sm",value:n,onChange:C=>a(C.target.value)}),u.jsx("label",{className:"font-semibold text-gray-700 ml-4",children:"Loại thay đổi:"}),u.jsx("select",{className:"border border-gray-300 rounded-md px-3 py-2 text-sm",value:r,onChange:C=>l(C.target.value),children:ak.map(C=>u.jsx("option",{value:C.value,children:C.label},C.value))}),u.jsx("button",{onClick:T,className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors text-sm",disabled:y,children:y?"Đang tải...":"Làm mới"})]}),u.jsxs("div",{className:"mt-6 bg-white rounded-md shadow-md overflow-hidden border border-gray-200",children:[u.jsx("div",{className:"p-4 bg-gray-100 border-b border-gray-200",children:u.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Danh sách lịch sử thay đổi hộ khẩu"})}),u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider cursor-pointer",onClick:()=>{h("tenNhanKhau"),x(C=>!C)},children:"Tên nhân khẩu"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider cursor-pointer",onClick:()=>{h("soHoKhau"),x(C=>!C)},children:"Số hộ khẩu"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider cursor-pointer",onClick:()=>{h("loaiThayDoi"),x(C=>!C)},children:"Loại thay đổi"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider cursor-pointer",onClick:()=>{h("thoiGian"),x(C=>!C)},children:"Thời gian"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y?u.jsx("tr",{children:u.jsx("td",{colSpan:4,className:"px-6 py-4 text-center text-gray-500",children:"Đang tải dữ liệu..."})}):E.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:4,className:"px-6 py-4 text-center text-gray-500",children:"Không có dữ liệu lịch sử thay đổi"})}):E.map((C,A)=>u.jsxs("tr",{className:"hover:bg-blue-50 cursor-pointer",onClick:()=>p(C),children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:C.tenNhanKhau}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:C.soHoKhau}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:C.loaiThayDoi}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:C.thoiGian})]},A))})]})]}),g&&u.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 min-w-[320px] max-w-[90vw]",children:[u.jsx("h3",{className:"text-lg font-bold mb-2",children:"Chi tiết thay đổi"}),u.jsxs("div",{className:"mb-2",children:[u.jsx("b",{children:"Tên nhân khẩu:"})," ",g.tenNhanKhau]}),u.jsxs("div",{className:"mb-2",children:[u.jsx("b",{children:"CCCD:"})," ",g.cccd]}),u.jsxs("div",{className:"mb-2",children:[u.jsx("b",{children:"Số hộ khẩu:"})," ",g.soHoKhau]}),u.jsxs("div",{className:"mb-2",children:[u.jsx("b",{children:"Địa chỉ:"})," ",g.diaChi]}),u.jsxs("div",{className:"mb-2",children:[u.jsx("b",{children:"Loại thay đổi:"})," ",g.loaiThayDoi]}),u.jsxs("div",{className:"mb-2",children:[u.jsx("b",{children:"Thời gian:"})," ",g.thoiGian]}),u.jsxs("div",{className:"mb-2",children:[u.jsx("b",{children:"Nội dung chi tiết:"})," ",g.chiTiet]}),u.jsx("button",{className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",onClick:()=>p(null),children:"Đóng"})]})})]})})};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sk=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ik=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,a)=>a?a.toUpperCase():n.toLowerCase()),hv=e=>{const t=ik(e);return t.charAt(0).toUpperCase()+t.slice(1)},pb=(...e)=>e.filter((t,n,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===n).join(" ").trim(),lk=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ok={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ck=k.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:a,className:r="",children:l,iconNode:o,...h},f)=>k.createElement("svg",{ref:f,...ok,width:t,height:t,stroke:e,strokeWidth:a?Number(n)*24/Number(t):n,className:pb("lucide",r),...!l&&!lk(h)&&{"aria-hidden":"true"},...h},[...o.map(([x,g])=>k.createElement(x,g)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=(e,t)=>{const n=k.forwardRef(({className:a,...r},l)=>k.createElement(ck,{ref:l,iconNode:t,className:pb(`lucide-${sk(hv(e))}`,`lucide-${e}`,a),...r}));return n.displayName=hv(e),n};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uk=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],fv=ar("car",uk);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hk=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],Md=ar("house",hk);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fk=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],dk=ar("loader-circle",fk);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xk=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],yb=ar("plus",xk);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gk=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],mk=ar("search",gk);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pk=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],yk=ar("square-pen",pk);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vk=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],bk=ar("trash-2",vk);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _k=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],wk=ar("triangle-alert",_k);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tk=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],dv=ar("users",Tk);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sk=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],lc=ar("x",Sk),Nk=({isOpen:e,onClose:t,onSubmit:n,vehicleTypes:a,editingVehicle:r})=>{const[l,o]=k.useState([]),[h,f]=k.useState(!1),[x,g]=k.useState({hoKhauId:"",loaiXeId:"",bienSo:"",ngayBatDau:new Date().toISOString().split("T")[0],ngayKetThuc:"",trangThai:"ACTIVE",ghiChu:""});k.useEffect(()=>{e&&(p(),r?g({hoKhauId:r.hoKhauId.toString(),loaiXeId:r.loaiXeId.toString(),bienSo:r.bienSo,ngayBatDau:r.ngayBatDau.split("T")[0],ngayKetThuc:r.ngayKetThuc?r.ngayKetThuc.split("T")[0]:"",trangThai:r.trangThai,ghiChu:r.ghiChu||""}):y())},[e,r]);const p=async()=>{var b;try{f(!0);const T=await Ha.getAll({limit:1e3});o(((b=T.data)==null?void 0:b.households)||[])}catch(T){console.error("Error loading households:",T)}finally{f(!1)}},y=()=>{g({hoKhauId:"",loaiXeId:"",bienSo:"",ngayBatDau:new Date().toISOString().split("T")[0],ngayKetThuc:"",trangThai:"ACTIVE",ghiChu:""})},_=b=>{b.preventDefault();const T={hoKhauId:parseInt(x.hoKhauId),loaiXeId:parseInt(x.loaiXeId),bienSo:x.bienSo.toUpperCase(),ngayBatDau:x.ngayBatDau,ngayKetThuc:x.ngayKetThuc||void 0,trangThai:x.trangThai,ghiChu:x.ghiChu};n(T)},w=(b,T)=>{g(S=>({...S,[b]:T}))};return e?u.jsxs("div",{className:"fixed inset-0 z-50",children:[u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25",onClick:t}),u.jsxs("div",{className:"fixed left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg shadow-lg w-full max-w-md max-h-[90vh] overflow-auto",children:[u.jsxs("div",{className:"sticky top-0 bg-white flex items-center justify-between p-5 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r?"Chỉnh sửa xe":"Thêm xe mới"}),u.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors rounded-full p-1 hover:bg-gray-100",children:u.jsx(lc,{className:"w-5 h-5"})})]}),u.jsxs("form",{onSubmit:_,className:"p-6 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hộ khẩu *"}),u.jsxs("select",{value:x.hoKhauId,onChange:b=>w("hoKhauId",b.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:h,children:[u.jsx("option",{value:"",children:h?"Đang tải...":"Chọn hộ khẩu"}),l.map(b=>{var T;return u.jsxs("option",{value:b.soHoKhau,children:["HK",b.soHoKhau.toString().padStart(3,"0")," - ",(T=b.chuHoInfo)==null?void 0:T.hoTen," - ",b.soNha," ",b.duong]},b.soHoKhau)})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Loại xe *"}),u.jsxs("select",{value:x.loaiXeId,onChange:b=>w("loaiXeId",b.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[u.jsx("option",{value:"",children:"Chọn loại xe"}),a.map(b=>{let T="";return b.ten==="Xe đạp"||b.ten==="Xe máy"?T="70.000 VNĐ/tháng":b.ten==="Ô tô"&&(T="1.200.000 VNĐ/tháng"),u.jsxs("option",{value:b.id,children:[b.ten," - ",T]},b.id)})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Biển số xe *"}),u.jsx("input",{type:"text",value:x.bienSo,onChange:b=>w("bienSo",b.target.value.toUpperCase()),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"VD: 30A-12345",required:!0}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Định dạng: 30A-12345 hoặc HN-1234"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ngày bắt đầu *"}),u.jsx("input",{type:"date",value:x.ngayBatDau,onChange:b=>w("ngayBatDau",b.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ngày kết thúc"}),u.jsx("input",{type:"date",value:x.ngayKetThuc,onChange:b=>w("ngayKetThuc",b.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:x.ngayBatDau}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Để trống nếu không có ngày kết thúc"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trạng thái"}),u.jsxs("select",{value:x.trangThai,onChange:b=>w("trangThai",b.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[u.jsx("option",{value:"ACTIVE",children:"Đang hoạt động"}),u.jsx("option",{value:"INACTIVE",children:"Tạm ngưng"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ghi chú"}),u.jsx("textarea",{value:x.ghiChu,onChange:b=>w("ghiChu",b.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"Ghi chú về xe..."})]}),u.jsx("div",{className:"border-t border-gray-200 py-4 mt-6",children:u.jsxs("div",{className:"flex gap-3 justify-end",children:[u.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-offset-1 transition-colors",children:"Hủy"}),u.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-1 focus:ring-offset-1 transition-colors",children:r?"Cập nhật":"Lưu"})]})})]})]})]}):null},rh={async getVehicleTypes(){const e=await Re("/vehicles/types");return e.data||e},async createVehicleType(e){return(await Re("/vehicles/types",{method:"POST",body:JSON.stringify(e)})).data},async updateVehicleType(e,t){return(await Re(`/vehicles/types/${e}`,{method:"PUT",body:JSON.stringify(t)})).data},async deleteVehicleType(e){await Re(`/vehicles/types/${e}`,{method:"DELETE"})},async getVehicles(e){const t=e?"?"+new URLSearchParams(Object.entries(e).reduce((a,[r,l])=>(l!==void 0&&l!==""&&(a[r]=String(l)),a),{})).toString():"";return(await Re(`/vehicles${t}`)).data},async createVehicle(e){return(await Re("/vehicles",{method:"POST",body:JSON.stringify(e)})).data},async updateVehicle(e,t){return(await Re(`/vehicles/${e}`,{method:"PUT",body:JSON.stringify(t)})).data},async deleteVehicle(e){await Re(`/vehicles/${e}`,{method:"DELETE"})},async getVehiclesByHousehold(e){const t=await Re(`/vehicles/household/${e}`);return t.data||t},async getVehicleStatistics(){const e=await Re("/vehicles/statistics");return e.data||e}},Ek=()=>{const[e,t]=k.useState([]),[n,a]=k.useState([]),[r,l]=k.useState(!1),[o,h]=k.useState(""),[f,x]=k.useState(""),[g,p]=k.useState(""),[y,_]=k.useState(""),[w,b]=k.useState(!1),[T,S]=k.useState(null),[E,C]=k.useState(null);k.useEffect(()=>{A()},[]);const A=async()=>{try{l(!0),h("");const I=await rh.getVehicles();t(I.vehicles||[]),a([{id:1,ten:"Xe máy",phiThue:7e4,moTa:"Xe máy các loại"},{id:2,ten:"Ô tô",phiThue:12e5,moTa:"Xe ô tô các loại"},{id:3,ten:"Xe đạp",phiThue:7e4,moTa:"Xe đạp các loại"}])}catch(I){h(I.message||"Không thể tải dữ liệu"),console.error("Error loading data:",I)}finally{l(!1)}},F=e.filter(I=>{var re,ee,Q;const te=I.bienSo.toLowerCase().includes(f.toLowerCase())||((Q=(ee=(re=I.hoKhau)==null?void 0:re.chuHoInfo)==null?void 0:ee.hoTen)==null?void 0:Q.toLowerCase().includes(f.toLowerCase()))||"",q=!g||I.trangThai===g||g==="ACTIVE"&&I.trangThai==="Hoạt động"||g==="INACTIVE"&&I.trangThai==="Ngừng sử dụng",ae=!y||I.loaiXeId.toString()===y;return te&&q&&ae}),K=()=>{S(null),b(!0)},O=I=>{S(I),b(!0)},P=async I=>{try{l(!0);const te=parseInt(I.loaiXeId),q={...I,loaiXeId:te};T?await rh.updateVehicle(T.id,q):await rh.createVehicle(q),b(!1),S(null),await A()}catch(te){h(te.message||"Có lỗi xảy ra khi lưu thông tin xe")}finally{l(!1)}},M=async I=>{try{l(!0),await rh.deleteVehicle(I.id),C(null),await A()}catch(te){h(te.message||"Không thể xóa xe")}finally{l(!1)}},B=I=>I==="ACTIVE"||I==="Hoạt động"?u.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:"Đang sử dụng"}):u.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:"Ngừng sử dụng"});return u.jsx(kn,{role:"totruong",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"mb-6",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[u.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:u.jsx(fv,{className:"h-6 w-6 text-blue-600"})}),u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Quản lý xe"})]}),u.jsx("p",{className:"text-gray-600 text-sm",children:"Quản lý thông tin xe và phí gửi xe trong chung cư"})]}),o&&u.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:u.jsxs("div",{className:"flex",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),u.jsx("div",{className:"ml-3",children:u.jsx("p",{className:"text-sm",children:o})})]})}),u.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 mb-6",children:u.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-end",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tìm kiếm"}),u.jsxs("div",{className:"relative",children:[u.jsx(mk,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),u.jsx("input",{type:"text",placeholder:"Tìm kiếm theo biển số hoặc tên chủ xe...",className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:f,onChange:I=>x(I.target.value)})]})]}),u.jsxs("div",{className:"w-full lg:w-48",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trạng thái"}),u.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:g,onChange:I=>p(I.target.value),children:[u.jsx("option",{value:"",children:"Tất cả trạng thái"}),u.jsx("option",{value:"ACTIVE",children:"Đang sử dụng"}),u.jsx("option",{value:"INACTIVE",children:"Ngừng sử dụng"})]})]}),u.jsxs("div",{className:"w-full lg:w-48",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Loại xe"}),u.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:y,onChange:I=>_(I.target.value),children:[u.jsx("option",{value:"",children:"Tất cả loại xe"}),n.map(I=>u.jsx("option",{value:I.id.toString(),children:I.ten},I.id))]})]}),u.jsx("div",{className:"w-full lg:w-auto",children:u.jsxs("button",{onClick:K,className:"w-full lg:w-auto flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",disabled:r,children:[u.jsx(yb,{className:"h-5 w-5 mr-2"}),"Thêm xe mới"]})})]})}),u.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[u.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:u.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Danh sách xe (",F.length,")"]})}),r?u.jsxs("div",{className:"p-8 text-center",children:[u.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),u.jsx("p",{className:"mt-2 text-gray-500",children:"Đang tải dữ liệu..."})]}):F.length===0?u.jsxs("div",{className:"p-8 text-center text-gray-500",children:[u.jsx(fv,{className:"h-12 w-12 mx-auto text-gray-300 mb-4"}),u.jsx("p",{children:"Không tìm thấy xe nào"})]}):u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Biển số"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Loại xe"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Chủ xe"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phí thuê/tháng"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trạng thái"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ngày bắt đầu"}),u.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thao tác"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:F.map(I=>{var te,q,ae,re,ee,Q,me,ye,Y,de;return u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("div",{className:"text-sm font-medium text-gray-900",children:I.bienSo})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("div",{className:"text-sm text-gray-900",children:((te=I.loaiXe)==null?void 0:te.ten)||"-"})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsxs("div",{className:"text-sm text-gray-900",children:[u.jsx("div",{className:"font-medium",children:((ae=(q=I.hoKhau)==null?void 0:q.chuHoInfo)==null?void 0:ae.hoTen)||"-"}),u.jsxs("div",{className:"text-xs text-gray-500",children:["HK",(ee=(re=I.hoKhau)==null?void 0:re.soHoKhau)==null?void 0:ee.toString().padStart(3,"0")," - ",(Q=I.hoKhau)==null?void 0:Q.soNha," ",(me=I.hoKhau)==null?void 0:me.duong]})]})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("div",{className:"text-sm text-gray-900",children:((ye=I.loaiXe)==null?void 0:ye.ten)==="Ô tô"?"1.200.000 VNĐ":((Y=I.loaiXe)==null?void 0:Y.ten)==="Xe máy"||((de=I.loaiXe)==null?void 0:de.ten)==="Xe đạp"?"70.000 VNĐ":"-"})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:B(I.trangThai)}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("div",{className:"text-sm text-gray-900",children:I.ngayBatDau?new Date(I.ngayBatDau).toLocaleDateString("vi-VN"):"-"})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:u.jsxs("div",{className:"flex justify-end space-x-2",children:[u.jsx("button",{onClick:()=>O(I),className:"text-blue-600 hover:text-blue-900 p-1 rounded",title:"Chỉnh sửa",children:u.jsx(yk,{className:"h-4 w-4"})}),u.jsx("button",{onClick:()=>C(I),className:"text-red-600 hover:text-red-900 p-1 rounded",title:"Xóa",children:u.jsx(bk,{className:"h-4 w-4"})})]})})]},I.id)})})]})})]}),u.jsx(Nk,{isOpen:w,onClose:()=>{b(!1),S(null)},onSubmit:P,editingVehicle:T,vehicleTypes:n}),E&&u.jsxs("div",{className:"fixed inset-0 z-50",children:[u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25",onClick:()=>C(null)}),u.jsxs("div",{className:"fixed left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg shadow-lg max-w-md w-full",children:[u.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-gray-200",children:[u.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center gap-2",children:[u.jsx("svg",{className:"h-5 w-5 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 15.5c-.77.833.192 2.5 1.732 2.5z"})}),"Xác nhận xóa xe"]}),u.jsx("button",{onClick:()=>C(null),className:"text-gray-400 hover:text-gray-600 transition-colors rounded-full p-1 hover:bg-gray-100",children:u.jsx(lc,{className:"w-5 h-5"})}),u.jsx("button",{onClick:()=>C(null),className:"text-gray-400 hover:text-gray-600 transition-colors rounded-full p-1 hover:bg-gray-100",children:u.jsx(lc,{className:"w-5 h-5"})})]}),u.jsxs("div",{className:"p-6",children:[u.jsx("div",{className:"mb-4",children:u.jsxs("p",{className:"text-sm text-gray-700",children:["Bạn có chắc chắn muốn xóa xe ",u.jsx("strong",{children:E.bienSo})," không? Hành động này không thể hoàn tác."]})}),u.jsx("div",{className:"border-t border-gray-200 py-4 mt-6",children:u.jsxs("div",{className:"flex justify-end space-x-3",children:[u.jsx("button",{onClick:()=>C(null),className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50",children:"Hủy"}),u.jsx("button",{onClick:()=>M(E),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700",disabled:r,children:r?"Đang xóa...":"Xóa"})]})})]})]})]})]})})},Ck=({isOpen:e,onClose:t,onSave:n,editData:a})=>{const[r,l]=k.useState({soPhong:"",tang:"",dienTich:0,trangThai:"trong",hoThue:"",ngayBatDau:"",ghiChu:""});k.useEffect(()=>{l(a?{...a}:{soPhong:"",tang:"",dienTich:0,trangThai:"trong",hoThue:"",ngayBatDau:"",ghiChu:""})},[a,e]);const o=f=>{const{name:x,value:g}=f.target;l(x==="dienTich"?{...r,[x]:parseFloat(g)||0}:{...r,[x]:g})},h=f=>{f.preventDefault(),n(r)};return e?u.jsxs("div",{className:"fixed inset-0 z-50",children:[u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25",onClick:t}),u.jsxs("div",{className:"fixed left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg shadow-lg w-full max-w-md max-h-[90vh] overflow-auto",children:[u.jsxs("div",{className:"sticky top-0 bg-white flex items-center justify-between p-5 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:a?"Chỉnh sửa phòng":"Thêm phòng mới"}),u.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors rounded-full p-1 hover:bg-gray-100",children:u.jsx(lc,{className:"w-5 h-5"})})]}),u.jsxs("form",{onSubmit:h,className:"p-6 space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Số phòng ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",name:"soPhong",value:r.soPhong,onChange:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"VD: 101",required:!0})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tầng ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",name:"tang",value:r.tang,onChange:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"VD: 1",required:!0})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Diện tích (m²) ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"number",name:"dienTich",value:r.dienTich,onChange:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"VD: 30",required:!0,min:"0",step:"0.01"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trạng thái"}),u.jsxs("select",{name:"trangThai",value:r.trangThai,onChange:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[u.jsx("option",{value:"trong",children:"Trống"}),u.jsx("option",{value:"da_thue",children:"Đã thuê"}),u.jsx("option",{value:"bao_tri",children:"Bảo trì"})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi chú"}),u.jsx("textarea",{name:"ghiChu",value:r.ghiChu||"",onChange:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nhập ghi chú về phòng...",rows:3})]}),u.jsx("div",{className:"border-t border-gray-200 py-4 mt-6",children:u.jsxs("div",{className:"flex gap-3 justify-end",children:[u.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-offset-1 transition-colors",children:"Hủy"}),u.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-1 focus:ring-offset-1 transition-colors",children:a?"Cập nhật":"Thêm mới"})]})})]})]})]}):null},jk=({isOpen:e,onClose:t,onSave:n,availableRooms:a,households:r=[]})=>{const[l,o]=k.useState({id:"",tenChuHo:"",nguoiThue:"",soHoKhau:"",soPhong:"",ngayBatDau:new Date().toISOString().split("T")[0],sdt:""});k.useEffect(()=>{e&&o({id:"",tenChuHo:"",nguoiThue:"",soHoKhau:"",soPhong:"",ngayBatDau:new Date().toISOString().split("T")[0],sdt:""})},[e]);const h=g=>{var _;const{name:p,value:y}=g.target;if(p==="soHoKhau"){const w=r.find(b=>b.soHoKhau.toString()===y);w!=null&&w.chuHoInfo?o({...l,[p]:y,tenChuHo:w.chuHoInfo.hoTen||"",sdt:((_=w.chuHoInfo)==null?void 0:_.sdt)||""}):o({...l,[p]:y})}else o({...l,[p]:y})},f=g=>{g.preventDefault(),n(l),t(),x()},x=()=>{o({id:"",tenChuHo:"",nguoiThue:"",soHoKhau:"",soPhong:"",ngayBatDau:new Date().toISOString().split("T")[0],sdt:""})};return e?u.jsxs("div",{className:"fixed inset-0 z-50",children:[u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25",onClick:t}),u.jsxs("div",{className:"fixed left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg shadow-lg w-full max-w-md max-h-[90vh] overflow-auto",children:[u.jsxs("div",{className:"sticky top-0 bg-white flex items-center justify-between p-5 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Thêm hộ thuê mới"}),u.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors rounded-full p-1 hover:bg-gray-100",children:u.jsx(lc,{className:"w-5 h-5"})})]}),u.jsxs("form",{onSubmit:f,className:"p-6 space-y-4",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tên chủ hộ ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",name:"tenChuHo",value:l.tenChuHo,onChange:h,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"VD: Nguyễn Văn A",readOnly:!!l.soHoKhau,required:!0}),!!l.soHoKhau&&u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Tự động điền theo hộ khẩu đã chọn"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Người thuê thực tế ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",name:"nguoiThue",value:l.nguoiThue,onChange:h,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"VD: Nguyễn Thị B (có thể khác chủ hộ)",required:!0}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Người thực tế sống trong phòng (có thể khác chủ hộ)"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Hộ khẩu ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsxs("select",{name:"soHoKhau",value:l.soHoKhau,onChange:h,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[u.jsx("option",{value:"",children:"Chọn hộ khẩu"}),r.map(g=>{var p;return u.jsxs("option",{value:g.soHoKhau.toString(),children:[g.soHoKhau," - ",((p=g.chuHoInfo)==null?void 0:p.hoTen)||"Không có chủ hộ"]},g.soHoKhau)})]}),r.length===0&&u.jsx("p",{className:"text-sm text-red-500 mt-1",children:"Không có hộ khẩu nào"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Số điện thoại ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"tel",name:"sdt",value:l.sdt,onChange:h,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"VD: 0912345678",readOnly:!!l.soHoKhau,required:!0,pattern:"[0-9]{10}",title:"Vui lòng nhập số điện thoại 10 số"}),!!l.soHoKhau&&u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Tự động điền theo hộ khẩu đã chọn"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Chọn phòng ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsxs("select",{name:"soPhong",value:l.soPhong,onChange:h,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[u.jsx("option",{value:"",children:"Chọn phòng"}),a.map(g=>u.jsxs("option",{value:g.soPhong,children:["Phòng ",g.soPhong," - Tầng ",g.tang," (",g.dienTich,"m²)"]},g.id))]}),a.length===0&&u.jsx("p",{className:"text-sm text-red-500 mt-1",children:"Không có phòng trống"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Ngày bắt đầu ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"date",name:"ngayBatDau",value:l.ngayBatDau,onChange:h,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),u.jsx("div",{className:"border-t border-gray-200 py-4 mt-6",children:u.jsxs("div",{className:"flex gap-3 justify-end",children:[u.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-offset-1 transition-colors",children:"Hủy"}),u.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-1 focus:ring-offset-1 transition-colors",disabled:a.length===0,children:"Thêm mới"})]})})]})]})]}):null},Ks={async getRooms(e){const t=e?"?"+new URLSearchParams(Object.entries(e).reduce((a,[r,l])=>(l!==void 0&&l!==""&&(a[r]=String(l)),a),{})).toString():"";return await Re(`/rooms${t}`)},async getRoom(e){return await Re(`/rooms/${e}`)},async createRoom(e){return(await Re("/rooms",{method:"POST",body:JSON.stringify(e)})).room},async updateRoom(e,t){return(await Re(`/rooms/${e}`,{method:"PUT",body:JSON.stringify(t)})).room},async deleteRoom(e){await Re(`/rooms/${e}`,{method:"DELETE"})},async assignRoom(e,t,n){return(await Re(`/rooms/${e}/assign`,{method:"POST",body:JSON.stringify({hoKhauId:t,ngayBatDau:n})})).room},async releaseRoom(e,t){return(await Re(`/rooms/${e}/release`,{method:"POST",body:JSON.stringify({ngayKetThuc:t})})).room},async updateTenant(e,t){return(await Re(`/rooms/${e}/tenant`,{method:"PUT",body:JSON.stringify({nguoiThue:t})})).room},async getRoomStatistics(){return await Re("/rooms/statistics")}},kk=()=>{const[e,t]=k.useState([]),[n,a]=k.useState([]),[r,l]=k.useState(!1),[o,h]=k.useState(!1),[f,x]=k.useState(null),[g,p]=k.useState(null),[y,_]=k.useState(""),[w,b]=k.useState(""),[T,S]=k.useState(!0),[E,C]=k.useState(null),[A,F]=k.useState(null),[K,O]=k.useState([]),P=async()=>{try{S(!0);const V=(await Ks.getRooms()).rooms.map(Te=>{var ie,_e;return{...Te,hoThue:((_e=(ie=Te.hoKhau)==null?void 0:ie.chuHoInfo)==null?void 0:_e.hoTen)||void 0,nguoiThue:Te.nguoiThue||void 0}});t(V);const U=await Ks.getRoomStatistics();F(U),C(null)}catch(j){console.error("Error fetching room data:",j),C("Có lỗi xảy ra khi tải dữ liệu phòng. Vui lòng thử lại sau.")}finally{S(!1)}},M=async()=>{try{const j=await Ha.getAll();if(j.data){O(j.data.households||[]);const V=[];j.data.households.forEach(U=>{var Te,ie,_e;U.roomInfo&&V.push({id:U.soHoKhau.toString(),tenChuHo:((Te=U.chuHoInfo)==null?void 0:Te.hoTen)||"Unknown",nguoiThue:((ie=U.chuHoInfo)==null?void 0:ie.hoTen)||"Unknown",soHoKhau:U.soHoKhau.toString(),soPhong:U.roomInfo.soPhong,ngayBatDau:U.roomInfo.ngayBatDau||"",sdt:((_e=U.chuHoInfo)==null?void 0:_e.soDienThoai)||""})}),a(V)}}catch(j){console.error("Error fetching households:",j)}};k.useEffect(()=>{P(),M()},[]);const B=(j=null)=>{x(j),l(!0)},I=()=>{x(null),l(!1)},te=async j=>{try{S(!0),f&&f.id?await Ks.updateRoom(f.id,j):await Ks.createRoom(j),await P(),I()}catch(V){console.error("Error saving room:",V),C("Có lỗi xảy ra khi lưu thông tin phòng. Vui lòng thử lại sau.")}finally{S(!1)}},q=()=>{h(!0)},ae=()=>{h(!1)},re=async j=>{try{S(!0);const V=e.find(U=>U.soPhong===j.soPhong);if(!V)throw new Error("Không tìm thấy phòng");await Ks.assignRoom(V.id,Number(j.soHoKhau),j.ngayBatDau),j.nguoiThue&&await Ks.updateTenant(V.id,j.nguoiThue),await P(),await M(),ae()}catch(V){console.error("Error assigning room to tenant:",V),C("Có lỗi xảy ra khi cập nhật thông tin người thuê. Vui lòng thử lại sau.")}finally{S(!1)}},ee=async()=>{if(g)try{S(!0),await Ks.deleteRoom(g.id),await P(),p(null)}catch(j){console.error("Error deleting room:",j),C("Có lỗi xảy ra khi xóa phòng. Vui lòng thử lại sau.")}finally{S(!1)}},Q=()=>{p(null)},me=(A==null?void 0:A.rentedRooms)||e.filter(j=>j.hoKhauId).length,ye=(A==null?void 0:A.availableRooms)||e.filter(j=>j.trangThai==="trong").length,Y=(A==null?void 0:A.maintenanceRooms)||e.filter(j=>j.trangThai==="bao_tri").length,de=(A==null?void 0:A.totalRooms)||e.length,H=[...new Set(e.map(j=>j.tang))].sort(),Z=e.filter(j=>{const V=j.soPhong.toLowerCase().includes(y.toLowerCase())||(j.hoThue||"").toLowerCase().includes(y.toLowerCase()),U=!w||j.tang===w;return V&&U});return u.jsxs(kn,{role:"totruong",children:[u.jsxs("div",{className:"p-4 flex flex-col gap-6",children:[u.jsxs("div",{className:"mb-4",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[u.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:u.jsx(Md,{className:"h-6 w-6 text-blue-600"})}),u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"QUẢN LÝ PHÒNG"})]}),u.jsx("p",{className:"text-gray-600 text-sm",children:"Quản lý thông tin phòng và người thuê trong chung cư"})]}),T&&u.jsxs("div",{className:"flex justify-center items-center py-8",children:[u.jsx(dk,{className:"h-8 w-8 animate-spin text-blue-600"}),u.jsx("span",{className:"ml-2 text-gray-600",children:"Đang tải dữ liệu..."})]}),E&&u.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg",children:u.jsx("p",{children:E})}),!T&&!E&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 mb-2",children:u.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-end",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tìm kiếm"}),u.jsx("input",{type:"text",placeholder:"Tìm theo số phòng hoặc tên người thuê...",value:y,onChange:j=>_(j.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),u.jsxs("div",{className:"w-full lg:w-48",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tầng"}),u.jsxs("select",{value:w,onChange:j=>b(j.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"",children:"Tất cả các tầng"}),H.map(j=>u.jsxs("option",{value:j,children:["Tầng ",j]},j))]})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsxs("button",{onClick:()=>B(),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:[u.jsx(yb,{className:"h-5 w-5"}),"Thêm phòng mới"]}),u.jsxs("button",{onClick:()=>q(),className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors",disabled:ye===0,children:[u.jsx(dv,{className:"h-5 w-5"}),"Thêm hộ thuê"]})]})]})}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[u.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-500 text-sm",children:"Tổng số phòng"}),u.jsx("div",{className:"text-2xl font-semibold",children:de})]}),u.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:u.jsx(Md,{className:"h-6 w-6 text-blue-600"})})]})}),u.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-500 text-sm",children:"Phòng đã thuê"}),u.jsx("div",{className:"text-2xl font-semibold",children:me})]}),u.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:u.jsx(dv,{className:"h-6 w-6 text-green-600"})})]})}),u.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-500 text-sm",children:"Phòng trống"}),u.jsx("div",{className:"text-2xl font-semibold",children:ye})]}),u.jsx("div",{className:"p-3 bg-orange-100 rounded-full",children:u.jsx(Md,{className:"h-6 w-6 text-orange-600"})})]})}),u.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-500 text-sm",children:"Phòng bảo trì"}),u.jsx("div",{className:"text-2xl font-semibold",children:Y})]}),u.jsx("div",{className:"p-3 bg-red-100 rounded-full",children:u.jsx(wk,{className:"h-6 w-6 text-red-600"})})]})})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[u.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:u.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Danh sách phòng (",Z.length,")"]})}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Số phòng"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tầng"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Diện tích (m²)"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trạng thái"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ghi chú"}),u.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thao tác"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Z.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"px-4 py-4 text-center text-gray-500",children:"Không tìm thấy phòng nào"})}):Z.map(j=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:j.soPhong}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:j.tang}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:j.dienTich}),u.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:[j.trangThai==="da_thue"&&u.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Đã thuê"}),j.trangThai==="trong"&&u.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Trống"}),j.trangThai==="bao_tri"&&u.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Bảo trì"})]}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:j.ghiChu||"-"}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:u.jsxs("div",{className:"flex justify-center gap-3",children:[u.jsx("button",{onClick:()=>B(j),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-50 transition-colors",title:"Sửa",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),u.jsx("button",{onClick:()=>p(j),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-50 transition-colors",disabled:!!j.hoKhauId,title:"Xóa",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},j.id))})]})})]})]})]}),u.jsx(Ck,{isOpen:r,onClose:I,onSave:te,editData:f,tenants:n}),u.jsx(jk,{isOpen:o,onClose:ae,onSave:re,availableRooms:e.filter(j=>!j.hoKhauId),households:K}),g&&u.jsxs("div",{className:"fixed inset-0 z-50",children:[u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25",onClick:Q}),u.jsx("div",{className:"fixed left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg shadow-lg max-w-md w-full",children:u.jsxs("div",{className:"p-6",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Xác nhận xóa phòng"}),u.jsxs("p",{className:"text-sm text-gray-600 mb-6",children:["Bạn có chắc chắn muốn xóa phòng ",u.jsx("strong",{children:g.soPhong}),"?",u.jsx("br",{}),g.hoKhauId&&"Hộ thuê sẽ bị gỡ liên kết khỏi phòng này."]}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx("button",{onClick:Q,className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50",children:"Hủy"}),u.jsx("button",{onClick:ee,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700",children:"Xóa"})]})]})})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var jh={};jh.version="0.18.5";var vb=1252,Ak=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],bb=function(e){Ak.indexOf(e)!=-1&&(vb=e)};function Dk(){bb(1252)}var oc=function(e){bb(e)};function Ok(){oc(1200),Dk()}var sh=function(t){return String.fromCharCode(t)},xv=function(t){return String.fromCharCode(t)},gv,fs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function cc(e){for(var t="",n=0,a=0,r=0,l=0,o=0,h=0,f=0,x=0;x<e.length;)n=e.charCodeAt(x++),l=n>>2,a=e.charCodeAt(x++),o=(n&3)<<4|a>>4,r=e.charCodeAt(x++),h=(a&15)<<2|r>>6,f=r&63,isNaN(a)?h=f=64:isNaN(r)&&(f=64),t+=fs.charAt(l)+fs.charAt(o)+fs.charAt(h)+fs.charAt(f);return t}function Or(e){var t="",n=0,a=0,r=0,l=0,o=0,h=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var x=0;x<e.length;)l=fs.indexOf(e.charAt(x++)),o=fs.indexOf(e.charAt(x++)),n=l<<2|o>>4,t+=String.fromCharCode(n),h=fs.indexOf(e.charAt(x++)),a=(o&15)<<4|h>>2,h!==64&&(t+=String.fromCharCode(a)),f=fs.indexOf(e.charAt(x++)),r=(h&3)<<6|f,f!==64&&(t+=String.fromCharCode(r));return t}var ht=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Fr=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,n){return n?new Buffer(t,n):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ni(e){return ht?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function mv(e){return ht?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ra=function(t){return ht?Fr(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)&255})};function Zh(e){if(typeof ArrayBuffer>"u")return Ra(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),a=0;a!=e.length;++a)n[a]=e.charCodeAt(a)&255;return t}function yc(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function Mk(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var vn=ht?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Fr(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var a=new Uint8Array(n),r=0;for(t=0,n=0;t<e.length;n+=r,++t)if(r=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],n);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),n)}return a}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function Rk(e){for(var t=[],n=0,a=e.length+250,r=ni(e.length+255),l=0;l<e.length;++l){var o=e.charCodeAt(l);if(o<128)r[n++]=o;else if(o<2048)r[n++]=192|o>>6&31,r[n++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var h=e.charCodeAt(++l)&1023;r[n++]=240|o>>8&7,r[n++]=128|o>>2&63,r[n++]=128|h>>6&15|(o&3)<<4,r[n++]=128|h&63}else r[n++]=224|o>>12&15,r[n++]=128|o>>6&63,r[n++]=128|o&63;n>a&&(t.push(r.slice(0,n)),n=0,r=ni(65535),a=65530)}return t.push(r.slice(0,n)),vn(t)}var Ko=/\u0000/g,ih=/[\u0001-\u0006]/g;function sl(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function Fa(e,t){var n=""+e;return n.length>=t?n:Pt("0",t-n.length)+n}function Ox(e,t){var n=""+e;return n.length>=t?n:Pt(" ",t-n.length)+n}function kh(e,t){var n=""+e;return n.length>=t?n:n+Pt(" ",t-n.length)}function Fk(e,t){var n=""+Math.round(e);return n.length>=t?n:Pt("0",t-n.length)+n}function Lk(e,t){var n=""+e;return n.length>=t?n:Pt("0",t-n.length)+n}var pv=Math.pow(2,32);function qi(e,t){if(e>pv||e<-pv)return Fk(e,t);var n=Math.round(e);return Lk(n,t)}function Ah(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var yv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Rd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Bk(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Vt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},vv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Hk={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Dh(e,t,n){for(var a=e<0?-1:1,r=e*a,l=0,o=1,h=0,f=1,x=0,g=0,p=Math.floor(r);x<t&&(p=Math.floor(r),h=p*o+l,g=p*x+f,!(r-p<5e-8));)r=1/(r-p),l=o,o=h,f=x,x=g;if(g>t&&(x>t?(g=f,h=l):(g=x,h=o)),!n)return[0,a*h,g];var y=Math.floor(a*h/g);return[y,a*h-y*g,g]}function lh(e,t,n){if(e>2958465||e<0)return null;var a=e|0,r=Math.floor(86400*(e-a)),l=0,o=[],h={D:a,T:r,u:86400*(e-a)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(h.u)<1e-6&&(h.u=0),t&&t.date1904&&(a+=1462),h.u>.9999&&(h.u=0,++r==86400&&(h.T=r=0,++a,++h.D)),a===60)o=n?[1317,10,29]:[1900,2,29],l=3;else if(a===0)o=n?[1317,8,29]:[1900,1,0],l=6;else{a>60&&--a;var f=new Date(1900,0,1);f.setDate(f.getDate()+a-1),o=[f.getFullYear(),f.getMonth()+1,f.getDate()],l=f.getDay(),a<60&&(l=(l+6)%7),n&&(l=Wk(f,o))}return h.y=o[0],h.m=o[1],h.d=o[2],h.S=r%60,r=Math.floor(r/60),h.M=r%60,r=Math.floor(r/60),h.H=r,h.q=l,h}var _b=new Date(1899,11,31,0,0,0),Pk=_b.getTime(),Ik=new Date(1900,2,1,0,0,0);function wb(e,t){var n=e.getTime();return t?n-=1461*24*60*60*1e3:e>=Ik&&(n+=24*60*60*1e3),(n-(Pk+(e.getTimezoneOffset()-_b.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Mx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function zk(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Uk(e){var t=e<0?12:11,n=Mx(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10),n.length<=t)?n:e.toExponential(5)}function Vk(e){var t=Mx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Kk(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n;return t>=-4&&t<=-1?n=e.toPrecision(10+t):Math.abs(t)<=9?n=Uk(e):t===10?n=e.toFixed(10).substr(0,12):n=Vk(e),Mx(zk(n.toUpperCase()))}function tx(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Kk(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ms(14,wb(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Wk(e,t){t[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}function Gk(e,t,n,a){var r="",l=0,o=0,h=n.y,f,x=0;switch(e){case 98:h=n.y+543;case 121:switch(t.length){case 1:case 2:f=h%100,x=2;break;default:f=h%1e4,x=4;break}break;case 109:switch(t.length){case 1:case 2:f=n.m,x=t.length;break;case 3:return Rd[n.m-1][1];case 5:return Rd[n.m-1][0];default:return Rd[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:f=n.d,x=t.length;break;case 3:return yv[n.q][0];default:return yv[n.q][1]}break;case 104:switch(t.length){case 1:case 2:f=1+(n.H+11)%12,x=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:f=n.H,x=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:f=n.M,x=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return n.u===0&&(t=="s"||t=="ss")?Fa(n.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,l=Math.round(o*(n.S+n.u)),l>=60*o&&(l=0),t==="s"?l===0?"0":""+l/o:(r=Fa(l,2+a),t==="ss"?r.substr(0,2):"."+r.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":f=n.D*24+n.H;break;case"[m]":case"[mm]":f=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":f=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}x=t.length===3?1:2;break;case 101:f=h,x=1;break}var g=x>0?Fa(f,x):"";return g}function ds(e){var t=3;if(e.length<=t)return e;for(var n=e.length%t,a=e.substr(0,n);n!=e.length;n+=t)a+=(a.length>0?",":"")+e.substr(n,t);return a}var Tb=/%/g;function Xk(e,t,n){var a=t.replace(Tb,""),r=t.length-a.length;return jr(e,a,n*Math.pow(10,2*r))+Pt("%",r)}function Yk(e,t,n){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return jr(e,t.substr(0,a),n/Math.pow(10,3*(t.length-a)))}function Sb(e,t){var n,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Sb(e,-t);var r=e.indexOf(".");r===-1&&(r=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%r;if(l<0&&(l+=r),n=(t/Math.pow(10,l)).toPrecision(a+1+(r+l)%r),n.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+l):n+="E+"+(o-l);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,r)+"."+n.substr(2+r),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,f,x,g){return f+x+g.substr(0,(r+l)%r)+"."+g.substr(l)+"E"})}else n=t.toExponential(a);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var Nb=/# (\?+)( ?)\/( ?)(\d+)/;function qk(e,t,n){var a=parseInt(e[4],10),r=Math.round(t*a),l=Math.floor(r/a),o=r-l*a,h=a;return n+(l===0?"":""+l)+" "+(o===0?Pt(" ",e[1].length+1+e[4].length):Ox(o,e[1].length)+e[2]+"/"+e[3]+Fa(h,e[4].length))}function $k(e,t,n){return n+(t===0?"":""+t)+Pt(" ",e[1].length+2+e[4].length)}var Eb=/^#*0*\.([0#]+)/,Cb=/\).*[0#]/,jb=/\(###\) ###\\?-####/;function Rn(e){for(var t="",n,a=0;a!=e.length;++a)switch(n=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(n)}return t}function bv(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function _v(e,t){var n=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(n*a)).length?0:Math.round(n*a)}function Qk(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Zk(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function _a(e,t,n){if(e.charCodeAt(0)===40&&!t.match(Cb)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?_a("n",a,n):"("+_a("n",a,-n)+")"}if(t.charCodeAt(t.length-1)===44)return Yk(e,t,n);if(t.indexOf("%")!==-1)return Xk(e,t,n);if(t.indexOf("E")!==-1)return Sb(t,n);if(t.charCodeAt(0)===36)return"$"+_a(e,t.substr(t.charAt(1)==" "?2:1),n);var r,l,o,h,f=Math.abs(n),x=n<0?"-":"";if(t.match(/^00+$/))return x+qi(f,t.length);if(t.match(/^[#?]+$/))return r=qi(n,0),r==="0"&&(r=""),r.length>t.length?r:Rn(t.substr(0,t.length-r.length))+r;if(l=t.match(Nb))return qk(l,f,x);if(t.match(/^#+0+$/))return x+qi(f,t.length-t.indexOf("0"));if(l=t.match(Eb))return r=bv(n,l[1].length).replace(/^([^\.]+)$/,"$1."+Rn(l[1])).replace(/\.$/,"."+Rn(l[1])).replace(/\.(\d*)$/,function(w,b){return"."+b+Pt("0",Rn(l[1]).length-b.length)}),t.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return x+bv(f,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return x+ds(qi(f,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+_a(e,t,-n):ds(""+(Math.floor(n)+Qk(n,l[1].length)))+"."+Fa(_v(n,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return _a(e,t.replace(/^#,#*,/,""),n);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=sl(_a(e,t.replace(/[\\-]/g,""),n)),o=0,sl(sl(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<r.length?r.charAt(o++):w==="0"?"0":""}));if(t.match(jb))return r=_a(e,"##########",n),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var g="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),h=Dh(f,Math.pow(10,o)-1,!1),r=""+x,g=jr("n",l[1],h[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),r+=g+l[2]+"/"+l[3],g=kh(h[2],o),g.length<l[4].length&&(g=Rn(l[4].substr(l[4].length-g.length))+g),r+=g,r;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),h=Dh(f,Math.pow(10,o)-1,!0),x+(h[0]||(h[1]?"":"0"))+" "+(h[1]?Ox(h[1],o)+l[2]+"/"+l[3]+kh(h[2],o):Pt(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return r=qi(n,0),t.length<=r.length?r:Rn(t.substr(0,t.length-r.length))+r;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){r=""+n.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=r.indexOf(".");var p=t.indexOf(".")-o,y=t.length-r.length-p;return Rn(t.substr(0,p)+r+t.substr(t.length-y))}if(l=t.match(/^00,000\.([#0]*0)$/))return o=_v(n,l[1].length),n<0?"-"+_a(e,t,-n):ds(Zk(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?Fa(0,3-w.length):"")+w})+"."+Fa(o,l[1].length);switch(t){case"###,##0.00":return _a(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var _=ds(qi(f,0));return _!=="0"?x+_:"";case"###,###.00":return _a(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return _a(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Jk(e,t,n){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return jr(e,t.substr(0,a),n/Math.pow(10,3*(t.length-a)))}function eA(e,t,n){var a=t.replace(Tb,""),r=t.length-a.length;return jr(e,a,n*Math.pow(10,2*r))+Pt("%",r)}function kb(e,t){var n,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+kb(e,-t);var r=e.indexOf(".");r===-1&&(r=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%r;if(l<0&&(l+=r),n=(t/Math.pow(10,l)).toPrecision(a+1+(r+l)%r),!n.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+l):n+="E+"+(o-l),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,f,x,g){return f+x+g.substr(0,(r+l)%r)+"."+g.substr(l)+"E"})}else n=t.toExponential(a);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function $a(e,t,n){if(e.charCodeAt(0)===40&&!t.match(Cb)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?$a("n",a,n):"("+$a("n",a,-n)+")"}if(t.charCodeAt(t.length-1)===44)return Jk(e,t,n);if(t.indexOf("%")!==-1)return eA(e,t,n);if(t.indexOf("E")!==-1)return kb(t,n);if(t.charCodeAt(0)===36)return"$"+$a(e,t.substr(t.charAt(1)==" "?2:1),n);var r,l,o,h,f=Math.abs(n),x=n<0?"-":"";if(t.match(/^00+$/))return x+Fa(f,t.length);if(t.match(/^[#?]+$/))return r=""+n,n===0&&(r=""),r.length>t.length?r:Rn(t.substr(0,t.length-r.length))+r;if(l=t.match(Nb))return $k(l,f,x);if(t.match(/^#+0+$/))return x+Fa(f,t.length-t.indexOf("0"));if(l=t.match(Eb))return r=(""+n).replace(/^([^\.]+)$/,"$1."+Rn(l[1])).replace(/\.$/,"."+Rn(l[1])),r=r.replace(/\.(\d*)$/,function(w,b){return"."+b+Pt("0",Rn(l[1]).length-b.length)}),t.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return x+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return x+ds(""+f);if(l=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+$a(e,t,-n):ds(""+n)+"."+Pt("0",l[1].length);if(l=t.match(/^#,#*,#0/))return $a(e,t.replace(/^#,#*,/,""),n);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=sl($a(e,t.replace(/[\\-]/g,""),n)),o=0,sl(sl(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<r.length?r.charAt(o++):w==="0"?"0":""}));if(t.match(jb))return r=$a(e,"##########",n),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var g="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),h=Dh(f,Math.pow(10,o)-1,!1),r=""+x,g=jr("n",l[1],h[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),r+=g+l[2]+"/"+l[3],g=kh(h[2],o),g.length<l[4].length&&(g=Rn(l[4].substr(l[4].length-g.length))+g),r+=g,r;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),h=Dh(f,Math.pow(10,o)-1,!0),x+(h[0]||(h[1]?"":"0"))+" "+(h[1]?Ox(h[1],o)+l[2]+"/"+l[3]+kh(h[2],o):Pt(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return r=""+n,t.length<=r.length?r:Rn(t.substr(0,t.length-r.length))+r;if(l=t.match(/^([#0]+)\.([#0]+)$/)){r=""+n.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=r.indexOf(".");var p=t.indexOf(".")-o,y=t.length-r.length-p;return Rn(t.substr(0,p)+r+t.substr(t.length-y))}if(l=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+$a(e,t,-n):ds(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?Fa(0,3-w.length):"")+w})+"."+Fa(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var _=ds(""+f);return _!=="0"?x+_:"";default:if(t.match(/\.[0#?]*$/))return $a(e,t.slice(0,t.lastIndexOf(".")),n)+Rn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function jr(e,t,n){return(n|0)===n?$a(e,t,n):_a(e,t,n)}function tA(e){for(var t=[],n=!1,a=0,r=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:n=!n;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(r,a-r),r=a+1}if(t[t.length]=e.substr(r),n===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Ab=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Db(e){for(var t=0,n="",a="";t<e.length;)switch(n=e.charAt(t)){case"G":Ah(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(a=n;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(Ab))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||n=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function nA(e,t,n,a){for(var r=[],l="",o=0,h="",f="t",x,g,p,y="H";o<e.length;)switch(h=e.charAt(o)){case"G":if(!Ah(e,o))throw new Error("unrecognized character "+h+" in "+e);r[r.length]={t:"G",v:"General"},o+=7;break;case'"':for(l="";(p=e.charCodeAt(++o))!==34&&o<e.length;)l+=String.fromCharCode(p);r[r.length]={t:"t",v:l},++o;break;case"\\":var _=e.charAt(++o),w=_==="("||_===")"?_:"t";r[r.length]={t:w,v:_},++o;break;case"_":r[r.length]={t:"t",v:" "},o+=2;break;case"@":r[r.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(x==null&&(x=lh(t,n,e.charAt(o+1)==="2"),x==null))return"";r[r.length]={t:"X",v:e.substr(o,2)},f=h,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":h=h.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||x==null&&(x=lh(t,n),x==null))return"";for(l=h;++o<e.length&&e.charAt(o).toLowerCase()===h;)l+=h;h==="m"&&f.toLowerCase()==="h"&&(h="M"),h==="h"&&(h=y),r[r.length]={t:h,v:l},f=h;break;case"A":case"a":case"上":var b={t:h,v:h};if(x==null&&(x=lh(t,n)),e.substr(o,3).toUpperCase()==="A/P"?(x!=null&&(b.v=x.H>=12?"P":"A"),b.t="T",y="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(x!=null&&(b.v=x.H>=12?"PM":"AM"),b.t="T",o+=5,y="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(x!=null&&(b.v=x.H>=12?"下午":"上午"),b.t="T",o+=5,y="h"):(b.t="t",++o),x==null&&b.t==="T")return"";r[r.length]=b,f=h;break;case"[":for(l=h;e.charAt(o++)!=="]"&&o<e.length;)l+=e.charAt(o);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(Ab)){if(x==null&&(x=lh(t,n),x==null))return"";r[r.length]={t:"Z",v:l.toLowerCase()},f=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Db(e)||(r[r.length]={t:"t",v:l}));break;case".":if(x!=null){for(l=h;++o<e.length&&(h=e.charAt(o))==="0";)l+=h;r[r.length]={t:"s",v:l};break}case"0":case"#":for(l=h;++o<e.length&&"0#?.,E+-%".indexOf(h=e.charAt(o))>-1;)l+=h;r[r.length]={t:"n",v:l};break;case"?":for(l=h;e.charAt(++o)===h;)l+=h;r[r.length]={t:h,v:l},f=h;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":r[r.length]={t:a===1?"t":h,v:h},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=h;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)l+=e.charAt(o);r[r.length]={t:"D",v:l};break;case" ":r[r.length]={t:h,v:h},++o;break;case"$":r[r.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(h)===-1)throw new Error("unrecognized character "+h+" in "+e);r[r.length]={t:"t",v:h},++o;break}var T=0,S=0,E;for(o=r.length-1,f="t";o>=0;--o)switch(r[o].t){case"h":case"H":r[o].t=y,f="h",T<1&&(T=1);break;case"s":(E=r[o].v.match(/\.0+$/))&&(S=Math.max(S,E[0].length-1)),T<3&&(T=3);case"d":case"y":case"M":case"e":f=r[o].t;break;case"m":f==="s"&&(r[o].t="M",T<2&&(T=2));break;case"X":break;case"Z":T<1&&r[o].v.match(/[Hh]/)&&(T=1),T<2&&r[o].v.match(/[Mm]/)&&(T=2),T<3&&r[o].v.match(/[Ss]/)&&(T=3)}switch(T){case 0:break;case 1:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M),x.M>=60&&(x.M=0,++x.H);break;case 2:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M);break}var C="",A;for(o=0;o<r.length;++o)switch(r[o].t){case"t":case"T":case" ":case"D":break;case"X":r[o].v="",r[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":r[o].v=Gk(r[o].t.charCodeAt(0),r[o].v,x,S),r[o].t="t";break;case"n":case"?":for(A=o+1;r[A]!=null&&((h=r[A].t)==="?"||h==="D"||(h===" "||h==="t")&&r[A+1]!=null&&(r[A+1].t==="?"||r[A+1].t==="t"&&r[A+1].v==="/")||r[o].t==="("&&(h===" "||h==="n"||h===")")||h==="t"&&(r[A].v==="/"||r[A].v===" "&&r[A+1]!=null&&r[A+1].t=="?"));)r[o].v+=r[A].v,r[A]={v:"",t:";"},++A;C+=r[o].v,o=A-1;break;case"G":r[o].t="t",r[o].v=tx(t,n);break}var F="",K,O;if(C.length>0){C.charCodeAt(0)==40?(K=t<0&&C.charCodeAt(0)===45?-t:t,O=jr("n",C,K)):(K=t<0&&a>1?-t:t,O=jr("n",C,K),K<0&&r[0]&&r[0].t=="t"&&(O=O.substr(1),r[0].v="-"+r[0].v)),A=O.length-1;var P=r.length;for(o=0;o<r.length;++o)if(r[o]!=null&&r[o].t!="t"&&r[o].v.indexOf(".")>-1){P=o;break}var M=r.length;if(P===r.length&&O.indexOf("E")===-1){for(o=r.length-1;o>=0;--o)r[o]==null||"n?".indexOf(r[o].t)===-1||(A>=r[o].v.length-1?(A-=r[o].v.length,r[o].v=O.substr(A+1,r[o].v.length)):A<0?r[o].v="":(r[o].v=O.substr(0,A+1),A=-1),r[o].t="t",M=o);A>=0&&M<r.length&&(r[M].v=O.substr(0,A+1)+r[M].v)}else if(P!==r.length&&O.indexOf("E")===-1){for(A=O.indexOf(".")-1,o=P;o>=0;--o)if(!(r[o]==null||"n?".indexOf(r[o].t)===-1)){for(g=r[o].v.indexOf(".")>-1&&o===P?r[o].v.indexOf(".")-1:r[o].v.length-1,F=r[o].v.substr(g+1);g>=0;--g)A>=0&&(r[o].v.charAt(g)==="0"||r[o].v.charAt(g)==="#")&&(F=O.charAt(A--)+F);r[o].v=F,r[o].t="t",M=o}for(A>=0&&M<r.length&&(r[M].v=O.substr(0,A+1)+r[M].v),A=O.indexOf(".")+1,o=P;o<r.length;++o)if(!(r[o]==null||"n?(".indexOf(r[o].t)===-1&&o!==P)){for(g=r[o].v.indexOf(".")>-1&&o===P?r[o].v.indexOf(".")+1:0,F=r[o].v.substr(0,g);g<r[o].v.length;++g)A<O.length&&(F+=O.charAt(A++));r[o].v=F,r[o].t="t",M=o}}}for(o=0;o<r.length;++o)r[o]!=null&&"n?".indexOf(r[o].t)>-1&&(K=a>1&&t<0&&o>0&&r[o-1].v==="-"?-t:t,r[o].v=jr(r[o].t,r[o].v,K),r[o].t="t");var B="";for(o=0;o!==r.length;++o)r[o]!=null&&(B+=r[o].v);return B}var wv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Tv(e,t){if(t==null)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function aA(e,t){var n=tA(e),a=n.length,r=n[a-1].indexOf("@");if(a<4&&r>-1&&--a,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||r>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=r>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=r>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=r>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var l=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[a,l];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var o=n[0].match(wv),h=n[1].match(wv);return Tv(t,o)?[a,n[0]]:Tv(t,h)?[a,n[1]]:[a,n[o!=null&&h!=null?2:1]]}return[a,l]}function ms(e,t,n){n==null&&(n={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&n.dateNF?a=n.dateNF:a=e;break;case"number":e==14&&n.dateNF?a=n.dateNF:a=(n.table!=null?n.table:Vt)[e],a==null&&(a=n.table&&n.table[vv[e]]||Vt[vv[e]]),a==null&&(a=Hk[e]||"General");break}if(Ah(a,0))return tx(t,n);t instanceof Date&&(t=wb(t,n.date1904));var r=aA(a,t);if(Ah(r[1]))return tx(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return nA(r[1],t,n,r[0])}function Ob(e,t){if(typeof t!="number"){t=+t||-1;for(var n=0;n<392;++n){if(Vt[n]==null){t<0&&(t=n);continue}if(Vt[n]==e){t=n;break}}t<0&&(t=391)}return Vt[t]=e,t}function Jh(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Ob(e[t],t)}function ef(){Vt=Bk()}var Mb=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function rA(e){var t=typeof e=="number"?Vt[e]:e;return t=t.replace(Mb,"(\\d+)"),new RegExp("^"+t+"$")}function sA(e,t,n){var a=-1,r=-1,l=-1,o=-1,h=-1,f=-1;(t.match(Mb)||[]).forEach(function(p,y){var _=parseInt(n[y+1],10);switch(p.toLowerCase().charAt(0)){case"y":a=_;break;case"d":l=_;break;case"h":o=_;break;case"s":f=_;break;case"m":o>=0?h=_:r=_;break}}),f>=0&&h==-1&&r>=0&&(h=r,r=-1);var x=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);x.length==7&&(x="0"+x),x.length==8&&(x="20"+x);var g=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return o==-1&&h==-1&&f==-1?x:a==-1&&r==-1&&l==-1?g:x+"T"+g}var iA=function(){var e={};e.version="1.2.0";function t(){for(var O=0,P=new Array(256),M=0;M!=256;++M)O=M,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,P[M]=O;return typeof Int32Array<"u"?new Int32Array(P):P}var n=t();function a(O){var P=0,M=0,B=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)I[B]=O[B];for(B=0;B!=256;++B)for(M=O[B],P=256+B;P<4096;P+=256)M=I[P]=M>>>8^O[M&255];var te=[];for(B=1;B!=16;++B)te[B-1]=typeof Int32Array<"u"?I.subarray(B*256,B*256+256):I.slice(B*256,B*256+256);return te}var r=a(n),l=r[0],o=r[1],h=r[2],f=r[3],x=r[4],g=r[5],p=r[6],y=r[7],_=r[8],w=r[9],b=r[10],T=r[11],S=r[12],E=r[13],C=r[14];function A(O,P){for(var M=P^-1,B=0,I=O.length;B<I;)M=M>>>8^n[(M^O.charCodeAt(B++))&255];return~M}function F(O,P){for(var M=P^-1,B=O.length-15,I=0;I<B;)M=C[O[I++]^M&255]^E[O[I++]^M>>8&255]^S[O[I++]^M>>16&255]^T[O[I++]^M>>>24]^b[O[I++]]^w[O[I++]]^_[O[I++]]^y[O[I++]]^p[O[I++]]^g[O[I++]]^x[O[I++]]^f[O[I++]]^h[O[I++]]^o[O[I++]]^l[O[I++]]^n[O[I++]];for(B+=15;I<B;)M=M>>>8^n[(M^O[I++])&255];return~M}function K(O,P){for(var M=P^-1,B=0,I=O.length,te=0,q=0;B<I;)te=O.charCodeAt(B++),te<128?M=M>>>8^n[(M^te)&255]:te<2048?(M=M>>>8^n[(M^(192|te>>6&31))&255],M=M>>>8^n[(M^(128|te&63))&255]):te>=55296&&te<57344?(te=(te&1023)+64,q=O.charCodeAt(B++)&1023,M=M>>>8^n[(M^(240|te>>8&7))&255],M=M>>>8^n[(M^(128|te>>2&63))&255],M=M>>>8^n[(M^(128|q>>6&15|(te&3)<<4))&255],M=M>>>8^n[(M^(128|q&63))&255]):(M=M>>>8^n[(M^(224|te>>12&15))&255],M=M>>>8^n[(M^(128|te>>6&63))&255],M=M>>>8^n[(M^(128|te&63))&255]);return~M}return e.table=n,e.bstr=A,e.buf=F,e.str=K,e}(),Et=function(){var t={};t.version="1.2.1";function n(D,G){for(var L=D.split("/"),z=G.split("/"),W=0,X=0,ue=Math.min(L.length,z.length);W<ue;++W){if(X=L[W].length-z[W].length)return X;if(L[W]!=z[W])return L[W]<z[W]?-1:1}return L.length-z.length}function a(D){if(D.charAt(D.length-1)=="/")return D.slice(0,-1).indexOf("/")===-1?D:a(D.slice(0,-1));var G=D.lastIndexOf("/");return G===-1?D:D.slice(0,G+1)}function r(D){if(D.charAt(D.length-1)=="/")return r(D.slice(0,-1));var G=D.lastIndexOf("/");return G===-1?D:D.slice(G+1)}function l(D,G){typeof G=="string"&&(G=new Date(G));var L=G.getHours();L=L<<6|G.getMinutes(),L=L<<5|G.getSeconds()>>>1,D.write_shift(2,L);var z=G.getFullYear()-1980;z=z<<4|G.getMonth()+1,z=z<<5|G.getDate(),D.write_shift(2,z)}function o(D){var G=D.read_shift(2)&65535,L=D.read_shift(2)&65535,z=new Date,W=L&31;L>>>=5;var X=L&15;L>>>=4,z.setMilliseconds(0),z.setFullYear(L+1980),z.setMonth(X-1),z.setDate(W);var ue=G&31;G>>>=5;var ve=G&63;return G>>>=6,z.setHours(G),z.setMinutes(ve),z.setSeconds(ue<<1),z}function h(D){ra(D,0);for(var G={},L=0;D.l<=D.length-4;){var z=D.read_shift(2),W=D.read_shift(2),X=D.l+W,ue={};switch(z){case 21589:L=D.read_shift(1),L&1&&(ue.mtime=D.read_shift(4)),W>5&&(L&2&&(ue.atime=D.read_shift(4)),L&4&&(ue.ctime=D.read_shift(4))),ue.mtime&&(ue.mt=new Date(ue.mtime*1e3));break}D.l=X,G[z]=ue}return G}var f;function x(){return f||(f={})}function g(D,G){if(D[0]==80&&D[1]==75)return _l(D,G);if((D[0]|32)==109&&(D[1]|32)==105)return lf(D,G);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var L=3,z=512,W=0,X=0,ue=0,ve=0,le=0,he=[],xe=D.slice(0,512);ra(xe,0);var je=p(xe);switch(L=je[0],L){case 3:z=512;break;case 4:z=4096;break;case 0:if(je[1]==0)return _l(D,G);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}z!==512&&(xe=D.slice(0,z),ra(xe,28));var De=D.slice(0,z);y(xe,L);var Be=xe.read_shift(4,"i");if(L===3&&Be!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Be);xe.l+=4,ue=xe.read_shift(4,"i"),xe.l+=4,xe.chk("00100000","Mini Stream Cutoff Size: "),ve=xe.read_shift(4,"i"),W=xe.read_shift(4,"i"),le=xe.read_shift(4,"i"),X=xe.read_shift(4,"i");for(var Ae=-1,Le=0;Le<109&&(Ae=xe.read_shift(4,"i"),!(Ae<0));++Le)he[Le]=Ae;var Xe=_(D,z);T(le,X,Xe,z,he);var _t=E(Xe,ue,he,z);_t[ue].name="!Directory",W>0&&ve!==q&&(_t[ve].name="!MiniFAT"),_t[he[0]].name="!FAT",_t.fat_addrs=he,_t.ssz=z;var wt={},kt=[],rr=[],Br=[];C(ue,_t,Xe,kt,W,wt,rr,ve),w(rr,Br,kt),kt.shift();var ca={FileIndex:rr,FullPaths:Br};return G&&G.raw&&(ca.raw={header:De,sectors:Xe}),ca}function p(D){if(D[D.l]==80&&D[D.l+1]==75)return[0,0];D.chk(ae,"Header Signature: "),D.l+=16;var G=D.read_shift(2,"u");return[D.read_shift(2,"u"),G]}function y(D,G){var L=9;switch(D.l+=2,L=D.read_shift(2)){case 9:if(G!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(G!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}function _(D,G){for(var L=Math.ceil(D.length/G)-1,z=[],W=1;W<L;++W)z[W-1]=D.slice(W*G,(W+1)*G);return z[L-1]=D.slice(L*G),z}function w(D,G,L){for(var z=0,W=0,X=0,ue=0,ve=0,le=L.length,he=[],xe=[];z<le;++z)he[z]=xe[z]=z,G[z]=L[z];for(;ve<xe.length;++ve)z=xe[ve],W=D[z].L,X=D[z].R,ue=D[z].C,he[z]===z&&(W!==-1&&he[W]!==W&&(he[z]=he[W]),X!==-1&&he[X]!==X&&(he[z]=he[X])),ue!==-1&&(he[ue]=z),W!==-1&&z!=he[z]&&(he[W]=he[z],xe.lastIndexOf(W)<ve&&xe.push(W)),X!==-1&&z!=he[z]&&(he[X]=he[z],xe.lastIndexOf(X)<ve&&xe.push(X));for(z=1;z<le;++z)he[z]===z&&(X!==-1&&he[X]!==X?he[z]=he[X]:W!==-1&&he[W]!==W&&(he[z]=he[W]));for(z=1;z<le;++z)if(D[z].type!==0){if(ve=z,ve!=he[ve])do ve=he[ve],G[z]=G[ve]+"/"+G[z];while(ve!==0&&he[ve]!==-1&&ve!=he[ve]);he[z]=-1}for(G[0]+="/",z=1;z<le;++z)D[z].type!==2&&(G[z]+="/")}function b(D,G,L){for(var z=D.start,W=D.size,X=[],ue=z;L&&W>0&&ue>=0;)X.push(G.slice(ue*te,ue*te+te)),W-=te,ue=Xs(L,ue*4);return X.length===0?be(0):vn(X).slice(0,D.size)}function T(D,G,L,z,W){var X=q;if(D===q){if(G!==0)throw new Error("DIFAT chain shorter than expected")}else if(D!==-1){var ue=L[D],ve=(z>>>2)-1;if(!ue)return;for(var le=0;le<ve&&(X=Xs(ue,le*4))!==q;++le)W.push(X);T(Xs(ue,z-4),G-1,L,z,W)}}function S(D,G,L,z,W){var X=[],ue=[];W||(W=[]);var ve=z-1,le=0,he=0;for(le=G;le>=0;){W[le]=!0,X[X.length]=le,ue.push(D[le]);var xe=L[Math.floor(le*4/z)];if(he=le*4&ve,z<4+he)throw new Error("FAT boundary crossed: "+le+" 4 "+z);if(!D[xe])break;le=Xs(D[xe],he)}return{nodes:X,data:Dv([ue])}}function E(D,G,L,z){var W=D.length,X=[],ue=[],ve=[],le=[],he=z-1,xe=0,je=0,De=0,Be=0;for(xe=0;xe<W;++xe)if(ve=[],De=xe+G,De>=W&&(De-=W),!ue[De]){le=[];var Ae=[];for(je=De;je>=0;){Ae[je]=!0,ue[je]=!0,ve[ve.length]=je,le.push(D[je]);var Le=L[Math.floor(je*4/z)];if(Be=je*4&he,z<4+Be)throw new Error("FAT boundary crossed: "+je+" 4 "+z);if(!D[Le]||(je=Xs(D[Le],Be),Ae[je]))break}X[De]={nodes:ve,data:Dv([le])}}return X}function C(D,G,L,z,W,X,ue,ve){for(var le=0,he=z.length?2:0,xe=G[D].data,je=0,De=0,Be;je<xe.length;je+=128){var Ae=xe.slice(je,je+128);ra(Ae,64),De=Ae.read_shift(2),Be=Hx(Ae,0,De-he),z.push(Be);var Le={name:Be,type:Ae.read_shift(1),color:Ae.read_shift(1),L:Ae.read_shift(4,"i"),R:Ae.read_shift(4,"i"),C:Ae.read_shift(4,"i"),clsid:Ae.read_shift(16),state:Ae.read_shift(4,"i"),start:0,size:0},Xe=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);Xe!==0&&(Le.ct=A(Ae,Ae.l-8));var _t=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);_t!==0&&(Le.mt=A(Ae,Ae.l-8)),Le.start=Ae.read_shift(4,"i"),Le.size=Ae.read_shift(4,"i"),Le.size<0&&Le.start<0&&(Le.size=Le.type=0,Le.start=q,Le.name=""),Le.type===5?(le=Le.start,W>0&&le!==q&&(G[le].name="!StreamData")):Le.size>=4096?(Le.storage="fat",G[Le.start]===void 0&&(G[Le.start]=S(L,Le.start,G.fat_addrs,G.ssz)),G[Le.start].name=Le.name,Le.content=G[Le.start].data.slice(0,Le.size)):(Le.storage="minifat",Le.size<0?Le.size=0:le!==q&&Le.start!==q&&G[le]&&(Le.content=b(Le,G[le].data,(G[ve]||{}).data))),Le.content&&ra(Le.content,0),X[Be]=Le,ue.push(Le)}}function A(D,G){return new Date((ia(D,G+4)/1e7*Math.pow(2,32)+ia(D,G)/1e7-11644473600)*1e3)}function F(D,G){return x(),g(f.readFileSync(D),G)}function K(D,G){var L=G&&G.type;switch(L||ht&&Buffer.isBuffer(D)&&(L="buffer"),L||"base64"){case"file":return F(D,G);case"base64":return g(Ra(Or(D)),G);case"binary":return g(Ra(D),G)}return g(D,G)}function O(D,G){var L=G||{},z=L.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");D.FullPaths.length===0&&(D.FullPaths[0]=z+"/",D.FileIndex[0]={name:z,type:5}),L.CLSID&&(D.FileIndex[0].clsid=L.CLSID),P(D)}function P(D){var G="Sh33tJ5";if(!Et.find(D,"/"+G)){var L=be(4);L[0]=55,L[1]=L[3]=50,L[2]=54,D.FileIndex.push({name:G,type:2,content:L,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+G),M(D)}}function M(D,G){O(D);for(var L=!1,z=!1,W=D.FullPaths.length-1;W>=0;--W){var X=D.FileIndex[W];switch(X.type){case 0:z?L=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:z=!0,isNaN(X.R*X.L*X.C)&&(L=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!G)){var ue=new Date(1987,1,19),ve=0,le=Object.create?Object.create(null):{},he=[];for(W=0;W<D.FullPaths.length;++W)le[D.FullPaths[W]]=!0,D.FileIndex[W].type!==0&&he.push([D.FullPaths[W],D.FileIndex[W]]);for(W=0;W<he.length;++W){var xe=a(he[W][0]);z=le[xe],z||(he.push([xe,{name:r(xe).replace("/",""),type:1,clsid:ee,ct:ue,mt:ue,content:null}]),le[xe]=!0)}for(he.sort(function(Be,Ae){return n(Be[0],Ae[0])}),D.FullPaths=[],D.FileIndex=[],W=0;W<he.length;++W)D.FullPaths[W]=he[W][0],D.FileIndex[W]=he[W][1];for(W=0;W<he.length;++W){var je=D.FileIndex[W],De=D.FullPaths[W];if(je.name=r(De).replace("/",""),je.L=je.R=je.C=-(je.color=1),je.size=je.content?je.content.length:0,je.start=0,je.clsid=je.clsid||ee,W===0)je.C=he.length>1?1:-1,je.size=0,je.type=5;else if(De.slice(-1)=="/"){for(ve=W+1;ve<he.length&&a(D.FullPaths[ve])!=De;++ve);for(je.C=ve>=he.length?-1:ve,ve=W+1;ve<he.length&&a(D.FullPaths[ve])!=a(De);++ve);je.R=ve>=he.length?-1:ve,je.type=1}else a(D.FullPaths[W+1]||"")==a(De)&&(je.R=W+1),je.type=2}}}function B(D,G){var L=G||{};if(L.fileType=="mad")return Ua(D,L);switch(M(D),L.fileType){case"zip":return Ts(D,L)}var z=function(Be){for(var Ae=0,Le=0,Xe=0;Xe<Be.FileIndex.length;++Xe){var _t=Be.FileIndex[Xe];if(_t.content){var wt=_t.content.length;wt>0&&(wt<4096?Ae+=wt+63>>6:Le+=wt+511>>9)}}for(var kt=Be.FullPaths.length+3>>2,rr=Ae+7>>3,Br=Ae+127>>7,ca=rr+Le+kt+Br,Ca=ca+127>>7,Ss=Ca<=109?0:Math.ceil((Ca-109)/127);ca+Ca+Ss+127>>7>Ca;)Ss=++Ca<=109?0:Math.ceil((Ca-109)/127);var ja=[1,Ss,Ca,Br,kt,Le,Ae,0];return Be.FileIndex[0].size=Ae<<6,ja[7]=(Be.FileIndex[0].start=ja[0]+ja[1]+ja[2]+ja[3]+ja[4]+ja[5])+(ja[6]+7>>3),ja}(D),W=be(z[7]<<9),X=0,ue=0;{for(X=0;X<8;++X)W.write_shift(1,re[X]);for(X=0;X<8;++X)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),X=0;X<3;++X)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,z[2]),W.write_shift(4,z[0]+z[1]+z[2]+z[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,z[3]?z[0]+z[1]+z[2]-1:q),W.write_shift(4,z[3]),W.write_shift(-4,z[1]?z[0]-1:q),W.write_shift(4,z[1]),X=0;X<109;++X)W.write_shift(-4,X<z[2]?z[1]+X:-1)}if(z[1])for(ue=0;ue<z[1];++ue){for(;X<236+ue*127;++X)W.write_shift(-4,X<z[2]?z[1]+X:-1);W.write_shift(-4,ue===z[1]-1?q:ue+1)}var ve=function(Be){for(ue+=Be;X<ue-1;++X)W.write_shift(-4,X+1);Be&&(++X,W.write_shift(-4,q))};for(ue=X=0,ue+=z[1];X<ue;++X)W.write_shift(-4,Q.DIFSECT);for(ue+=z[2];X<ue;++X)W.write_shift(-4,Q.FATSECT);ve(z[3]),ve(z[4]);for(var le=0,he=0,xe=D.FileIndex[0];le<D.FileIndex.length;++le)xe=D.FileIndex[le],xe.content&&(he=xe.content.length,!(he<4096)&&(xe.start=ue,ve(he+511>>9)));for(ve(z[6]+7>>3);W.l&511;)W.write_shift(-4,Q.ENDOFCHAIN);for(ue=X=0,le=0;le<D.FileIndex.length;++le)xe=D.FileIndex[le],xe.content&&(he=xe.content.length,!(!he||he>=4096)&&(xe.start=ue,ve(he+63>>6)));for(;W.l&511;)W.write_shift(-4,Q.ENDOFCHAIN);for(X=0;X<z[4]<<2;++X){var je=D.FullPaths[X];if(!je||je.length===0){for(le=0;le<17;++le)W.write_shift(4,0);for(le=0;le<3;++le)W.write_shift(4,-1);for(le=0;le<12;++le)W.write_shift(4,0);continue}xe=D.FileIndex[X],X===0&&(xe.start=xe.size?xe.start-1:q);var De=X===0&&L.root||xe.name;if(he=2*(De.length+1),W.write_shift(64,De,"utf16le"),W.write_shift(2,he),W.write_shift(1,xe.type),W.write_shift(1,xe.color),W.write_shift(-4,xe.L),W.write_shift(-4,xe.R),W.write_shift(-4,xe.C),xe.clsid)W.write_shift(16,xe.clsid,"hex");else for(le=0;le<4;++le)W.write_shift(4,0);W.write_shift(4,xe.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,xe.start),W.write_shift(4,xe.size),W.write_shift(4,0)}for(X=1;X<D.FileIndex.length;++X)if(xe=D.FileIndex[X],xe.size>=4096)if(W.l=xe.start+1<<9,ht&&Buffer.isBuffer(xe.content))xe.content.copy(W,W.l,0,xe.size),W.l+=xe.size+511&-512;else{for(le=0;le<xe.size;++le)W.write_shift(1,xe.content[le]);for(;le&511;++le)W.write_shift(1,0)}for(X=1;X<D.FileIndex.length;++X)if(xe=D.FileIndex[X],xe.size>0&&xe.size<4096)if(ht&&Buffer.isBuffer(xe.content))xe.content.copy(W,W.l,0,xe.size),W.l+=xe.size+63&-64;else{for(le=0;le<xe.size;++le)W.write_shift(1,xe.content[le]);for(;le&63;++le)W.write_shift(1,0)}if(ht)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}function I(D,G){var L=D.FullPaths.map(function(le){return le.toUpperCase()}),z=L.map(function(le){var he=le.split("/");return he[he.length-(le.slice(-1)=="/"?2:1)]}),W=!1;G.charCodeAt(0)===47?(W=!0,G=L[0].slice(0,-1)+G):W=G.indexOf("/")!==-1;var X=G.toUpperCase(),ue=W===!0?L.indexOf(X):z.indexOf(X);if(ue!==-1)return D.FileIndex[ue];var ve=!X.match(ih);for(X=X.replace(Ko,""),ve&&(X=X.replace(ih,"!")),ue=0;ue<L.length;++ue)if((ve?L[ue].replace(ih,"!"):L[ue]).replace(Ko,"")==X||(ve?z[ue].replace(ih,"!"):z[ue]).replace(Ko,"")==X)return D.FileIndex[ue];return null}var te=64,q=-2,ae="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",Q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:ae,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function me(D,G,L){x();var z=B(D,L);f.writeFileSync(G,z)}function ye(D){for(var G=new Array(D.length),L=0;L<D.length;++L)G[L]=String.fromCharCode(D[L]);return G.join("")}function Y(D,G){var L=B(D,G);switch(G&&G.type||"buffer"){case"file":return x(),f.writeFileSync(G.filename,L),L;case"binary":return typeof L=="string"?L:ye(L);case"base64":return cc(typeof L=="string"?L:ye(L));case"buffer":if(ht)return Buffer.isBuffer(L)?L:Fr(L);case"array":return typeof L=="string"?Ra(L):L}return L}var de;function H(D){try{var G=D.InflateRaw,L=new G;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)de=D;else throw new Error("zlib does not expose bytesRead")}catch(z){console.error("cannot use native zlib: "+(z.message||z))}}function Z(D,G){if(!de)return Cc(D,G);var L=de.InflateRaw,z=new L,W=z._processChunk(D.slice(D.l),z._finishFlushFlag);return D.l+=z.bytesRead,W}function j(D){return de?de.deflateRawSync(D):Sc(D)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ie(D){var G=(D<<1|D<<11)&139536|(D<<5|D<<15)&558144;return(G>>16|G>>8|G)&255}for(var _e=typeof Uint8Array<"u",Ne=_e?new Uint8Array(256):[],Ie=0;Ie<256;++Ie)Ne[Ie]=ie(Ie);function Ue(D,G){var L=Ne[D&255];return G<=8?L>>>8-G:(L=L<<8|Ne[D>>8&255],G<=16?L>>>16-G:(L=L<<8|Ne[D>>16&255],L>>>24-G))}function at(D,G){var L=G&7,z=G>>>3;return(D[z]|(L<=6?0:D[z+1]<<8))>>>L&3}function Ye(D,G){var L=G&7,z=G>>>3;return(D[z]|(L<=5?0:D[z+1]<<8))>>>L&7}function nn(D,G){var L=G&7,z=G>>>3;return(D[z]|(L<=4?0:D[z+1]<<8))>>>L&15}function xt(D,G){var L=G&7,z=G>>>3;return(D[z]|(L<=3?0:D[z+1]<<8))>>>L&31}function Fe(D,G){var L=G&7,z=G>>>3;return(D[z]|(L<=1?0:D[z+1]<<8))>>>L&127}function ft(D,G,L){var z=G&7,W=G>>>3,X=(1<<L)-1,ue=D[W]>>>z;return L<8-z||(ue|=D[W+1]<<8-z,L<16-z)||(ue|=D[W+2]<<16-z,L<24-z)||(ue|=D[W+3]<<24-z),ue&X}function pe(D,G,L){var z=G&7,W=G>>>3;return z<=5?D[W]|=(L&7)<<z:(D[W]|=L<<z&255,D[W+1]=(L&7)>>8-z),G+3}function ke(D,G,L){var z=G&7,W=G>>>3;return L=(L&1)<<z,D[W]|=L,G+1}function ze(D,G,L){var z=G&7,W=G>>>3;return L<<=z,D[W]|=L&255,L>>>=8,D[W+1]=L,G+8}function et(D,G,L){var z=G&7,W=G>>>3;return L<<=z,D[W]|=L&255,L>>>=8,D[W+1]=L&255,D[W+2]=L>>>8,G+16}function Dt(D,G){var L=D.length,z=2*L>G?2*L:G+5,W=0;if(L>=G)return D;if(ht){var X=mv(z);if(D.copy)D.copy(X);else for(;W<D.length;++W)X[W]=D[W];return X}else if(_e){var ue=new Uint8Array(z);if(ue.set)ue.set(D);else for(;W<L;++W)ue[W]=D[W];return ue}return D.length=z,D}function lt(D){for(var G=new Array(D),L=0;L<D;++L)G[L]=0;return G}function Bn(D,G,L){var z=1,W=0,X=0,ue=0,ve=0,le=D.length,he=_e?new Uint16Array(32):lt(32);for(X=0;X<32;++X)he[X]=0;for(X=le;X<L;++X)D[X]=0;le=D.length;var xe=_e?new Uint16Array(le):lt(le);for(X=0;X<le;++X)he[W=D[X]]++,z<W&&(z=W),xe[X]=0;for(he[0]=0,X=1;X<=z;++X)he[X+16]=ve=ve+he[X-1]<<1;for(X=0;X<le;++X)ve=D[X],ve!=0&&(xe[X]=he[ve+16]++);var je=0;for(X=0;X<le;++X)if(je=D[X],je!=0)for(ve=Ue(xe[X],z)>>z-je,ue=(1<<z+4-je)-1;ue>=0;--ue)G[ve|ue<<je]=je&15|X<<4;return z}var Ea=_e?new Uint16Array(512):lt(512),fn=_e?new Uint16Array(32):lt(32);if(!_e){for(var Sn=0;Sn<512;++Sn)Ea[Sn]=0;for(Sn=0;Sn<32;++Sn)fn[Sn]=0}(function(){for(var D=[],G=0;G<32;G++)D.push(5);Bn(D,fn,32);var L=[];for(G=0;G<=143;G++)L.push(8);for(;G<=255;G++)L.push(9);for(;G<=279;G++)L.push(7);for(;G<=287;G++)L.push(8);Bn(L,Ea,288)})();var On=function(){for(var G=_e?new Uint8Array(32768):[],L=0,z=0;L<Te.length-1;++L)for(;z<Te[L+1];++z)G[z]=L;for(;z<32768;++z)G[z]=29;var W=_e?new Uint8Array(259):[];for(L=0,z=0;L<U.length-1;++L)for(;z<U[L+1];++z)W[z]=L;function X(ve,le){for(var he=0;he<ve.length;){var xe=Math.min(65535,ve.length-he),je=he+xe==ve.length;for(le.write_shift(1,+je),le.write_shift(2,xe),le.write_shift(2,~xe&65535);xe-- >0;)le[le.l++]=ve[he++]}return le.l}function ue(ve,le){for(var he=0,xe=0,je=_e?new Uint16Array(32768):[];xe<ve.length;){var De=Math.min(65535,ve.length-xe);if(De<10){for(he=pe(le,he,+(xe+De==ve.length)),he&7&&(he+=8-(he&7)),le.l=he/8|0,le.write_shift(2,De),le.write_shift(2,~De&65535);De-- >0;)le[le.l++]=ve[xe++];he=le.l*8;continue}he=pe(le,he,+(xe+De==ve.length)+2);for(var Be=0;De-- >0;){var Ae=ve[xe];Be=(Be<<5^Ae)&32767;var Le=-1,Xe=0;if((Le=je[Be])&&(Le|=xe&-32768,Le>xe&&(Le-=32768),Le<xe))for(;ve[Le+Xe]==ve[xe+Xe]&&Xe<250;)++Xe;if(Xe>2){Ae=W[Xe],Ae<=22?he=ze(le,he,Ne[Ae+1]>>1)-1:(ze(le,he,3),he+=5,ze(le,he,Ne[Ae-23]>>5),he+=3);var _t=Ae<8?0:Ae-4>>2;_t>0&&(et(le,he,Xe-U[Ae]),he+=_t),Ae=G[xe-Le],he=ze(le,he,Ne[Ae]>>3),he-=3;var wt=Ae<4?0:Ae-2>>1;wt>0&&(et(le,he,xe-Le-Te[Ae]),he+=wt);for(var kt=0;kt<Xe;++kt)je[Be]=xe&32767,Be=(Be<<5^ve[xe])&32767,++xe;De-=Xe-1}else Ae<=143?Ae=Ae+48:he=ke(le,he,1),he=ze(le,he,Ne[Ae]),je[Be]=xe&32767,++xe}he=ze(le,he,0)-1}return le.l=(he+7)/8|0,le.l}return function(le,he){return le.length<8?X(le,he):ue(le,he)}}();function Sc(D){var G=be(50+Math.floor(D.length*1.1)),L=On(D,G);return G.slice(0,L)}var Nc=_e?new Uint16Array(32768):lt(32768),Ec=_e?new Uint16Array(32768):lt(32768),bs=_e?new Uint16Array(128):lt(128),_s=1,za=1;function fi(D,G){var L=xt(D,G)+257;G+=5;var z=xt(D,G)+1;G+=5;var W=nn(D,G)+4;G+=4;for(var X=0,ue=_e?new Uint8Array(19):lt(19),ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,he=_e?new Uint8Array(8):lt(8),xe=_e?new Uint8Array(8):lt(8),je=ue.length,De=0;De<W;++De)ue[V[De]]=X=Ye(D,G),le<X&&(le=X),he[X]++,G+=3;var Be=0;for(he[0]=0,De=1;De<=le;++De)xe[De]=Be=Be+he[De-1]<<1;for(De=0;De<je;++De)(Be=ue[De])!=0&&(ve[De]=xe[Be]++);var Ae=0;for(De=0;De<je;++De)if(Ae=ue[De],Ae!=0){Be=Ne[ve[De]]>>8-Ae;for(var Le=(1<<7-Ae)-1;Le>=0;--Le)bs[Be|Le<<Ae]=Ae&7|De<<3}var Xe=[];for(le=1;Xe.length<L+z;)switch(Be=bs[Fe(D,G)],G+=Be&7,Be>>>=3){case 16:for(X=3+at(D,G),G+=2,Be=Xe[Xe.length-1];X-- >0;)Xe.push(Be);break;case 17:for(X=3+Ye(D,G),G+=3;X-- >0;)Xe.push(0);break;case 18:for(X=11+Fe(D,G),G+=7;X-- >0;)Xe.push(0);break;default:Xe.push(Be),le<Be&&(le=Be);break}var _t=Xe.slice(0,L),wt=Xe.slice(L);for(De=L;De<286;++De)_t[De]=0;for(De=z;De<30;++De)wt[De]=0;return _s=Bn(_t,Nc,286),za=Bn(wt,Ec,30),G}function ws(D,G){if(D[0]==3&&!(D[1]&3))return[ni(G),2];for(var L=0,z=0,W=mv(G||1<<18),X=0,ue=W.length>>>0,ve=0,le=0;(z&1)==0;){if(z=Ye(D,L),L+=3,z>>>1)z>>1==1?(ve=9,le=5):(L=fi(D,L),ve=_s,le=za);else{L&7&&(L+=8-(L&7));var he=D[L>>>3]|D[(L>>>3)+1]<<8;if(L+=32,he>0)for(!G&&ue<X+he&&(W=Dt(W,X+he),ue=W.length);he-- >0;)W[X++]=D[L>>>3],L+=8;continue}for(;;){!G&&ue<X+32767&&(W=Dt(W,X+32767),ue=W.length);var xe=ft(D,L,ve),je=z>>>1==1?Ea[xe]:Nc[xe];if(L+=je&15,je>>>=4,(je>>>8&255)===0)W[X++]=je;else{if(je==256)break;je-=257;var De=je<8?0:je-4>>2;De>5&&(De=0);var Be=X+U[je];De>0&&(Be+=ft(D,L,De),L+=De),xe=ft(D,L,le),je=z>>>1==1?fn[xe]:Ec[xe],L+=je&15,je>>>=4;var Ae=je<4?0:je-2>>1,Le=Te[je];for(Ae>0&&(Le+=ft(D,L,Ae),L+=Ae),!G&&ue<Be&&(W=Dt(W,Be+100),ue=W.length);X<Be;)W[X]=W[X-Le],++X}}}return G?[W,L+7>>>3]:[W.slice(0,X),L+7>>>3]}function Cc(D,G){var L=D.slice(D.l||0),z=ws(L,G);return D.l+=z[1],z[0]}function bl(D,G){if(D)typeof console<"u"&&console.error(G);else throw new Error(G)}function _l(D,G){var L=D;ra(L,0);var z=[],W=[],X={FileIndex:z,FullPaths:W};O(X,{root:G.root});for(var ue=L.length-4;(L[ue]!=80||L[ue+1]!=75||L[ue+2]!=5||L[ue+3]!=6)&&ue>=0;)--ue;L.l=ue+4,L.l+=4;var ve=L.read_shift(2);L.l+=6;var le=L.read_shift(4);for(L.l=le,ue=0;ue<ve;++ue){L.l+=20;var he=L.read_shift(4),xe=L.read_shift(4),je=L.read_shift(2),De=L.read_shift(2),Be=L.read_shift(2);L.l+=8;var Ae=L.read_shift(4),Le=h(L.slice(L.l+je,L.l+je+De));L.l+=je+De+Be;var Xe=L.l;L.l=Ae+4,wl(L,he,xe,X,Le),L.l=Xe}return X}function wl(D,G,L,z,W){D.l+=2;var X=D.read_shift(2),ue=D.read_shift(2),ve=o(D);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var le=D.read_shift(4),he=D.read_shift(4),xe=D.read_shift(4),je=D.read_shift(2),De=D.read_shift(2),Be="",Ae=0;Ae<je;++Ae)Be+=String.fromCharCode(D[D.l++]);if(De){var Le=h(D.slice(D.l,D.l+De));(Le[21589]||{}).mt&&(ve=Le[21589].mt),((W||{})[21589]||{}).mt&&(ve=W[21589].mt)}D.l+=De;var Xe=D.slice(D.l,D.l+he);switch(ue){case 8:Xe=Z(D,xe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ue)}var _t=!1;X&8&&(le=D.read_shift(4),le==134695760&&(le=D.read_shift(4),_t=!0),he=D.read_shift(4),xe=D.read_shift(4)),he!=G&&bl(_t,"Bad compressed size: "+G+" != "+he),xe!=L&&bl(_t,"Bad uncompressed size: "+L+" != "+xe),rn(z,Be,Xe,{unsafe:!0,mt:ve})}function Ts(D,G){var L=G||{},z=[],W=[],X=be(1),ue=L.compression?8:0,ve=0,le=0,he=0,xe=0,je=0,De=D.FullPaths[0],Be=De,Ae=D.FileIndex[0],Le=[],Xe=0;for(le=1;le<D.FullPaths.length;++le)if(Be=D.FullPaths[le].slice(De.length),Ae=D.FileIndex[le],!(!Ae.size||!Ae.content||Be=="Sh33tJ5")){var _t=xe,wt=be(Be.length);for(he=0;he<Be.length;++he)wt.write_shift(1,Be.charCodeAt(he)&127);wt=wt.slice(0,wt.l),Le[je]=iA.buf(Ae.content,0);var kt=Ae.content;ue==8&&(kt=j(kt)),X=be(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,ve),X.write_shift(2,ue),Ae.mt?l(X,Ae.mt):X.write_shift(4,0),X.write_shift(-4,Le[je]),X.write_shift(4,kt.length),X.write_shift(4,Ae.content.length),X.write_shift(2,wt.length),X.write_shift(2,0),xe+=X.length,z.push(X),xe+=wt.length,z.push(wt),xe+=kt.length,z.push(kt),X=be(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,ve),X.write_shift(2,ue),X.write_shift(4,0),X.write_shift(-4,Le[je]),X.write_shift(4,kt.length),X.write_shift(4,Ae.content.length),X.write_shift(2,wt.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,_t),Xe+=X.l,W.push(X),Xe+=wt.length,W.push(wt),++je}return X=be(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,je),X.write_shift(2,je),X.write_shift(4,Xe),X.write_shift(4,xe),X.write_shift(2,0),vn([vn(z),vn(W),X])}var di={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function jc(D,G){if(D.ctype)return D.ctype;var L=D.name||"",z=L.match(/\.([^\.]+)$/);return z&&di[z[1]]||G&&(z=(L=G).match(/[\.\\]([^\.\\])+$/),z&&di[z[1]])?di[z[1]]:"application/octet-stream"}function kc(D){for(var G=cc(D),L=[],z=0;z<G.length;z+=76)L.push(G.slice(z,z+76));return L.join(`\r
`)+`\r
`}function Tl(D){var G=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(he){var xe=he.charCodeAt(0).toString(16).toUpperCase();return"="+(xe.length==1?"0"+xe:xe)});G=G.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),G.charAt(0)==`
`&&(G="=0D"+G.slice(1)),G=G.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],z=G.split(`\r
`),W=0;W<z.length;++W){var X=z[W];if(X.length==0){L.push("");continue}for(var ue=0;ue<X.length;){var ve=76,le=X.slice(ue,ue+ve);le.charAt(ve-1)=="="?ve--:le.charAt(ve-2)=="="?ve-=2:le.charAt(ve-3)=="="&&(ve-=3),le=X.slice(ue,ue+ve),ue+=ve,ue<X.length&&(le+="="),L.push(le)}}return L.join(`\r
`)}function Sl(D){for(var G=[],L=0;L<D.length;++L){for(var z=D[L];L<=D.length&&z.charAt(z.length-1)=="=";)z=z.slice(0,z.length-1)+D[++L];G.push(z)}for(var W=0;W<G.length;++W)G[W]=G[W].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return Ra(G.join(`\r
`))}function Ac(D,G,L){for(var z="",W="",X="",ue,ve=0;ve<10;++ve){var le=G[ve];if(!le||le.match(/^\s*$/))break;var he=le.match(/^(.*?):\s*([^\s].*)$/);if(he)switch(he[1].toLowerCase()){case"content-location":z=he[2].trim();break;case"content-type":X=he[2].trim();break;case"content-transfer-encoding":W=he[2].trim();break}}switch(++ve,W.toLowerCase()){case"base64":ue=Ra(Or(G.slice(ve).join("")));break;case"quoted-printable":ue=Sl(G.slice(ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var xe=rn(D,z.slice(L.length),ue,{unsafe:!0});X&&(xe.ctype=X)}function lf(D,G){if(ye(D.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=G&&G.root||"",z=(ht&&Buffer.isBuffer(D)?D.toString("binary"):ye(D)).split(`\r
`),W=0,X="";for(W=0;W<z.length;++W)if(X=z[W],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),L||(L=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),X.slice(0,L.length)!=L););var ue=(z[1]||"").match(/boundary="(.*?)"/);if(!ue)throw new Error("MAD cannot find boundary");var ve="--"+(ue[1]||""),le=[],he=[],xe={FileIndex:le,FullPaths:he};O(xe);var je,De=0;for(W=0;W<z.length;++W){var Be=z[W];Be!==ve&&Be!==ve+"--"||(De++&&Ac(xe,z.slice(je,W),L),je=W)}return xe}function Ua(D,G){var L=G||{},z=L.boundary||"SheetJS";z="------="+z;for(var W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+z.slice(2)+'"',"","",""],X=D.FullPaths[0],ue=X,ve=D.FileIndex[0],le=1;le<D.FullPaths.length;++le)if(ue=D.FullPaths[le].slice(X.length),ve=D.FileIndex[le],!(!ve.size||!ve.content||ue=="Sh33tJ5")){ue=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Xe){return"_x"+Xe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Xe){return"_u"+Xe.charCodeAt(0).toString(16)+"_"});for(var he=ve.content,xe=ht&&Buffer.isBuffer(he)?he.toString("binary"):ye(he),je=0,De=Math.min(1024,xe.length),Be=0,Ae=0;Ae<=De;++Ae)(Be=xe.charCodeAt(Ae))>=32&&Be<128&&++je;var Le=je>=De*4/5;W.push(z),W.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+ue),W.push("Content-Transfer-Encoding: "+(Le?"quoted-printable":"base64")),W.push("Content-Type: "+jc(ve,ue)),W.push(""),W.push(Le?Tl(xe):kc(xe))}return W.push(z+`--\r
`),W.join(`\r
`)}function an(D){var G={};return O(G,D),G}function rn(D,G,L,z){var W=z&&z.unsafe;W||O(D);var X=!W&&Et.find(D,G);if(!X){var ue=D.FullPaths[0];G.slice(0,ue.length)==ue?ue=G:(ue.slice(-1)!="/"&&(ue+="/"),ue=(ue+G).replace("//","/")),X={name:r(G),type:2},D.FileIndex.push(X),D.FullPaths.push(ue),W||Et.utils.cfb_gc(D)}return X.content=L,X.size=L?L.length:0,z&&(z.CLSID&&(X.clsid=z.CLSID),z.mt&&(X.mt=z.mt),z.ct&&(X.ct=z.ct)),X}function Lr(D,G){O(D);var L=Et.find(D,G);if(L){for(var z=0;z<D.FileIndex.length;++z)if(D.FileIndex[z]==L)return D.FileIndex.splice(z,1),D.FullPaths.splice(z,1),!0}return!1}function Nl(D,G,L){O(D);var z=Et.find(D,G);if(z){for(var W=0;W<D.FileIndex.length;++W)if(D.FileIndex[W]==z)return D.FileIndex[W].name=r(L),D.FullPaths[W]=L,!0}return!1}function of(D){M(D,!0)}return t.find=I,t.read=K,t.parse=g,t.write=Y,t.writeFile=me,t.utils={cfb_new:an,cfb_add:rn,cfb_del:Lr,cfb_mov:Nl,cfb_gc:of,ReadShift:Go,CheckField:Qb,prep_blob:ra,bconcat:vn,use_zlib:H,_deflateRaw:Sc,_inflateRaw:Cc,consts:Q},t}();function lA(e){return typeof e=="string"?Zh(e):Array.isArray(e)?Mk(e):e}function vc(e,t,n){if(typeof Deno<"u"){if(n&&typeof t=="string")switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=Zh(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var a=n=="utf8"?hc(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var r=new Blob([lA(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(r,e);if(typeof saveAs<"u")return saveAs(r,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(r);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=l,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var h=File(e);return h.open("w"),h.encoding="binary",Array.isArray(t)&&(t=yc(t)),h.write(t),h.close(),t}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+e)}function Tn(e){for(var t=Object.keys(e),n=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&n.push(t[a]);return n}function Sv(e,t){for(var n=[],a=Tn(e),r=0;r!==a.length;++r)n[e[a[r]][t]]==null&&(n[e[a[r]][t]]=a[r]);return n}function Rx(e){for(var t=[],n=Tn(e),a=0;a!==n.length;++a)t[e[n[a]]]=n[a];return t}function tf(e){for(var t=[],n=Tn(e),a=0;a!==n.length;++a)t[e[n[a]]]=parseInt(n[a],10);return t}function oA(e){for(var t=[],n=Tn(e),a=0;a!==n.length;++a)t[e[n[a]]]==null&&(t[e[n[a]]]=[]),t[e[n[a]]].push(n[a]);return t}var Oh=new Date(1899,11,30,0,0,0);function Yn(e,t){var n=e.getTime(),a=Oh.getTime()+(e.getTimezoneOffset()-Oh.getTimezoneOffset())*6e4;return(n-a)/(24*60*60*1e3)}var Rb=new Date,cA=Oh.getTime()+(Rb.getTimezoneOffset()-Oh.getTimezoneOffset())*6e4,Nv=Rb.getTimezoneOffset();function Fb(e){var t=new Date;return t.setTime(e*24*60*60*1e3+cA),t.getTimezoneOffset()!==Nv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Nv)*6e4),t}var Ev=new Date("2017-02-19T19:06:09.000Z"),Lb=isNaN(Ev.getFullYear())?new Date("2/19/17"):Ev,uA=Lb.getFullYear()==2017;function Ln(e,t){var n=new Date(e);if(uA)return t>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):t<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(e instanceof Date)return e;if(Lb.getFullYear()==1917&&!isNaN(n.getFullYear())){var a=n.getFullYear();return e.indexOf(""+a)>-1||n.setFullYear(n.getFullYear()+100),n}var r=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function nf(e,t){if(ht&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var n={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(l){return n[l]||l})}catch{}for(var a=[],r=0;r!=e.length;++r)a.push(String.fromCharCode(e[r]));return a.join("")}function qn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=qn(e[n]));return t}function Pt(e,t){for(var n="";n.length<t;)n+=e;return n}function kr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(r,l){return n=-n,l}),!isNaN(t=Number(a)))?t/n:t}var hA=["january","february","march","april","may","june","july","august","september","october","november","december"];function uc(e){var t=new Date(e),n=new Date(NaN),a=t.getYear(),r=t.getMonth(),l=t.getDate();if(isNaN(l))return n;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&hA.indexOf(o)==-1)return n}else if(o.match(/[a-z]/))return n;return a<0||a>8099?n:(r>0||l>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?n:t}function $e(e,t,n){if(e.FullPaths){if(typeof n=="string"){var a;return ht?a=Fr(n):a=Rk(n),Et.utils.cfb_add(e,t,a)}Et.utils.cfb_add(e,t,n)}else e.file(t,n)}function Fx(){return Et.utils.cfb_new()}var Qt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,fA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Lx=Rx(fA),Bx=/[&<>'"]/g,dA=/[\u0000-\u0008\u000b-\u001f]/g;function vt(e){var t=e+"";return t.replace(Bx,function(n){return Lx[n]}).replace(dA,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Cv(e){return vt(e).replace(/ /g,"_x0020_")}var Bb=/[\u0000-\u001f]/g;function xA(e){var t=e+"";return t.replace(Bx,function(n){return Lx[n]}).replace(/\n/g,"<br/>").replace(Bb,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function gA(e){var t=e+"";return t.replace(Bx,function(n){return Lx[n]}).replace(Bb,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}function mA(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function pA(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Fd(e){for(var t="",n=0,a=0,r=0,l=0,o=0,h=0;n<e.length;){if(a=e.charCodeAt(n++),a<128){t+=String.fromCharCode(a);continue}if(r=e.charCodeAt(n++),a>191&&a<224){o=(a&31)<<6,o|=r&63,t+=String.fromCharCode(o);continue}if(l=e.charCodeAt(n++),a<240){t+=String.fromCharCode((a&15)<<12|(r&63)<<6|l&63);continue}o=e.charCodeAt(n++),h=((a&7)<<18|(r&63)<<12|(l&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(h>>>10&1023)),t+=String.fromCharCode(56320+(h&1023))}return t}function jv(e){var t=ni(2*e.length),n,a,r=1,l=0,o=0,h;for(a=0;a<e.length;a+=r)r=1,(h=e.charCodeAt(a))<128?n=h:h<224?(n=(h&31)*64+(e.charCodeAt(a+1)&63),r=2):h<240?(n=(h&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),r=3):(r=4,n=(h&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),n-=65536,o=55296+(n>>>10&1023),n=56320+(n&1023)),o!==0&&(t[l++]=o&255,t[l++]=o>>>8,o=0),t[l++]=n%256,t[l++]=n>>>8;return t.slice(0,l).toString("ucs2")}function kv(e){return Fr(e,"binary").toString("utf8")}var oh="foo bar bazâð£",Wo=ht&&(kv(oh)==Fd(oh)&&kv||jv(oh)==Fd(oh)&&jv)||Fd,hc=ht?function(e){return Fr(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,a=0,r=0;n<e.length;)switch(a=e.charCodeAt(n++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,r=e.charCodeAt(n++)-56320+(a<<10),t.push(String.fromCharCode(240+(r>>18&7))),t.push(String.fromCharCode(144+(r>>12&63))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},yA=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(n){for(var a=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),r=0;r<e.length;++r)a=a.replace(e[r][0],e[r][1]);return a}}(),Hb=/(^\s|\s$|\n)/;function bn(e,t){return"<"+e+(t.match(Hb)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function fc(e){return Tn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Oe(e,t,n){return"<"+e+(n!=null?fc(n):"")+(t!=null?(t.match(Hb)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function nx(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}function vA(e,t){switch(typeof e){case"string":var n=Oe("vt:lpwstr",vt(e));return n=n.replace(/&quot;/g,"_x0022_"),n;case"number":return Oe((e|0)==e?"vt:i4":"vt:r8",vt(String(e)));case"boolean":return Oe("vt:bool",e?"true":"false")}if(e instanceof Date)return Oe("vt:filetime",nx(e));throw new Error("Unable to serialize "+e)}var cn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ml=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],sa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function bA(e,t){for(var n=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),r=e[t+6]&15,l=5;l>=0;--l)r=r*256+e[t+l];return a==2047?r==0?n*(1/0):NaN:(a==0?a=-1022:(a-=1023,r+=Math.pow(2,52)),n*Math.pow(2,a-52)*r)}function _A(e,t,n){var a=(t<0||1/t==-1/0?1:0)<<7,r=0,l=0,o=a?-t:t;isFinite(o)?o==0?r=l=0:(r=Math.floor(Math.log(o)/Math.LN2),l=o*Math.pow(2,52-r),r<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?r=-1022:(l-=Math.pow(2,52),r+=1023)):(r=2047,l=isNaN(t)?26985:0);for(var h=0;h<=5;++h,l/=256)e[n+h]=l&255;e[n+6]=(r&15)<<4|l&15,e[n+7]=r>>4|a}var Av=function(e){for(var t=[],n=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var r=0,l=e[0][a].length;r<l;r+=n)t.push.apply(t,e[0][a].slice(r,r+n));return t},Dv=ht?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Fr(t)})):Av(e)}:Av,Ov=function(e,t,n){for(var a=[],r=t;r<n;r+=2)a.push(String.fromCharCode(Bo(e,r)));return a.join("").replace(Ko,"")},Hx=ht?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(Ko,""):Ov(e,t,n)}:Ov,Mv=function(e,t,n){for(var a=[],r=t;r<t+n;++r)a.push(("0"+e[r].toString(16)).slice(-2));return a.join("")},Pb=ht?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):Mv(e,t,n)}:Mv,Rv=function(e,t,n){for(var a=[],r=t;r<n;r++)a.push(String.fromCharCode(Zi(e,r)));return a.join("")},bc=ht?function(t,n,a){return Buffer.isBuffer(t)?t.toString("utf8",n,a):Rv(t,n,a)}:Rv,Ib=function(e,t){var n=ia(e,t);return n>0?bc(e,t+4,t+4+n-1):""},zb=Ib,Ub=function(e,t){var n=ia(e,t);return n>0?bc(e,t+4,t+4+n-1):""},Vb=Ub,Kb=function(e,t){var n=2*ia(e,t);return n>0?bc(e,t+4,t+4+n-1):""},Wb=Kb,Gb=function(t,n){var a=ia(t,n);return a>0?Hx(t,n+4,n+4+a):""},Xb=Gb,Yb=function(e,t){var n=ia(e,t);return n>0?bc(e,t+4,t+4+n):""},qb=Yb,$b=function(e,t){return bA(e,t)},Mh=$b,Px=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ht&&(zb=function(t,n){if(!Buffer.isBuffer(t))return Ib(t,n);var a=t.readUInt32LE(n);return a>0?t.toString("utf8",n+4,n+4+a-1):""},Vb=function(t,n){if(!Buffer.isBuffer(t))return Ub(t,n);var a=t.readUInt32LE(n);return a>0?t.toString("utf8",n+4,n+4+a-1):""},Wb=function(t,n){if(!Buffer.isBuffer(t))return Kb(t,n);var a=2*t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+a-1)},Xb=function(t,n){if(!Buffer.isBuffer(t))return Gb(t,n);var a=t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+a)},qb=function(t,n){if(!Buffer.isBuffer(t))return Yb(t,n);var a=t.readUInt32LE(n);return t.toString("utf8",n+4,n+4+a)},Mh=function(t,n){return Buffer.isBuffer(t)?t.readDoubleLE(n):$b(t,n)},Px=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Zi=function(e,t){return e[t]},Bo=function(e,t){return e[t+1]*256+e[t]},wA=function(e,t){var n=e[t+1]*256+e[t];return n<32768?n:(65535-n+1)*-1},ia=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Xs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},TA=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Go(e,t){var n="",a,r,l=[],o,h,f,x;switch(t){case"dbcs":if(x=this.l,ht&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)n+=String.fromCharCode(Bo(this,x)),x+=2;e*=2;break;case"utf8":n=bc(this,this.l,this.l+e);break;case"utf16le":e*=2,n=Hx(this,this.l,this.l+e);break;case"wstr":return Go.call(this,e,"dbcs");case"lpstr-ansi":n=zb(this,this.l),e=4+ia(this,this.l);break;case"lpstr-cp":n=Vb(this,this.l),e=4+ia(this,this.l);break;case"lpwstr":n=Wb(this,this.l),e=4+2*ia(this,this.l);break;case"lpp4":e=4+ia(this,this.l),n=Xb(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ia(this,this.l),n=qb(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,n="";(o=Zi(this,this.l+e++))!==0;)l.push(sh(o));n=l.join("");break;case"_wstr":for(e=0,n="";(o=Bo(this,this.l+e))!==0;)l.push(sh(o)),e+=2;e+=2,n=l.join("");break;case"dbcs-cont":for(n="",x=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(x)!==-1)return o=Zi(this,x),this.l=x+1,h=Go.call(this,e-f,o?"dbcs-cont":"sbcs-cont"),l.join("")+h;l.push(sh(Bo(this,x))),x+=2}n=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(n="",x=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(x)!==-1)return o=Zi(this,x),this.l=x+1,h=Go.call(this,e-f,o?"dbcs-cont":"sbcs-cont"),l.join("")+h;l.push(sh(Zi(this,x))),x+=1}n=l.join("");break;default:switch(e){case 1:return a=Zi(this,this.l),this.l++,a;case 2:return a=(t==="i"?wA:Bo)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?Xs:TA)(this,this.l),this.l+=4,a):(r=ia(this,this.l),this.l+=4,r);case 8:case-8:if(t==="f")return e==8?r=Mh(this,this.l):r=Mh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:n=Pb(this,this.l,e);break}}return this.l+=e,n}var SA=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},NA=function(e,t,n){e[n]=t&255,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},EA=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255};function CA(e,t,n){var a=0,r=0;if(n==="dbcs"){for(r=0;r!=t.length;++r)EA(this,t.charCodeAt(r),this.l+2*r);a=2*t.length}else if(n==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=t.length;++r)this[this.l+r]=t.charCodeAt(r)&255;a=t.length}else if(n==="hex"){for(;r<e;++r)this[this.l++]=parseInt(t.slice(2*r,2*r+2),16)||0;return this}else if(n==="utf16le"){var l=Math.min(this.l+e,this.length);for(r=0;r<Math.min(t.length,e);++r){var o=t.charCodeAt(r);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,SA(this,t,this.l);break;case 8:if(a=8,n==="f"){_A(this,t,this.l);break}case 16:break;case-4:a=4,NA(this,t,this.l);break}return this.l+=a,this}function Qb(e,t){var n=Pb(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function ra(e,t){e.l=t,e.read_shift=Go,e.chk=Qb,e.write_shift=CA}function tr(e,t){e.l+=t}function be(e){var t=ni(e);return ra(t,0),t}function Xn(){var e=[],t=ht?256:2048,n=function(x){var g=be(x);return ra(g,0),g},a=n(t),r=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},l=function(x){return a&&x<a.length-a.l?a:(r(),a=n(Math.max(x+1,t)))},o=function(){return r(),vn(e)},h=function(x){r(),a=x,a.l==null&&(a.l=a.length),l(t)};return{next:l,push:h,end:o,_bufs:e}}function Ce(e,t,n,a){var r=+t,l;if(!isNaN(r)){a||(a=bM[r].p||(n||[]).length||0),l=1+(r>=128?1:0)+1,a>=128&&++l,a>=16384&&++l,a>=2097152&&++l;var o=e.next(l);r<=127?o.write_shift(1,r):(o.write_shift(1,(r&127)+128),o.write_shift(1,r>>7));for(var h=0;h!=4;++h)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&Px(n)&&e.push(n)}}function Xo(e,t,n){var a=qn(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!n||n.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Fv(e,t,n){var a=qn(e);return a.s=Xo(a.s,t.s,n),a.e=Xo(a.e,t.s,n),a}function Yo(e,t){if(e.cRel&&e.c<0)for(e=qn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=qn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=bt(e);return!e.cRel&&e.cRel!=null&&(n=AA(n)),!e.rRel&&e.rRel!=null&&(n=jA(n)),n}function Ld(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+An(e.s.c)+":"+(e.e.cRel?"":"$")+An(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+wn(e.s.r)+":"+(e.e.rRel?"":"$")+wn(e.e.r):Yo(e.s,t.biff)+":"+Yo(e.e,t.biff)}function Ix(e){return parseInt(kA(e),10)-1}function wn(e){return""+(e+1)}function jA(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function kA(e){return e.replace(/\$(\d+)$/,"$1")}function zx(e){for(var t=DA(e),n=0,a=0;a!==t.length;++a)n=26*n+t.charCodeAt(a)-64;return n-1}function An(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function AA(e){return e.replace(/^([A-Z])/,"$$$1")}function DA(e){return e.replace(/^\$([A-Z])/,"$1")}function OA(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function un(e){for(var t=0,n=0,a=0;a<e.length;++a){var r=e.charCodeAt(a);r>=48&&r<=57?t=10*t+(r-48):r>=65&&r<=90&&(n=26*n+(r-64))}return{c:n-1,r:t-1}}function bt(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function oa(e){var t=e.indexOf(":");return t==-1?{s:un(e),e:un(e)}:{s:un(e.slice(0,t)),e:un(e.slice(t+1))}}function $t(e,t){return typeof t>"u"||typeof t=="number"?$t(e.s,e.e):(typeof e!="string"&&(e=bt(e)),typeof t!="string"&&(t=bt(t)),e==t?e:e+":"+t)}function Ot(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,a=0,r=0,l=e.length;for(n=0;a<l&&!((r=e.charCodeAt(a)-64)<1||r>26);++a)n=26*n+r;for(t.s.c=--n,n=0;a<l&&!((r=e.charCodeAt(a)-48)<0||r>9);++a)n=10*n+r;if(t.s.r=--n,a===l||r!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,n=0;a!=l&&!((r=e.charCodeAt(a)-64)<1||r>26);++a)n=26*n+r;for(t.e.c=--n,n=0;a!=l&&!((r=e.charCodeAt(a)-48)<0||r>9);++a)n=10*n+r;return t.e.r=--n,t}function Lv(e,t){var n=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ms(e.z,n?Yn(t):t)}catch{}try{return e.w=ms((e.XF||{}).numFmtId||(n?14:0),n?Yn(t):t)}catch{return""+t}}function Mr(e,t,n){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),e.t=="e"?_c[e.v]||e.v:t==null?Lv(e,e.v):Lv(e,t))}function li(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",a={};return a[n]=e,{SheetNames:[n],Sheets:a}}function Zb(e,t,n){var a=n||{},r=e?Array.isArray(e):a.dense,l=e||(r?[]:{}),o=0,h=0;if(l&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var f=typeof a.origin=="string"?un(a.origin):a.origin;o=f.r,h=f.c}l["!ref"]||(l["!ref"]="A1:A1")}var x={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var g=Ot(l["!ref"]);x.s.c=g.s.c,x.s.r=g.s.r,x.e.c=Math.max(x.e.c,g.e.c),x.e.r=Math.max(x.e.r,g.e.r),o==-1&&(x.e.r=o=g.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=t[p].length;++y)if(!(typeof t[p][y]>"u")){var _={v:t[p][y]},w=o+p,b=h+y;if(x.s.r>w&&(x.s.r=w),x.s.c>b&&(x.s.c=b),x.e.r<w&&(x.e.r=w),x.e.c<b&&(x.e.c=b),t[p][y]&&typeof t[p][y]=="object"&&!Array.isArray(t[p][y])&&!(t[p][y]instanceof Date))_=t[p][y];else if(Array.isArray(_.v)&&(_.f=t[p][y][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(a.nullError)_.t="e",_.v=0;else if(a.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=a.dateNF||Vt[14],a.cellDates?(_.t="d",_.w=ms(_.z,Yn(_.v))):(_.t="n",_.v=Yn(_.v),_.w=ms(_.z,_.v))):_.t="s";if(r)l[w]||(l[w]=[]),l[w][b]&&l[w][b].z&&(_.z=l[w][b].z),l[w][b]=_;else{var T=bt({c:b,r:w});l[T]&&l[T].z&&(_.z=l[T].z),l[T]=_}}}return x.s.c<1e7&&(l["!ref"]=$t(x)),l}function pl(e,t){return Zb(null,e,t)}function MA(e){return e.read_shift(4,"i")}function La(e,t){return t||(t=be(4)),t.write_shift(4,e),t}function Dn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function hn(e,t){var n=!1;return t==null&&(n=!0,t=be(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function RA(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function FA(e,t){return t||(t=be(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Ux(e,t){var n=e.l,a=e.read_shift(1),r=Dn(e),l=[],o={t:r,h:r};if((a&1)!==0){for(var h=e.read_shift(4),f=0;f!=h;++f)l.push(RA(e));o.r=l}else o.r=[{ich:0,ifnt:0}];return e.l=n+t,o}function LA(e,t){var n=!1;return t==null&&(n=!0,t=be(15+4*e.t.length)),t.write_shift(1,0),hn(e.t,t),n?t.slice(0,t.l):t}var BA=Ux;function HA(e,t){var n=!1;return t==null&&(n=!0,t=be(23+4*e.t.length)),t.write_shift(1,1),hn(e.t,t),t.write_shift(4,1),FA({},t),n?t.slice(0,t.l):t}function Na(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function oi(e,t){return t==null&&(t=be(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ci(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ui(e,t){return t==null&&(t=be(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var PA=Dn,Jb=hn;function Vx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Rh(e,t){var n=!1;return t==null&&(n=!0,t=be(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var IA=Dn,ax=Vx,Kx=Rh;function e_(e){var t=e.slice(e.l,e.l+4),n=t[0]&1,a=t[0]&2;e.l+=4;var r=a===0?Mh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Xs(t,0)>>2;return n?r/100:r}function t_(e,t){t==null&&(t=be(4));var n=0,a=0,r=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:r==(r|0)&&r>=-536870912&&r<1<<29&&(a=1,n=1),a)t.write_shift(-4,((n?r:e)<<2)+(n+2));else throw new Error("unsupported RkNumber "+e)}function n_(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function zA(e,t){return t||(t=be(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var hi=n_,yl=zA;function vl(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ai(e,t){return(t||be(8)).write_shift(8,e,"f")}function UA(e){var t={},n=e.read_shift(1),a=n>>>1,r=e.read_shift(1),l=e.read_shift(2,"i"),o=e.read_shift(1),h=e.read_shift(1),f=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=r;var x=QA[r];x&&(t.rgb=Xv(x));break;case 2:t.rgb=Xv([o,h,f]);break;case 3:t.theme=r;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function Fh(e,t){if(t||(t=be(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function VA(e){var t=e.read_shift(1);e.l++;var n={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return n}function KA(e,t){t||(t=be(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,n),t.write_shift(1,0),t}var a_=2,aa=3,ch=11,Lh=19,uh=64,WA=65,GA=71,XA=4108,YA=4126,yn=80,Bv={1:{n:"CodePage",t:a_},2:{n:"Category",t:yn},3:{n:"PresentationFormat",t:yn},4:{n:"ByteCount",t:aa},5:{n:"LineCount",t:aa},6:{n:"ParagraphCount",t:aa},7:{n:"SlideCount",t:aa},8:{n:"NoteCount",t:aa},9:{n:"HiddenCount",t:aa},10:{n:"MultimediaClipCount",t:aa},11:{n:"ScaleCrop",t:ch},12:{n:"HeadingPairs",t:XA},13:{n:"TitlesOfParts",t:YA},14:{n:"Manager",t:yn},15:{n:"Company",t:yn},16:{n:"LinksUpToDate",t:ch},17:{n:"CharacterCount",t:aa},19:{n:"SharedDoc",t:ch},22:{n:"HyperlinksChanged",t:ch},23:{n:"AppVersion",t:aa,p:"version"},24:{n:"DigSig",t:WA},26:{n:"ContentType",t:yn},27:{n:"ContentStatus",t:yn},28:{n:"Language",t:yn},29:{n:"Version",t:yn},255:{},2147483648:{n:"Locale",t:Lh},2147483651:{n:"Behavior",t:Lh},1919054434:{}},Hv={1:{n:"CodePage",t:a_},2:{n:"Title",t:yn},3:{n:"Subject",t:yn},4:{n:"Author",t:yn},5:{n:"Keywords",t:yn},6:{n:"Comments",t:yn},7:{n:"Template",t:yn},8:{n:"LastAuthor",t:yn},9:{n:"RevNumber",t:yn},10:{n:"EditTime",t:uh},11:{n:"LastPrinted",t:uh},12:{n:"CreatedDate",t:uh},13:{n:"ModifiedDate",t:uh},14:{n:"PageCount",t:aa},15:{n:"WordCount",t:aa},16:{n:"CharCount",t:aa},17:{n:"Thumbnail",t:GA},18:{n:"Application",t:yn},19:{n:"DocSecurity",t:aa},255:{},2147483648:{n:"Locale",t:Lh},2147483651:{n:"Behavior",t:Lh},1919054434:{}};function qA(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var $A=qA([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),QA=qn($A),_c={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ZA={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},hh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function r_(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function s_(e,t){var n=oA(ZA),a=[],r;a[a.length]=Qt,a[a.length]=Oe("Types",null,{xmlns:cn.CT,"xmlns:xsd":cn.xsd,"xmlns:xsi":cn.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Oe("Default",null,{Extension:f[0],ContentType:f[1]})}));var l=function(f){e[f]&&e[f].length>0&&(r=e[f][0],a[a.length]=Oe("Override",null,{PartName:(r[0]=="/"?"":"/")+r,ContentType:hh[f][t.bookType]||hh[f].xlsx}))},o=function(f){(e[f]||[]).forEach(function(x){a[a.length]=Oe("Override",null,{PartName:(x[0]=="/"?"":"/")+x,ContentType:hh[f][t.bookType]||hh[f].xlsx})})},h=function(f){(e[f]||[]).forEach(function(x){a[a.length]=Oe("Override",null,{PartName:(x[0]=="/"?"":"/")+x,ContentType:n[f][0]})})};return l("workbooks"),o("sheets"),o("charts"),h("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(h),h("vba"),h("comments"),h("threadedcomments"),h("drawings"),o("metadata"),h("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var ct={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function i_(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function il(e){var t=[Qt,Oe("Relationships",null,{xmlns:cn.RELS})];return Tn(e["!id"]).forEach(function(n){t[t.length]=Oe("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function yt(e,t,n,a,r,l){if(r||(r={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,r.Id="rId"+t,r.Type=a,r.Target=n,[ct.HLINK,ct.XPATH,ct.XMISS].indexOf(r.Type)>-1&&(r.TargetMode="External"),e["!id"][r.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][r.Id]=r,e[("/"+r.Target).replace("//","/")]=r,t}function JA(e){var t=[Qt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Pv(e,t,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function e6(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function t6(e){var t=[Qt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=e.length;++n)t.push(Pv(e[n][0],e[n][1])),t.push(e6("",e[n][0]));return t.push(Pv("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function l_(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+jh.version+"</meta:generator></office:meta></office:document-meta>"}var Js=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Bd(e,t,n,a,r){r[e]!=null||t==null||t===""||(r[e]=t,t=vt(t),a[a.length]=n?Oe(e,t,n):bn(e,t))}function o_(e,t){var n=t||{},a=[Qt,Oe("cp:coreProperties",null,{"xmlns:cp":cn.CORE_PROPS,"xmlns:dc":cn.dc,"xmlns:dcterms":cn.dcterms,"xmlns:dcmitype":cn.dcmitype,"xmlns:xsi":cn.xsi})],r={};if(!e&&!n.Props)return a.join("");e&&(e.CreatedDate!=null&&Bd("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:nx(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},a,r),e.ModifiedDate!=null&&Bd("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:nx(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},a,r));for(var l=0;l!=Js.length;++l){var o=Js[l],h=n.Props&&n.Props[o[1]]!=null?n.Props[o[1]]:e?e[o[1]]:null;h===!0?h="1":h===!1?h="0":typeof h=="number"&&(h=String(h)),h!=null&&Bd(o[0],h,null,a,r)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var ll=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],c_=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function u_(e){var t=[],n=Oe;return e||(e={}),e.Application="SheetJS",t[t.length]=Qt,t[t.length]=Oe("Properties",null,{xmlns:cn.EXT_PROPS,"xmlns:vt":cn.vt}),ll.forEach(function(a){if(e[a[1]]!==void 0){var r;switch(a[2]){case"string":r=vt(String(e[a[1]]));break;case"bool":r=e[a[1]]?"true":"false";break}r!==void 0&&(t[t.length]=n(a[0],r))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+vt(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function h_(e){var t=[Qt,Oe("Properties",null,{xmlns:cn.CUST_PROPS,"xmlns:vt":cn.vt})];if(!e)return t.join("");var n=1;return Tn(e).forEach(function(r){++n,t[t.length]=Oe("property",vA(e[r]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:vt(r)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Iv={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function n6(e,t){var n=[];return Tn(Iv).map(function(a){for(var r=0;r<Js.length;++r)if(Js[r][1]==a)return Js[r];for(r=0;r<ll.length;++r)if(ll[r][1]==a)return ll[r];throw a}).forEach(function(a){if(e[a[1]]!=null){var r=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":r=new Date(r).toISOString().replace(/\.\d*Z/,"Z");break}typeof r=="number"?r=String(r):r===!0||r===!1?r=r?"1":"0":r instanceof Date&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"")),n.push(bn(Iv[a[1]]||a[1],r))}}),Oe("DocumentProperties",n.join(""),{xmlns:sa.o})}function a6(e,t){var n=["Worksheets","SheetNames"],a="CustomDocumentProperties",r=[];return e&&Tn(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)){for(var o=0;o<Js.length;++o)if(l==Js[o][1])return;for(o=0;o<ll.length;++o)if(l==ll[o][1])return;for(o=0;o<n.length;++o)if(l==n[o])return;var h=e[l],f="string";typeof h=="number"?(f="float",h=String(h)):h===!0||h===!1?(f="boolean",h=h?"1":"0"):h=String(h),r.push(Oe(Cv(l),h,{"dt:dt":f}))}}),t&&Tn(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)&&!(e&&Object.prototype.hasOwnProperty.call(e,l))){var o=t[l],h="string";typeof o=="number"?(h="float",o=String(o)):o===!0||o===!1?(h="boolean",o=o?"1":"0"):o instanceof Date?(h="dateTime.tz",o=o.toISOString()):o=String(o),r.push(Oe(Cv(l),o,{"dt:dt":h}))}}),"<"+a+' xmlns="'+sa.o+'">'+r.join("")+"</"+a+">"}function r6(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,n=t.getTime()/1e3+11644473600,a=n%Math.pow(2,32),r=(n-a)/Math.pow(2,32);a*=1e7,r*=1e7;var l=a/Math.pow(2,32)|0;l>0&&(a=a%Math.pow(2,32),r+=l);var o=be(8);return o.write_shift(4,a),o.write_shift(4,r),o}function zv(e,t){var n=be(4),a=be(4);switch(n.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=be(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=r6(t);break;case 31:case 80:for(a=be(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return vn([n,a])}var f_=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function s6(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Uv(e,t,n){var a=be(8),r=[],l=[],o=8,h=0,f=be(8),x=be(8);if(f.write_shift(4,2),f.write_shift(4,1200),x.write_shift(4,1),l.push(f),r.push(x),o+=8+f.length,!t){x=be(8),x.write_shift(4,0),r.unshift(x);var g=[be(4)];for(g[0].write_shift(4,e.length),h=0;h<e.length;++h){var p=e[h][0];for(f=be(8+2*(p.length+1)+(p.length%2?0:2)),f.write_shift(4,h+2),f.write_shift(4,p.length+1),f.write_shift(0,p,"dbcs");f.l!=f.length;)f.write_shift(1,0);g.push(f)}f=vn(g),l.unshift(f),o+=8+f.length}for(h=0;h<e.length;++h)if(!(t&&!t[e[h][0]])&&!(f_.indexOf(e[h][0])>-1||c_.indexOf(e[h][0])>-1)&&e[h][1]!=null){var y=e[h][1],_=0;if(t){_=+t[e[h][0]];var w=n[_];if(w.p=="version"&&typeof y=="string"){var b=y.split(".");y=(+b[0]<<16)+(+b[1]||0)}f=zv(w.t,y)}else{var T=s6(y);T==-1&&(T=31,y=String(y)),f=zv(T,y)}l.push(f),x=be(8),x.write_shift(4,t?_:2+h),r.push(x),o+=8+f.length}var S=8*(l.length+1);for(h=0;h<l.length;++h)r[h].write_shift(4,S),S+=l[h].length;return a.write_shift(4,o),a.write_shift(4,l.length),vn([a].concat(r).concat(l))}function Vv(e,t,n,a,r,l){var o=be(r?68:48),h=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Et.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,r?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,r?68:48);var f=Uv(e,n,a);if(h.push(f),r){var x=Uv(r,null,null);o.write_shift(16,l,"hex"),o.write_shift(4,68+f.length),h.push(x)}return vn(h)}function i6(e,t){t||(t=be(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}function l6(e,t){return e.read_shift(t)===1}function Fn(e,t){return t||(t=be(2)),t.write_shift(2,+!!e),t}function d_(e){return e.read_shift(2,"u")}function wa(e,t){return t||(t=be(2)),t.write_shift(2,e),t}function x_(e,t,n){return n||(n=be(2)),n.write_shift(1,t=="e"?+e:+!!e),n.write_shift(1,t=="e"?1:0),n}function g_(e,t,n){var a=e.read_shift(n&&n.biff>=12?2:1),r="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var l=e.read_shift(1);l&&(r="dbcs-cont")}else n.biff==12&&(r="wstr");n.biff>=2&&n.biff<=5&&(r="cpstr");var o=a?e.read_shift(a,r):"";return o}function o6(e){var t=e.t||"",n=be(3);n.write_shift(2,t.length),n.write_shift(1,1);var a=be(2*t.length);a.write_shift(2*t.length,t,"utf16le");var r=[n,a];return vn(r)}function c6(e,t,n){var a;if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}var r=e.read_shift(1);return r===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function u6(e,t,n){var a=e.read_shift(n&&n.biff==2?1:2);return a===0?(e.l++,""):c6(e,a,n)}function h6(e,t,n){if(n.biff>5)return u6(e,t,n);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function m_(e,t,n){return n||(n=be(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function Kv(e,t){t||(t=be(6+e.length*2)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function f6(e){var t=be(512),n=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var r=a.indexOf("#"),l=r>-1?31:23;switch(a.charAt(0)){case"#":l=28;break;case".":l&=-3;break}t.write_shift(4,2),t.write_shift(4,l);var o=[8,6815827,6619237,4849780,83];for(n=0;n<o.length;++n)t.write_shift(4,o[n]);if(l==28)a=a.slice(1),Kv(a,t);else if(l&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<o.length;++n)t.write_shift(1,parseInt(o[n],16));var h=r>-1?a.slice(0,r):a;for(t.write_shift(4,2*(h.length+1)),n=0;n<h.length;++n)t.write_shift(2,h.charCodeAt(n));t.write_shift(2,0),l&8&&Kv(r>-1?a.slice(r+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<o.length;++n)t.write_shift(1,parseInt(o[n],16));for(var f=0;a.slice(f*3,f*3+3)=="../"||a.slice(f*3,f*3+3)=="..\\";)++f;for(t.write_shift(2,f),t.write_shift(4,a.length-3*f+1),n=0;n<a.length-3*f;++n)t.write_shift(1,a.charCodeAt(n+3*f)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function ri(e,t,n,a){return a||(a=be(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,n||0),a}function d6(e,t,n){var a=n.biff>8?4:2,r=e.read_shift(a),l=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[r,l,o]}function x6(e){var t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2);return{s:{c:a,r:t},e:{c:r,r:n}}}function p_(e,t){return t||(t=be(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Wx(e,t,n){var a=1536,r=16;switch(n.bookType){case"biff8":break;case"biff5":a=1280,r=8;break;case"biff4":a=4,r=6;break;case"biff3":a=3,r=6;break;case"biff2":a=2,r=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=be(r);return l.write_shift(2,a),l.write_shift(2,t),r>4&&l.write_shift(2,29282),r>6&&l.write_shift(2,1997),r>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function g6(e,t){var n=!t||t.biff==8,a=be(n?112:54);for(a.write_shift(t.biff==8?2:1,7),n&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(n?0:536870912));a.l<a.length;)a.write_shift(1,n?0:32);return a}function m6(e,t){var n=!t||t.biff>=8?2:1,a=be(8+n*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var r=a.slice(0,a.l);return r.l=a.l,r}function p6(e,t){var n=be(8);n.write_shift(4,e.Count),n.write_shift(4,e.Unique);for(var a=[],r=0;r<e.length;++r)a[r]=o6(e[r]);var l=vn([n].concat(a));return l.parts=[n.length].concat(a.map(function(o){return o.length})),l}function y6(){var e=be(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function v6(e){var t=be(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function b6(e,t){var n=e.name||"Arial",a=t&&t.biff==5,r=a?15+n.length:16+2*n.length,l=be(r);return l.write_shift(2,e.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,n.length),a||l.write_shift(1,1),l.write_shift((a?1:2)*n.length,n,a?"sbcs":"utf16le"),l}function _6(e,t,n,a){var r=be(10);return ri(e,t,a,r),r.write_shift(4,n),r}function w6(e,t,n,a,r){var l=!r||r.biff==8,o=be(8+ +l+(1+l)*n.length);return ri(e,t,a,o),o.write_shift(2,n.length),l&&o.write_shift(1,1),o.write_shift((1+l)*n.length,n,l?"utf16le":"sbcs"),o}function T6(e,t,n,a){var r=n&&n.biff==5;a||(a=be(r?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(r?1:2,t.length),r||a.write_shift(1,1),a.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le");var l=a.length>a.l?a.slice(0,a.l):a;return l.l==null&&(l.l=l.length),l}function S6(e,t){var n=t.biff==8||!t.biff?4:2,a=be(2*n+6);return a.write_shift(n,e.s.r),a.write_shift(n,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function Wv(e,t,n,a){var r=n&&n.biff==5;a||(a=be(r?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var l=0;return e.numFmtId>0&&r&&(l|=1024),a.write_shift(4,l),a.write_shift(4,0),r||a.write_shift(4,0),a.write_shift(2,0),a}function N6(e){var t=be(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function E6(e,t,n,a,r,l){var o=be(8);return ri(e,t,a,o),x_(n,l,o),o}function C6(e,t,n,a){var r=be(14);return ri(e,t,a,r),ai(n,r),r}function j6(e,t,n){if(n.biff<8)return k6(e,t,n);for(var a=[],r=e.l+t,l=e.read_shift(n.biff>8?4:2);l--!==0;)a.push(d6(e,n.biff>8?12:6,n));if(e.l!=r)throw new Error("Bad ExternSheet: "+e.l+" != "+r);return a}function k6(e,t,n){e[e.l+1]==3&&e[e.l]++;var a=g_(e,t,n);return a.charCodeAt(0)==3?a.slice(1):a}function A6(e){var t=be(2+e.length*8);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)p_(e[n],t);return t}function D6(e){var t=be(24),n=un(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<16;++r)t.write_shift(1,parseInt(a[r],16));return vn([t,f6(e[1])])}function O6(e){var t=e[1].Tooltip,n=be(10+2*(t.length+1));n.write_shift(2,2048);var a=un(e[0]);n.write_shift(2,a.r),n.write_shift(2,a.r),n.write_shift(2,a.c),n.write_shift(2,a.c);for(var r=0;r<t.length;++r)n.write_shift(2,t.charCodeAt(r));return n.write_shift(2,0),n}function M6(e){return e||(e=be(4)),e.write_shift(2,1),e.write_shift(2,1),e}function R6(e,t,n){if(!n.cellStyles)return tr(e,t);var a=n&&n.biff>=12?4:2,r=e.read_shift(a),l=e.read_shift(a),o=e.read_shift(a),h=e.read_shift(a),f=e.read_shift(2);a==2&&(e.l+=2);var x={s:r,e:l,w:o,ixfe:h,flags:f};return(n.biff>=5||!n.biff)&&(x.level=f>>8&7),x}function F6(e,t){var n=be(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,e.width*256),n.write_shift(2,0);var a=0;return e.hidden&&(a|=1),n.write_shift(1,a),a=e.level||0,n.write_shift(1,a),n.write_shift(2,0),n}function L6(e){for(var t=be(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}function B6(e,t,n){var a=be(15);return Tc(a,e,t),a.write_shift(8,n,"f"),a}function H6(e,t,n){var a=be(9);return Tc(a,e,t),a.write_shift(2,n),a}var P6=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Rx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(h,f){var x=[],g=ni(1);switch(f.type){case"base64":g=Ra(Or(h));break;case"binary":g=Ra(h);break;case"buffer":case"array":g=h;break}ra(g,0);var p=g.read_shift(1),y=!!(p&136),_=!1,w=!1;switch(p){case 2:break;case 3:break;case 48:_=!0,y=!0;break;case 49:_=!0,y=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var b=0,T=521;p==2&&(b=g.read_shift(2)),g.l+=3,p!=2&&(b=g.read_shift(4)),b>1048576&&(b=1e6),p!=2&&(T=g.read_shift(2));var S=g.read_shift(2),E=f.codepage||1252;p!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(E=e[g[g.l]]),g.l+=1,g.l+=2),w&&(g.l+=36);for(var C=[],A={},F=Math.min(g.length,p==2?521:T-10-(_?264:0)),K=w?32:11;g.l<F&&g[g.l]!=13;)switch(A={},A.name=gv.utils.decode(E,g.slice(g.l,g.l+K)).replace(/[\u0000\r\n].*$/g,""),g.l+=K,A.type=String.fromCharCode(g.read_shift(1)),p!=2&&!w&&(A.offset=g.read_shift(4)),A.len=g.read_shift(1),p==2&&(A.offset=g.read_shift(2)),A.dec=g.read_shift(1),A.name.length&&C.push(A),p!=2&&(g.l+=w?13:14),A.type){case"B":(!_||A.len!=8)&&f.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+A.type)}if(g[g.l]!==13&&(g.l=T-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=T;var O=0,P=0;for(x[0]=[],P=0;P!=C.length;++P)x[0][P]=C[P].name;for(;b-- >0;){if(g[g.l]===42){g.l+=S;continue}for(++g.l,x[++O]=[],P=0,P=0;P!=C.length;++P){var M=g.slice(g.l,g.l+C[P].len);g.l+=C[P].len,ra(M,0);var B=gv.utils.decode(E,M);switch(C[P].type){case"C":B.trim().length&&(x[O][P]=B.replace(/\s+$/,""));break;case"D":B.length===8?x[O][P]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):x[O][P]=B;break;case"F":x[O][P]=parseFloat(B.trim());break;case"+":case"I":x[O][P]=w?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":x[O][P]=!0;break;case"N":case"F":x[O][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));x[O][P]="##MEMO##"+(w?parseInt(B.trim(),10):M.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(x[O][P]=+B||0);break;case"@":x[O][P]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":x[O][P]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":x[O][P]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":x[O][P]=-M.read_shift(-8,"f");break;case"B":if(_&&C[P].len==8){x[O][P]=M.read_shift(8,"f");break}case"G":case"P":M.l+=C[P].len;break;case"0":if(C[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[P].type)}}}if(p!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return f&&f.sheetRows&&(x=x.slice(0,f.sheetRows)),f.DBF=C,x}function a(h,f){var x=f||{};x.dateNF||(x.dateNF="yyyymmdd");var g=pl(n(h,x),x);return g["!cols"]=x.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete x.DBF,g}function r(h,f){try{return li(a(h,f),f)}catch(x){if(f&&f.WTF)throw x}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function o(h,f){var x=f||{};if(+x.codepage>=0&&oc(+x.codepage),x.type=="string")throw new Error("Cannot write DBF to JS string");var g=Xn(),p=zh(h,{header:1,raw:!0,cellDates:!0}),y=p[0],_=p.slice(1),w=h["!cols"]||[],b=0,T=0,S=0,E=1;for(b=0;b<y.length;++b){if(((w[b]||{}).DBF||{}).name){y[b]=w[b].DBF.name,++S;continue}if(y[b]!=null){if(++S,typeof y[b]=="number"&&(y[b]=y[b].toString(10)),typeof y[b]!="string")throw new Error("DBF Invalid column name "+y[b]+" |"+typeof y[b]+"|");if(y.indexOf(y[b])!==b){for(T=0;T<1024;++T)if(y.indexOf(y[b]+"_"+T)==-1){y[b]+="_"+T;break}}}}var C=Ot(h["!ref"]),A=[],F=[],K=[];for(b=0;b<=C.e.c-C.s.c;++b){var O="",P="",M=0,B=[];for(T=0;T<_.length;++T)_[T][b]!=null&&B.push(_[T][b]);if(B.length==0||y[b]==null){A[b]="?";continue}for(T=0;T<B.length;++T){switch(typeof B[T]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=B[T]instanceof Date?"D":"C";break;default:P="C"}M=Math.max(M,String(B[T]).length),O=O&&O!=P?"C":P}M>250&&(M=250),P=((w[b]||{}).DBF||{}).type,P=="C"&&w[b].DBF.len>M&&(M=w[b].DBF.len),O=="B"&&P=="N"&&(O="N",K[b]=w[b].DBF.dec,M=w[b].DBF.len),F[b]=O=="C"||P=="N"?M:l[O]||0,E+=F[b],A[b]=O}var I=g.next(32);for(I.write_shift(4,318902576),I.write_shift(4,_.length),I.write_shift(2,296+32*S),I.write_shift(2,E),b=0;b<4;++b)I.write_shift(4,0);for(I.write_shift(4,0|(+t[vb]||3)<<8),b=0,T=0;b<y.length;++b)if(y[b]!=null){var te=g.next(32),q=(y[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);te.write_shift(1,q,"sbcs"),te.write_shift(1,A[b]=="?"?"C":A[b],"sbcs"),te.write_shift(4,T),te.write_shift(1,F[b]||l[A[b]]||0),te.write_shift(1,K[b]||0),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(1,0),te.write_shift(4,0),te.write_shift(4,0),T+=F[b]||l[A[b]]||0}var ae=g.next(264);for(ae.write_shift(4,13),b=0;b<65;++b)ae.write_shift(4,0);for(b=0;b<_.length;++b){var re=g.next(E);for(re.write_shift(1,0),T=0;T<y.length;++T)if(y[T]!=null)switch(A[T]){case"L":re.write_shift(1,_[b][T]==null?63:_[b][T]?84:70);break;case"B":re.write_shift(8,_[b][T]||0,"f");break;case"N":var ee="0";for(typeof _[b][T]=="number"&&(ee=_[b][T].toFixed(K[T]||0)),S=0;S<F[T]-ee.length;++S)re.write_shift(1,32);re.write_shift(1,ee,"sbcs");break;case"D":_[b][T]?(re.write_shift(4,("0000"+_[b][T].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(_[b][T].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+_[b][T].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var Q=String(_[b][T]!=null?_[b][T]:"").slice(0,F[T]);for(re.write_shift(1,Q,"sbcs"),S=0;S<F[T]-Q.length;++S)re.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:r,to_sheet:a,from_sheet:o}}(),I6=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Tn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(y,_){var w=e[_];return typeof w=="number"?xv(w):w},a=function(y,_,w){var b=_.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return b==59?y:xv(b)};e["|"]=254;function r(y,_){switch(_.type){case"base64":return l(Or(y),_);case"binary":return l(y,_);case"buffer":return l(ht&&Buffer.isBuffer(y)?y.toString("binary"):yc(y),_);case"array":return l(nf(y),_)}throw new Error("Unrecognized type "+_.type)}function l(y,_){var w=y.split(/[\n\r]+/),b=-1,T=-1,S=0,E=0,C=[],A=[],F=null,K={},O=[],P=[],M=[],B=0,I;for(+_.codepage>=0&&oc(+_.codepage);S!==w.length;++S){B=0;var te=w[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,n),q=te.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),ae=q[0],re;if(te.length>0)switch(ae){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&A.push(te.slice(3).replace(/;;/g,";"));break;case"C":var ee=!1,Q=!1,me=!1,ye=!1,Y=-1,de=-1;for(E=1;E<q.length;++E)switch(q[E].charAt(0)){case"A":break;case"X":T=parseInt(q[E].slice(1))-1,Q=!0;break;case"Y":for(b=parseInt(q[E].slice(1))-1,Q||(T=0),I=C.length;I<=b;++I)C[I]=[];break;case"K":re=q[E].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(kr(re))?isNaN(uc(re).getDate())||(re=Ln(re)):(re=kr(re),F!==null&&Db(F)&&(re=Fb(re))),ee=!0;break;case"E":ye=!0;var H=H5(q[E].slice(1),{r:b,c:T});C[b][T]=[C[b][T],H];break;case"S":me=!0,C[b][T]=[C[b][T],"S5S"];break;case"G":break;case"R":Y=parseInt(q[E].slice(1))-1;break;case"C":de=parseInt(q[E].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+te)}if(ee&&(C[b][T]&&C[b][T].length==2?C[b][T][0]=re:C[b][T]=re,F=null),me){if(ye)throw new Error("SYLK shared formula cannot have own formula");var Z=Y>-1&&C[Y][de];if(!Z||!Z[1])throw new Error("SYLK shared formula cannot find base");C[b][T][1]=P5(Z[1],{r:b-Y,c:T-de})}break;case"F":var j=0;for(E=1;E<q.length;++E)switch(q[E].charAt(0)){case"X":T=parseInt(q[E].slice(1))-1,++j;break;case"Y":for(b=parseInt(q[E].slice(1))-1,I=C.length;I<=b;++I)C[I]=[];break;case"M":B=parseInt(q[E].slice(1))/20;break;case"F":break;case"G":break;case"P":F=A[parseInt(q[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=q[E].slice(1).split(" "),I=parseInt(M[0],10);I<=parseInt(M[1],10);++I)B=parseInt(M[2],10),P[I-1]=B===0?{hidden:!0}:{wch:B},Gx(P[I-1]);break;case"C":T=parseInt(q[E].slice(1))-1,P[T]||(P[T]={});break;case"R":b=parseInt(q[E].slice(1))-1,O[b]||(O[b]={}),B>0?(O[b].hpt=B,O[b].hpx=w_(B)):B===0&&(O[b].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+te)}j<1&&(F=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+te)}}return O.length>0&&(K["!rows"]=O),P.length>0&&(K["!cols"]=P),_&&_.sheetRows&&(C=C.slice(0,_.sheetRows)),[C,K]}function o(y,_){var w=r(y,_),b=w[0],T=w[1],S=pl(b,_);return Tn(T).forEach(function(E){S[E]=T[E]}),S}function h(y,_){return li(o(y,_),_)}function f(y,_,w,b){var T="C;Y"+(w+1)+";X"+(b+1)+";K";switch(y.t){case"n":T+=y.v||0,y.f&&!y.F&&(T+=";E"+Yx(y.f,{r:w,c:b}));break;case"b":T+=y.v?"TRUE":"FALSE";break;case"e":T+=y.w||y.v;break;case"d":T+='"'+(y.w||y.v)+'"';break;case"s":T+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function x(y,_){_.forEach(function(w,b){var T="F;W"+(b+1)+" "+(b+1)+" ";w.hidden?T+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=Bh(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=Hh(w.wpx)),typeof w.wch=="number"&&(T+=Math.round(w.wch))),T.charAt(T.length-1)!=" "&&y.push(T)})}function g(y,_){_.forEach(function(w,b){var T="F;";w.hidden?T+="M0;":w.hpt?T+="M"+20*w.hpt+";":w.hpx&&(T+="M"+20*Ph(w.hpx)+";"),T.length>2&&y.push(T+"R"+(b+1))})}function p(y,_){var w=["ID;PWXL;N;E"],b=[],T=Ot(y["!ref"]),S,E=Array.isArray(y),C=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),y["!cols"]&&x(w,y["!cols"]),y["!rows"]&&g(w,y["!rows"]),w.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" "));for(var A=T.s.r;A<=T.e.r;++A)for(var F=T.s.c;F<=T.e.c;++F){var K=bt({r:A,c:F});S=E?(y[A]||[])[F]:y[K],!(!S||S.v==null&&(!S.f||S.F))&&b.push(f(S,y,A,F))}return w.join(C)+C+b.join(C)+C+"E"+C}return{to_workbook:h,to_sheet:o,from_sheet:p}}(),z6=function(){function e(l,o){switch(o.type){case"base64":return t(Or(l),o);case"binary":return t(l,o);case"buffer":return t(ht&&Buffer.isBuffer(l)?l.toString("binary"):yc(l),o);case"array":return t(nf(l),o)}throw new Error("Unrecognized type "+o.type)}function t(l,o){for(var h=l.split(`
`),f=-1,x=-1,g=0,p=[];g!==h.length;++g){if(h[g].trim()==="BOT"){p[++f]=[],x=0;continue}if(!(f<0)){var y=h[g].trim().split(","),_=y[0],w=y[1];++g;for(var b=h[g]||"";(b.match(/["]/g)||[]).length&1&&g<h.length-1;)b+=`
`+h[++g];switch(b=b.trim(),+_){case-1:if(b==="BOT"){p[++f]=[],x=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?p[f][x]=!0:b==="FALSE"?p[f][x]=!1:isNaN(kr(w))?isNaN(uc(w).getDate())?p[f][x]=w:p[f][x]=Ln(w):p[f][x]=kr(w),++x;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),p[f][x++]=b!==""?b:null;break}if(b==="EOD")break}}return o&&o.sheetRows&&(p=p.slice(0,o.sheetRows)),p}function n(l,o){return pl(e(l,o),o)}function a(l,o){return li(n(l,o),o)}var r=function(){var l=function(f,x,g,p,y){f.push(x),f.push(g+","+p),f.push('"'+y.replace(/"/g,'""')+'"')},o=function(f,x,g,p){f.push(x+","+g),f.push(x==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(f){var x=[],g=Ot(f["!ref"]),p,y=Array.isArray(f);l(x,"TABLE",0,1,"sheetjs"),l(x,"VECTORS",0,g.e.r-g.s.r+1,""),l(x,"TUPLES",0,g.e.c-g.s.c+1,""),l(x,"DATA",0,0,"");for(var _=g.s.r;_<=g.e.r;++_){o(x,-1,0,"BOT");for(var w=g.s.c;w<=g.e.c;++w){var b=bt({r:_,c:w});if(p=y?(f[_]||[])[w]:f[b],!p){o(x,1,0,"");continue}switch(p.t){case"n":var T=p.w;!T&&p.v!=null&&(T=p.v),T==null?p.f&&!p.F?o(x,1,0,"="+p.f):o(x,1,0,""):o(x,0,T,"V");break;case"b":o(x,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":o(x,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=ms(p.z||Vt[14],Yn(Ln(p.v)))),o(x,0,p.w,"V");break;default:o(x,1,0,"")}}}o(x,-1,0,"EOD");var S=`\r
`,E=x.join(S);return E}}();return{to_workbook:a,to_sheet:n,from_sheet:r}}(),y_=function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(p,y){for(var _=p.split(`
`),w=-1,b=-1,T=0,S=[];T!==_.length;++T){var E=_[T].trim().split(":");if(E[0]==="cell"){var C=un(E[1]);if(S.length<=C.r)for(w=S.length;w<=C.r;++w)S[w]||(S[w]=[]);switch(w=C.r,b=C.c,E[2]){case"t":S[w][b]=e(E[3]);break;case"v":S[w][b]=+E[3];break;case"vtf":var A=E[E.length-1];case"vtc":switch(E[3]){case"nl":S[w][b]=!!+E[4];break;default:S[w][b]=+E[4];break}E[2]=="vtf"&&(S[w][b]=[S[w][b],A])}}}return y&&y.sheetRows&&(S=S.slice(0,y.sheetRows)),S}function a(p,y){return pl(n(p,y),y)}function r(p,y){return li(a(p,y),y)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,h=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function x(p){if(!p||!p["!ref"])return"";for(var y=[],_=[],w,b="",T=oa(p["!ref"]),S=Array.isArray(p),E=T.s.r;E<=T.e.r;++E)for(var C=T.s.c;C<=T.e.c;++C)if(b=bt({r:E,c:C}),w=S?(p[E]||[])[C]:p[b],!(!w||w.v==null||w.t==="z")){switch(_=["cell",b,"t"],w.t){case"s":case"str":_.push(t(w.v));break;case"n":w.f?(_[2]="vtf",_[3]="n",_[4]=w.v,_[5]=t(w.f)):(_[2]="v",_[3]=w.v);break;case"b":_[2]="vt"+(w.f?"f":"c"),_[3]="nl",_[4]=w.v?"1":"0",_[5]=t(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var A=Yn(Ln(w.v));_[2]="vtc",_[3]="nd",_[4]=""+A,_[5]=w.w||ms(w.z||Vt[14],A);break;case"e":continue}y.push(_.join(":"))}return y.push("sheet:c:"+(T.e.c-T.s.c+1)+":r:"+(T.e.r-T.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function g(p){return[l,o,h,o,x(p),f].join(`
`)}return{to_workbook:r,to_sheet:a,from_sheet:g}}(),U6=function(){function e(g,p,y,_,w){w.raw?p[y][_]=g:g===""||(g==="TRUE"?p[y][_]=!0:g==="FALSE"?p[y][_]=!1:isNaN(kr(g))?isNaN(uc(g).getDate())?p[y][_]=g:p[y][_]=Ln(g):p[y][_]=kr(g))}function t(g,p){var y=p||{},_=[];if(!g||g.length===0)return _;for(var w=g.split(/[\r\n]/),b=w.length-1;b>=0&&w[b].length===0;)--b;for(var T=10,S=0,E=0;E<=b;++E)S=w[E].indexOf(" "),S==-1?S=w[E].length:S++,T=Math.max(T,S);for(E=0;E<=b;++E){_[E]=[];var C=0;for(e(w[E].slice(0,T).trim(),_,E,C,y),C=1;C<=(w[E].length-T)/10+1;++C)e(w[E].slice(T+(C-1)*10,T+C*10).trim(),_,E,C,y)}return y.sheetRows&&(_=_.slice(0,y.sheetRows)),_}var n={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function r(g){for(var p={},y=!1,_=0,w=0;_<g.length;++_)(w=g.charCodeAt(_))==34?y=!y:!y&&w in n&&(p[w]=(p[w]||0)+1);w=[];for(_ in p)Object.prototype.hasOwnProperty.call(p,_)&&w.push([p[_],_]);if(!w.length){p=a;for(_ in p)Object.prototype.hasOwnProperty.call(p,_)&&w.push([p[_],_])}return w.sort(function(b,T){return b[0]-T[0]||a[b[1]]-a[T[1]]}),n[w.pop()[1]]||44}function l(g,p){var y=p||{},_="",w=y.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(_=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(_=g.charAt(4),g=g.slice(6)):_=r(g.slice(0,1024)):y&&y.FS?_=y.FS:_=r(g.slice(0,1024));var T=0,S=0,E=0,C=0,A=0,F=_.charCodeAt(0),K=!1,O=0,P=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var M=y.dateNF!=null?rA(y.dateNF):null;function B(){var I=g.slice(C,A),te={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)te.t="z";else if(y.raw)te.t="s",te.v=I;else if(I.trim().length===0)te.t="s",te.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(te.t="s",te.v=I.slice(2,-1).replace(/""/g,'"')):I5(I)?(te.t="n",te.f=I.slice(1)):(te.t="s",te.v=I);else if(I=="TRUE")te.t="b",te.v=!0;else if(I=="FALSE")te.t="b",te.v=!1;else if(!isNaN(E=kr(I)))te.t="n",y.cellText!==!1&&(te.w=I),te.v=E;else if(!isNaN(uc(I).getDate())||M&&I.match(M)){te.z=y.dateNF||Vt[14];var q=0;M&&I.match(M)&&(I=sA(I,y.dateNF,I.match(M)||[]),q=1),y.cellDates?(te.t="d",te.v=Ln(I,q)):(te.t="n",te.v=Yn(Ln(I,q))),y.cellText!==!1&&(te.w=ms(te.z,te.v instanceof Date?Yn(te.v):te.v)),y.cellNF||delete te.z}else te.t="s",te.v=I;if(te.t=="z"||(y.dense?(w[T]||(w[T]=[]),w[T][S]=te):w[bt({c:S,r:T})]=te),C=A+1,P=g.charCodeAt(C),b.e.c<S&&(b.e.c=S),b.e.r<T&&(b.e.r=T),O==F)++S;else if(S=0,++T,y.sheetRows&&y.sheetRows<=T)return!0}e:for(;A<g.length;++A)switch(O=g.charCodeAt(A)){case 34:P===34&&(K=!K);break;case F:case 10:case 13:if(!K&&B())break e;break}return A-C>0&&B(),w["!ref"]=$t(b),w}function o(g,p){return!(p&&p.PRN)||p.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?l(g,p):pl(t(g,p),p)}function h(g,p){var y="",_=p.type=="string"?[0,0,0,0]:eR(g,p);switch(p.type){case"base64":y=Or(g);break;case"binary":y=g;break;case"buffer":p.codepage==65001?y=g.toString("utf8"):(p.codepage,y=ht&&Buffer.isBuffer(g)?g.toString("binary"):yc(g));break;case"array":y=nf(g);break;case"string":y=g;break;default:throw new Error("Unrecognized type "+p.type)}return _[0]==239&&_[1]==187&&_[2]==191?y=Wo(y.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?y=Wo(y):p.type=="binary",y.slice(0,19)=="socialcalc:version:"?y_.to_sheet(p.type=="string"?y:Wo(y),p):o(y,p)}function f(g,p){return li(h(g,p),p)}function x(g){for(var p=[],y=Ot(g["!ref"]),_,w=Array.isArray(g),b=y.s.r;b<=y.e.r;++b){for(var T=[],S=y.s.c;S<=y.e.c;++S){var E=bt({r:b,c:S});if(_=w?(g[b]||[])[S]:g[E],!_||_.v==null){T.push("          ");continue}for(var C=(_.w||(Mr(_),_.w)||"").slice(0,10);C.length<10;)C+=" ";T.push(C+(S===0?" ":""))}p.push(T.join(""))}return p.join(`
`)}return{to_workbook:f,to_sheet:h,from_sheet:x}}(),Gv=function(){function e(H,Z,j){if(H){ra(H,H.l||0);for(var V=j.Enum||Y;H.l<H.length;){var U=H.read_shift(2),Te=V[U]||V[65535],ie=H.read_shift(2),_e=H.l+ie,Ne=Te.f&&Te.f(H,ie,j);if(H.l=_e,Z(Ne,Te,U))return}}}function t(H,Z){switch(Z.type){case"base64":return n(Ra(Or(H)),Z);case"binary":return n(Ra(H),Z);case"buffer":case"array":return n(H,Z)}throw"Unsupported type "+Z.type}function n(H,Z){if(!H)return H;var j=Z||{},V=j.dense?[]:{},U="Sheet1",Te="",ie=0,_e={},Ne=[],Ie=[],Ue={s:{r:0,c:0},e:{r:0,c:0}},at=j.sheetRows||0;if(H[2]==0&&(H[3]==8||H[3]==9)&&H.length>=16&&H[14]==5&&H[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(H[2]==2)j.Enum=Y,e(H,function(Fe,ft,pe){switch(pe){case 0:j.vers=Fe,Fe>=4096&&(j.qpro=!0);break;case 6:Ue=Fe;break;case 204:Fe&&(Te=Fe);break;case 222:Te=Fe;break;case 15:case 51:j.qpro||(Fe[1].v=Fe[1].v.slice(1));case 13:case 14:case 16:pe==14&&(Fe[2]&112)==112&&(Fe[2]&15)>1&&(Fe[2]&15)<15&&(Fe[1].z=j.dateNF||Vt[14],j.cellDates&&(Fe[1].t="d",Fe[1].v=Fb(Fe[1].v))),j.qpro&&Fe[3]>ie&&(V["!ref"]=$t(Ue),_e[U]=V,Ne.push(U),V=j.dense?[]:{},Ue={s:{r:0,c:0},e:{r:0,c:0}},ie=Fe[3],U=Te||"Sheet"+(ie+1),Te="");var ke=j.dense?(V[Fe[0].r]||[])[Fe[0].c]:V[bt(Fe[0])];if(ke){ke.t=Fe[1].t,ke.v=Fe[1].v,Fe[1].z!=null&&(ke.z=Fe[1].z),Fe[1].f!=null&&(ke.f=Fe[1].f);break}j.dense?(V[Fe[0].r]||(V[Fe[0].r]=[]),V[Fe[0].r][Fe[0].c]=Fe[1]):V[bt(Fe[0])]=Fe[1];break}},j);else if(H[2]==26||H[2]==14)j.Enum=de,H[2]==14&&(j.qpro=!0,H.l=0),e(H,function(Fe,ft,pe){switch(pe){case 204:U=Fe;break;case 22:Fe[1].v=Fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Fe[3]>ie&&(V["!ref"]=$t(Ue),_e[U]=V,Ne.push(U),V=j.dense?[]:{},Ue={s:{r:0,c:0},e:{r:0,c:0}},ie=Fe[3],U="Sheet"+(ie+1)),at>0&&Fe[0].r>=at)break;j.dense?(V[Fe[0].r]||(V[Fe[0].r]=[]),V[Fe[0].r][Fe[0].c]=Fe[1]):V[bt(Fe[0])]=Fe[1],Ue.e.c<Fe[0].c&&(Ue.e.c=Fe[0].c),Ue.e.r<Fe[0].r&&(Ue.e.r=Fe[0].r);break;case 27:Fe[14e3]&&(Ie[Fe[14e3][0]]=Fe[14e3][1]);break;case 1537:Ie[Fe[0]]=Fe[1],Fe[0]==ie&&(U=Fe[1]);break}},j);else throw new Error("Unrecognized LOTUS BOF "+H[2]);if(V["!ref"]=$t(Ue),_e[Te||U]=V,Ne.push(Te||U),!Ie.length)return{SheetNames:Ne,Sheets:_e};for(var Ye={},nn=[],xt=0;xt<Ie.length;++xt)_e[Ne[xt]]?(nn.push(Ie[xt]||Ne[xt]),Ye[Ie[xt]]=_e[Ie[xt]]||_e[Ne[xt]]):(nn.push(Ie[xt]),Ye[Ie[xt]]={"!ref":"A1"});return{SheetNames:nn,Sheets:Ye}}function a(H,Z){var j=Z||{};if(+j.codepage>=0&&oc(+j.codepage),j.type=="string")throw new Error("Cannot write WK1 to JS string");var V=Xn(),U=Ot(H["!ref"]),Te=Array.isArray(H),ie=[];Me(V,0,l(1030)),Me(V,6,f(U));for(var _e=Math.min(U.e.r,8191),Ne=U.s.r;Ne<=_e;++Ne)for(var Ie=wn(Ne),Ue=U.s.c;Ue<=U.e.c;++Ue){Ne===U.s.r&&(ie[Ue]=An(Ue));var at=ie[Ue]+Ie,Ye=Te?(H[Ne]||[])[Ue]:H[at];if(!(!Ye||Ye.t=="z"))if(Ye.t=="n")(Ye.v|0)==Ye.v&&Ye.v>=-32768&&Ye.v<=32767?Me(V,13,_(Ne,Ue,Ye.v)):Me(V,14,b(Ne,Ue,Ye.v));else{var nn=Mr(Ye);Me(V,15,p(Ne,Ue,nn.slice(0,239)))}}return Me(V,1),V.end()}function r(H,Z){var j=Z||{};if(+j.codepage>=0&&oc(+j.codepage),j.type=="string")throw new Error("Cannot write WK3 to JS string");var V=Xn();Me(V,0,o(H));for(var U=0,Te=0;U<H.SheetNames.length;++U)(H.Sheets[H.SheetNames[U]]||{})["!ref"]&&Me(V,27,ye(H.SheetNames[U],Te++));var ie=0;for(U=0;U<H.SheetNames.length;++U){var _e=H.Sheets[H.SheetNames[U]];if(!(!_e||!_e["!ref"])){for(var Ne=Ot(_e["!ref"]),Ie=Array.isArray(_e),Ue=[],at=Math.min(Ne.e.r,8191),Ye=Ne.s.r;Ye<=at;++Ye)for(var nn=wn(Ye),xt=Ne.s.c;xt<=Ne.e.c;++xt){Ye===Ne.s.r&&(Ue[xt]=An(xt));var Fe=Ue[xt]+nn,ft=Ie?(_e[Ye]||[])[xt]:_e[Fe];if(!(!ft||ft.t=="z"))if(ft.t=="n")Me(V,23,B(Ye,xt,ie,ft.v));else{var pe=Mr(ft);Me(V,22,O(Ye,xt,ie,pe.slice(0,239)))}}++ie}}return Me(V,1),V.end()}function l(H){var Z=be(2);return Z.write_shift(2,H),Z}function o(H){var Z=be(26);Z.write_shift(2,4096),Z.write_shift(2,4),Z.write_shift(4,0);for(var j=0,V=0,U=0,Te=0;Te<H.SheetNames.length;++Te){var ie=H.SheetNames[Te],_e=H.Sheets[ie];if(!(!_e||!_e["!ref"])){++U;var Ne=oa(_e["!ref"]);j<Ne.e.r&&(j=Ne.e.r),V<Ne.e.c&&(V=Ne.e.c)}}return j>8191&&(j=8191),Z.write_shift(2,j),Z.write_shift(1,U),Z.write_shift(1,V),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(1,1),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(4,0),Z}function h(H,Z,j){var V={s:{c:0,r:0},e:{c:0,r:0}};return Z==8&&j.qpro?(V.s.c=H.read_shift(1),H.l++,V.s.r=H.read_shift(2),V.e.c=H.read_shift(1),H.l++,V.e.r=H.read_shift(2),V):(V.s.c=H.read_shift(2),V.s.r=H.read_shift(2),Z==12&&j.qpro&&(H.l+=2),V.e.c=H.read_shift(2),V.e.r=H.read_shift(2),Z==12&&j.qpro&&(H.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function f(H){var Z=be(8);return Z.write_shift(2,H.s.c),Z.write_shift(2,H.s.r),Z.write_shift(2,H.e.c),Z.write_shift(2,H.e.r),Z}function x(H,Z,j){var V=[{c:0,r:0},{t:"n",v:0},0,0];return j.qpro&&j.vers!=20768?(V[0].c=H.read_shift(1),V[3]=H.read_shift(1),V[0].r=H.read_shift(2),H.l+=2):(V[2]=H.read_shift(1),V[0].c=H.read_shift(2),V[0].r=H.read_shift(2)),V}function g(H,Z,j){var V=H.l+Z,U=x(H,Z,j);if(U[1].t="s",j.vers==20768){H.l++;var Te=H.read_shift(1);return U[1].v=H.read_shift(Te,"utf8"),U}return j.qpro&&H.l++,U[1].v=H.read_shift(V-H.l,"cstr"),U}function p(H,Z,j){var V=be(7+j.length);V.write_shift(1,255),V.write_shift(2,Z),V.write_shift(2,H),V.write_shift(1,39);for(var U=0;U<V.length;++U){var Te=j.charCodeAt(U);V.write_shift(1,Te>=128?95:Te)}return V.write_shift(1,0),V}function y(H,Z,j){var V=x(H,Z,j);return V[1].v=H.read_shift(2,"i"),V}function _(H,Z,j){var V=be(7);return V.write_shift(1,255),V.write_shift(2,Z),V.write_shift(2,H),V.write_shift(2,j,"i"),V}function w(H,Z,j){var V=x(H,Z,j);return V[1].v=H.read_shift(8,"f"),V}function b(H,Z,j){var V=be(13);return V.write_shift(1,255),V.write_shift(2,Z),V.write_shift(2,H),V.write_shift(8,j,"f"),V}function T(H,Z,j){var V=H.l+Z,U=x(H,Z,j);if(U[1].v=H.read_shift(8,"f"),j.qpro)H.l=V;else{var Te=H.read_shift(2);A(H.slice(H.l,H.l+Te),U),H.l+=Te}return U}function S(H,Z,j){var V=Z&32768;return Z&=-32769,Z=(V?H:0)+(Z>=8192?Z-16384:Z),(V?"":"$")+(j?An(Z):wn(Z))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function A(H,Z){ra(H,0);for(var j=[],V=0,U="",Te="",ie="",_e="";H.l<H.length;){var Ne=H[H.l++];switch(Ne){case 0:j.push(H.read_shift(8,"f"));break;case 1:Te=S(Z[0].c,H.read_shift(2),!0),U=S(Z[0].r,H.read_shift(2),!1),j.push(Te+U);break;case 2:{var Ie=S(Z[0].c,H.read_shift(2),!0),Ue=S(Z[0].r,H.read_shift(2),!1);Te=S(Z[0].c,H.read_shift(2),!0),U=S(Z[0].r,H.read_shift(2),!1),j.push(Ie+Ue+":"+Te+U)}break;case 3:if(H.l<H.length){console.error("WK1 premature formula end");return}break;case 4:j.push("("+j.pop()+")");break;case 5:j.push(H.read_shift(2));break;case 6:{for(var at="";Ne=H[H.l++];)at+=String.fromCharCode(Ne);j.push('"'+at.replace(/"/g,'""')+'"')}break;case 8:j.push("-"+j.pop());break;case 23:j.push("+"+j.pop());break;case 22:j.push("NOT("+j.pop()+")");break;case 20:case 21:_e=j.pop(),ie=j.pop(),j.push(["AND","OR"][Ne-20]+"("+ie+","+_e+")");break;default:if(Ne<32&&C[Ne])_e=j.pop(),ie=j.pop(),j.push(ie+C[Ne]+_e);else if(E[Ne]){if(V=E[Ne][1],V==69&&(V=H[H.l++]),V>j.length){console.error("WK1 bad formula parse 0x"+Ne.toString(16)+":|"+j.join("|")+"|");return}var Ye=j.slice(-V);j.length-=V,j.push(E[Ne][0]+"("+Ye.join(",")+")")}else return Ne<=7?console.error("WK1 invalid opcode "+Ne.toString(16)):Ne<=24?console.error("WK1 unsupported op "+Ne.toString(16)):Ne<=30?console.error("WK1 invalid opcode "+Ne.toString(16)):Ne<=115?console.error("WK1 unsupported function opcode "+Ne.toString(16)):console.error("WK1 unrecognized opcode "+Ne.toString(16))}}j.length==1?Z[1].f=""+j[0]:console.error("WK1 bad formula parse |"+j.join("|")+"|")}function F(H){var Z=[{c:0,r:0},{t:"n",v:0},0];return Z[0].r=H.read_shift(2),Z[3]=H[H.l++],Z[0].c=H[H.l++],Z}function K(H,Z){var j=F(H);return j[1].t="s",j[1].v=H.read_shift(Z-4,"cstr"),j}function O(H,Z,j,V){var U=be(6+V.length);U.write_shift(2,H),U.write_shift(1,j),U.write_shift(1,Z),U.write_shift(1,39);for(var Te=0;Te<V.length;++Te){var ie=V.charCodeAt(Te);U.write_shift(1,ie>=128?95:ie)}return U.write_shift(1,0),U}function P(H,Z){var j=F(H);j[1].v=H.read_shift(2);var V=j[1].v>>1;if(j[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return j[1].v=V,j}function M(H,Z){var j=F(H),V=H.read_shift(4),U=H.read_shift(4),Te=H.read_shift(2);if(Te==65535)return V===0&&U===3221225472?(j[1].t="e",j[1].v=15):V===0&&U===3489660928?(j[1].t="e",j[1].v=42):j[1].v=0,j;var ie=Te&32768;return Te=(Te&32767)-16446,j[1].v=(1-ie*2)*(U*Math.pow(2,Te+32)+V*Math.pow(2,Te)),j}function B(H,Z,j,V){var U=be(14);if(U.write_shift(2,H),U.write_shift(1,j),U.write_shift(1,Z),V==0)return U.write_shift(4,0),U.write_shift(4,0),U.write_shift(2,65535),U;var Te=0,ie=0,_e=0,Ne=0;return V<0&&(Te=1,V=-V),ie=Math.log2(V)|0,V/=Math.pow(2,ie-31),Ne=V>>>0,(Ne&2147483648)==0&&(V/=2,++ie,Ne=V>>>0),V-=Ne,Ne|=2147483648,Ne>>>=0,V*=Math.pow(2,32),_e=V>>>0,U.write_shift(4,_e),U.write_shift(4,Ne),ie+=16383+(Te?32768:0),U.write_shift(2,ie),U}function I(H,Z){var j=M(H);return H.l+=Z-14,j}function te(H,Z){var j=F(H),V=H.read_shift(4);return j[1].v=V>>6,j}function q(H,Z){var j=F(H),V=H.read_shift(8,"f");return j[1].v=V,j}function ae(H,Z){var j=q(H);return H.l+=Z-10,j}function re(H,Z){return H[H.l+Z-1]==0?H.read_shift(Z,"cstr"):""}function ee(H,Z){var j=H[H.l++];j>Z-1&&(j=Z-1);for(var V="";V.length<j;)V+=String.fromCharCode(H[H.l++]);return V}function Q(H,Z,j){if(!(!j.qpro||Z<21)){var V=H.read_shift(1);H.l+=17,H.l+=1,H.l+=2;var U=H.read_shift(Z-21,"cstr");return[V,U]}}function me(H,Z){for(var j={},V=H.l+Z;H.l<V;){var U=H.read_shift(2);if(U==14e3){for(j[U]=[0,""],j[U][0]=H.read_shift(2);H[H.l];)j[U][1]+=String.fromCharCode(H[H.l]),H.l++;H.l++}}return j}function ye(H,Z){var j=be(5+H.length);j.write_shift(2,14e3),j.write_shift(2,Z);for(var V=0;V<H.length;++V){var U=H.charCodeAt(V);j[j.l++]=U>127?95:U}return j[j.l++]=0,j}var Y={0:{n:"BOF",f:d_},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:h},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:ee},65535:{n:""}},de={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:K},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:me},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:te},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:ae},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:r,to_workbook:t}}(),V6=/^\s|\s$|[\t\n\r]/;function v_(e,t){if(!t.bookSST)return"";var n=[Qt];n[n.length]=Oe("sst",null,{xmlns:ml[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var r=e[a],l="<si>";r.r?l+=r.r:(l+="<t",r.t||(r.t=""),r.t.match(V6)&&(l+=' xml:space="preserve"'),l+=">"+vt(r.t)+"</t>"),l+="</si>",n[n.length]=l}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function K6(e){return[e.read_shift(4),e.read_shift(4)]}function W6(e,t){return t||(t=be(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var G6=LA;function X6(e){var t=Xn();Ce(t,159,W6(e));for(var n=0;n<e.length;++n)Ce(t,19,G6(e[n]));return Ce(t,160),t.end()}function Y6(e){for(var t=[],n=e.split(""),a=0;a<n.length;++a)t[a]=n[a].charCodeAt(0);return t}function b_(e){var t=0,n,a=Y6(e),r=a.length+1,l,o,h,f,x;for(n=ni(r),n[0]=a.length,l=1;l!=r;++l)n[l]=a[l-1];for(l=r-1;l>=0;--l)o=n[l],h=(t&16384)===0?0:1,f=t<<1&32767,x=h|f,t=x^o;return t^52811}var q6=function(){function e(r,l){switch(l.type){case"base64":return t(Or(r),l);case"binary":return t(r,l);case"buffer":return t(ht&&Buffer.isBuffer(r)?r.toString("binary"):yc(r),l);case"array":return t(nf(r),l)}throw new Error("Unrecognized type "+l.type)}function t(r,l){var o=l||{},h=o.dense?[]:{},f=r.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var x={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(g,p){Array.isArray(h)&&(h[p]=[]);for(var y=/\\\w+\b/g,_=0,w,b=-1;w=y.exec(g);){switch(w[0]){case"\\cell":var T=g.slice(_,y.lastIndex-w[0].length);if(T[0]==" "&&(T=T.slice(1)),++b,T.length){var S={v:T,t:"s"};Array.isArray(h)?h[p][b]=S:h[bt({r:p,c:b})]=S}break}_=y.lastIndex}b>x.e.c&&(x.e.c=b)}),h["!ref"]=$t(x),h}function n(r,l){return li(e(r,l),l)}function a(r){for(var l=["{\\rtf1\\ansi"],o=Ot(r["!ref"]),h,f=Array.isArray(r),x=o.s.r;x<=o.e.r;++x){l.push("\\trowd\\trautofit1");for(var g=o.s.c;g<=o.e.c;++g)l.push("\\cellx"+(g+1));for(l.push("\\pard\\intbl"),g=o.s.c;g<=o.e.c;++g){var p=bt({r:x,c:g});h=f?(r[x]||[])[g]:r[p],!(!h||h.v==null&&(!h.f||h.F))&&(l.push(" "+(h.w||(Mr(h),h.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:n,to_sheet:e,from_sheet:a}}();function Xv(e){for(var t=0,n=1;t!=3;++t)n=n*256+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}var $6=6,Ar=$6;function Bh(e){return Math.floor((e+Math.round(128/Ar)/256)*Ar)}function Hh(e){return Math.floor((e-5)/Ar*100+.5)/100}function rx(e){return Math.round((e*Ar+5)/Ar*256)/256}function Gx(e){e.width?(e.wpx=Bh(e.width),e.wch=Hh(e.wpx),e.MDW=Ar):e.wpx?(e.wch=Hh(e.wpx),e.width=rx(e.wch),e.MDW=Ar):typeof e.wch=="number"&&(e.width=rx(e.wch),e.wpx=Bh(e.width),e.MDW=Ar),e.customWidth&&delete e.customWidth}var Q6=96,__=Q6;function Ph(e){return e*96/__}function w_(e){return e*__/96}function Z6(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&(t[t.length]=Oe("numFmt",null,{numFmtId:a,formatCode:vt(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Oe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function J6(e){var t=[];return t[t.length]=Oe("cellXfs",null),e.forEach(function(n){t[t.length]=Oe("xf",null,n)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Oe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function T_(e,t){var n=[Qt,Oe("styleSheet",null,{xmlns:ml[0],"xmlns:vt":cn.vt})],a;return e.SSF&&(a=Z6(e.SSF))!=null&&(n[n.length]=a),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=J6(t.cellXfs))&&(n[n.length]=a),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function e5(e,t){var n=e.read_shift(2),a=Dn(e);return[n,a]}function t5(e,t,n){n||(n=be(6+4*t.length)),n.write_shift(2,e),hn(t,n);var a=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),a}function n5(e,t,n){var a={};a.sz=e.read_shift(2)/20;var r=VA(e);r.fItalic&&(a.italic=1),r.fCondense&&(a.condense=1),r.fExtend&&(a.extend=1),r.fShadow&&(a.shadow=1),r.fOutline&&(a.outline=1),r.fStrikeout&&(a.strike=1);var l=e.read_shift(2);switch(l===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var h=e.read_shift(1);h>0&&(a.family=h);var f=e.read_shift(1);switch(f>0&&(a.charset=f),e.l++,a.color=UA(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Dn(e),a}function a5(e,t){t||(t=be(25+4*32)),t.write_shift(2,e.sz*20),KA(e,t),t.write_shift(2,e.bold?700:400);var n=0;e.vertAlign=="superscript"?n=1:e.vertAlign=="subscript"&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Fh(e.color,t);var a=0;return a=2,t.write_shift(1,a),hn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var r5=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Hd,s5=tr;function Yv(e,t){t||(t=be(4*3+8*7+16*1)),Hd||(Hd=Rx(r5));var n=Hd[e.patternType];n==null&&(n=40),t.write_shift(4,n);var a=0;if(n!=40)for(Fh({auto:1},t),Fh({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function i5(e,t){var n=e.l+t,a=e.read_shift(2),r=e.read_shift(2);return e.l=n,{ixfe:a,numFmtId:r}}function S_(e,t,n){n||(n=be(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var a=0;return n.write_shift(1,a),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function Ao(e,t){return t||(t=be(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var l5=tr;function o5(e,t){return t||(t=be(51)),t.write_shift(1,0),Ao(null,t),Ao(null,t),Ao(null,t),Ao(null,t),Ao(null,t),t.length>t.l?t.slice(0,t.l):t}function c5(e,t){return t||(t=be(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Rh(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function u5(e,t,n){var a=be(2052);return a.write_shift(4,e),Rh(t,a),Rh(n,a),a.length>a.l?a.slice(0,a.l):a}function h5(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var r=a[0];r<=a[1];++r)t[r]!=null&&++n}),n!=0&&(Ce(e,615,La(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var r=a[0];r<=a[1];++r)t[r]!=null&&Ce(e,44,t5(r,t[r]))}),Ce(e,616))}}function f5(e){var t=1;Ce(e,611,La(t)),Ce(e,43,a5({sz:12,color:{theme:1},name:"Calibri",family:2})),Ce(e,612)}function d5(e){var t=2;Ce(e,603,La(t)),Ce(e,45,Yv({patternType:"none"})),Ce(e,45,Yv({patternType:"gray125"})),Ce(e,604)}function x5(e){var t=1;Ce(e,613,La(t)),Ce(e,46,o5()),Ce(e,614)}function g5(e){var t=1;Ce(e,626,La(t)),Ce(e,47,S_({numFmtId:0},65535)),Ce(e,627)}function m5(e,t){Ce(e,617,La(t.length)),t.forEach(function(n){Ce(e,47,S_(n,0))}),Ce(e,618)}function p5(e){var t=1;Ce(e,619,La(t)),Ce(e,48,c5({xfId:0,name:"Normal"})),Ce(e,620)}function y5(e){var t=0;Ce(e,505,La(t)),Ce(e,506)}function v5(e){var t=0;Ce(e,508,u5(t,"TableStyleMedium9","PivotStyleMedium4")),Ce(e,509)}function b5(e,t){var n=Xn();return Ce(n,278),h5(n,e.SSF),f5(n),d5(n),x5(n),g5(n),m5(n,t.cellXfs),p5(n),y5(n),v5(n),Ce(n,279),n.end()}function N_(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var n=[Qt];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function _5(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Dn(e)}}function w5(e){var t=be(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),hn(e.name,t),t.slice(0,t.l)}function T5(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function S5(e){var t=be(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}function N5(e,t){var n=be(8+2*t.length);return n.write_shift(4,e),hn(t,n),n.slice(0,n.l)}function E5(e){return e.l+=4,e.read_shift(4)!=0}function C5(e,t){var n=be(8);return n.write_shift(4,e),n.write_shift(4,1),n}function j5(){var e=Xn();return Ce(e,332),Ce(e,334,La(1)),Ce(e,335,w5({name:"XLDAPR",version:12e4,flags:3496657072})),Ce(e,336),Ce(e,339,N5(1,"XLDAPR")),Ce(e,52),Ce(e,35,La(514)),Ce(e,4096,La(0)),Ce(e,4097,wa(1)),Ce(e,36),Ce(e,53),Ce(e,340),Ce(e,337,C5(1)),Ce(e,51,S5([[1,0]])),Ce(e,338),Ce(e,333),e.end()}function E_(){var e=[Qt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function k5(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=bt(n);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}var tl=1024;function C_(e,t){for(var n=[21600,21600],a=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),r=[Oe("xml",null,{"xmlns:v":sa.v,"xmlns:o":sa.o,"xmlns:x":sa.x,"xmlns:mv":sa.mv}).replace(/\/>/,">"),Oe("o:shapelayout",Oe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Oe("v:shapetype",[Oe("v:stroke",null,{joinstyle:"miter"}),Oe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:a})];tl<e*1e3;)tl+=1e3;return t.forEach(function(l){var o=un(l[0]),h={color2:"#BEFF82",type:"gradient"};h.type=="gradient"&&(h.angle="-180");var f=h.type=="gradient"?Oe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,x=Oe("v:fill",f,h),g={on:"t",obscured:"t"};++tl,r=r.concat(["<v:shape"+fc({id:"_x0000_s"+tl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",x,Oe("v:shadow",null,g),Oe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",bn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),bn("x:AutoFill","False"),bn("x:Row",String(o.r)),bn("x:Column",String(o.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),r.push("</xml>"),r.join("")}function j_(e){var t=[Qt,Oe("comments",null,{xmlns:ml[0]})],n=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(r){var l=vt(r.a);n.indexOf(l)==-1&&(n.push(l),t.push("<author>"+l+"</author>")),r.T&&r.ID&&n.indexOf("tc="+r.ID)==-1&&(n.push("tc="+r.ID),t.push("<author>tc="+r.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var r=0,l=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?r=n.indexOf("tc="+a[1][0].ID):a[1].forEach(function(f){f.a&&(r=n.indexOf(vt(f.a))),l.push(f.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+r+'"><text>'),l.length<=1)t.push(bn("t",vt(l[0]||"")));else{for(var o=`Comment:
    `+l[0]+`
`,h=1;h<l.length;++h)o+=`Reply:
    `+l[h]+`
`;t.push(bn("t",vt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function A5(e,t,n){var a=[Qt,Oe("ThreadedComments",null,{xmlns:cn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(r){var l="";(r[1]||[]).forEach(function(o,h){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var f={ref:r[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};h==0?l=f.id:f.parentId=l,o.ID=f.id,o.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),a.push(Oe("threadedComment",bn("text",o.t||""),f))})}),a.push("</ThreadedComments>"),a.join("")}function D5(e){var t=[Qt,Oe("personList",null,{xmlns:cn.TCMNT,"xmlns:x":ml[0]}).replace(/[\/]>/,">")];return e.forEach(function(n,a){t.push(Oe("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:n,providerId:"None"}))}),t.push("</personList>"),t.join("")}function O5(e){var t={};t.iauthor=e.read_shift(4);var n=hi(e);return t.rfx=n.s,t.ref=bt(n.s),e.l+=16,t}function M5(e,t){return t==null&&(t=be(36)),t.write_shift(4,e[1].iauthor),yl(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var R5=Dn;function F5(e){return hn(e.slice(0,54))}function L5(e){var t=Xn(),n=[];return Ce(t,628),Ce(t,630),e.forEach(function(a){a[1].forEach(function(r){n.indexOf(r.a)>-1||(n.push(r.a.slice(0,54)),Ce(t,632,F5(r.a)))})}),Ce(t,631),Ce(t,633),e.forEach(function(a){a[1].forEach(function(r){r.iauthor=n.indexOf(r.a);var l={s:un(a[0]),e:un(a[0])};Ce(t,635,M5([l,r])),r.t&&r.t.length>0&&Ce(t,637,HA(r)),Ce(t,636),delete r.iauthor})}),Ce(t,634),Ce(t,629),t.end()}function B5(e,t){t.FullPaths.forEach(function(n,a){if(a!=0){var r=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");r.slice(-1)!=="/"&&Et.utils.cfb_add(e,r,t.FileIndex[a].content)}})}var k_=["xlsb","xlsm","xlam","biff8","xla"],H5=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(a,r,l,o){var h=!1,f=!1;l.length==0?f=!0:l.charAt(0)=="["&&(f=!0,l=l.slice(1,-1)),o.length==0?h=!0:o.charAt(0)=="["&&(h=!0,o=o.slice(1,-1));var x=l.length>0?parseInt(l,10)|0:0,g=o.length>0?parseInt(o,10)|0:0;return h?g+=t.c:--g,f?x+=t.r:--x,r+(h?"":"$")+An(g)+(f?"":"$")+wn(x)}return function(r,l){return t=l,r.replace(e,n)}}(),Xx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Yx=function(){return function(t,n){return t.replace(Xx,function(a,r,l,o,h,f){var x=zx(o)-(l?0:n.c),g=Ix(f)-(h?0:n.r),p=g==0?"":h?g+1:"["+g+"]",y=x==0?"":l?x+1:"["+x+"]";return r+"R"+p+"C"+y})}}();function P5(e,t){return e.replace(Xx,function(n,a,r,l,o,h){return a+(r=="$"?r+l:An(zx(l)+t.c))+(o=="$"?o+h:wn(Ix(h)+t.r))})}function I5(e){return e.length!=1}function Yt(e){e.l+=1}function ps(e,t){var n=e.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function A_(e,t,n){var a=2;if(n){if(n.biff>=2&&n.biff<=5)return D_(e);n.biff==12&&(a=4)}var r=e.read_shift(a),l=e.read_shift(a),o=ps(e),h=ps(e);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:l,c:h[0],cRel:h[1],rRel:h[2]}}}function D_(e){var t=ps(e),n=ps(e),a=e.read_shift(1),r=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:n[0],c:r,cRel:n[1],rRel:n[2]}}}function z5(e,t,n){if(n.biff<8)return D_(e);var a=e.read_shift(n.biff==12?4:2),r=e.read_shift(n.biff==12?4:2),l=ps(e),o=ps(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r,c:o[0],cRel:o[1],rRel:o[2]}}}function O_(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return U5(e);var a=e.read_shift(n&&n.biff==12?4:2),r=ps(e);return{r:a,c:r[0],cRel:r[1],rRel:r[2]}}function U5(e){var t=ps(e),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}function V5(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function K5(e,t,n){var a=n&&n.biff?n.biff:8;if(a>=2&&a<=5)return W5(e);var r=e.read_shift(a>=12?4:2),l=e.read_shift(2),o=(l&16384)>>14,h=(l&32768)>>15;if(l&=16383,h==1)for(;r>524287;)r-=1048576;if(o==1)for(;l>8191;)l=l-16384;return{r,c:l,cRel:o,rRel:h}}function W5(e){var t=e.read_shift(2),n=e.read_shift(1),a=(t&32768)>>15,r=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),r==1&&n>=128&&(n=n-256),{r:t,c:n,cRel:r,rRel:a}}function G5(e,t,n){var a=(e[e.l++]&96)>>5,r=A_(e,n.biff>=2&&n.biff<=5?6:8,n);return[a,r]}function X5(e,t,n){var a=(e[e.l++]&96)>>5,r=e.read_shift(2,"i"),l=8;if(n)switch(n.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var o=A_(e,l,n);return[a,r,o]}function Y5(e,t,n){var a=(e[e.l++]&96)>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[a]}function q5(e,t,n){var a=(e[e.l++]&96)>>5,r=e.read_shift(2),l=8;if(n)switch(n.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[a,r]}function $5(e,t,n){var a=(e[e.l++]&96)>>5,r=z5(e,t-1,n);return[a,r]}function Q5(e,t,n){var a=(e[e.l++]&96)>>5;return e.l+=n.biff==2?6:n.biff==12?14:7,[a]}function qv(e){var t=e[e.l+1]&1,n=1;return e.l+=4,[t,n]}function Z5(e,t,n){e.l+=2;for(var a=e.read_shift(n&&n.biff==2?1:2),r=[],l=0;l<=a;++l)r.push(e.read_shift(n&&n.biff==2?1:2));return r}function J5(e,t,n){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(n&&n.biff==2?1:2)]}function eD(e,t,n){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(n&&n.biff==2?1:2)]}function tD(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function nD(e,t,n){var a=e[e.l+1]&255?1:0;return e.l+=n&&n.biff==2?3:4,[a]}function M_(e){var t=e.read_shift(1),n=e.read_shift(1);return[t,n]}function aD(e){return e.read_shift(2),M_(e)}function rD(e){return e.read_shift(2),M_(e)}function sD(e,t,n){var a=(e[e.l]&96)>>5;e.l+=1;var r=O_(e,0,n);return[a,r]}function iD(e,t,n){var a=(e[e.l]&96)>>5;e.l+=1;var r=K5(e,0,n);return[a,r]}function lD(e,t,n){var a=(e[e.l]&96)>>5;e.l+=1;var r=e.read_shift(2);n&&n.biff==5&&(e.l+=12);var l=O_(e,0,n);return[a,r,l]}function oD(e,t,n){var a=(e[e.l]&96)>>5;e.l+=1;var r=e.read_shift(n&&n.biff<=3?1:2);return[o8[r],L_[r],a]}function cD(e,t,n){var a=e[e.l++],r=e.read_shift(1),l=n&&n.biff<=3?[a==88?-1:0,e.read_shift(1)]:uD(e);return[r,(l[0]===0?L_:l8)[l[1]]]}function uD(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function hD(e,t,n){e.l+=n&&n.biff==2?3:4}function fD(e,t,n){if(e.l++,n&&n.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),r=e.read_shift(n&&n.biff==2?1:2);return[a,r]}function dD(e){return e.l++,_c[e.read_shift(1)]}function xD(e){return e.l++,e.read_shift(2)}function gD(e){return e.l++,e.read_shift(1)!==0}function mD(e){return e.l++,vl(e)}function pD(e,t,n){return e.l++,g_(e,t-1,n)}function yD(e,t){var n=[e.read_shift(1)];if(t==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=l6(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:n[1]=_c[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:n[1]=vl(e);break;case 2:n[1]=h6(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function vD(e,t,n){for(var a=e.read_shift(n.biff==12?4:2),r=[],l=0;l!=a;++l)r.push((n.biff==12?hi:x6)(e));return r}function bD(e,t,n){var a=0,r=0;n.biff==12?(a=e.read_shift(4),r=e.read_shift(4)):(r=1+e.read_shift(1),a=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--a,--r==0&&(r=256));for(var l=0,o=[];l!=a&&(o[l]=[]);++l)for(var h=0;h!=r;++h)o[l][h]=yD(e,n.biff);return o}function _D(e,t,n){var a=e.read_shift(1)>>>5&3,r=!n||n.biff>=8?4:2,l=e.read_shift(r);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,l]}function wD(e,t,n){if(n.biff==5)return TD(e);var a=e.read_shift(1)>>>5&3,r=e.read_shift(2),l=e.read_shift(4);return[a,r,l]}function TD(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,n,a]}function SD(e,t,n){var a=e.read_shift(1)>>>5&3;e.l+=n&&n.biff==2?3:4;var r=e.read_shift(n&&n.biff==2?1:2);return[a,r]}function ND(e,t,n){var a=e.read_shift(1)>>>5&3,r=e.read_shift(n&&n.biff==2?1:2);return[a,r]}function ED(e,t,n){var a=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,n.biff==12&&(e.l+=2),[a]}function CD(e,t,n){var a=(e[e.l++]&96)>>5,r=e.read_shift(2),l=4;if(n)switch(n.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[a,r]}var jD=tr,kD=tr,AD=tr;function wc(e,t,n){return e.l+=2,[V5(e)]}function qx(e){return e.l+=6,[]}var DD=wc,OD=qx,MD=qx,RD=wc;function R_(e){return e.l+=2,[d_(e),e.read_shift(2)&1]}var FD=wc,LD=R_,BD=qx,HD=wc,PD=wc,ID=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function zD(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(4),r=e.read_shift(2),l=e.read_shift(2),o=ID[n>>2&31];return{ixti:t,coltype:n&3,rt:o,idx:a,c:r,C:l}}function UD(e){return e.l+=2,[e.read_shift(4)]}function VD(e,t,n){return e.l+=5,e.l+=2,e.l+=n.biff==2?1:4,["PTGSHEET"]}function KD(e,t,n){return e.l+=n.biff==2?4:5,["PTGENDSHEET"]}function WD(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function GD(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function XD(e){return e.l+=4,[0,0]}var $v={1:{n:"PtgExp",f:fD},2:{n:"PtgTbl",f:AD},3:{n:"PtgAdd",f:Yt},4:{n:"PtgSub",f:Yt},5:{n:"PtgMul",f:Yt},6:{n:"PtgDiv",f:Yt},7:{n:"PtgPower",f:Yt},8:{n:"PtgConcat",f:Yt},9:{n:"PtgLt",f:Yt},10:{n:"PtgLe",f:Yt},11:{n:"PtgEq",f:Yt},12:{n:"PtgGe",f:Yt},13:{n:"PtgGt",f:Yt},14:{n:"PtgNe",f:Yt},15:{n:"PtgIsect",f:Yt},16:{n:"PtgUnion",f:Yt},17:{n:"PtgRange",f:Yt},18:{n:"PtgUplus",f:Yt},19:{n:"PtgUminus",f:Yt},20:{n:"PtgPercent",f:Yt},21:{n:"PtgParen",f:Yt},22:{n:"PtgMissArg",f:Yt},23:{n:"PtgStr",f:pD},26:{n:"PtgSheet",f:VD},27:{n:"PtgEndSheet",f:KD},28:{n:"PtgErr",f:dD},29:{n:"PtgBool",f:gD},30:{n:"PtgInt",f:xD},31:{n:"PtgNum",f:mD},32:{n:"PtgArray",f:Q5},33:{n:"PtgFunc",f:oD},34:{n:"PtgFuncVar",f:cD},35:{n:"PtgName",f:_D},36:{n:"PtgRef",f:sD},37:{n:"PtgArea",f:G5},38:{n:"PtgMemArea",f:SD},39:{n:"PtgMemErr",f:jD},40:{n:"PtgMemNoMem",f:kD},41:{n:"PtgMemFunc",f:ND},42:{n:"PtgRefErr",f:ED},43:{n:"PtgAreaErr",f:Y5},44:{n:"PtgRefN",f:iD},45:{n:"PtgAreaN",f:$5},46:{n:"PtgMemAreaN",f:WD},47:{n:"PtgMemNoMemN",f:GD},57:{n:"PtgNameX",f:wD},58:{n:"PtgRef3d",f:lD},59:{n:"PtgArea3d",f:X5},60:{n:"PtgRefErr3d",f:CD},61:{n:"PtgAreaErr3d",f:q5},255:{}},YD={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},qD={1:{n:"PtgElfLel",f:R_},2:{n:"PtgElfRw",f:HD},3:{n:"PtgElfCol",f:DD},6:{n:"PtgElfRwV",f:PD},7:{n:"PtgElfColV",f:RD},10:{n:"PtgElfRadical",f:FD},11:{n:"PtgElfRadicalS",f:BD},13:{n:"PtgElfColS",f:OD},15:{n:"PtgElfColSV",f:MD},16:{n:"PtgElfRadicalLel",f:LD},25:{n:"PtgList",f:zD},29:{n:"PtgSxName",f:UD},255:{}},$D={0:{n:"PtgAttrNoop",f:XD},1:{n:"PtgAttrSemi",f:nD},2:{n:"PtgAttrIf",f:eD},4:{n:"PtgAttrChoose",f:Z5},8:{n:"PtgAttrGoto",f:J5},16:{n:"PtgAttrSum",f:hD},32:{n:"PtgAttrBaxcel",f:qv},33:{n:"PtgAttrBaxcel",f:qv},64:{n:"PtgAttrSpace",f:aD},65:{n:"PtgAttrSpaceSemi",f:rD},128:{n:"PtgAttrIfError",f:tD},255:{}};function QD(e,t,n,a){if(a.biff<8)return tr(e,t);for(var r=e.l+t,l=[],o=0;o!==n.length;++o)switch(n[o][0]){case"PtgArray":n[o][1]=bD(e,0,a),l.push(n[o][1]);break;case"PtgMemArea":n[o][2]=vD(e,n[o][1],a),l.push(n[o][2]);break;case"PtgExp":a&&a.biff==12&&(n[o][1][1]=e.read_shift(4),l.push(n[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[o][0]}return t=r-e.l,t!==0&&l.push(tr(e,t)),l}function ZD(e,t,n){for(var a=e.l+t,r,l,o=[];a!=e.l;)t=a-e.l,l=e[e.l],r=$v[l]||$v[YD[l]],(l===24||l===25)&&(r=(l===24?qD:$D)[e[e.l+1]]),!r||!r.f?tr(e,t):o.push([r.n,r.f(e,t,n)]);return o}function JD(e){for(var t=[],n=0;n<e.length;++n){for(var a=e[n],r=[],l=0;l<a.length;++l){var o=a[l];if(o)switch(o[0]){case 2:r.push('"'+o[1].replace(/"/g,'""')+'"');break;default:r.push(o[1])}else r.push("")}t.push(r.join(","))}return t.join(";")}var e8={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function t8(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function F_(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var r="";if(n.biff>8)switch(e[a[0]][0]){case 357:return r=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?r:r+":"+e.SheetNames[a[2]];case 358:return n.SID!=null?e.SheetNames[n.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return r=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?r:r+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[a[0]][0][3]?(r=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?r:r+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Qv(e,t,n){var a=F_(e,t,n);return a=="#REF"?a:t8(a,n)}function hl(e,t,n,a,r){var l=r&&r.biff||8,o={s:{c:0,r:0}},h=[],f,x,g,p=0,y=0,_,w="";if(!e[0]||!e[0][0])return"";for(var b=-1,T="",S=0,E=e[0].length;S<E;++S){var C=e[0][S];switch(C[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=h.pop(),x=h.pop(),b>=0){switch(e[0][b][1][0]){case 0:T=Pt(" ",e[0][b][1][1]);break;case 1:T=Pt("\r",e[0][b][1][1]);break;default:if(T="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}x=x+T,b=-1}h.push(x+e8[C[0]]+f);break;case"PtgIsect":f=h.pop(),x=h.pop(),h.push(x+" "+f);break;case"PtgUnion":f=h.pop(),x=h.pop(),h.push(x+","+f);break;case"PtgRange":f=h.pop(),x=h.pop(),h.push(x+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=Xo(C[1][1],o,r),h.push(Yo(g,l));break;case"PtgRefN":g=n?Xo(C[1][1],n,r):C[1][1],h.push(Yo(g,l));break;case"PtgRef3d":p=C[1][1],g=Xo(C[1][2],o,r),w=Qv(a,p,r),h.push(w+"!"+Yo(g,l));break;case"PtgFunc":case"PtgFuncVar":var A=C[1][0],F=C[1][1];A||(A=0),A&=127;var K=A==0?[]:h.slice(-A);h.length-=A,F==="User"&&(F=K.shift()),h.push(F+"("+K.join(",")+")");break;case"PtgBool":h.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":h.push(C[1]);break;case"PtgNum":h.push(String(C[1]));break;case"PtgStr":h.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":h.push(C[1]);break;case"PtgAreaN":_=Fv(C[1][1],n?{s:n}:o,r),h.push(Ld(_,r));break;case"PtgArea":_=Fv(C[1][1],o,r),h.push(Ld(_,r));break;case"PtgArea3d":p=C[1][1],_=C[1][2],w=Qv(a,p,r),h.push(w+"!"+Ld(_,r));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=C[1][2];var O=(a.names||[])[y-1]||(a[0]||[])[y],P=O?O.Name:"SH33TJSNAME"+String(y);P&&P.slice(0,6)=="_xlfn."&&!r.xlfn&&(P=P.slice(6)),h.push(P);break;case"PtgNameX":var M=C[1][1];y=C[1][2];var B;if(r.biff<=5)M<0&&(M=-M),a[M]&&(B=a[M][y]);else{var I="";if(((a[M]||[])[0]||[])[0]==14849||(((a[M]||[])[0]||[])[0]==1025?a[M][y]&&a[M][y].itab>0&&(I=a.SheetNames[a[M][y].itab-1]+"!"):I=a.SheetNames[y-1]+"!"),a[M]&&a[M][y])I+=a[M][y].Name;else if(a[0]&&a[0][y])I+=a[0][y].Name;else{var te=(F_(a,M,r)||"").split(";;");te[y-1]?I=te[y-1]:I+="SH33TJSERRX"}h.push(I);break}B||(B={Name:"SH33TJSERRY"}),h.push(B.Name);break;case"PtgParen":var q="(",ae=")";if(b>=0){switch(T="",e[0][b][1][0]){case 2:q=Pt(" ",e[0][b][1][1])+q;break;case 3:q=Pt("\r",e[0][b][1][1])+q;break;case 4:ae=Pt(" ",e[0][b][1][1])+ae;break;case 5:ae=Pt("\r",e[0][b][1][1])+ae;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}b=-1}h.push(q+h.pop()+ae);break;case"PtgRefErr":h.push("#REF!");break;case"PtgRefErr3d":h.push("#REF!");break;case"PtgExp":g={c:C[1][1],r:C[1][0]};var re={c:n.c,r:n.r};if(a.sharedf[bt(g)]){var ee=a.sharedf[bt(g)];h.push(hl(ee,o,re,a,r))}else{var Q=!1;for(f=0;f!=a.arrayf.length;++f)if(x=a.arrayf[f],!(g.c<x[0].s.c||g.c>x[0].e.c)&&!(g.r<x[0].s.r||g.r>x[0].e.r)){h.push(hl(x[1],o,re,a,r)),Q=!0;break}Q||h.push(C[1])}break;case"PtgArray":h.push("{"+JD(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":h.push("");break;case"PtgAreaErr":h.push("#REF!");break;case"PtgAreaErr3d":h.push("#REF!");break;case"PtgList":h.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var me=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(r.biff!=3&&b>=0&&me.indexOf(e[0][S][0])==-1){C=e[0][b];var ye=!0;switch(C[1][0]){case 4:ye=!1;case 0:T=Pt(" ",C[1][1]);break;case 5:ye=!1;case 1:T=Pt("\r",C[1][1]);break;default:if(T="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}h.push((ye?T:"")+h.pop()+(ye?"":T)),b=-1}}if(h.length>1&&r.WTF)throw new Error("bad formula stack");return h[0]}function n8(e){if(e==null){var t=be(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ai(e);return ai(0)}function a8(e,t,n,a,r){var l=ri(t,n,r),o=n8(e.v),h=be(6),f=33;h.write_shift(2,f),h.write_shift(4,0);for(var x=be(e.bf.length),g=0;g<e.bf.length;++g)x[g]=e.bf[g];var p=vn([l,o,h,x]);return p}function af(e,t,n){var a=e.read_shift(4),r=ZD(e,a,n),l=e.read_shift(4),o=l>0?QD(e,l,r,n):null;return[r,o]}var r8=af,rf=af,s8=af,i8=af,l8={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},L_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},o8={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function c8(e){var t="of:="+e.replace(Xx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function u8(e){return e.replace(/\./,"!")}var qo=typeof Map<"u";function $x(e,t,n){var a=0,r=e.length;if(n){if(qo?n.has(t):Object.prototype.hasOwnProperty.call(n,t)){for(var l=qo?n.get(t):n[t];a<l.length;++a)if(e[l[a]].t===t)return e.Count++,l[a]}}else for(;a<r;++a)if(e[a].t===t)return e.Count++,a;return e[r]={t},e.Count++,e.Unique++,n&&(qo?(n.has(t)||n.set(t,[]),n.get(t).push(r)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(r))),r}function sf(e,t){var n={min:e+1,max:e+1},a=-1;return t.MDW&&(Ar=t.MDW),t.width!=null?n.customWidth=1:t.wpx!=null?a=Hh(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(n.width=rx(a),n.customWidth=1):t.width!=null&&(n.width=t.width),t.hidden&&(n.hidden=!0),t.level!=null&&(n.outlineLevel=n.level=t.level),n}function B_(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=n[0]),e.right==null&&(e.right=n[1]),e.top==null&&(e.top=n[2]),e.bottom==null&&(e.bottom=n[3]),e.header==null&&(e.header=n[4]),e.footer==null&&(e.footer=n[5])}}function vs(e,t,n){var a=n.revssf[t.z!=null?t.z:"General"],r=60,l=e.length;if(a==null&&n.ssf){for(;r<392;++r)if(n.ssf[r]==null){Ob(t.z,r),n.ssf[r]=t.z,n.revssf[t.z]=a=r;break}}for(r=0;r!=l;++r)if(e[r].numFmtId===a)return r;return e[l]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function h8(e,t,n){if(e&&e["!ref"]){var a=Ot(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}function f8(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+$t(e[n])+'"/>';return t+"</mergeCells>"}function d8(e,t,n,a,r){var l=!1,o={},h=null;if(a.bookType!=="xlsx"&&t.vbaraw){var f=t.SheetNames[n];try{t.Workbook&&(f=t.Workbook.Sheets[n].CodeName||f)}catch{}l=!0,o.codeName=hc(vt(f))}if(e&&e["!outline"]){var x={summaryBelow:1,summaryRight:1};e["!outline"].above&&(x.summaryBelow=0),e["!outline"].left&&(x.summaryRight=0),h=(h||"")+Oe("outlinePr",null,x)}!l&&!h||(r[r.length]=Oe("sheetPr",h,o))}var x8=["objects","scenarios","selectLockedCells","selectUnlockedCells"],g8=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function m8(e){var t={sheet:1};return x8.forEach(function(n){e[n]!=null&&e[n]&&(t[n]="1")}),g8.forEach(function(n){e[n]!=null&&!e[n]&&(t[n]="0")}),e.password&&(t.password=b_(e.password).toString(16).toUpperCase()),Oe("sheetProtection",null,t)}function p8(e){return B_(e),Oe("pageMargins",null,e)}function y8(e,t){for(var n=["<cols>"],a,r=0;r!=t.length;++r)(a=t[r])&&(n[n.length]=Oe("col",null,sf(r,a)));return n[n.length]="</cols>",n.join("")}function v8(e,t,n,a){var r=typeof e.ref=="string"?e.ref:$t(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var l=n.Workbook.Names,o=oa(r);o.s.r==o.e.r&&(o.e.r=oa(t["!ref"]).e.r,r=$t(o));for(var h=0;h<l.length;++h){var f=l[h];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==a){f.Ref="'"+n.SheetNames[a]+"'!"+r;break}}return h==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+n.SheetNames[a]+"'!"+r}),Oe("autoFilter",null,{ref:r})}function b8(e,t,n,a){var r={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(r.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Oe("sheetViews",Oe("sheetView",null,r),{})}function _8(e,t,n,a){if(e.c&&n["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var r="",l=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":r=e.v?"1":"0";break;case"n":r=""+e.v;break;case"e":r=_c[e.v];break;case"d":a&&a.cellDates?r=Ln(e.v,-1).toISOString():(e=qn(e),e.t="n",r=""+(e.v=Yn(Ln(e.v)))),typeof e.z>"u"&&(e.z=Vt[14]);break;default:r=e.v;break}var h=bn("v",vt(r)),f={r:t},x=vs(a.cellXfs,e,a);switch(x!==0&&(f.s=x),e.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){h=bn("v",""+$x(a.Strings,e.v,a.revStrings)),f.t="s";break}f.t="str";break}if(e.t!=l&&(e.t=l,e.v=o),typeof e.f=="string"&&e.f){var g=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;h=Oe("f",vt(e.f),g)+(e.v!=null?h:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(f.cm=1),Oe("c",h,f)}function w8(e,t,n,a){var r=[],l=[],o=Ot(e["!ref"]),h="",f,x="",g=[],p=0,y=0,_=e["!rows"],w=Array.isArray(e),b={r:x},T,S=-1;for(y=o.s.c;y<=o.e.c;++y)g[y]=An(y);for(p=o.s.r;p<=o.e.r;++p){for(l=[],x=wn(p),y=o.s.c;y<=o.e.c;++y){f=g[y]+x;var E=w?(e[p]||[])[y]:e[f];E!==void 0&&(h=_8(E,f,e,t))!=null&&l.push(h)}(l.length>0||_&&_[p])&&(b={r:x},_&&_[p]&&(T=_[p],T.hidden&&(b.hidden=1),S=-1,T.hpx?S=Ph(T.hpx):T.hpt&&(S=T.hpt),S>-1&&(b.ht=S,b.customHeight=1),T.level&&(b.outlineLevel=T.level)),r[r.length]=Oe("row",l.join(""),b))}if(_)for(;p<_.length;++p)_&&_[p]&&(b={r:p+1},T=_[p],T.hidden&&(b.hidden=1),S=-1,T.hpx?S=Ph(T.hpx):T.hpt&&(S=T.hpt),S>-1&&(b.ht=S,b.customHeight=1),T.level&&(b.outlineLevel=T.level),r[r.length]=Oe("row","",b));return r.join("")}function H_(e,t,n,a){var r=[Qt,Oe("worksheet",null,{xmlns:ml[0],"xmlns:r":cn.r})],l=n.SheetNames[e],o=0,h="",f=n.Sheets[l];f==null&&(f={});var x=f["!ref"]||"A1",g=Ot(x);if(g.e.c>16383||g.e.r>1048575){if(t.WTF)throw new Error("Range "+x+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575),x=$t(g)}a||(a={}),f["!comments"]=[];var p=[];d8(f,n,e,t,r),r[r.length]=Oe("dimension",null,{ref:x}),r[r.length]=b8(f,t,e,n),t.sheetFormat&&(r[r.length]=Oe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(r[r.length]=y8(f,f["!cols"])),r[o=r.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(h=w8(f,t),h.length>0&&(r[r.length]=h)),r.length>o+1&&(r[r.length]="</sheetData>",r[o]=r[o].replace("/>",">")),f["!protect"]&&(r[r.length]=m8(f["!protect"])),f["!autofilter"]!=null&&(r[r.length]=v8(f["!autofilter"],f,n,e)),f["!merges"]!=null&&f["!merges"].length>0&&(r[r.length]=f8(f["!merges"]));var y=-1,_,w=-1;return f["!links"].length>0&&(r[r.length]="<hyperlinks>",f["!links"].forEach(function(b){b[1].Target&&(_={ref:b[0]},b[1].Target.charAt(0)!="#"&&(w=yt(a,-1,vt(b[1].Target).replace(/#.*$/,""),ct.HLINK),_["r:id"]="rId"+w),(y=b[1].Target.indexOf("#"))>-1&&(_.location=vt(b[1].Target.slice(y+1))),b[1].Tooltip&&(_.tooltip=vt(b[1].Tooltip)),r[r.length]=Oe("hyperlink",null,_))}),r[r.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(r[r.length]=p8(f["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(r[r.length]=bn("ignoredErrors",Oe("ignoredError",null,{numberStoredAsText:1,sqref:x}))),p.length>0&&(w=yt(a,-1,"../drawings/drawing"+(e+1)+".xml",ct.DRAW),r[r.length]=Oe("drawing",null,{"r:id":"rId"+w}),f["!drawing"]=p),f["!comments"].length>0&&(w=yt(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ct.VML),r[r.length]=Oe("legacyDrawing",null,{"r:id":"rId"+w}),f["!legacy"]=w),r.length>1&&(r[r.length]="</worksheet>",r[1]=r[1].replace("/>",">")),r.join("")}function T8(e,t){var n={},a=e.l+t;n.r=e.read_shift(4),e.l+=4;var r=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=a,l&7&&(n.level=l&7),l&16&&(n.hidden=!0),l&32&&(n.hpt=r/20),n}function S8(e,t,n){var a=be(145),r=(n["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var l=320;r.hpx?l=Ph(r.hpx)*20:r.hpt&&(l=r.hpt*20),a.write_shift(2,l),a.write_shift(1,0);var o=0;r.level&&(o|=r.level),r.hidden&&(o|=16),(r.hpx||r.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var h=0,f=a.l;a.l+=4;for(var x={r:e,c:0},g=0;g<16;++g)if(!(t.s.c>g+1<<10||t.e.c<g<<10)){for(var p=-1,y=-1,_=g<<10;_<g+1<<10;++_){x.c=_;var w=Array.isArray(n)?(n[x.r]||[])[x.c]:n[bt(x)];w&&(p<0&&(p=_),y=_)}p<0||(++h,a.write_shift(4,p),a.write_shift(4,y))}var b=a.l;return a.l=f,a.write_shift(4,h),a.l=b,a.length>a.l?a.slice(0,a.l):a}function N8(e,t,n,a){var r=S8(a,n,t);(r.length>17||(t["!rows"]||[])[a])&&Ce(e,0,r)}var E8=hi,C8=yl;function j8(){}function k8(e,t){var n={},a=e[e.l];return++e.l,n.above=!(a&64),n.left=!(a&128),e.l+=18,n.name=PA(e),n}function A8(e,t,n){n==null&&(n=be(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),n.write_shift(1,a);for(var r=1;r<3;++r)n.write_shift(1,0);return Fh({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),Jb(e,n),n.slice(0,n.l)}function D8(e){var t=Na(e);return[t]}function O8(e,t,n){return n==null&&(n=be(8)),oi(t,n)}function M8(e){var t=ci(e);return[t]}function R8(e,t,n){return n==null&&(n=be(4)),ui(t,n)}function F8(e){var t=Na(e),n=e.read_shift(1);return[t,n,"b"]}function L8(e,t,n){return n==null&&(n=be(9)),oi(t,n),n.write_shift(1,e.v?1:0),n}function B8(e){var t=ci(e),n=e.read_shift(1);return[t,n,"b"]}function H8(e,t,n){return n==null&&(n=be(5)),ui(t,n),n.write_shift(1,e.v?1:0),n}function P8(e){var t=Na(e),n=e.read_shift(1);return[t,n,"e"]}function I8(e,t,n){return n==null&&(n=be(9)),oi(t,n),n.write_shift(1,e.v),n}function z8(e){var t=ci(e),n=e.read_shift(1);return[t,n,"e"]}function U8(e,t,n){return n==null&&(n=be(8)),ui(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}function V8(e){var t=Na(e),n=e.read_shift(4);return[t,n,"s"]}function K8(e,t,n){return n==null&&(n=be(12)),oi(t,n),n.write_shift(4,t.v),n}function W8(e){var t=ci(e),n=e.read_shift(4);return[t,n,"s"]}function G8(e,t,n){return n==null&&(n=be(8)),ui(t,n),n.write_shift(4,t.v),n}function X8(e){var t=Na(e),n=vl(e);return[t,n,"n"]}function Y8(e,t,n){return n==null&&(n=be(16)),oi(t,n),ai(e.v,n),n}function q8(e){var t=ci(e),n=vl(e);return[t,n,"n"]}function $8(e,t,n){return n==null&&(n=be(12)),ui(t,n),ai(e.v,n),n}function Q8(e){var t=Na(e),n=e_(e);return[t,n,"n"]}function Z8(e,t,n){return n==null&&(n=be(12)),oi(t,n),t_(e.v,n),n}function J8(e){var t=ci(e),n=e_(e);return[t,n,"n"]}function eO(e,t,n){return n==null&&(n=be(8)),ui(t,n),t_(e.v,n),n}function tO(e){var t=Na(e),n=Ux(e);return[t,n,"is"]}function nO(e){var t=Na(e),n=Dn(e);return[t,n,"str"]}function aO(e,t,n){return n==null&&(n=be(12+4*e.v.length)),oi(t,n),hn(e.v,n),n.length>n.l?n.slice(0,n.l):n}function rO(e){var t=ci(e),n=Dn(e);return[t,n,"str"]}function sO(e,t,n){return n==null&&(n=be(8+4*e.v.length)),ui(t,n),hn(e.v,n),n.length>n.l?n.slice(0,n.l):n}function iO(e,t,n){var a=e.l+t,r=Na(e);r.r=n["!row"];var l=e.read_shift(1),o=[r,l,"b"];if(n.cellFormula){e.l+=2;var h=rf(e,a-e.l,n);o[3]=hl(h,null,r,n.supbooks,n)}else e.l=a;return o}function lO(e,t,n){var a=e.l+t,r=Na(e);r.r=n["!row"];var l=e.read_shift(1),o=[r,l,"e"];if(n.cellFormula){e.l+=2;var h=rf(e,a-e.l,n);o[3]=hl(h,null,r,n.supbooks,n)}else e.l=a;return o}function oO(e,t,n){var a=e.l+t,r=Na(e);r.r=n["!row"];var l=vl(e),o=[r,l,"n"];if(n.cellFormula){e.l+=2;var h=rf(e,a-e.l,n);o[3]=hl(h,null,r,n.supbooks,n)}else e.l=a;return o}function cO(e,t,n){var a=e.l+t,r=Na(e);r.r=n["!row"];var l=Dn(e),o=[r,l,"str"];if(n.cellFormula){e.l+=2;var h=rf(e,a-e.l,n);o[3]=hl(h,null,r,n.supbooks,n)}else e.l=a;return o}var uO=hi,hO=yl;function fO(e,t){return t==null&&(t=be(4)),t.write_shift(4,e),t}function dO(e,t){var n=e.l+t,a=hi(e),r=Vx(e),l=Dn(e),o=Dn(e),h=Dn(e);e.l=n;var f={rfx:a,relId:r,loc:l,display:h};return o&&(f.Tooltip=o),f}function xO(e,t){var n=be(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));yl({s:un(e[0]),e:un(e[0])},n),Kx("rId"+t,n);var a=e[1].Target.indexOf("#"),r=a==-1?"":e[1].Target.slice(a+1);return hn(r||"",n),hn(e[1].Tooltip||"",n),hn("",n),n.slice(0,n.l)}function gO(){}function mO(e,t,n){var a=e.l+t,r=n_(e),l=e.read_shift(1),o=[r];if(o[2]=l,n.cellFormula){var h=r8(e,a-e.l,n);o[1]=h}else e.l=a;return o}function pO(e,t,n){var a=e.l+t,r=hi(e),l=[r];if(n.cellFormula){var o=i8(e,a-e.l,n);l[1]=o,e.l=a}else e.l=a;return l}function yO(e,t,n){n==null&&(n=be(18));var a=sf(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,(a.width||10)*256),n.write_shift(4,0);var r=0;return t.hidden&&(r|=1),typeof a.width=="number"&&(r|=2),t.level&&(r|=t.level<<8),n.write_shift(2,r),n}var P_=["left","right","top","bottom","header","footer"];function vO(e){var t={};return P_.forEach(function(n){t[n]=vl(e)}),t}function bO(e,t){return t==null&&(t=be(6*8)),B_(e),P_.forEach(function(n){ai(e[n],t)}),t}function _O(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function wO(e,t,n){n==null&&(n=be(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),n.write_shift(2,a),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function TO(e){var t=be(24);return t.write_shift(4,4),t.write_shift(4,1),yl(e,t),t}function SO(e,t){return t==null&&(t=be(16*4+2)),t.write_shift(2,e.password?b_(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?t.write_shift(4,e[n[0]]!=null&&!e[n[0]]?1:0):t.write_shift(4,e[n[0]]!=null&&e[n[0]]?0:1)}),t}function NO(){}function EO(){}function CO(e,t,n,a,r,l,o){if(t.v===void 0)return!1;var h="";switch(t.t){case"b":h=t.v?"1":"0";break;case"d":t=qn(t),t.z=t.z||Vt[14],t.v=Yn(Ln(t.v)),t.t="n";break;case"n":case"e":h=""+t.v;break;default:h=t.v;break}var f={r:n,c:a};switch(f.s=vs(r.cellXfs,t,r),t.l&&l["!links"].push([bt(f),t.l]),t.c&&l["!comments"].push([bt(f),t.c]),t.t){case"s":case"str":return r.bookSST?(h=$x(r.Strings,t.v,r.revStrings),f.t="s",f.v=h,o?Ce(e,18,G8(t,f)):Ce(e,7,K8(t,f))):(f.t="str",o?Ce(e,17,sO(t,f)):Ce(e,6,aO(t,f))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Ce(e,13,eO(t,f)):Ce(e,2,Z8(t,f)):o?Ce(e,16,$8(t,f)):Ce(e,5,Y8(t,f)),!0;case"b":return f.t="b",o?Ce(e,15,H8(t,f)):Ce(e,4,L8(t,f)),!0;case"e":return f.t="e",o?Ce(e,14,U8(t,f)):Ce(e,3,I8(t,f)),!0}return o?Ce(e,12,R8(t,f)):Ce(e,1,O8(t,f)),!0}function jO(e,t,n,a){var r=Ot(t["!ref"]||"A1"),l,o="",h=[];Ce(e,145);var f=Array.isArray(t),x=r.e.r;t["!rows"]&&(x=Math.max(r.e.r,t["!rows"].length-1));for(var g=r.s.r;g<=x;++g){o=wn(g),N8(e,t,r,g);var p=!1;if(g<=r.e.r)for(var y=r.s.c;y<=r.e.c;++y){g===r.s.r&&(h[y]=An(y)),l=h[y]+o;var _=f?(t[g]||[])[y]:t[l];if(!_){p=!1;continue}p=CO(e,_,g,y,a,t,p)}}Ce(e,146)}function kO(e,t){!t||!t["!merges"]||(Ce(e,177,fO(t["!merges"].length)),t["!merges"].forEach(function(n){Ce(e,176,hO(n))}),Ce(e,178))}function AO(e,t){!t||!t["!cols"]||(Ce(e,390),t["!cols"].forEach(function(n,a){n&&Ce(e,60,yO(a,n))}),Ce(e,391))}function DO(e,t){!t||!t["!ref"]||(Ce(e,648),Ce(e,649,TO(Ot(t["!ref"]))),Ce(e,650))}function OO(e,t,n){t["!links"].forEach(function(a){if(a[1].Target){var r=yt(n,-1,a[1].Target.replace(/#.*$/,""),ct.HLINK);Ce(e,494,xO(a,r))}}),delete t["!links"]}function MO(e,t,n,a){if(t["!comments"].length>0){var r=yt(a,-1,"../drawings/vmlDrawing"+(n+1)+".vml",ct.VML);Ce(e,551,Kx("rId"+r)),t["!legacy"]=r}}function RO(e,t,n,a){if(t["!autofilter"]){var r=t["!autofilter"],l=typeof r.ref=="string"?r.ref:$t(r.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,h=oa(l);h.s.r==h.e.r&&(h.e.r=oa(t["!ref"]).e.r,l=$t(h));for(var f=0;f<o.length;++f){var x=o[f];if(x.Name=="_xlnm._FilterDatabase"&&x.Sheet==a){x.Ref="'"+n.SheetNames[a]+"'!"+l;break}}f==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+n.SheetNames[a]+"'!"+l}),Ce(e,161,yl(Ot(l))),Ce(e,162)}}function FO(e,t,n){Ce(e,133),Ce(e,137,wO(t,n)),Ce(e,138),Ce(e,134)}function LO(e,t){t["!protect"]&&Ce(e,535,SO(t["!protect"]))}function BO(e,t,n,a){var r=Xn(),l=n.SheetNames[e],o=n.Sheets[l]||{},h=l;try{n&&n.Workbook&&(h=n.Workbook.Sheets[e].CodeName||h)}catch{}var f=Ot(o["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Ce(r,129),(n.vbaraw||o["!outline"])&&Ce(r,147,A8(h,o["!outline"])),Ce(r,148,C8(f)),FO(r,o,n.Workbook),AO(r,o),jO(r,o,e,t),LO(r,o),RO(r,o,n,e),kO(r,o),OO(r,o,a),o["!margins"]&&Ce(r,476,bO(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&DO(r,o),MO(r,o,e,a),Ce(r,130),r.end()}function HO(e,t){e.l+=10;var n=Dn(e);return{name:n}}var PO=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function IO(e){return!e.Workbook||!e.Workbook.WBProps?"false":pA(e.Workbook.WBProps.date1904)?"true":"false"}var zO="][*?/\\".split("");function I_(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return zO.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}function UO(e,t,n){e.forEach(function(a,r){I_(a);for(var l=0;l<r;++l)if(a==e[l])throw new Error("Duplicate Sheet Name: "+a);if(n){var o=t&&t[r]&&t[r].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function VO(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];UO(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)h8(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}function z_(e){var t=[Qt];t[t.length]=Oe("workbook",null,{xmlns:ml[0],"xmlns:r":cn.r});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(PO.forEach(function(h){e.Workbook.WBProps[h[0]]!=null&&e.Workbook.WBProps[h[0]]!=h[1]&&(a[h[0]]=e.Workbook.WBProps[h[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Oe("workbookPr",null,a);var r=e.Workbook&&e.Workbook.Sheets||[],l=0;if(r&&r[0]&&r[0].Hidden){for(t[t.length]="<bookViews>",l=0;l!=e.SheetNames.length&&!(!r[l]||!r[l].Hidden);++l);l==e.SheetNames.length&&(l=0),t[t.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",l=0;l!=e.SheetNames.length;++l){var o={name:vt(e.SheetNames[l].slice(0,31))};if(o.sheetId=""+(l+1),o["r:id"]="rId"+(l+1),r[l])switch(r[l].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Oe("sheet",null,o)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(h){var f={name:h.Name};h.Comment&&(f.comment=h.Comment),h.Sheet!=null&&(f.localSheetId=""+h.Sheet),h.Hidden&&(f.hidden="1"),h.Ref&&(t[t.length]=Oe("definedName",vt(h.Ref),f))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function KO(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=ax(e),n.name=Dn(e),n}function WO(e,t){return t||(t=be(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Kx(e.strRelID,t),hn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function GO(e,t){var n={},a=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var r=t>8?Dn(e):"";return r.length>0&&(n.CodeName=r),n.autoCompressPictures=!!(a&65536),n.backupFile=!!(a&64),n.checkCompatibility=!!(a&4096),n.date1904=!!(a&1),n.filterPrivacy=!!(a&8),n.hidePivotFieldList=!!(a&1024),n.promptedSolutions=!!(a&16),n.publishItems=!!(a&2048),n.refreshAllConnections=!!(a&262144),n.saveExternalLinkValues=!!(a&128),n.showBorderUnselectedTables=!!(a&4),n.showInkAnnotation=!!(a&32),n.showObjects=["all","placeholders","none"][a>>13&3],n.showPivotChartFilter=!!(a&32768),n.updateLinks=["userSet","never","always"][a>>8&3],n}function XO(e,t){t||(t=be(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),Jb(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function YO(e,t,n){var a=e.l+t;e.l+=4,e.l+=1;var r=e.read_shift(4),l=IA(e),o=s8(e,0,n),h=Vx(e);e.l=a;var f={Name:l,Ptg:o};return r<268435455&&(f.Sheet=r),h&&(f.Comment=h),f}function qO(e,t){Ce(e,143);for(var n=0;n!=t.SheetNames.length;++n){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,r={Hidden:a,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]};Ce(e,156,WO(r))}Ce(e,144)}function $O(e,t){t||(t=be(127));for(var n=0;n!=4;++n)t.write_shift(4,0);return hn("SheetJS",t),hn(jh.version,t),hn(jh.version,t),hn("7262",t),t.length>t.l?t.slice(0,t.l):t}function QO(e,t){t||(t=be(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var n=120;return t.write_shift(1,n),t.length>t.l?t.slice(0,t.l):t}function ZO(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var n=t.Workbook.Sheets,a=0,r=-1,l=-1;a<n.length;++a)!n[a]||!n[a].Hidden&&r==-1?r=a:n[a].Hidden==1&&l==-1&&(l=a);l>r||(Ce(e,135),Ce(e,158,QO(r)),Ce(e,136))}}function JO(e,t){var n=Xn();return Ce(n,131),Ce(n,128,$O()),Ce(n,153,XO(e.Workbook&&e.Workbook.WBProps||null)),ZO(n,e),qO(n,e),Ce(n,132),n.end()}function eM(e,t,n){return(t.slice(-4)===".bin"?JO:z_)(e)}function tM(e,t,n,a,r){return(t.slice(-4)===".bin"?BO:H_)(e,n,a,r)}function nM(e,t,n){return(t.slice(-4)===".bin"?b5:T_)(e,n)}function aM(e,t,n){return(t.slice(-4)===".bin"?X6:v_)(e,n)}function rM(e,t,n){return(t.slice(-4)===".bin"?L5:j_)(e)}function sM(e){return(e.slice(-4)===".bin"?j5:E_)()}function iM(e,t){var n=[];return e.Props&&n.push(n6(e.Props,t)),e.Custprops&&n.push(a6(e.Props,e.Custprops)),n.join("")}function lM(){return""}function oM(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,r){var l=[];l.push(Oe("NumberFormat",null,{"ss:Format":vt(Vt[a.numFmtId])}));var o={"ss:ID":"s"+(21+r)};n.push(Oe("Style",l.join(""),o))}),Oe("Styles",n.join(""))}function U_(e){return Oe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Yx(e.Ref,{r:0,c:0})})}function cM(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],a=0;a<t.length;++a){var r=t[a];r.Sheet==null&&(r.Name.match(/^_xlfn\./)||n.push(U_(r)))}return Oe("Names",n.join(""))}function uM(e,t,n,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var r=a.Workbook.Names,l=[],o=0;o<r.length;++o){var h=r[o];h.Sheet==n&&(h.Name.match(/^_xlfn\./)||l.push(U_(h)))}return l.join("")}function hM(e,t,n,a){if(!e)return"";var r=[];if(e["!margins"]&&(r.push("<PageSetup>"),e["!margins"].header&&r.push(Oe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&r.push(Oe("Footer",null,{"x:Margin":e["!margins"].footer})),r.push(Oe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),r.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[n])if(a.Workbook.Sheets[n].Hidden)r.push(Oe("Visible",a.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<n&&!(a.Workbook.Sheets[l]&&!a.Workbook.Sheets[l].Hidden);++l);l==n&&r.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&r.push("<DisplayRightToLeft/>"),e["!protect"]&&(r.push(bn("ProtectContents","True")),e["!protect"].objects&&r.push(bn("ProtectObjects","True")),e["!protect"].scenarios&&r.push(bn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?r.push(bn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&r.push(bn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&r.push("<"+o[1]+"/>")})),r.length==0?"":Oe("WorksheetOptions",r.join(""),{xmlns:sa.x})}function fM(e){return e.map(function(t){var n=mA(t.t||""),a=Oe("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return Oe("Comment",a,{"ss:Author":t.a})}).join("")}function dM(e,t,n,a,r,l,o){if(!e||e.v==null&&e.f==null)return"";var h={};if(e.f&&(h["ss:Formula"]="="+vt(Yx(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var f=un(e.F.slice(t.length+1));h["ss:ArrayRange"]="RC:R"+(f.r==o.r?"":"["+(f.r-o.r)+"]")+"C"+(f.c==o.c?"":"["+(f.c-o.c)+"]")}if(e.l&&e.l.Target&&(h["ss:HRef"]=vt(e.l.Target),e.l.Tooltip&&(h["x:HRefScreenTip"]=vt(e.l.Tooltip))),n["!merges"])for(var x=n["!merges"],g=0;g!=x.length;++g)x[g].s.c!=o.c||x[g].s.r!=o.r||(x[g].e.c>x[g].s.c&&(h["ss:MergeAcross"]=x[g].e.c-x[g].s.c),x[g].e.r>x[g].s.r&&(h["ss:MergeDown"]=x[g].e.r-x[g].s.r));var p="",y="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":p="Number",y=String(e.v);break;case"b":p="Boolean",y=e.v?"1":"0";break;case"e":p="Error",y=_c[e.v];break;case"d":p="DateTime",y=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Vt[14]);break;case"s":p="String",y=gA(e.v||"");break}var _=vs(a.cellXfs,e,a);h["ss:StyleID"]="s"+(21+_),h["ss:Index"]=o.c+1;var w=e.v!=null?y:"",b=e.t=="z"?"":'<Data ss:Type="'+p+'">'+w+"</Data>";return(e.c||[]).length>0&&(b+=fM(e.c)),Oe("Cell",b,h)}function xM(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=w_(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function gM(e,t,n,a){if(!e["!ref"])return"";var r=Ot(e["!ref"]),l=e["!merges"]||[],o=0,h=[];e["!cols"]&&e["!cols"].forEach(function(T,S){Gx(T);var E=!!T.width,C=sf(S,T),A={"ss:Index":S+1};E&&(A["ss:Width"]=Bh(C.width)),T.hidden&&(A["ss:Hidden"]="1"),h.push(Oe("Column",null,A))});for(var f=Array.isArray(e),x=r.s.r;x<=r.e.r;++x){for(var g=[xM(x,(e["!rows"]||[])[x])],p=r.s.c;p<=r.e.c;++p){var y=!1;for(o=0;o!=l.length;++o)if(!(l[o].s.c>p)&&!(l[o].s.r>x)&&!(l[o].e.c<p)&&!(l[o].e.r<x)){(l[o].s.c!=p||l[o].s.r!=x)&&(y=!0);break}if(!y){var _={r:x,c:p},w=bt(_),b=f?(e[x]||[])[p]:e[w];g.push(dM(b,w,e,t,n,a,_))}}g.push("</Row>"),g.length>2&&h.push(g.join(""))}return h.join("")}function mM(e,t,n){var a=[],r=n.SheetNames[e],l=n.Sheets[r],o=l?uM(l,t,e,n):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=l?gM(l,t,e,n):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(hM(l,t,e,n)),a.join("")}function pM(e,t){t||(t={}),e.SSF||(e.SSF=qn(Vt)),e.SSF&&(ef(),Jh(e.SSF),t.revssf=tf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],vs(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(iM(e,t)),n.push(lM()),n.push(""),n.push("");for(var a=0;a<e.SheetNames.length;++a)n.push(Oe("Worksheet",mM(a,t,e),{"ss:Name":vt(e.SheetNames[a])}));return n[2]=oM(e,t),n[3]=cM(e),Qt+Oe("Workbook",n.join(""),{xmlns:sa.ss,"xmlns:o":sa.o,"xmlns:x":sa.x,"xmlns:ss":sa.ss,"xmlns:dt":sa.dt,"xmlns:html":sa.html})}var Pd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function yM(e,t){var n=[],a=[],r=[],l=0,o,h=Sv(Bv,"n"),f=Sv(Hv,"n");if(e.Props)for(o=Tn(e.Props),l=0;l<o.length;++l)(Object.prototype.hasOwnProperty.call(h,o[l])?n:Object.prototype.hasOwnProperty.call(f,o[l])?a:r).push([o[l],e.Props[o[l]]]);if(e.Custprops)for(o=Tn(e.Custprops),l=0;l<o.length;++l)Object.prototype.hasOwnProperty.call(e.Props||{},o[l])||(Object.prototype.hasOwnProperty.call(h,o[l])?n:Object.prototype.hasOwnProperty.call(f,o[l])?a:r).push([o[l],e.Custprops[o[l]]]);var x=[];for(l=0;l<r.length;++l)f_.indexOf(r[l][0])>-1||c_.indexOf(r[l][0])>-1||r[l][1]!=null&&x.push(r[l]);a.length&&Et.utils.cfb_add(t,"/SummaryInformation",Vv(a,Pd.SI,f,Hv)),(n.length||x.length)&&Et.utils.cfb_add(t,"/DocumentSummaryInformation",Vv(n,Pd.DSI,h,Bv,x.length?x:null,Pd.UDI))}function vM(e,t){var n=t||{},a=Et.utils.cfb_new({root:"R"}),r="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":r="/Workbook",n.biff=8;break;case"biff5":r="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return Et.utils.cfb_add(a,r,V_(e,n)),n.biff==8&&(e.Props||e.Custprops)&&yM(e,a),n.biff==8&&e.vbaraw&&B5(a,Et.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var bM={0:{f:T8},1:{f:D8},2:{f:Q8},3:{f:P8},4:{f:F8},5:{f:X8},6:{f:nO},7:{f:V8},8:{f:cO},9:{f:oO},10:{f:iO},11:{f:lO},12:{f:M8},13:{f:J8},14:{f:z8},15:{f:B8},16:{f:q8},17:{f:rO},18:{f:W8},19:{f:Ux},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:YO},40:{},42:{},43:{f:n5},44:{f:e5},45:{f:s5},46:{f:l5},47:{f:i5},48:{},49:{f:MA},50:{},51:{f:T5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:R6},62:{f:tO},63:{f:k5},64:{f:NO},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:tr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:_O},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:k8},148:{f:E8,p:16},151:{f:gO},152:{},153:{f:GO},154:{},155:{},156:{f:KO},157:{},158:{},159:{T:1,f:K6},160:{T:-1},161:{T:1,f:hi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:uO},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:_5},336:{T:-1},337:{f:E5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ax},357:{},358:{},359:{},360:{T:1},361:{},362:{f:j6},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:mO},427:{f:pO},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:vO},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:j8},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:dO},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ax},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:R5},633:{T:1},634:{T:-1},635:{T:1,f:O5},636:{T:-1},637:{f:BA},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:HO},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:EO},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Me(e,t,n,a){var r=t;if(!isNaN(r)){var l=a||(n||[]).length||0,o=e.next(4);o.write_shift(2,r),o.write_shift(2,l),l>0&&Px(n)&&e.push(n)}}function _M(e,t,n,a){var r=(n||[]).length||0;if(r<=8224)return Me(e,t,n,r);var l=t;if(!isNaN(l)){for(var o=n.parts||[],h=0,f=0,x=0;x+(o[h]||8224)<=8224;)x+=o[h]||8224,h++;var g=e.next(4);for(g.write_shift(2,l),g.write_shift(2,x),e.push(n.slice(f,f+x)),f+=x;f<r;){for(g=e.next(4),g.write_shift(2,60),x=0;x+(o[h]||8224)<=8224;)x+=o[h]||8224,h++;g.write_shift(2,x),e.push(n.slice(f,f+x)),f+=x}}}function Tc(e,t,n){return e||(e=be(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function wM(e,t,n,a){var r=be(9);return Tc(r,e,t),x_(n,a||"b",r),r}function TM(e,t,n){var a=be(8+2*n.length);return Tc(a,e,t),a.write_shift(1,n.length),a.write_shift(n.length,n,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function SM(e,t,n,a){if(t.v!=null)switch(t.t){case"d":case"n":var r=t.t=="d"?Yn(Ln(t.v)):t.v;r==(r|0)&&r>=0&&r<65536?Me(e,2,H6(n,a,r)):Me(e,3,B6(n,a,r));return;case"b":case"e":Me(e,5,wM(n,a,t.v,t.t));return;case"s":case"str":Me(e,4,TM(n,a,(t.v||"").slice(0,255)));return}Me(e,1,Tc(null,n,a))}function NM(e,t,n,a){var r=Array.isArray(t),l=Ot(t["!ref"]||"A1"),o,h="",f=[];if(l.e.c>255||l.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),o=$t(l)}for(var x=l.s.r;x<=l.e.r;++x){h=wn(x);for(var g=l.s.c;g<=l.e.c;++g){x===l.s.r&&(f[g]=An(g)),o=f[g]+h;var p=r?(t[x]||[])[g]:t[o];p&&SM(e,p,x,g)}}}function EM(e,t){for(var n=t||{},a=Xn(),r=0,l=0;l<e.SheetNames.length;++l)e.SheetNames[l]==n.sheet&&(r=l);if(r==0&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return Me(a,n.biff==4?1033:n.biff==3?521:9,Wx(e,16,n)),NM(a,e.Sheets[e.SheetNames[r]],r,n),Me(a,10),a.end()}function CM(e,t,n){Me(e,49,b6({sz:12,name:"Arial"},n))}function jM(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var r=a[0];r<=a[1];++r)t[r]!=null&&Me(e,1054,T6(r,t[r],n))})}function kM(e,t){var n=be(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),Me(e,2151,n),n=be(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),p_(Ot(t["!ref"]||"A1"),n),n.write_shift(4,4),Me(e,2152,n)}function AM(e,t){for(var n=0;n<16;++n)Me(e,224,Wv({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Me(e,224,Wv(a,0,t))})}function DM(e,t){for(var n=0;n<t["!links"].length;++n){var a=t["!links"][n];Me(e,440,D6(a)),a[1].Tooltip&&Me(e,2048,O6(a))}delete t["!links"]}function OM(e,t){if(t){var n=0;t.forEach(function(a,r){++n<=256&&a&&Me(e,125,F6(sf(r,a),r))})}}function MM(e,t,n,a,r){var l=16+vs(r.cellXfs,t,r);if(t.v==null&&!t.bf){Me(e,513,ri(n,a,l));return}if(t.bf)Me(e,6,a8(t,n,a,r,l));else switch(t.t){case"d":case"n":var o=t.t=="d"?Yn(Ln(t.v)):t.v;Me(e,515,C6(n,a,o,l));break;case"b":case"e":Me(e,517,E6(n,a,t.v,l,r,t.t));break;case"s":case"str":if(r.bookSST){var h=$x(r.Strings,t.v,r.revStrings);Me(e,253,_6(n,a,h,l))}else Me(e,516,w6(n,a,(t.v||"").slice(0,255),l,r));break;default:Me(e,513,ri(n,a,l))}}function RM(e,t,n){var a=Xn(),r=n.SheetNames[e],l=n.Sheets[r]||{},o=(n||{}).Workbook||{},h=(o.Sheets||[])[e]||{},f=Array.isArray(l),x=t.biff==8,g,p="",y=[],_=Ot(l["!ref"]||"A1"),w=x?65536:16384;if(_.e.c>255||_.e.r>=w){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,w-1)}Me(a,2057,Wx(n,16,t)),Me(a,13,wa(1)),Me(a,12,wa(100)),Me(a,15,Fn(!0)),Me(a,17,Fn(!1)),Me(a,16,ai(.001)),Me(a,95,Fn(!0)),Me(a,42,Fn(!1)),Me(a,43,Fn(!1)),Me(a,130,wa(1)),Me(a,128,N6()),Me(a,131,Fn(!1)),Me(a,132,Fn(!1)),x&&OM(a,l["!cols"]),Me(a,512,S6(_,t)),x&&(l["!links"]=[]);for(var b=_.s.r;b<=_.e.r;++b){p=wn(b);for(var T=_.s.c;T<=_.e.c;++T){b===_.s.r&&(y[T]=An(T)),g=y[T]+p;var S=f?(l[b]||[])[T]:l[g];S&&(MM(a,S,b,T,t),x&&S.l&&l["!links"].push([g,S.l]))}}var E=h.CodeName||h.name||r;return x&&Me(a,574,v6((o.Views||[])[0])),x&&(l["!merges"]||[]).length&&Me(a,229,A6(l["!merges"])),x&&DM(a,l),Me(a,442,m_(E)),x&&kM(a,l),Me(a,10),a.end()}function FM(e,t,n){var a=Xn(),r=(e||{}).Workbook||{},l=r.Sheets||[],o=r.WBProps||{},h=n.biff==8,f=n.biff==5;if(Me(a,2057,Wx(e,5,n)),n.bookType=="xla"&&Me(a,135),Me(a,225,h?wa(1200):null),Me(a,193,i6(2)),f&&Me(a,191),f&&Me(a,192),Me(a,226),Me(a,92,g6("SheetJS",n)),Me(a,66,wa(h?1200:1252)),h&&Me(a,353,wa(0)),h&&Me(a,448),Me(a,317,L6(e.SheetNames.length)),h&&e.vbaraw&&Me(a,211),h&&e.vbaraw){var x=o.CodeName||"ThisWorkbook";Me(a,442,m_(x))}Me(a,156,wa(17)),Me(a,25,Fn(!1)),Me(a,18,Fn(!1)),Me(a,19,wa(0)),h&&Me(a,431,Fn(!1)),h&&Me(a,444,wa(0)),Me(a,61,y6()),Me(a,64,Fn(!1)),Me(a,141,wa(0)),Me(a,34,Fn(IO(e)=="true")),Me(a,14,Fn(!0)),h&&Me(a,439,Fn(!1)),Me(a,218,wa(0)),CM(a,e,n),jM(a,e.SSF,n),AM(a,n),h&&Me(a,352,Fn(!1));var g=a.end(),p=Xn();h&&Me(p,140,M6()),h&&n.Strings&&_M(p,252,p6(n.Strings)),Me(p,10);var y=p.end(),_=Xn(),w=0,b=0;for(b=0;b<e.SheetNames.length;++b)w+=(h?12:11)+(h?2:1)*e.SheetNames[b].length;var T=g.length+w+y.length;for(b=0;b<e.SheetNames.length;++b){var S=l[b]||{};Me(_,133,m6({pos:T,hs:S.Hidden||0,dt:0,name:e.SheetNames[b]},n)),T+=t[b].length}var E=_.end();if(w!=E.length)throw new Error("BS8 "+w+" != "+E.length);var C=[];return g.length&&C.push(g),E.length&&C.push(E),y.length&&C.push(y),vn(C)}function LM(e,t){var n=t||{},a=[];e&&!e.SSF&&(e.SSF=qn(Vt)),e&&e.SSF&&(ef(),Jh(e.SSF),n.revssf=tf(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Qx(n),n.cellXfs=[],vs(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var r=0;r<e.SheetNames.length;++r)a[a.length]=RM(r,n,e);return a.unshift(FM(e,a,n)),vn(a)}function V_(e,t){for(var n=0;n<=e.SheetNames.length;++n){var a=e.Sheets[e.SheetNames[n]];if(!(!a||!a["!ref"])){var r=oa(a["!ref"]);r.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var l=t||{};switch(l.biff||2){case 8:case 5:return LM(e,t);case 4:case 3:case 2:return EM(e,t)}throw new Error("invalid type "+l.bookType+" for BIFF")}function BM(e,t,n,a){for(var r=e["!merges"]||[],l=[],o=t.s.c;o<=t.e.c;++o){for(var h=0,f=0,x=0;x<r.length;++x)if(!(r[x].s.r>n||r[x].s.c>o)&&!(r[x].e.r<n||r[x].e.c<o)){if(r[x].s.r<n||r[x].s.c<o){h=-1;break}h=r[x].e.r-r[x].s.r+1,f=r[x].e.c-r[x].s.c+1;break}if(!(h<0)){var g=bt({r:n,c:o}),p=a.dense?(e[n]||[])[o]:e[g],y=p&&p.v!=null&&(p.h||xA(p.w||(Mr(p),p.w)||""))||"",_={};h>1&&(_.rowspan=h),f>1&&(_.colspan=f),a.editable?y='<span contenteditable="true">'+y+"</span>":p&&(_["data-t"]=p&&p.t||"z",p.v!=null&&(_["data-v"]=p.v),p.z!=null&&(_["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+p.l.Target+'">'+y+"</a>")),_.id=(a.id||"sjs")+"-"+g,l.push(Oe("td",y,_))}}var w="<tr>";return w+l.join("")+"</tr>"}var HM='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',PM="</body></html>";function IM(e,t,n){var a=[];return a.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function K_(e,t){var n=t||{},a=n.header!=null?n.header:HM,r=n.footer!=null?n.footer:PM,l=[a],o=oa(e["!ref"]);n.dense=Array.isArray(e),l.push(IM(e,o,n));for(var h=o.s.r;h<=o.e.r;++h)l.push(BM(e,o,h,n));return l.push("</table>"+r),l.join("")}function W_(e,t,n){var a=n||{},r=0,l=0;if(a.origin!=null)if(typeof a.origin=="number")r=a.origin;else{var o=typeof a.origin=="string"?un(a.origin):a.origin;r=o.r,l=o.c}var h=t.getElementsByTagName("tr"),f=Math.min(a.sheetRows||1e7,h.length),x={s:{r:0,c:0},e:{r,c:l}};if(e["!ref"]){var g=oa(e["!ref"]);x.s.r=Math.min(x.s.r,g.s.r),x.s.c=Math.min(x.s.c,g.s.c),x.e.r=Math.max(x.e.r,g.e.r),x.e.c=Math.max(x.e.c,g.e.c),r==-1&&(x.e.r=r=g.e.r+1)}var p=[],y=0,_=e["!rows"]||(e["!rows"]=[]),w=0,b=0,T=0,S=0,E=0,C=0;for(e["!cols"]||(e["!cols"]=[]);w<h.length&&b<f;++w){var A=h[w];if(Zv(A)){if(a.display)continue;_[b]={hidden:!0}}var F=A.children;for(T=S=0;T<F.length;++T){var K=F[T];if(!(a.display&&Zv(K))){var O=K.hasAttribute("data-v")?K.getAttribute("data-v"):K.hasAttribute("v")?K.getAttribute("v"):yA(K.innerHTML),P=K.getAttribute("data-z")||K.getAttribute("z");for(y=0;y<p.length;++y){var M=p[y];M.s.c==S+l&&M.s.r<b+r&&b+r<=M.e.r&&(S=M.e.c+1-l,y=-1)}C=+K.getAttribute("colspan")||1,((E=+K.getAttribute("rowspan")||1)>1||C>1)&&p.push({s:{r:b+r,c:S+l},e:{r:b+r+(E||1)-1,c:S+l+(C||1)-1}});var B={t:"s",v:O},I=K.getAttribute("data-t")||K.getAttribute("t")||"";O!=null&&(O.length==0?B.t=I||"z":a.raw||O.trim().length==0||I=="s"||(O==="TRUE"?B={t:"b",v:!0}:O==="FALSE"?B={t:"b",v:!1}:isNaN(kr(O))?isNaN(uc(O).getDate())||(B={t:"d",v:Ln(O)},a.cellDates||(B={t:"n",v:Yn(B.v)}),B.z=a.dateNF||Vt[14]):B={t:"n",v:kr(O)})),B.z===void 0&&P!=null&&(B.z=P);var te="",q=K.getElementsByTagName("A");if(q&&q.length)for(var ae=0;ae<q.length&&!(q[ae].hasAttribute("href")&&(te=q[ae].getAttribute("href"),te.charAt(0)!="#"));++ae);te&&te.charAt(0)!="#"&&(B.l={Target:te}),a.dense?(e[b+r]||(e[b+r]=[]),e[b+r][S+l]=B):e[bt({c:S+l,r:b+r})]=B,x.e.c<S+l&&(x.e.c=S+l),S+=C}}++b}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),x.e.r=Math.max(x.e.r,b-1+r),e["!ref"]=$t(x),b>=f&&(e["!fullref"]=$t((x.e.r=h.length-w+b-1+r,x))),e}function G_(e,t){var n=t||{},a=n.dense?[]:{};return W_(a,e,t)}function zM(e,t){return li(G_(e,t),t)}function Zv(e){var t="",n=UM(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function UM(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var VM=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+fc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Qt+t}}(),Jv=function(){var e=function(l){return vt(l).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,a=function(l,o,h){var f=[];f.push('      <table:table table:name="'+vt(o.SheetNames[h])+`" table:style-name="ta1">
`);var x=0,g=0,p=oa(l["!ref"]||"A1"),y=l["!merges"]||[],_=0,w=Array.isArray(l);if(l["!cols"])for(g=0;g<=p.e.c;++g)f.push("        <table:table-column"+(l["!cols"][g]?' table:style-name="co'+l["!cols"][g].ods+'"':"")+`></table:table-column>
`);var b="",T=l["!rows"]||[];for(x=0;x<p.s.r;++x)b=T[x]?' table:style-name="ro'+T[x].ods+'"':"",f.push("        <table:table-row"+b+`></table:table-row>
`);for(;x<=p.e.r;++x){for(b=T[x]?' table:style-name="ro'+T[x].ods+'"':"",f.push("        <table:table-row"+b+`>
`),g=0;g<p.s.c;++g)f.push(t);for(;g<=p.e.c;++g){var S=!1,E={},C="";for(_=0;_!=y.length;++_)if(!(y[_].s.c>g)&&!(y[_].s.r>x)&&!(y[_].e.c<g)&&!(y[_].e.r<x)){(y[_].s.c!=g||y[_].s.r!=x)&&(S=!0),E["table:number-columns-spanned"]=y[_].e.c-y[_].s.c+1,E["table:number-rows-spanned"]=y[_].e.r-y[_].s.r+1;break}if(S){f.push(n);continue}var A=bt({r:x,c:g}),F=w?(l[x]||[])[g]:l[A];if(F&&F.f&&(E["table:formula"]=vt(c8(F.f)),F.F&&F.F.slice(0,A.length)==A)){var K=oa(F.F);E["table:number-matrix-columns-spanned"]=K.e.c-K.s.c+1,E["table:number-matrix-rows-spanned"]=K.e.r-K.s.r+1}if(!F){f.push(t);continue}switch(F.t){case"b":C=F.v?"TRUE":"FALSE",E["office:value-type"]="boolean",E["office:boolean-value"]=F.v?"true":"false";break;case"n":C=F.w||String(F.v||0),E["office:value-type"]="float",E["office:value"]=F.v||0;break;case"s":case"str":C=F.v==null?"":F.v,E["office:value-type"]="string";break;case"d":C=F.w||Ln(F.v).toISOString(),E["office:value-type"]="date",E["office:date-value"]=Ln(F.v).toISOString(),E["table:style-name"]="ce1";break;default:f.push(t);continue}var O=e(C);if(F.l&&F.l.Target){var P=F.l.Target;P=P.charAt(0)=="#"?"#"+u8(P.slice(1)):P,P.charAt(0)!="#"&&!P.match(/^\w+:/)&&(P="../"+P),O=Oe("text:a",O,{"xlink:href":P.replace(/&/g,"&amp;")})}f.push("          "+Oe("table:table-cell",Oe("text:p",O,{}),E)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},r=function(l,o){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var h=0;o.SheetNames.map(function(x){return o.Sheets[x]}).forEach(function(x){if(x&&x["!cols"]){for(var g=0;g<x["!cols"].length;++g)if(x["!cols"][g]){var p=x["!cols"][g];if(p.width==null&&p.wpx==null&&p.wch==null)continue;Gx(p),p.ods=h;var y=x["!cols"][g].wpx+"px";l.push('  <style:style style:name="co'+h+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),l.push(`  </style:style>
`),++h}}});var f=0;o.SheetNames.map(function(x){return o.Sheets[x]}).forEach(function(x){if(x&&x["!rows"]){for(var g=0;g<x["!rows"].length;++g)if(x["!rows"][g]){x["!rows"][g].ods=f;var p=x["!rows"][g].hpx+"px";l.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),l.push(`  </style:style>
`),++f}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(o,h){var f=[Qt],x=fc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),g=fc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});h.bookType=="fods"?(f.push("<office:document"+x+g+`>
`),f.push(l_().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+x+`>
`),r(f,o),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var p=0;p!=o.SheetNames.length;++p)f.push(a(o.Sheets[o.SheetNames[p]],o,p));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),h.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}}();function X_(e,t){if(t.bookType=="fods")return Jv(e,t);var n=Fx(),a="",r=[],l=[];return a="mimetype",$e(n,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",$e(n,a,Jv(e,t)),r.push([a,"text/xml"]),l.push([a,"ContentFile"]),a="styles.xml",$e(n,a,VM(e,t)),r.push([a,"text/xml"]),l.push([a,"StylesFile"]),a="meta.xml",$e(n,a,Qt+l_()),r.push([a,"text/xml"]),l.push([a,"MetadataFile"]),a="manifest.rdf",$e(n,a,t6(l)),r.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",$e(n,a,JA(r)),n}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ih(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function KM(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ra(hc(e))}function WM(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var a=0;a<t.length;++a)if(e[n+a]!=t[a])continue e;return!0}return!1}function ys(e){var t=e.reduce(function(r,l){return r+l.length},0),n=new Uint8Array(t),a=0;return e.forEach(function(r){n.set(r,a),a+=r.length}),n}function GM(e,t,n){var a=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,r=n/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var l=0;r>=1;++l,r/=256)e[t+l]=r&255;e[t+15]|=n>=0?0:128}function dc(e,t){var n=t?t[0]:0,a=e[n]&127;e:if(e[n++]>=128&&(a|=(e[n]&127)<<7,e[n++]<128||(a|=(e[n]&127)<<14,e[n++]<128)||(a|=(e[n]&127)<<21,e[n++]<128)||(a+=(e[n]&127)*Math.pow(2,28),++n,e[n++]<128)||(a+=(e[n]&127)*Math.pow(2,35),++n,e[n++]<128)||(a+=(e[n]&127)*Math.pow(2,42),++n,e[n++]<128)))break e;return t&&(t[0]=n),a}function pt(e){var t=new Uint8Array(7);t[0]=e&127;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383||(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)||(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)||(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)||(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103))break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function ol(e){var t=0,n=e[t]&127;e:if(e[t++]>=128){if(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128))break e;n|=(e[t]&127)<<28}return n}function en(e){for(var t=[],n=[0];n[0]<e.length;){var a=n[0],r=dc(e,n),l=r&7;r=Math.floor(r/8);var o=0,h;if(r==0)break;switch(l){case 0:{for(var f=n[0];e[n[0]++]>=128;);h=e.slice(f,n[0])}break;case 5:o=4,h=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,h=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=dc(e,n),h=e.slice(n[0],n[0]+o),n[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(r," at offset ").concat(a))}var x={data:h,type:l};t[r]==null?t[r]=[x]:t[r].push(x)}return t}function pn(e){var t=[];return e.forEach(function(n,a){n.forEach(function(r){r.data&&(t.push(pt(a*8+r.type)),r.type==2&&t.push(pt(r.data.length)),t.push(r.data))})}),ys(t)}function Oa(e){for(var t,n=[],a=[0];a[0]<e.length;){var r=dc(e,a),l=en(e.slice(a[0],a[0]+r));a[0]+=r;var o={id:ol(l[1][0].data),messages:[]};l[2].forEach(function(h){var f=en(h.data),x=ol(f[3][0].data);o.messages.push({meta:f,data:e.slice(a[0],a[0]+x)}),a[0]+=x}),(t=l[3])!=null&&t[0]&&(o.merge=ol(l[3][0].data)>>>0>0),n.push(o)}return n}function $i(e){var t=[];return e.forEach(function(n){var a=[];a[1]=[{data:pt(n.id),type:0}],a[2]=[],n.merge!=null&&(a[3]=[{data:pt(+!!n.merge),type:0}]);var r=[];n.messages.forEach(function(o){r.push(o.data),o.meta[3]=[{type:0,data:pt(o.data.length)}],a[2].push({data:pn(o.meta),type:2})});var l=pn(a);t.push(pt(l.length)),t.push(l),r.forEach(function(o){return t.push(o)})}),ys(t)}function XM(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],a=dc(t,n),r=[];n[0]<t.length;){var l=t[n[0]]&3;if(l==0){var o=t[n[0]++]>>2;if(o<60)++o;else{var h=o-59;o=t[n[0]],h>1&&(o|=t[n[0]+1]<<8),h>2&&(o|=t[n[0]+2]<<16),h>3&&(o|=t[n[0]+3]<<24),o>>>=0,o++,n[0]+=h}r.push(t.slice(n[0],n[0]+o)),n[0]+=o;continue}else{var f=0,x=0;if(l==1?(x=(t[n[0]]>>2&7)+4,f=(t[n[0]++]&224)<<3,f|=t[n[0]++]):(x=(t[n[0]++]>>2)+1,l==2?(f=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(f=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),r=[ys(r)],f==0)throw new Error("Invalid offset 0");if(f>r[0].length)throw new Error("Invalid offset beyond length");if(x>=f)for(r.push(r[0].slice(-f)),x-=f;x>=r[r.length-1].length;)r.push(r[r.length-1]),x-=r[r.length-1].length;r.push(r[0].slice(-f,-f+x))}}var g=ys(r);if(g.length!=a)throw new Error("Unexpected length: ".concat(g.length," != ").concat(a));return g}function Ma(e){for(var t=[],n=0;n<e.length;){var a=e[n++],r=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(XM(a,e.slice(n,n+r))),n+=r}if(n!==e.length)throw new Error("data is not a valid framed stream!");return ys(t)}function Qi(e){for(var t=[],n=0;n<e.length;){var a=Math.min(e.length-n,268435455),r=new Uint8Array(4);t.push(r);var l=pt(a),o=l.length;t.push(l),a<=60?(o++,t.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(n,n+a)),o+=a,r[0]=0,r[1]=o&255,r[2]=o>>8&255,r[3]=o>>16&255,n+=a}return ys(t)}function Id(e,t){var n=new Uint8Array(32),a=Ih(n),r=12,l=0;switch(n[0]=5,e.t){case"n":n[1]=2,GM(n,r,e.v),l|=1,r+=16;break;case"b":n[1]=6,a.setFloat64(r,e.v?1:0,!0),l|=2,r+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,a.setUint32(r,t.indexOf(e.v),!0),l|=8,r+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,l,!0),n.slice(0,r)}function zd(e,t){var n=new Uint8Array(32),a=Ih(n),r=12,l=0;switch(n[0]=3,e.t){case"n":n[2]=2,a.setFloat64(r,e.v,!0),l|=32,r+=8;break;case"b":n[2]=6,a.setFloat64(r,e.v?1:0,!0),l|=32,r+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,a.setUint32(r,t.indexOf(e.v),!0),l|=16,r+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,l,!0),n.slice(0,r)}function is(e){var t=en(e);return dc(t[1][0].data)}function YM(e,t,n){var a,r,l,o;if(!((a=e[6])!=null&&a[0])||!((r=e[7])!=null&&r[0]))throw"Mutation only works on post-BNC storages!";var h=((o=(l=e[8])==null?void 0:l[0])==null?void 0:o.data)&&ol(e[8][0].data)>0||!1;if(h)throw"Math only works with normal offsets";for(var f=0,x=Ih(e[7][0].data),g=0,p=[],y=Ih(e[4][0].data),_=0,w=[],b=0;b<t.length;++b){if(t[b]==null){x.setUint16(b*2,65535,!0),y.setUint16(b*2,65535);continue}x.setUint16(b*2,g,!0),y.setUint16(b*2,_,!0);var T,S;switch(typeof t[b]){case"string":T=Id({t:"s",v:t[b]},n),S=zd({t:"s",v:t[b]},n);break;case"number":T=Id({t:"n",v:t[b]},n),S=zd({t:"n",v:t[b]},n);break;case"boolean":T=Id({t:"b",v:t[b]},n),S=zd({t:"b",v:t[b]},n);break;default:throw new Error("Unsupported value "+t[b])}p.push(T),g+=T.length,w.push(S),_+=S.length,++f}for(e[2][0].data=pt(f);b<e[7][0].data.length/2;++b)x.setUint16(b*2,65535,!0),y.setUint16(b*2,65535,!0);return e[6][0].data=ys(p),e[3][0].data=ys(w),f}function qM(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=oa(n["!ref"]);a.s.r=a.s.c=0;var r=!1;a.e.c>9&&(r=!0,a.e.c=9),a.e.r>49&&(r=!0,a.e.r=49),r&&console.error("The Numbers writer is currently limited to ".concat($t(a)));var l=zh(n,{range:a,header:1}),o=["~Sh33tJ5~"];l.forEach(function(Z){return Z.forEach(function(j){typeof j=="string"&&o.push(j)})});var h={},f=[],x=Et.read(t.numbers,{type:"base64"});x.FileIndex.map(function(Z,j){return[Z,x.FullPaths[j]]}).forEach(function(Z){var j=Z[0],V=Z[1];if(j.type==2&&j.name.match(/\.iwa/)){var U=j.content,Te=Ma(U),ie=Oa(Te);ie.forEach(function(_e){f.push(_e.id),h[_e.id]={deps:[],location:V,type:ol(_e.messages[0].meta[1][0].data)}})}}),f.sort(function(Z,j){return Z-j});var g=f.filter(function(Z){return Z>1}).map(function(Z){return[Z,pt(Z)]});x.FileIndex.map(function(Z,j){return[Z,x.FullPaths[j]]}).forEach(function(Z){var j=Z[0];if(Z[1],!!j.name.match(/\.iwa/)){var V=Oa(Ma(j.content));V.forEach(function(U){U.messages.forEach(function(Te){g.forEach(function(ie){U.messages.some(function(_e){return ol(_e.meta[1][0].data)!=11006&&WM(_e.data,ie[1])})&&h[ie[0]].deps.push(U.id)})})})}});for(var p=Et.find(x,h[1].location),y=Oa(Ma(p.content)),_,w=0;w<y.length;++w){var b=y[w];b.id==1&&(_=b)}var T=is(en(_.messages[0].data)[1][0].data);for(p=Et.find(x,h[T].location),y=Oa(Ma(p.content)),w=0;w<y.length;++w)b=y[w],b.id==T&&(_=b);for(T=is(en(_.messages[0].data)[2][0].data),p=Et.find(x,h[T].location),y=Oa(Ma(p.content)),w=0;w<y.length;++w)b=y[w],b.id==T&&(_=b);for(T=is(en(_.messages[0].data)[2][0].data),p=Et.find(x,h[T].location),y=Oa(Ma(p.content)),w=0;w<y.length;++w)b=y[w],b.id==T&&(_=b);var S=en(_.messages[0].data);{S[6][0].data=pt(a.e.r+1),S[7][0].data=pt(a.e.c+1);var E=is(S[46][0].data),C=Et.find(x,h[E].location),A=Oa(Ma(C.content));{for(var F=0;F<A.length&&A[F].id!=E;++F);if(A[F].id!=E)throw"Bad ColumnRowUIDMapArchive";var K=en(A[F].messages[0].data);K[1]=[],K[2]=[],K[3]=[];for(var O=0;O<=a.e.c;++O){var P=[];P[1]=P[2]=[{type:0,data:pt(O+420690)}],K[1].push({type:2,data:pn(P)}),K[2].push({type:0,data:pt(O)}),K[3].push({type:0,data:pt(O)})}K[4]=[],K[5]=[],K[6]=[];for(var M=0;M<=a.e.r;++M)P=[],P[1]=P[2]=[{type:0,data:pt(M+726270)}],K[4].push({type:2,data:pn(P)}),K[5].push({type:0,data:pt(M)}),K[6].push({type:0,data:pt(M)});A[F].messages[0].data=pn(K)}C.content=Qi($i(A)),C.size=C.content.length,delete S[46];var B=en(S[4][0].data);{B[7][0].data=pt(a.e.r+1);var I=en(B[1][0].data),te=is(I[2][0].data);C=Et.find(x,h[te].location),A=Oa(Ma(C.content));{if(A[0].id!=te)throw"Bad HeaderStorageBucket";var q=en(A[0].messages[0].data);for(M=0;M<l.length;++M){var ae=en(q[2][0].data);ae[1][0].data=pt(M),ae[4][0].data=pt(l[M].length),q[2][M]={type:q[2][0].type,data:pn(ae)}}A[0].messages[0].data=pn(q)}C.content=Qi($i(A)),C.size=C.content.length;var re=is(B[2][0].data);C=Et.find(x,h[re].location),A=Oa(Ma(C.content));{if(A[0].id!=re)throw"Bad HeaderStorageBucket";for(q=en(A[0].messages[0].data),O=0;O<=a.e.c;++O)ae=en(q[2][0].data),ae[1][0].data=pt(O),ae[4][0].data=pt(a.e.r+1),q[2][O]={type:q[2][0].type,data:pn(ae)};A[0].messages[0].data=pn(q)}C.content=Qi($i(A)),C.size=C.content.length;var ee=is(B[4][0].data);(function(){for(var Z=Et.find(x,h[ee].location),j=Oa(Ma(Z.content)),V,U=0;U<j.length;++U){var Te=j[U];Te.id==ee&&(V=Te)}var ie=en(V.messages[0].data);{ie[3]=[];var _e=[];o.forEach(function(Ue,at){_e[1]=[{type:0,data:pt(at)}],_e[2]=[{type:0,data:pt(1)}],_e[3]=[{type:2,data:KM(Ue)}],ie[3].push({type:2,data:pn(_e)})})}V.messages[0].data=pn(ie);var Ne=$i(j),Ie=Qi(Ne);Z.content=Ie,Z.size=Z.content.length})();var Q=en(B[3][0].data);{var me=Q[1][0];delete Q[2];var ye=en(me.data);{var Y=is(ye[2][0].data);(function(){for(var Z=Et.find(x,h[Y].location),j=Oa(Ma(Z.content)),V,U=0;U<j.length;++U){var Te=j[U];Te.id==Y&&(V=Te)}var ie=en(V.messages[0].data);{delete ie[6],delete Q[7];var _e=new Uint8Array(ie[5][0].data);ie[5]=[];for(var Ne=0,Ie=0;Ie<=a.e.r;++Ie){var Ue=en(_e);Ne+=YM(Ue,l[Ie],o),Ue[1][0].data=pt(Ie),ie[5].push({data:pn(Ue),type:2})}ie[1]=[{type:0,data:pt(a.e.c+1)}],ie[2]=[{type:0,data:pt(a.e.r+1)}],ie[3]=[{type:0,data:pt(Ne)}],ie[4]=[{type:0,data:pt(a.e.r+1)}]}V.messages[0].data=pn(ie);var at=$i(j),Ye=Qi(at);Z.content=Ye,Z.size=Z.content.length})()}me.data=pn(ye)}B[3][0].data=pn(Q)}S[4][0].data=pn(B)}_.messages[0].data=pn(S);var de=$i(y),H=Qi(de);return p.content=H,p.size=p.content.length,x}function $M(e){return function(n){for(var a=0;a!=e.length;++a){var r=e[a];n[r[0]]===void 0&&(n[r[0]]=r[1]),r[2]==="n"&&(n[r[0]]=Number(n[r[0]]))}}}function Qx(e){$M([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function QM(e,t){return t.bookType=="ods"?X_(e,t):t.bookType=="numbers"?qM(e,t):t.bookType=="xlsb"?ZM(e,t):JM(e,t)}function ZM(e,t){tl=1024,e&&!e.SSF&&(e.SSF=qn(Vt)),e&&e.SSF&&(ef(),Jh(e.SSF),t.revssf=tf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,qo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n=t.bookType=="xlsb"?"bin":"xml",a=k_.indexOf(t.bookType)>-1,r=r_();Qx(t=t||{});var l=Fx(),o="",h=0;if(t.cellXfs=[],vs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",$e(l,o,o_(e.Props,t)),r.coreprops.push(o),yt(t.rels,2,o,ct.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],x=0;x<e.SheetNames.length;++x)(e.Workbook.Sheets[x]||{}).Hidden!=2&&f.push(e.SheetNames[x]);e.Props.SheetNames=f}for(e.Props.Worksheets=e.Props.SheetNames.length,$e(l,o,u_(e.Props)),r.extprops.push(o),yt(t.rels,3,o,ct.EXT_PROPS),e.Custprops!==e.Props&&Tn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",$e(l,o,h_(e.Custprops)),r.custprops.push(o),yt(t.rels,4,o,ct.CUST_PROPS)),h=1;h<=e.SheetNames.length;++h){var g={"!id":{}},p=e.Sheets[e.SheetNames[h-1]],y=(p||{})["!type"]||"sheet";switch(y){case"chart":default:o="xl/worksheets/sheet"+h+"."+n,$e(l,o,tM(h-1,o,t,e,g)),r.sheets.push(o),yt(t.wbrels,-1,"worksheets/sheet"+h+"."+n,ct.WS[0])}if(p){var _=p["!comments"],w=!1,b="";_&&_.length>0&&(b="xl/comments"+h+"."+n,$e(l,b,rM(_,b)),r.comments.push(b),yt(g,-1,"../comments"+h+"."+n,ct.CMNT),w=!0),p["!legacy"]&&w&&$e(l,"xl/drawings/vmlDrawing"+h+".vml",C_(h,p["!comments"])),delete p["!comments"],delete p["!legacy"]}g["!id"].rId1&&$e(l,i_(o),il(g))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+n,$e(l,o,aM(t.Strings,o,t)),r.strs.push(o),yt(t.wbrels,-1,"sharedStrings."+n,ct.SST)),o="xl/workbook."+n,$e(l,o,eM(e,o)),r.workbooks.push(o),yt(t.rels,1,o,ct.WB),o="xl/theme/theme1.xml",$e(l,o,N_(e.Themes,t)),r.themes.push(o),yt(t.wbrels,-1,"theme/theme1.xml",ct.THEME),o="xl/styles."+n,$e(l,o,nM(e,o,t)),r.styles.push(o),yt(t.wbrels,-1,"styles."+n,ct.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",$e(l,o,e.vbaraw),r.vba.push(o),yt(t.wbrels,-1,"vbaProject.bin",ct.VBA)),o="xl/metadata."+n,$e(l,o,sM(o)),r.metadata.push(o),yt(t.wbrels,-1,"metadata."+n,ct.XLMETA),$e(l,"[Content_Types].xml",s_(r,t)),$e(l,"_rels/.rels",il(t.rels)),$e(l,"xl/_rels/workbook."+n+".rels",il(t.wbrels)),delete t.revssf,delete t.ssf,l}function JM(e,t){tl=1024,e&&!e.SSF&&(e.SSF=qn(Vt)),e&&e.SSF&&(ef(),Jh(e.SSF),t.revssf=tf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,qo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",a=k_.indexOf(t.bookType)>-1,r=r_();Qx(t=t||{});var l=Fx(),o="",h=0;if(t.cellXfs=[],vs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",$e(l,o,o_(e.Props,t)),r.coreprops.push(o),yt(t.rels,2,o,ct.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],x=0;x<e.SheetNames.length;++x)(e.Workbook.Sheets[x]||{}).Hidden!=2&&f.push(e.SheetNames[x]);e.Props.SheetNames=f}e.Props.Worksheets=e.Props.SheetNames.length,$e(l,o,u_(e.Props)),r.extprops.push(o),yt(t.rels,3,o,ct.EXT_PROPS),e.Custprops!==e.Props&&Tn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",$e(l,o,h_(e.Custprops)),r.custprops.push(o),yt(t.rels,4,o,ct.CUST_PROPS));var g=["SheetJ5"];for(t.tcid=0,h=1;h<=e.SheetNames.length;++h){var p={"!id":{}},y=e.Sheets[e.SheetNames[h-1]],_=(y||{})["!type"]||"sheet";switch(_){case"chart":default:o="xl/worksheets/sheet"+h+"."+n,$e(l,o,H_(h-1,t,e,p)),r.sheets.push(o),yt(t.wbrels,-1,"worksheets/sheet"+h+"."+n,ct.WS[0])}if(y){var w=y["!comments"],b=!1,T="";if(w&&w.length>0){var S=!1;w.forEach(function(E){E[1].forEach(function(C){C.T==!0&&(S=!0)})}),S&&(T="xl/threadedComments/threadedComment"+h+"."+n,$e(l,T,A5(w,g,t)),r.threadedcomments.push(T),yt(p,-1,"../threadedComments/threadedComment"+h+"."+n,ct.TCMNT)),T="xl/comments"+h+"."+n,$e(l,T,j_(w)),r.comments.push(T),yt(p,-1,"../comments"+h+"."+n,ct.CMNT),b=!0}y["!legacy"]&&b&&$e(l,"xl/drawings/vmlDrawing"+h+".vml",C_(h,y["!comments"])),delete y["!comments"],delete y["!legacy"]}p["!id"].rId1&&$e(l,i_(o),il(p))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+n,$e(l,o,v_(t.Strings,t)),r.strs.push(o),yt(t.wbrels,-1,"sharedStrings."+n,ct.SST)),o="xl/workbook."+n,$e(l,o,z_(e)),r.workbooks.push(o),yt(t.rels,1,o,ct.WB),o="xl/theme/theme1.xml",$e(l,o,N_(e.Themes,t)),r.themes.push(o),yt(t.wbrels,-1,"theme/theme1.xml",ct.THEME),o="xl/styles."+n,$e(l,o,T_(e,t)),r.styles.push(o),yt(t.wbrels,-1,"styles."+n,ct.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",$e(l,o,e.vbaraw),r.vba.push(o),yt(t.wbrels,-1,"vbaProject.bin",ct.VBA)),o="xl/metadata."+n,$e(l,o,E_()),r.metadata.push(o),yt(t.wbrels,-1,"metadata."+n,ct.XLMETA),g.length>1&&(o="xl/persons/person.xml",$e(l,o,D5(g)),r.people.push(o),yt(t.wbrels,-1,"persons/person.xml",ct.PEOPLE)),$e(l,"[Content_Types].xml",s_(r,t)),$e(l,"_rels/.rels",il(t.rels)),$e(l,"xl/_rels/workbook."+n+".rels",il(t.wbrels)),delete t.revssf,delete t.ssf,l}function eR(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=Or(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function Y_(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return vc(t.file,Et.write(e,{type:ht?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Et.write(e,t)}function tR(e,t){var n=qn(t||{}),a=QM(e,n);return nR(a,n)}function nR(e,t){var n={},a=ht?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=a;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var r=e.FullPaths?Et.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if(typeof Deno<"u"&&typeof r=="string"){if(t.type=="binary"||t.type=="base64")return r;r=new Uint8Array(Zh(r))}return t.password&&typeof encrypt_agile<"u"?Y_(encrypt_agile(r,t.password),t):t.type==="file"?vc(t.file,r):t.type=="string"?Wo(r):r}function aR(e,t){var n=t||{},a=vM(e,n);return Y_(a,n)}function Qa(e,t,n){n||(n="");var a=n+e;switch(t.type){case"base64":return cc(hc(a));case"binary":return hc(a);case"string":return e;case"file":return vc(t.file,a,"utf8");case"buffer":return ht?Fr(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):Qa(a,{type:"binary"}).split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function rR(e,t){switch(t.type){case"base64":return cc(e);case"binary":return e;case"string":return e;case"file":return vc(t.file,e,"binary");case"buffer":return ht?Fr(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function fh(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",a=0;a<e.length;++a)n+=String.fromCharCode(e[a]);return t.type=="base64"?cc(n):t.type=="string"?Wo(n):n;case"file":return vc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function q_(e,t){Ok(),VO(e);var n=qn(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var a=q_(e,n);return n.type="array",Zh(a)}var r=0;if(n.sheet&&(typeof n.sheet=="number"?r=n.sheet:r=e.SheetNames.indexOf(n.sheet),!e.SheetNames[r]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return Qa(pM(e,n),n);case"slk":case"sylk":return Qa(I6.from_sheet(e.Sheets[e.SheetNames[r]],n),n);case"htm":case"html":return Qa(K_(e.Sheets[e.SheetNames[r]],n),n);case"txt":return rR($_(e.Sheets[e.SheetNames[r]],n),n);case"csv":return Qa(Zx(e.Sheets[e.SheetNames[r]],n),n,"\uFEFF");case"dif":return Qa(z6.from_sheet(e.Sheets[e.SheetNames[r]],n),n);case"dbf":return fh(P6.from_sheet(e.Sheets[e.SheetNames[r]],n),n);case"prn":return Qa(U6.from_sheet(e.Sheets[e.SheetNames[r]],n),n);case"rtf":return Qa(q6.from_sheet(e.Sheets[e.SheetNames[r]],n),n);case"eth":return Qa(y_.from_sheet(e.Sheets[e.SheetNames[r]],n),n);case"fods":return Qa(X_(e,n),n);case"wk1":return fh(Gv.sheet_to_wk1(e.Sheets[e.SheetNames[r]],n),n);case"wk3":return fh(Gv.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),fh(V_(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),aR(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return tR(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function sR(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(e.bookType=n.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function iR(e,t,n){var a={};return a.type="file",a.file=t,sR(a),q_(e,a)}function lR(e,t,n,a,r,l,o,h){var f=wn(n),x=h.defval,g=h.raw||!Object.prototype.hasOwnProperty.call(h,"raw"),p=!0,y=r===1?[]:{};if(r!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:n,enumerable:!1})}catch{y.__rowNum__=n}else y.__rowNum__=n;if(!o||e[n])for(var _=t.s.c;_<=t.e.c;++_){var w=o?e[n][_]:e[a[_]+f];if(w===void 0||w.t===void 0){if(x===void 0)continue;l[_]!=null&&(y[l[_]]=x);continue}var b=w.v;switch(w.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(l[_]!=null){if(b==null)if(w.t=="e"&&b===null)y[l[_]]=null;else if(x!==void 0)y[l[_]]=x;else if(g&&b===null)y[l[_]]=null;else continue;else y[l[_]]=g&&(w.t!=="n"||w.t==="n"&&h.rawNumbers!==!1)?b:Mr(w,b,h);b!=null&&(p=!1)}}return{row:y,isempty:p}}function zh(e,t){if(e==null||e["!ref"]==null)return[];var n={t:"n",v:0},a=0,r=1,l=[],o=0,h="",f={s:{r:0,c:0},e:{r:0,c:0}},x=t||{},g=x.range!=null?x.range:e["!ref"];switch(x.header===1?a=1:x.header==="A"?a=2:Array.isArray(x.header)?a=3:x.header==null&&(a=0),typeof g){case"string":f=Ot(g);break;case"number":f=Ot(e["!ref"]),f.s.r=g;break;default:f=g}a>0&&(r=0);var p=wn(f.s.r),y=[],_=[],w=0,b=0,T=Array.isArray(e),S=f.s.r,E=0,C={};T&&!e[S]&&(e[S]=[]);var A=x.skipHidden&&e["!cols"]||[],F=x.skipHidden&&e["!rows"]||[];for(E=f.s.c;E<=f.e.c;++E)if(!(A[E]||{}).hidden)switch(y[E]=An(E),n=T?e[S][E]:e[y[E]+p],a){case 1:l[E]=E-f.s.c;break;case 2:l[E]=y[E];break;case 3:l[E]=x.header[E-f.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),h=o=Mr(n,null,x),b=C[o]||0,!b)C[o]=1;else{do h=o+"_"+b++;while(C[h]);C[o]=b,C[h]=1}l[E]=h}for(S=f.s.r+r;S<=f.e.r;++S)if(!(F[S]||{}).hidden){var K=lR(e,f,S,y,a,l,T,x);(K.isempty===!1||(a===1?x.blankrows!==!1:x.blankrows))&&(_[w++]=K.row)}return _.length=w,_}var e2=/"/g;function oR(e,t,n,a,r,l,o,h){for(var f=!0,x=[],g="",p=wn(n),y=t.s.c;y<=t.e.c;++y)if(a[y]){var _=h.dense?(e[n]||[])[y]:e[a[y]+p];if(_==null)g="";else if(_.v!=null){f=!1,g=""+(h.rawNumbers&&_.t=="n"?_.v:Mr(_,null,h));for(var w=0,b=0;w!==g.length;++w)if((b=g.charCodeAt(w))===r||b===l||b===34||h.forceQuotes){g='"'+g.replace(e2,'""')+'"';break}g=="ID"&&(g='"ID"')}else _.f!=null&&!_.F?(f=!1,g="="+_.f,g.indexOf(",")>=0&&(g='"'+g.replace(e2,'""')+'"')):g="";x.push(g)}return h.blankrows===!1&&f?null:x.join(o)}function Zx(e,t){var n=[],a=t??{};if(e==null||e["!ref"]==null)return"";var r=Ot(e["!ref"]),l=a.FS!==void 0?a.FS:",",o=l.charCodeAt(0),h=a.RS!==void 0?a.RS:`
`,f=h.charCodeAt(0),x=new RegExp((l=="|"?"\\|":l)+"+$"),g="",p=[];a.dense=Array.isArray(e);for(var y=a.skipHidden&&e["!cols"]||[],_=a.skipHidden&&e["!rows"]||[],w=r.s.c;w<=r.e.c;++w)(y[w]||{}).hidden||(p[w]=An(w));for(var b=0,T=r.s.r;T<=r.e.r;++T)(_[T]||{}).hidden||(g=oR(e,r,T,p,o,f,l,a),g!=null&&(a.strip&&(g=g.replace(x,"")),(g||a.blankrows!==!1)&&n.push((b++?h:"")+g)));return delete a.dense,n.join("")}function $_(e,t){t||(t={}),t.FS="	",t.RS=`
`;var n=Zx(e,t);return n}function cR(e){var t="",n,a="";if(e==null||e["!ref"]==null)return[];var r=Ot(e["!ref"]),l="",o=[],h,f=[],x=Array.isArray(e);for(h=r.s.c;h<=r.e.c;++h)o[h]=An(h);for(var g=r.s.r;g<=r.e.r;++g)for(l=wn(g),h=r.s.c;h<=r.e.c;++h)if(t=o[h]+l,n=x?(e[g]||[])[h]:e[t],a="",n!==void 0){if(n.F!=null){if(t=n.F,!n.f)continue;a=n.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(n.f!=null)a=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)a=""+n.v;else if(n.t=="b")a=n.v?"TRUE":"FALSE";else if(n.w!==void 0)a="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?a="'"+n.v:a=""+n.v}}f[f.length]=t+"="+a}return f}function Q_(e,t,n){var a=n||{},r=+!a.skipHeader,l=e||{},o=0,h=0;if(l&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var f=typeof a.origin=="string"?un(a.origin):a.origin;o=f.r,h=f.c}var x,g={s:{c:0,r:0},e:{c:h,r:o+t.length-1+r}};if(l["!ref"]){var p=Ot(l["!ref"]);g.e.c=Math.max(g.e.c,p.e.c),g.e.r=Math.max(g.e.r,p.e.r),o==-1&&(o=p.e.r+1,g.e.r=o+t.length-1+r)}else o==-1&&(o=0,g.e.r=t.length-1+r);var y=a.header||[],_=0;t.forEach(function(b,T){Tn(b).forEach(function(S){(_=y.indexOf(S))==-1&&(y[_=y.length]=S);var E=b[S],C="z",A="",F=bt({c:h+_,r:o+T+r});x=xc(l,F),E&&typeof E=="object"&&!(E instanceof Date)?l[F]=E:(typeof E=="number"?C="n":typeof E=="boolean"?C="b":typeof E=="string"?C="s":E instanceof Date?(C="d",a.cellDates||(C="n",E=Yn(E)),A=a.dateNF||Vt[14]):E===null&&a.nullError&&(C="e",E=0),x?(x.t=C,x.v=E,delete x.w,delete x.R,A&&(x.z=A)):l[F]=x={t:C,v:E},A&&(x.z=A))})}),g.e.c=Math.max(g.e.c,h+y.length-1);var w=wn(o);if(r)for(_=0;_<y.length;++_)l[An(_+h)+w]={t:"s",v:y[_]};return l["!ref"]=$t(g),l}function uR(e,t){return Q_(null,e,t)}function xc(e,t,n){if(typeof t=="string"){if(Array.isArray(e)){var a=un(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?xc(e,bt(t)):xc(e,bt({r:t,c:n||0}))}function hR(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function fR(){return{SheetNames:[],Sheets:{}}}function dR(e,t,n,a){var r=1;if(!n)for(;r<=65535&&e.SheetNames.indexOf(n="Sheet"+r)!=-1;++r,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(n)>=0){var l=n.match(/(^.*?)(\d+)$/);r=l&&+l[2]||0;var o=l&&l[1]||n;for(++r;r<=65535&&e.SheetNames.indexOf(n=o+r)!=-1;++r);}if(I_(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function xR(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=hR(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[a].Hidden=n}function gR(e,t){return e.z=t,e}function Z_(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}function mR(e,t,n){return Z_(e,"#"+t,n)}function pR(e,t,n){e.c||(e.c=[]),e.c.push({t,a:n||"SheetJS"})}function yR(e,t,n,a){for(var r=typeof t!="string"?t:Ot(t),l=typeof t=="string"?t:$t(t),o=r.s.r;o<=r.e.r;++o)for(var h=r.s.c;h<=r.e.c;++h){var f=xc(e,o,h);f.t="n",f.F=l,delete f.v,o==r.s.r&&h==r.s.c&&(f.f=n,a&&(f.D=!0))}return e}var Ud={encode_col:An,encode_row:wn,encode_cell:bt,encode_range:$t,decode_col:zx,decode_row:Ix,split_cell:OA,decode_cell:un,decode_range:oa,format_cell:Mr,sheet_add_aoa:Zb,sheet_add_json:Q_,sheet_add_dom:W_,aoa_to_sheet:pl,json_to_sheet:uR,table_to_sheet:G_,table_to_book:zM,sheet_to_csv:Zx,sheet_to_txt:$_,sheet_to_json:zh,sheet_to_html:K_,sheet_to_formulae:cR,sheet_to_row_object_array:zh,sheet_get_cell:xc,book_new:fR,book_append_sheet:dR,book_set_sheet_visibility:xR,cell_set_number_format:gR,cell_set_hyperlink:Z_,cell_set_internal_link:mR,cell_add_comment:pR,sheet_set_array_formula:yR,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};ii.register(rc,sc,Zs,Sr,rl,el,$h,qh,Cr);const vR=[{label:"Giới tính",value:"gender"},{label:"Độ tuổi",value:"age"},{label:"Khoảng thời gian",value:"time"},{label:"Trạng thái tạm trú",value:"status"}],bR=()=>{const[e,t]=k.useState("gender"),[n,a]=k.useState("2024-05-01"),[r,l]=k.useState("2024-05-31"),[o,h]=k.useState(null),[f,x]=k.useState(null),[g,p]=k.useState(null),[y,_]=k.useState([]),[w,b]=k.useState(!0),[T,S]=k.useState(null);k.useEffect(()=>{(async()=>{var P;try{b(!0),console.log("🔄 Fetching population data for filter:",e);let M=[];switch(e){case"gender":M=[Re("/population/gender"),Re("/residents")];break;case"age":M=[Re("/population/age"),Re("/residents")];break;case"status":M=[Re("/population/temporary-status"),Re("/residents")];break;case"time":M=[Re("/population/overview"),Re("/residents")];break;default:M=[Re("/population/gender"),Re("/residents")]}const[B,I]=await Promise.all(M);console.log("📊 Stats data received:",B),console.log("👥 Residents data received:",I),e==="gender"?h(B):e==="age"?x(B):e==="status"&&p(B),_(((P=I.data)==null?void 0:P.residents)||[]),S(null)}catch(M){console.error("❌ Error fetching population data:",M),S("Lỗi khi tải dữ liệu thống kê nhân khẩu: "+M.message)}finally{b(!1)}})()},[e,n,r]);const E=()=>{if(w)return{chart:u.jsx("div",{className:"text-center",children:"Đang tải dữ liệu..."}),legend:null};if(T)return{chart:u.jsx("div",{className:"text-center text-red-500",children:T}),legend:null};if(e==="gender"&&(o!=null&&o.statistics)){const O=o.statistics.chartData||[],P={labels:O.map(B=>B.label),datasets:[{label:"Số lượng",data:O.map(B=>B.value),backgroundColor:["#2196F3","#F6A6F6"],borderColor:["#2196F3","#F6A6F6"],borderWidth:2}]},M={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},datalabels:{color:"#222",font:{weight:"bold",size:16},formatter:(B,I)=>{const te=I.chart.data.datasets[0].data.reduce((ae,re)=>ae+re,0);return(B/te*100).toFixed(0)+"%"}}}};return{chart:u.jsx(ic,{data:P,options:M,plugins:[Cr]}),legend:u.jsx("div",{className:"flex gap-6 justify-center mt-4",children:O.map((B,I)=>u.jsxs("p",{className:"flex items-center",children:[u.jsx("span",{className:"inline-block w-4 h-4 rounded-full mr-2",style:{backgroundColor:I===0?"#2196F3":"#F6A6F6"}}),B.label,": ",B.value," (",B.percentage,"%)"]},I))})}}if(e==="age"&&(f!=null&&f.statistics)){const O=f.statistics.byAgeGroup||[],P={labels:O.map(I=>I.ageGroup),datasets:[{label:"Số lượng",data:O.map(I=>I.count),backgroundColor:["#B6E36C","#F6F36C","#F6A6F6","#7CC6F6"],borderColor:"#1976D2",borderWidth:1,borderRadius:4}]},M=Math.max(...O.map(I=>I.count))+100,B={responsive:!0,plugins:{legend:{display:!1},datalabels:{anchor:"end",align:"top",clamp:!0,color:"#222",font:{weight:"bold",size:16},formatter:I=>I}},scales:{y:{beginAtZero:!0,max:M,ticks:{stepSize:Math.ceil(M/10)}}}};return{chart:u.jsx(Dx,{data:P,options:B,plugins:[Cr]}),legend:u.jsx("div",{className:"flex flex-wrap gap-4 justify-center mt-4",children:O.map((I,te)=>u.jsxs("p",{children:[u.jsx("span",{className:"inline-block w-3 h-3 mr-2",style:{backgroundColor:["#B6E36C","#F6F36C","#F6A6F6","#7CC6F6"][te]}}),I.ageGroup,": ",I.count]},te))})}}if(e==="status"&&(g!=null&&g.statistics)){const O=g.statistics.chartData||[],P={labels:O.map(M=>M.label),datasets:[{label:"Số lượng",data:O.map(M=>M.value),backgroundColor:["#2196F3","#F6A6F6","#B6E36C"],borderColor:["#2196F3","#F6A6F6","#B6E36C"],borderWidth:2}]};return{chart:u.jsx(ic,{data:P,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},datalabels:{color:"#222",font:{weight:"bold",size:16},formatter:(M,B)=>{const I=B.chart.data.datasets[0].data.reduce((q,ae)=>q+ae,0);return(M/I*100).toFixed(0)+"%"}}}},plugins:[Cr]}),legend:u.jsx("div",{className:"flex gap-6 justify-center mt-4",children:O.map((M,B)=>u.jsxs("p",{className:"flex items-center",children:[u.jsx("span",{className:"inline-block w-4 h-4 rounded-full mr-2",style:{backgroundColor:["#2196F3","#F6A6F6","#B6E36C"][B]}}),M.label,": ",M.value," (",M.percentage,"%)"]},B))})}}return{chart:u.jsx("div",{className:"text-center text-gray-500",children:"Chọn loại thống kê để xem dữ liệu"}),legend:null}},{chart:C,legend:A}=E(),F=y.map((O,P)=>({id:O.id,ten:O.hoTen||"N/A",gioiTinh:O.gioiTinh||"N/A",tuoi:O.ngaySinh?new Date().getFullYear()-new Date(O.ngaySinh).getFullYear():"N/A",trangThai:"Thường trú",hoKhau:`HK${String(P+1).padStart(3,"0")}`})),K=()=>{const O=F.length>0?F:[{ten:"Không có dữ liệu",gioiTinh:"",tuoi:"",trangThai:"",hoKhau:""}],P=Ud.json_to_sheet(O.map(B=>({"Họ tên":B.ten,"Giới tính":B.gioiTinh,Tuổi:B.tuoi,"Trạng thái":B.trangThai,"Hộ khẩu":B.hoKhau}))),M=Ud.book_new();Ud.book_append_sheet(M,P,"Nhân khẩu"),iR(M,"thong_ke_nhan_khau.xlsx")};return u.jsx(kn,{role:"totruong",children:u.jsxs("div",{className:"p-4 flex flex-col gap-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"THỐNG KÊ NHÂN KHẨU"}),u.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Thống kê dữ liệu nhân khẩu thực tế từ hệ thống"})]}),u.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[u.jsx("label",{className:"font-semibold text-gray-700",children:"Thống kê theo:"}),u.jsx("select",{className:"border border-gray-300 rounded-md px-3 py-2 text-sm",value:e,onChange:O=>t(O.target.value),children:vR.map(O=>u.jsx("option",{value:O.value,children:O.label},O.value))}),e==="time"&&u.jsxs(u.Fragment,{children:[u.jsx("input",{type:"date",className:"border border-gray-300 rounded-md px-2 py-1 text-sm",value:n,onChange:O=>a(O.target.value)}),u.jsx("span",{children:"-"}),u.jsx("input",{type:"date",className:"border border-gray-300 rounded-md px-2 py-1 text-sm",value:r,onChange:O=>l(O.target.value)})]})]}),u.jsxs("div",{className:"bg-white rounded-md shadow-md border border-gray-200 p-6 flex flex-col items-center",children:[u.jsx("div",{className:"w-full h-80 flex items-center justify-center",children:C}),A]}),u.jsxs("div",{className:"mt-6 bg-white rounded-md shadow-md overflow-hidden border border-gray-200",children:[u.jsxs("div",{className:"p-4 bg-gray-100 border-b border-gray-200 flex items-center justify-between",children:[u.jsxs("h2",{className:"text-lg font-semibold text-gray-800",children:["Danh sách nhân khẩu (",F.length," người)"]}),u.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded-md font-semibold hover:bg-blue-600 transition",onClick:K,children:"Xuất báo cáo"})]}),u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Họ tên"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Giới tính"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Tuổi"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Trạng thái"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Hộ khẩu"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:w?u.jsx("tr",{children:u.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:"Đang tải dữ liệu..."})}):F.length>0?F.slice(0,10).map((O,P)=>u.jsxs("tr",{children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:O.ten}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O.gioiTinh}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O.tuoi}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O.trangThai}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O.hoKhau})]},P)):u.jsx("tr",{children:u.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:"Chưa có dữ liệu nhân khẩu"})})})]}),F.length>10&&u.jsxs("div",{className:"px-6 py-3 bg-gray-50 text-sm text-gray-500 text-center",children:["Hiển thị 10/",F.length," kết quả đầu tiên"]})]})]})})};ii.register(rc,sc,Zs,Sr,rl,el,$C,$h,qh,Cr);const _R=()=>{const[e,t]=k.useState("7days"),[n,a]=k.useState({labels:[],datasets:[]}),[r,l]=k.useState({labels:[],datasets:[]}),[o,h]=k.useState({labels:[],datasets:[]}),[f,x]=k.useState(!0),[g,p]=k.useState(null);k.useEffect(()=>{y()},[]);const y=async()=>{try{x(!0),p(null);const[A,,F,K]=await Promise.all([Kn.payment.getStatistics(),Kn.dotThu.getStatistics(),Kn.khoanThu.getAll(),Kn.dotThu.getAllWithKhoanThu({page:0,size:10})]);F&&Array.isArray(F)&&_(F,A),K&&K.dotThus&&w(K.dotThus),b(e,A)}catch(A){console.error("Error fetching statistics:",A),p("Không thể tải dữ liệu thống kê. Sử dụng dữ liệu mẫu."),T()}finally{x(!1)}},_=(A,F)=>{const K=A.slice(0,6).map(M=>M.tenKhoan||M.tenkhoanthu),O=["#8BC34A","#FFEB3B","#E91E63","#2196F3","#FF9800","#9C27B0"],P=K.map((M,B)=>{if(F&&F.paymentMethodBreakdown){const te=F.totalAmount||0;return Math.round(te/K.length/1e6)}return[500,200,150,300,100,80][B]||100});l({labels:K,datasets:[{label:"Theo khoản (triệu VND)",data:P,backgroundColor:O.slice(0,K.length),borderColor:Array(K.length).fill("#ffffff"),borderWidth:1}]})},w=A=>{if(!A||A.length===0){h({labels:["Đợt tháng 06/2025","Đợt tháng 07/2025"],datasets:[{label:"Tỷ lệ đợt thu",data:[60,40],backgroundColor:["#2196F3","#E0E0E0"],borderColor:["#ffffff","#ffffff"],borderWidth:2}]});return}const F=A.slice(0,5).map(P=>P.tenDotThu),K=A.slice(0,5).map((P,M)=>P.thongKe&&P.thongKe.tiLeHoanThanh?Math.round(parseFloat(P.thongKe.tiLeHoanThanh)):[75,60,45,30,20][M]||25);h({labels:F,datasets:[{label:"Tỷ lệ đợt thu (%)",data:K,backgroundColor:["#2196F3","#4CAF50","#FF9800","#E91E63","#9C27B0"].slice(0,F.length),borderColor:Array(F.length).fill("#ffffff"),borderWidth:2}]})},b=(A,F)=>{let K=[],O=[];const P=new Date;switch(A){case"7days":if(K=Array.from({length:7},(M,B)=>{const I=new Date(P);return I.setDate(I.getDate()-(6-B)),I.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit"})}),F&&F.totalAmount){const M=F.totalAmount/30/1e6;O=K.map(()=>Math.round(M*(.5+Math.random()*1.5)))}else O=[430,310,200,150,290,160,380];break;case"30days":if(K=Array.from({length:30},(M,B)=>`Ngày ${B+1}`),F&&F.totalAmount){const M=F.totalAmount/30/1e6;O=K.map(()=>Math.round(M*(.3+Math.random()*1.4)))}else O=Array.from({length:30},()=>Math.floor(Math.random()*500)+50);break;case"90days":if(K=Array.from({length:90},(M,B)=>`Ngày ${B+1}`),F&&F.totalAmount){const M=F.totalAmount/90/1e6;O=K.map(()=>Math.round(M*(.2+Math.random()*1.6)))}else O=Array.from({length:90},()=>Math.floor(Math.random()*400)+30);break;default:K=["Hôm nay"],O=[0]}a({labels:K,datasets:[{label:"Doanh thu (triệu VND)",data:O,borderColor:"#9E9E9E",backgroundColor:"#9E9E9E",tension:.3,pointRadius:A==="90days"?2:5,pointBackgroundColor:"#9E9E9E"}]})},T=()=>{l({labels:["Phí quản lý","Phí gửi xe","Phí điện","Phí nước"],datasets:[{label:"Theo khoản (triệu VND)",data:[550,320,280,180],backgroundColor:["#8BC34A","#FFEB3B","#E91E63","#2196F3"],borderColor:["#ffffff","#ffffff","#ffffff","#ffffff"],borderWidth:1}]}),h({labels:["Thu phí tháng 06/2025","Thu phí tháng 07/2025"],datasets:[{label:"Tỷ lệ đợt thu",data:[65,35],backgroundColor:["#2196F3","#E0E0E0"],borderColor:["#ffffff","#ffffff"],borderWidth:2}]}),b(e,null)};k.useEffect(()=>{f||b(e,null)},[e,f]);const S={responsive:!0,plugins:{legend:{display:!1},title:{display:!0,text:"Doanh thu theo khoản",font:{size:16}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Triệu VND"}}}},E={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"right",align:"center"},datalabels:{color:"#ffffff",formatter:(A,F)=>{const K=F.chart.data.datasets[0].data.reduce((P,M)=>P+M,0);return(A/K*100).toFixed(1)+"%"},font:{weight:"bold"}}},layout:{padding:{left:0,right:16,top:0,bottom:0}}},C={responsive:!0,aspectRatio:5,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(A){let F=A.dataset.label||"";return F&&(F+=": "),A.parsed.y!==null&&(F+=A.parsed.y+" triệu VND"),F}}},datalabels:{display:e!=="90days",color:"#000000",align:"end",anchor:"end",offset:4,formatter:A=>A,font:{weight:"bold",size:12}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Triệu VND"}},x:{title:{display:!0,text:"Ngày"}}},layout:{padding:{top:40,left:0,right:0,bottom:0}}};return u.jsx(kn,{role:"ketoan",children:u.jsxs("div",{className:"p-4 flex flex-col gap-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"THỐNG KÊ THU PHÍ"}),u.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Chào mừng đến với Hệ thống Quản lý Thu phí Chung cư"})]}),f&&u.jsxs("div",{className:"flex items-center justify-center py-12",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"}),u.jsx("span",{className:"ml-3 text-gray-600",children:"Đang tải dữ liệu thống kê..."})]}),g&&u.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:u.jsxs("div",{className:"flex",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),u.jsx("div",{className:"ml-3",children:u.jsx("p",{className:"text-sm text-yellow-700",children:g})})]})}),!f&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md shadow-sm overflow-hidden",children:[u.jsx("input",{type:"text",placeholder:"Chọn kiểu",className:"flex-1 p-2 outline-none text-sm"}),u.jsx("button",{className:"p-2 border-l border-gray-300 bg-gray-50 text-gray-600 hover:bg-gray-100",children:"..."})]}),u.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md shadow-sm overflow-hidden flex-1",children:[u.jsx("div",{className:"p-2 text-gray-400",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),u.jsx("input",{type:"text",placeholder:"Search",className:"flex-1 p-2 border-l border-gray-300 outline-none text-sm"})]}),u.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded-md shadow-sm hover:bg-blue-600",onClick:y,children:"Làm mới"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"bg-white rounded-md shadow-md overflow-hidden border border-gray-200 p-4 flex flex-col gap-4",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Theo khoản (triệu VND)"}),u.jsx("div",{className:"h-48 flex items-center justify-center",children:r.labels.length>0?u.jsx(Dx,{data:r,options:S}):u.jsx("div",{className:"text-gray-500",children:"Không có dữ liệu"})})]}),u.jsxs("div",{className:"bg-white rounded-md shadow-md overflow-hidden border border-gray-200 p-4 flex flex-col gap-4",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Theo đợt thu"}),u.jsx("div",{className:"h-48 flex items-center justify-center",children:o.labels.length>0?u.jsx(ic,{data:o,options:E}):u.jsx("div",{className:"text-gray-500",children:"Không có dữ liệu"})})]})]}),u.jsxs("div",{className:"bg-white rounded-md shadow-md overflow-hidden border border-gray-200 p-4 flex flex-col gap-4",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Theo thời gian"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{className:`px-4 py-1 text-sm rounded-full ${e==="7days"?"bg-blue-500 text-white":"border border-gray-300 text-gray-700"}`,onClick:()=>t("7days"),children:"7 ngày"}),u.jsx("button",{className:`px-4 py-1 text-sm rounded-full ${e==="30days"?"bg-blue-500 text-white":"border border-gray-300 text-gray-700"}`,onClick:()=>t("30days"),children:"30 ngày"}),u.jsx("button",{className:`px-4 py-1 text-sm rounded-full ${e==="90days"?"bg-blue-500 text-white":"border border-gray-300 text-gray-700"}`,onClick:()=>t("90days"),children:"90 ngày"})]}),u.jsx("div",{className:"h-64 flex items-center justify-center p-4",children:n.labels.length>0?u.jsx(mj,{data:n,options:C}):u.jsx("div",{className:"text-gray-500",children:"Không có dữ liệu"})})]})]})]})})},ba=({children:e,requiredRoles:t=[]})=>{const n=qs.isAuthenticated(),a=t.length===0||qs.hasRole(t);if(!n)return u.jsx(Ji,{to:"/login",replace:!0});if(!a){const r=qs.getCurrentUser();return(r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="accountant"?u.jsx(Ji,{to:"/homepage-ketoan",replace:!0}):(r==null?void 0:r.role)==="manager"?u.jsx(Ji,{to:"/homepage-totruong",replace:!0}):u.jsx(Ji,{to:"/login",replace:!0})}return u.jsx(u.Fragment,{children:e})};function wR(){const e=()=>"/login";return u.jsx(A4,{basename:"/KTPM_FE",children:u.jsxs(i4,{children:[u.jsx(mn,{path:"/login",element:u.jsx($4,{})}),u.jsx(mn,{path:"/test",element:u.jsx("div",{children:"Test Page Works!"})}),u.jsx(mn,{path:"/homepage-ketoan",element:u.jsx(ba,{requiredRoles:["admin","accountant"],children:u.jsx(Hj,{})})}),u.jsx(mn,{path:"/quan-ly-khoan-thu",element:u.jsx(ba,{requiredRoles:["admin","accountant"],children:u.jsx($j,{})})}),u.jsx(mn,{path:"/quan-ly-dot-thu-phi",element:u.jsx(ba,{requiredRoles:["admin","accountant"],children:u.jsx(ek,{})})}),u.jsx(mn,{path:"/thong-ke-khoan-thu",element:u.jsx(ba,{requiredRoles:["admin","accountant"],children:u.jsx(_R,{})})}),u.jsx(mn,{path:"/homepage-totruong",element:u.jsx(ba,{requiredRoles:["admin","manager"],children:u.jsx(Pj,{})})}),u.jsx(mn,{path:"/quan-ly-ho-khau",element:u.jsx(ba,{requiredRoles:["admin","manager"],children:u.jsx(Vj,{})})}),u.jsx(mn,{path:"/quan-ly-nhan-khau",element:u.jsx(ba,{requiredRoles:["admin","manager"],children:u.jsx(Xj,{})})}),u.jsx(mn,{path:"/quan-ly-tam-tru",element:u.jsx(ba,{requiredRoles:["admin","manager"],children:u.jsx(nk,{})})}),u.jsx(mn,{path:"/lich-su-thay-doi-nhan-khau",element:u.jsx(ba,{requiredRoles:["admin","manager"],children:u.jsx(rk,{})})}),u.jsx(mn,{path:"/quan-ly-phong",element:u.jsx(ba,{requiredRoles:["admin","manager"],children:u.jsx(kk,{})})}),u.jsx(mn,{path:"/quan-ly-xe",element:u.jsx(ba,{requiredRoles:["admin","manager"],children:u.jsx(Ek,{})})}),u.jsx(mn,{path:"/thong-ke-nhan-khau",element:u.jsx(ba,{requiredRoles:["admin","manager"],children:u.jsx(bR,{})})}),u.jsx(mn,{path:"/",element:u.jsx(Ji,{to:e(),replace:!0})}),u.jsx(mn,{path:"*",element:u.jsx(Ji,{to:e(),replace:!0})})]})})}gS.createRoot(document.getElementById("root")).render(u.jsx(k.StrictMode,{children:u.jsx(wR,{})}));
