var rS=Object.defineProperty;var sS=(e,t,n)=>t in e?rS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Ie=(e,t,n)=>sS(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}})();function iS(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var fd={exports:{}},vo={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O1;function lS(){if(O1)return vo;O1=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(a,r,l){var o=null;if(l!==void 0&&(o=""+l),r.key!==void 0&&(o=""+r.key),"key"in r){l={};for(var h in r)h!=="key"&&(l[h]=r[h])}else l=r;return r=l.ref,{$$typeof:e,type:a,key:o,ref:r!==void 0?r:null,props:l}}return vo.Fragment=t,vo.jsx=n,vo.jsxs=n,vo}var M1;function oS(){return M1||(M1=1,fd.exports=lS()),fd.exports}var c=oS(),dd={exports:{}},qe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R1;function cS(){if(R1)return qe;R1=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),p=Symbol.iterator;function y(Y){return Y===null||typeof Y!="object"?null:(Y=p&&Y[p]||Y["@@iterator"],typeof Y=="function"?Y:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,b={};function T(Y,de,P){this.props=Y,this.context=de,this.refs=b,this.updater=P||w}T.prototype.isReactComponent={},T.prototype.setState=function(Y,de){if(typeof Y!="object"&&typeof Y!="function"&&Y!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Y,de,"setState")},T.prototype.forceUpdate=function(Y){this.updater.enqueueForceUpdate(this,Y,"forceUpdate")};function S(){}S.prototype=T.prototype;function E(Y,de,P){this.props=Y,this.context=de,this.refs=b,this.updater=P||w}var C=E.prototype=new S;C.constructor=E,_(C,T.prototype),C.isPureReactComponent=!0;var A=Array.isArray,F={H:null,A:null,T:null,S:null,V:null},K=Object.prototype.hasOwnProperty;function D(Y,de,P,Z,k,V){return P=V.ref,{$$typeof:e,type:Y,key:de,ref:P!==void 0?P:null,props:V}}function H(Y,de){return D(Y.type,de,void 0,void 0,void 0,Y.props)}function M(Y){return typeof Y=="object"&&Y!==null&&Y.$$typeof===e}function B(Y){var de={"=":"=0",":":"=2"};return"$"+Y.replace(/[=:]/g,function(P){return de[P]})}var I=/\/+/g;function te(Y,de){return typeof Y=="object"&&Y!==null&&Y.key!=null?B(""+Y.key):de.toString(36)}function q(){}function ae(Y){switch(Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason;default:switch(typeof Y.status=="string"?Y.then(q,q):(Y.status="pending",Y.then(function(de){Y.status==="pending"&&(Y.status="fulfilled",Y.value=de)},function(de){Y.status==="pending"&&(Y.status="rejected",Y.reason=de)})),Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason}}throw Y}function re(Y,de,P,Z,k){var V=typeof Y;(V==="undefined"||V==="boolean")&&(Y=null);var U=!1;if(Y===null)U=!0;else switch(V){case"bigint":case"string":case"number":U=!0;break;case"object":switch(Y.$$typeof){case e:case t:U=!0;break;case g:return U=Y._init,re(U(Y._payload),de,P,Z,k)}}if(U)return k=k(Y),U=Z===""?"."+te(Y,0):Z,A(k)?(P="",U!=null&&(P=U.replace(I,"$&/")+"/"),re(k,de,P,"",function(we){return we})):k!=null&&(M(k)&&(k=H(k,P+(k.key==null||Y&&Y.key===k.key?"":(""+k.key).replace(I,"$&/")+"/")+U)),de.push(k)),1;U=0;var Te=Z===""?".":Z+":";if(A(Y))for(var ie=0;ie<Y.length;ie++)Z=Y[ie],V=Te+te(Z,ie),U+=re(Z,de,P,V,k);else if(ie=y(Y),typeof ie=="function")for(Y=ie.call(Y),ie=0;!(Z=Y.next()).done;)Z=Z.value,V=Te+te(Z,ie++),U+=re(Z,de,P,V,k);else if(V==="object"){if(typeof Y.then=="function")return re(ae(Y),de,P,Z,k);throw de=String(Y),Error("Objects are not valid as a React child (found: "+(de==="[object Object]"?"object with keys {"+Object.keys(Y).join(", ")+"}":de)+"). If you meant to render a collection of children, use an array instead.")}return U}function ee(Y,de,P){if(Y==null)return Y;var Z=[],k=0;return re(Y,Z,"","",function(V){return de.call(P,V,k++)}),Z}function Q(Y){if(Y._status===-1){var de=Y._result;de=de(),de.then(function(P){(Y._status===0||Y._status===-1)&&(Y._status=1,Y._result=P)},function(P){(Y._status===0||Y._status===-1)&&(Y._status=2,Y._result=P)}),Y._status===-1&&(Y._status=0,Y._result=de)}if(Y._status===1)return Y._result.default;throw Y._result}var pe=typeof reportError=="function"?reportError:function(Y){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var de=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Y=="object"&&Y!==null&&typeof Y.message=="string"?String(Y.message):String(Y),error:Y});if(!window.dispatchEvent(de))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Y);return}console.error(Y)};function ye(){}return qe.Children={map:ee,forEach:function(Y,de,P){ee(Y,function(){de.apply(this,arguments)},P)},count:function(Y){var de=0;return ee(Y,function(){de++}),de},toArray:function(Y){return ee(Y,function(de){return de})||[]},only:function(Y){if(!M(Y))throw Error("React.Children.only expected to receive a single React element child.");return Y}},qe.Component=T,qe.Fragment=n,qe.Profiler=r,qe.PureComponent=E,qe.StrictMode=a,qe.Suspense=f,qe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=F,qe.__COMPILER_RUNTIME={__proto__:null,c:function(Y){return F.H.useMemoCache(Y)}},qe.cache=function(Y){return function(){return Y.apply(null,arguments)}},qe.cloneElement=function(Y,de,P){if(Y==null)throw Error("The argument must be a React element, but you passed "+Y+".");var Z=_({},Y.props),k=Y.key,V=void 0;if(de!=null)for(U in de.ref!==void 0&&(V=void 0),de.key!==void 0&&(k=""+de.key),de)!K.call(de,U)||U==="key"||U==="__self"||U==="__source"||U==="ref"&&de.ref===void 0||(Z[U]=de[U]);var U=arguments.length-2;if(U===1)Z.children=P;else if(1<U){for(var Te=Array(U),ie=0;ie<U;ie++)Te[ie]=arguments[ie+2];Z.children=Te}return D(Y.type,k,void 0,void 0,V,Z)},qe.createContext=function(Y){return Y={$$typeof:o,_currentValue:Y,_currentValue2:Y,_threadCount:0,Provider:null,Consumer:null},Y.Provider=Y,Y.Consumer={$$typeof:l,_context:Y},Y},qe.createElement=function(Y,de,P){var Z,k={},V=null;if(de!=null)for(Z in de.key!==void 0&&(V=""+de.key),de)K.call(de,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(k[Z]=de[Z]);var U=arguments.length-2;if(U===1)k.children=P;else if(1<U){for(var Te=Array(U),ie=0;ie<U;ie++)Te[ie]=arguments[ie+2];k.children=Te}if(Y&&Y.defaultProps)for(Z in U=Y.defaultProps,U)k[Z]===void 0&&(k[Z]=U[Z]);return D(Y,V,void 0,void 0,null,k)},qe.createRef=function(){return{current:null}},qe.forwardRef=function(Y){return{$$typeof:h,render:Y}},qe.isValidElement=M,qe.lazy=function(Y){return{$$typeof:g,_payload:{_status:-1,_result:Y},_init:Q}},qe.memo=function(Y,de){return{$$typeof:d,type:Y,compare:de===void 0?null:de}},qe.startTransition=function(Y){var de=F.T,P={};F.T=P;try{var Z=Y(),k=F.S;k!==null&&k(P,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(ye,pe)}catch(V){pe(V)}finally{F.T=de}},qe.unstable_useCacheRefresh=function(){return F.H.useCacheRefresh()},qe.use=function(Y){return F.H.use(Y)},qe.useActionState=function(Y,de,P){return F.H.useActionState(Y,de,P)},qe.useCallback=function(Y,de){return F.H.useCallback(Y,de)},qe.useContext=function(Y){return F.H.useContext(Y)},qe.useDebugValue=function(){},qe.useDeferredValue=function(Y,de){return F.H.useDeferredValue(Y,de)},qe.useEffect=function(Y,de,P){var Z=F.H;if(typeof P=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Z.useEffect(Y,de)},qe.useId=function(){return F.H.useId()},qe.useImperativeHandle=function(Y,de,P){return F.H.useImperativeHandle(Y,de,P)},qe.useInsertionEffect=function(Y,de){return F.H.useInsertionEffect(Y,de)},qe.useLayoutEffect=function(Y,de){return F.H.useLayoutEffect(Y,de)},qe.useMemo=function(Y,de){return F.H.useMemo(Y,de)},qe.useOptimistic=function(Y,de){return F.H.useOptimistic(Y,de)},qe.useReducer=function(Y,de,P){return F.H.useReducer(Y,de,P)},qe.useRef=function(Y){return F.H.useRef(Y)},qe.useState=function(Y){return F.H.useState(Y)},qe.useSyncExternalStore=function(Y,de,P){return F.H.useSyncExternalStore(Y,de,P)},qe.useTransition=function(){return F.H.useTransition()},qe.version="19.1.0",qe}var F1;function sx(){return F1||(F1=1,dd.exports=cS()),dd.exports}var j=sx();const Vh=iS(j);var xd={exports:{}},bo={},gd={exports:{}},md={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L1;function uS(){return L1||(L1=1,function(e){function t(ee,Q){var pe=ee.length;ee.push(Q);e:for(;0<pe;){var ye=pe-1>>>1,Y=ee[ye];if(0<r(Y,Q))ee[ye]=Q,ee[pe]=Y,pe=ye;else break e}}function n(ee){return ee.length===0?null:ee[0]}function a(ee){if(ee.length===0)return null;var Q=ee[0],pe=ee.pop();if(pe!==Q){ee[0]=pe;e:for(var ye=0,Y=ee.length,de=Y>>>1;ye<de;){var P=2*(ye+1)-1,Z=ee[P],k=P+1,V=ee[k];if(0>r(Z,pe))k<Y&&0>r(V,Z)?(ee[ye]=V,ee[k]=pe,ye=k):(ee[ye]=Z,ee[P]=pe,ye=P);else if(k<Y&&0>r(V,pe))ee[ye]=V,ee[k]=pe,ye=k;else break e}}return Q}function r(ee,Q){var pe=ee.sortIndex-Q.sortIndex;return pe!==0?pe:ee.id-Q.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,h=o.now();e.unstable_now=function(){return o.now()-h}}var f=[],d=[],g=1,p=null,y=3,w=!1,_=!1,b=!1,T=!1,S=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function A(ee){for(var Q=n(d);Q!==null;){if(Q.callback===null)a(d);else if(Q.startTime<=ee)a(d),Q.sortIndex=Q.expirationTime,t(f,Q);else break;Q=n(d)}}function F(ee){if(b=!1,A(ee),!_)if(n(f)!==null)_=!0,K||(K=!0,te());else{var Q=n(d);Q!==null&&re(F,Q.startTime-ee)}}var K=!1,D=-1,H=5,M=-1;function B(){return T?!0:!(e.unstable_now()-M<H)}function I(){if(T=!1,K){var ee=e.unstable_now();M=ee;var Q=!0;try{e:{_=!1,b&&(b=!1,E(D),D=-1),w=!0;var pe=y;try{t:{for(A(ee),p=n(f);p!==null&&!(p.expirationTime>ee&&B());){var ye=p.callback;if(typeof ye=="function"){p.callback=null,y=p.priorityLevel;var Y=ye(p.expirationTime<=ee);if(ee=e.unstable_now(),typeof Y=="function"){p.callback=Y,A(ee),Q=!0;break t}p===n(f)&&a(f),A(ee)}else a(f);p=n(f)}if(p!==null)Q=!0;else{var de=n(d);de!==null&&re(F,de.startTime-ee),Q=!1}}break e}finally{p=null,y=pe,w=!1}Q=void 0}}finally{Q?te():K=!1}}}var te;if(typeof C=="function")te=function(){C(I)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,ae=q.port2;q.port1.onmessage=I,te=function(){ae.postMessage(null)}}else te=function(){S(I,0)};function re(ee,Q){D=S(function(){ee(e.unstable_now())},Q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_next=function(ee){switch(y){case 1:case 2:case 3:var Q=3;break;default:Q=y}var pe=y;y=Q;try{return ee()}finally{y=pe}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(ee,Q){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var pe=y;y=ee;try{return Q()}finally{y=pe}},e.unstable_scheduleCallback=function(ee,Q,pe){var ye=e.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?ye+pe:ye):pe=ye,ee){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=pe+Y,ee={id:g++,callback:Q,priorityLevel:ee,startTime:pe,expirationTime:Y,sortIndex:-1},pe>ye?(ee.sortIndex=pe,t(d,ee),n(f)===null&&ee===n(d)&&(b?(E(D),D=-1):b=!0,re(F,pe-ye))):(ee.sortIndex=Y,t(f,ee),_||w||(_=!0,K||(K=!0,te()))),ee},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(ee){var Q=y;return function(){var pe=y;y=Q;try{return ee.apply(this,arguments)}finally{y=pe}}}}(md)),md}var B1;function hS(){return B1||(B1=1,gd.exports=uS()),gd.exports}var pd={exports:{}},jn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H1;function fS(){if(H1)return jn;H1=1;var e=sx();function t(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var a={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function l(f,d,g){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:p==null?null:""+p,children:f,containerInfo:d,implementation:g}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return jn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,jn.createPortal=function(f,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return l(f,d,null,g)},jn.flushSync=function(f){var d=o.T,g=a.p;try{if(o.T=null,a.p=2,f)return f()}finally{o.T=d,a.p=g,a.d.f()}},jn.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,a.d.C(f,d))},jn.prefetchDNS=function(f){typeof f=="string"&&a.d.D(f)},jn.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var g=d.as,p=h(g,d.crossOrigin),y=typeof d.integrity=="string"?d.integrity:void 0,w=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;g==="style"?a.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:y,fetchPriority:w}):g==="script"&&a.d.X(f,{crossOrigin:p,integrity:y,fetchPriority:w,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},jn.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var g=h(d.as,d.crossOrigin);a.d.M(f,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&a.d.M(f)},jn.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var g=d.as,p=h(g,d.crossOrigin);a.d.L(f,g,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},jn.preloadModule=function(f,d){if(typeof f=="string")if(d){var g=h(d.as,d.crossOrigin);a.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else a.d.m(f)},jn.requestFormReset=function(f){a.d.r(f)},jn.unstable_batchedUpdates=function(f,d){return f(d)},jn.useFormState=function(f,d,g){return o.H.useFormState(f,d,g)},jn.useFormStatus=function(){return o.H.useHostTransitionStatus()},jn.version="19.1.0",jn}var P1;function n2(){if(P1)return pd.exports;P1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),pd.exports=fS(),pd.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I1;function dS(){if(I1)return bo;I1=1;var e=hS(),t=sx(),n=n2();function a(s){var i="https://react.dev/errors/"+s;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)i+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var i=s,u=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(u=i.return),s=i.return;while(s)}return i.tag===3?u:null}function o(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function h(s){if(l(s)!==s)throw Error(a(188))}function f(s){var i=s.alternate;if(!i){if(i=l(s),i===null)throw Error(a(188));return i!==s?null:s}for(var u=s,x=i;;){var m=u.return;if(m===null)break;var v=m.alternate;if(v===null){if(x=m.return,x!==null){u=x;continue}break}if(m.child===v.child){for(v=m.child;v;){if(v===u)return h(m),s;if(v===x)return h(m),i;v=v.sibling}throw Error(a(188))}if(u.return!==x.return)u=m,x=v;else{for(var N=!1,R=m.child;R;){if(R===u){N=!0,u=m,x=v;break}if(R===x){N=!0,x=m,u=v;break}R=R.sibling}if(!N){for(R=v.child;R;){if(R===u){N=!0,u=v,x=m;break}if(R===x){N=!0,x=v,u=m;break}R=R.sibling}if(!N)throw Error(a(189))}}if(u.alternate!==x)throw Error(a(190))}if(u.tag!==3)throw Error(a(188));return u.stateNode.current===u?s:i}function d(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s;for(s=s.child;s!==null;){if(i=d(s),i!==null)return i;s=s.sibling}return null}var g=Object.assign,p=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),E=Symbol.for("react.consumer"),C=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),K=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),H=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function te(s){return s===null||typeof s!="object"?null:(s=I&&s[I]||s["@@iterator"],typeof s=="function"?s:null)}var q=Symbol.for("react.client.reference");function ae(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===q?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case _:return"Fragment";case T:return"Profiler";case b:return"StrictMode";case F:return"Suspense";case K:return"SuspenseList";case M:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case w:return"Portal";case C:return(s.displayName||"Context")+".Provider";case E:return(s._context.displayName||"Context")+".Consumer";case A:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case D:return i=s.displayName||null,i!==null?i:ae(s.type)||"Memo";case H:i=s._payload,s=s._init;try{return ae(s(i))}catch{}}return null}var re=Array.isArray,ee=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe={pending:!1,data:null,method:null,action:null},ye=[],Y=-1;function de(s){return{current:s}}function P(s){0>Y||(s.current=ye[Y],ye[Y]=null,Y--)}function Z(s,i){Y++,ye[Y]=s.current,s.current=i}var k=de(null),V=de(null),U=de(null),Te=de(null);function ie(s,i){switch(Z(U,i),Z(V,s),Z(k,null),i.nodeType){case 9:case 11:s=(s=i.documentElement)&&(s=s.namespaceURI)?i1(s):0;break;default:if(s=i.tagName,i=i.namespaceURI)i=i1(i),s=l1(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}P(k),Z(k,s)}function we(){P(k),P(V),P(U)}function Ne(s){s.memoizedState!==null&&Z(Te,s);var i=k.current,u=l1(i,s.type);i!==u&&(Z(V,s),Z(k,u))}function ze(s){V.current===s&&(P(k),P(V)),Te.current===s&&(P(Te),xo._currentValue=pe)}var Ue=Object.prototype.hasOwnProperty,rt=e.unstable_scheduleCallback,Ye=e.unstable_cancelCallback,rn=e.unstable_shouldYield,xt=e.unstable_requestPaint,Fe=e.unstable_now,ft=e.unstable_getCurrentPriorityLevel,Jt=e.unstable_ImmediatePriority,Fn=e.unstable_UserBlockingPriority,Cn=e.unstable_NormalPriority,me=e.unstable_LowPriority,ke=e.unstable_IdlePriority,Le=e.log,Ze=e.unstable_setDisableYieldValue,wt=null,_t=null;function tt(s){if(typeof Le=="function"&&Ze(s),_t&&typeof _t.setStrictMode=="function")try{_t.setStrictMode(wt,s)}catch{}}var gn=Math.clz32?Math.clz32:Cc,Nc=Math.log,Ec=Math.LN2;function Cc(s){return s>>>=0,s===0?32:31-(Nc(s)/Ec|0)|0}var bs=256,ws=4194304;function za(s){var i=s&42;if(i!==0)return i;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function fi(s,i,u){var x=s.pendingLanes;if(x===0)return 0;var m=0,v=s.suspendedLanes,N=s.pingedLanes;s=s.warmLanes;var R=x&134217727;return R!==0?(x=R&~v,x!==0?m=za(x):(N&=R,N!==0?m=za(N):u||(u=R&~s,u!==0&&(m=za(u))))):(R=x&~v,R!==0?m=za(R):N!==0?m=za(N):u||(u=x&~s,u!==0&&(m=za(u)))),m===0?0:i!==0&&i!==m&&(i&v)===0&&(v=m&-m,u=i&-i,v>=u||v===32&&(u&4194048)!==0)?i:m}function _s(s,i){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&i)===0}function kc(s,i){switch(s){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bl(){var s=bs;return bs<<=1,(bs&4194048)===0&&(bs=256),s}function wl(){var s=ws;return ws<<=1,(ws&62914560)===0&&(ws=4194304),s}function _l(s){for(var i=[],u=0;31>u;u++)i.push(s);return i}function Ts(s,i){s.pendingLanes|=i,i!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function di(s,i,u,x,m,v){var N=s.pendingLanes;s.pendingLanes=u,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=u,s.entangledLanes&=u,s.errorRecoveryDisabledLanes&=u,s.shellSuspendCounter=0;var R=s.entanglements,J=s.expirationTimes,ce=s.hiddenUpdates;for(u=N&~u;0<u;){var _e=31-gn(u),Ee=1<<_e;R[_e]=0,J[_e]=-1;var fe=ce[_e];if(fe!==null)for(ce[_e]=null,_e=0;_e<fe.length;_e++){var ge=fe[_e];ge!==null&&(ge.lane&=-536870913)}u&=~Ee}x!==0&&jc(s,x,0),v!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=v&~(N&~i))}function jc(s,i,u){s.pendingLanes|=i,s.suspendedLanes&=~i;var x=31-gn(i);s.entangledLanes|=i,s.entanglements[x]=s.entanglements[x]|1073741824|u&4194090}function Ac(s,i){var u=s.entangledLanes|=i;for(s=s.entanglements;u;){var x=31-gn(u),m=1<<x;m&i|s[x]&i&&(s[x]|=i),u&=~m}}function Tl(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Sl(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Dc(){var s=Q.p;return s!==0?s:(s=window.event,s===void 0?32:E1(s.type))}function lf(s,i){var u=Q.p;try{return Q.p=s,i()}finally{Q.p=u}}var Ua=Math.random().toString(36).slice(2),sn="__reactFiber$"+Ua,ln="__reactProps$"+Ua,Lr="__reactContainer$"+Ua,Nl="__reactEvents$"+Ua,of="__reactListeners$"+Ua,O="__reactHandles$"+Ua,G="__reactResources$"+Ua,L="__reactMarker$"+Ua;function z(s){delete s[sn],delete s[ln],delete s[Nl],delete s[of],delete s[O]}function W(s){var i=s[sn];if(i)return i;for(var u=s.parentNode;u;){if(i=u[Lr]||u[sn]){if(u=i.alternate,i.child!==null||u!==null&&u.child!==null)for(s=h1(s);s!==null;){if(u=s[sn])return u;s=h1(s)}return i}s=u,u=s.parentNode}return null}function X(s){if(s=s[sn]||s[Lr]){var i=s.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return s}return null}function ue(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s.stateNode;throw Error(a(33))}function ve(s){var i=s[G];return i||(i=s[G]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function le(s){s[L]=!0}var he=new Set,xe={};function je(s,i){Oe(s,i),Oe(s+"Capture",i)}function Oe(s,i){for(xe[s]=i,s=0;s<i.length;s++)he.add(i[s])}var He=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ae={},Be={};function Xe(s){return Ue.call(Be,s)?!0:Ue.call(Ae,s)?!1:He.test(s)?Be[s]=!0:(Ae[s]=!0,!1)}function Tt(s,i,u){if(Xe(i))if(u===null)s.removeAttribute(i);else{switch(typeof u){case"undefined":case"function":case"symbol":s.removeAttribute(i);return;case"boolean":var x=i.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){s.removeAttribute(i);return}}s.setAttribute(i,""+u)}}function St(s,i,u){if(u===null)s.removeAttribute(i);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(i);return}s.setAttribute(i,""+u)}}function Dt(s,i,u,x){if(x===null)s.removeAttribute(u);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(u);return}s.setAttributeNS(i,u,""+x)}}var rr,Br;function ua(s){if(rr===void 0)try{throw Error()}catch(u){var i=u.stack.trim().match(/\n( *(at )?)/);rr=i&&i[1]||"",Br=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+rr+s+Br}var ka=!1;function Ss(s,i){if(!s||ka)return"";ka=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(i){var Ee=function(){throw Error()};if(Object.defineProperty(Ee.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ee,[])}catch(ge){var fe=ge}Reflect.construct(s,[],Ee)}else{try{Ee.call()}catch(ge){fe=ge}s.call(Ee.prototype)}}else{try{throw Error()}catch(ge){fe=ge}(Ee=s())&&typeof Ee.catch=="function"&&Ee.catch(function(){})}}catch(ge){if(ge&&fe&&typeof ge.stack=="string")return[ge.stack,fe.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=x.DetermineComponentFrameRoot(),N=v[0],R=v[1];if(N&&R){var J=N.split(`
`),ce=R.split(`
`);for(m=x=0;x<J.length&&!J[x].includes("DetermineComponentFrameRoot");)x++;for(;m<ce.length&&!ce[m].includes("DetermineComponentFrameRoot");)m++;if(x===J.length||m===ce.length)for(x=J.length-1,m=ce.length-1;1<=x&&0<=m&&J[x]!==ce[m];)m--;for(;1<=x&&0<=m;x--,m--)if(J[x]!==ce[m]){if(x!==1||m!==1)do if(x--,m--,0>m||J[x]!==ce[m]){var _e=`
`+J[x].replace(" at new "," at ");return s.displayName&&_e.includes("<anonymous>")&&(_e=_e.replace("<anonymous>",s.displayName)),_e}while(1<=x&&0<=m);break}}}finally{ka=!1,Error.prepareStackTrace=u}return(u=s?s.displayName||s.name:"")?ua(u):""}function ja(s){switch(s.tag){case 26:case 27:case 5:return ua(s.type);case 16:return ua("Lazy");case 13:return ua("Suspense");case 19:return ua("SuspenseList");case 0:case 15:return Ss(s.type,!1);case 11:return Ss(s.type.render,!1);case 1:return Ss(s.type,!0);case 31:return ua("Activity");default:return""}}function eg(s){try{var i="";do i+=ja(s),s=s.return;while(s);return i}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function ha(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function tg(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Jw(s){var i=tg(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),x=""+s[i];if(!s.hasOwnProperty(i)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var m=u.get,v=u.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return m.call(this)},set:function(N){x=""+N,v.call(this,N)}}),Object.defineProperty(s,i,{enumerable:u.enumerable}),{getValue:function(){return x},setValue:function(N){x=""+N},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function Oc(s){s._valueTracker||(s._valueTracker=Jw(s))}function ng(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var u=i.getValue(),x="";return s&&(x=tg(s)?s.checked?"true":"false":s.value),s=x,s!==u?(i.setValue(s),!0):!1}function Mc(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var e_=/[\n"\\]/g;function fa(s){return s.replace(e_,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function cf(s,i,u,x,m,v,N,R){s.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.type=N:s.removeAttribute("type"),i!=null?N==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+ha(i)):s.value!==""+ha(i)&&(s.value=""+ha(i)):N!=="submit"&&N!=="reset"||s.removeAttribute("value"),i!=null?uf(s,N,ha(i)):u!=null?uf(s,N,ha(u)):x!=null&&s.removeAttribute("value"),m==null&&v!=null&&(s.defaultChecked=!!v),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?s.name=""+ha(R):s.removeAttribute("name")}function ag(s,i,u,x,m,v,N,R){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.type=v),i!=null||u!=null){if(!(v!=="submit"&&v!=="reset"||i!=null))return;u=u!=null?""+ha(u):"",i=i!=null?""+ha(i):u,R||i===s.value||(s.value=i),s.defaultValue=i}x=x??m,x=typeof x!="function"&&typeof x!="symbol"&&!!x,s.checked=R?s.checked:!!x,s.defaultChecked=!!x,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(s.name=N)}function uf(s,i,u){i==="number"&&Mc(s.ownerDocument)===s||s.defaultValue===""+u||(s.defaultValue=""+u)}function xi(s,i,u,x){if(s=s.options,i){i={};for(var m=0;m<u.length;m++)i["$"+u[m]]=!0;for(u=0;u<s.length;u++)m=i.hasOwnProperty("$"+s[u].value),s[u].selected!==m&&(s[u].selected=m),m&&x&&(s[u].defaultSelected=!0)}else{for(u=""+ha(u),i=null,m=0;m<s.length;m++){if(s[m].value===u){s[m].selected=!0,x&&(s[m].defaultSelected=!0);return}i!==null||s[m].disabled||(i=s[m])}i!==null&&(i.selected=!0)}}function rg(s,i,u){if(i!=null&&(i=""+ha(i),i!==s.value&&(s.value=i),u==null)){s.defaultValue!==i&&(s.defaultValue=i);return}s.defaultValue=u!=null?""+ha(u):""}function sg(s,i,u,x){if(i==null){if(x!=null){if(u!=null)throw Error(a(92));if(re(x)){if(1<x.length)throw Error(a(93));x=x[0]}u=x}u==null&&(u=""),i=u}u=ha(i),s.defaultValue=u,x=s.textContent,x===u&&x!==""&&x!==null&&(s.value=x)}function gi(s,i){if(i){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=i;return}}s.textContent=i}var t_=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ig(s,i,u){var x=i.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?x?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="":x?s.setProperty(i,u):typeof u!="number"||u===0||t_.has(i)?i==="float"?s.cssFloat=u:s[i]=(""+u).trim():s[i]=u+"px"}function lg(s,i,u){if(i!=null&&typeof i!="object")throw Error(a(62));if(s=s.style,u!=null){for(var x in u)!u.hasOwnProperty(x)||i!=null&&i.hasOwnProperty(x)||(x.indexOf("--")===0?s.setProperty(x,""):x==="float"?s.cssFloat="":s[x]="");for(var m in i)x=i[m],i.hasOwnProperty(m)&&u[m]!==x&&ig(s,m,x)}else for(var v in i)i.hasOwnProperty(v)&&ig(s,v,i[v])}function hf(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var n_=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),a_=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Rc(s){return a_.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var ff=null;function df(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var mi=null,pi=null;function og(s){var i=X(s);if(i&&(s=i.stateNode)){var u=s[ln]||null;e:switch(s=i.stateNode,i.type){case"input":if(cf(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),i=u.name,u.type==="radio"&&i!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+fa(""+i)+'"][type="radio"]'),i=0;i<u.length;i++){var x=u[i];if(x!==s&&x.form===s.form){var m=x[ln]||null;if(!m)throw Error(a(90));cf(x,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(i=0;i<u.length;i++)x=u[i],x.form===s.form&&ng(x)}break e;case"textarea":rg(s,u.value,u.defaultValue);break e;case"select":i=u.value,i!=null&&xi(s,!!u.multiple,i,!1)}}}var xf=!1;function cg(s,i,u){if(xf)return s(i,u);xf=!0;try{var x=s(i);return x}finally{if(xf=!1,(mi!==null||pi!==null)&&(vu(),mi&&(i=mi,s=pi,pi=mi=null,og(i),s)))for(i=0;i<s.length;i++)og(s[i])}}function El(s,i){var u=s.stateNode;if(u===null)return null;var x=u[ln]||null;if(x===null)return null;u=x[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(s=s.type,x=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!x;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(a(231,i,typeof u));return u}var sr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gf=!1;if(sr)try{var Cl={};Object.defineProperty(Cl,"passive",{get:function(){gf=!0}}),window.addEventListener("test",Cl,Cl),window.removeEventListener("test",Cl,Cl)}catch{gf=!1}var Hr=null,mf=null,Fc=null;function ug(){if(Fc)return Fc;var s,i=mf,u=i.length,x,m="value"in Hr?Hr.value:Hr.textContent,v=m.length;for(s=0;s<u&&i[s]===m[s];s++);var N=u-s;for(x=1;x<=N&&i[u-x]===m[v-x];x++);return Fc=m.slice(s,1<x?1-x:void 0)}function Lc(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function Bc(){return!0}function hg(){return!1}function In(s){function i(u,x,m,v,N){this._reactName=u,this._targetInst=m,this.type=x,this.nativeEvent=v,this.target=N,this.currentTarget=null;for(var R in s)s.hasOwnProperty(R)&&(u=s[R],this[R]=u?u(v):v[R]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Bc:hg,this.isPropagationStopped=hg,this}return g(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Bc)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Bc)},persist:function(){},isPersistent:Bc}),i}var Ns={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Hc=In(Ns),kl=g({},Ns,{view:0,detail:0}),r_=In(kl),pf,yf,jl,Pc=g({},kl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bf,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==jl&&(jl&&s.type==="mousemove"?(pf=s.screenX-jl.screenX,yf=s.screenY-jl.screenY):yf=pf=0,jl=s),pf)},movementY:function(s){return"movementY"in s?s.movementY:yf}}),fg=In(Pc),s_=g({},Pc,{dataTransfer:0}),i_=In(s_),l_=g({},kl,{relatedTarget:0}),vf=In(l_),o_=g({},Ns,{animationName:0,elapsedTime:0,pseudoElement:0}),c_=In(o_),u_=g({},Ns,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),h_=In(u_),f_=g({},Ns,{data:0}),dg=In(f_),d_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},x_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},g_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function m_(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=g_[s])?!!i[s]:!1}function bf(){return m_}var p_=g({},kl,{key:function(s){if(s.key){var i=d_[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Lc(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?x_[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bf,charCode:function(s){return s.type==="keypress"?Lc(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Lc(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),y_=In(p_),v_=g({},Pc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xg=In(v_),b_=g({},kl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bf}),w_=In(b_),__=g({},Ns,{propertyName:0,elapsedTime:0,pseudoElement:0}),T_=In(__),S_=g({},Pc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),N_=In(S_),E_=g({},Ns,{newState:0,oldState:0}),C_=In(E_),k_=[9,13,27,32],wf=sr&&"CompositionEvent"in window,Al=null;sr&&"documentMode"in document&&(Al=document.documentMode);var j_=sr&&"TextEvent"in window&&!Al,gg=sr&&(!wf||Al&&8<Al&&11>=Al),mg=" ",pg=!1;function yg(s,i){switch(s){case"keyup":return k_.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vg(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var yi=!1;function A_(s,i){switch(s){case"compositionend":return vg(i);case"keypress":return i.which!==32?null:(pg=!0,mg);case"textInput":return s=i.data,s===mg&&pg?null:s;default:return null}}function D_(s,i){if(yi)return s==="compositionend"||!wf&&yg(s,i)?(s=ug(),Fc=mf=Hr=null,yi=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return gg&&i.locale!=="ko"?null:i.data;default:return null}}var O_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bg(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!O_[s.type]:i==="textarea"}function wg(s,i,u,x){mi?pi?pi.push(x):pi=[x]:mi=x,i=Nu(i,"onChange"),0<i.length&&(u=new Hc("onChange","change",null,u,x),s.push({event:u,listeners:i}))}var Dl=null,Ol=null;function M_(s){t1(s,0)}function Ic(s){var i=ue(s);if(ng(i))return s}function _g(s,i){if(s==="change")return i}var Tg=!1;if(sr){var _f;if(sr){var Tf="oninput"in document;if(!Tf){var Sg=document.createElement("div");Sg.setAttribute("oninput","return;"),Tf=typeof Sg.oninput=="function"}_f=Tf}else _f=!1;Tg=_f&&(!document.documentMode||9<document.documentMode)}function Ng(){Dl&&(Dl.detachEvent("onpropertychange",Eg),Ol=Dl=null)}function Eg(s){if(s.propertyName==="value"&&Ic(Ol)){var i=[];wg(i,Ol,s,df(s)),cg(M_,i)}}function R_(s,i,u){s==="focusin"?(Ng(),Dl=i,Ol=u,Dl.attachEvent("onpropertychange",Eg)):s==="focusout"&&Ng()}function F_(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Ic(Ol)}function L_(s,i){if(s==="click")return Ic(i)}function B_(s,i){if(s==="input"||s==="change")return Ic(i)}function H_(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Qn=typeof Object.is=="function"?Object.is:H_;function Ml(s,i){if(Qn(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var u=Object.keys(s),x=Object.keys(i);if(u.length!==x.length)return!1;for(x=0;x<u.length;x++){var m=u[x];if(!Ue.call(i,m)||!Qn(s[m],i[m]))return!1}return!0}function Cg(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function kg(s,i){var u=Cg(s);s=0;for(var x;u;){if(u.nodeType===3){if(x=s+u.textContent.length,s<=i&&x>=i)return{node:u,offset:i-s};s=x}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Cg(u)}}function jg(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?jg(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function Ag(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var i=Mc(s.document);i instanceof s.HTMLIFrameElement;){try{var u=typeof i.contentWindow.location.href=="string"}catch{u=!1}if(u)s=i.contentWindow;else break;i=Mc(s.document)}return i}function Sf(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}var P_=sr&&"documentMode"in document&&11>=document.documentMode,vi=null,Nf=null,Rl=null,Ef=!1;function Dg(s,i,u){var x=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Ef||vi==null||vi!==Mc(x)||(x=vi,"selectionStart"in x&&Sf(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Rl&&Ml(Rl,x)||(Rl=x,x=Nu(Nf,"onSelect"),0<x.length&&(i=new Hc("onSelect","select",null,i,u),s.push({event:i,listeners:x}),i.target=vi)))}function Es(s,i){var u={};return u[s.toLowerCase()]=i.toLowerCase(),u["Webkit"+s]="webkit"+i,u["Moz"+s]="moz"+i,u}var bi={animationend:Es("Animation","AnimationEnd"),animationiteration:Es("Animation","AnimationIteration"),animationstart:Es("Animation","AnimationStart"),transitionrun:Es("Transition","TransitionRun"),transitionstart:Es("Transition","TransitionStart"),transitioncancel:Es("Transition","TransitionCancel"),transitionend:Es("Transition","TransitionEnd")},Cf={},Og={};sr&&(Og=document.createElement("div").style,"AnimationEvent"in window||(delete bi.animationend.animation,delete bi.animationiteration.animation,delete bi.animationstart.animation),"TransitionEvent"in window||delete bi.transitionend.transition);function Cs(s){if(Cf[s])return Cf[s];if(!bi[s])return s;var i=bi[s],u;for(u in i)if(i.hasOwnProperty(u)&&u in Og)return Cf[s]=i[u];return s}var Mg=Cs("animationend"),Rg=Cs("animationiteration"),Fg=Cs("animationstart"),I_=Cs("transitionrun"),z_=Cs("transitionstart"),U_=Cs("transitioncancel"),Lg=Cs("transitionend"),Bg=new Map,kf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");kf.push("scrollEnd");function Aa(s,i){Bg.set(s,i),je(i,[s])}var Hg=new WeakMap;function da(s,i){if(typeof s=="object"&&s!==null){var u=Hg.get(s);return u!==void 0?u:(i={value:s,source:i,stack:eg(i)},Hg.set(s,i),i)}return{value:s,source:i,stack:eg(i)}}var xa=[],wi=0,jf=0;function zc(){for(var s=wi,i=jf=wi=0;i<s;){var u=xa[i];xa[i++]=null;var x=xa[i];xa[i++]=null;var m=xa[i];xa[i++]=null;var v=xa[i];if(xa[i++]=null,x!==null&&m!==null){var N=x.pending;N===null?m.next=m:(m.next=N.next,N.next=m),x.pending=m}v!==0&&Pg(u,m,v)}}function Uc(s,i,u,x){xa[wi++]=s,xa[wi++]=i,xa[wi++]=u,xa[wi++]=x,jf|=x,s.lanes|=x,s=s.alternate,s!==null&&(s.lanes|=x)}function Af(s,i,u,x){return Uc(s,i,u,x),Vc(s)}function _i(s,i){return Uc(s,null,null,i),Vc(s)}function Pg(s,i,u){s.lanes|=u;var x=s.alternate;x!==null&&(x.lanes|=u);for(var m=!1,v=s.return;v!==null;)v.childLanes|=u,x=v.alternate,x!==null&&(x.childLanes|=u),v.tag===22&&(s=v.stateNode,s===null||s._visibility&1||(m=!0)),s=v,v=v.return;return s.tag===3?(v=s.stateNode,m&&i!==null&&(m=31-gn(u),s=v.hiddenUpdates,x=s[m],x===null?s[m]=[i]:x.push(i),i.lane=u|536870912),v):null}function Vc(s){if(50<so)throw so=0,L0=null,Error(a(185));for(var i=s.return;i!==null;)s=i,i=s.return;return s.tag===3?s.stateNode:null}var Ti={};function V_(s,i,u,x){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zn(s,i,u,x){return new V_(s,i,u,x)}function Df(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ir(s,i){var u=s.alternate;return u===null?(u=Zn(s.tag,i,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=i,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&65011712,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,i=s.dependencies,u.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u.refCleanup=s.refCleanup,u}function Ig(s,i){s.flags&=65011714;var u=s.alternate;return u===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,i=u.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),s}function Kc(s,i,u,x,m,v){var N=0;if(x=s,typeof s=="function")Df(s)&&(N=1);else if(typeof s=="string")N=WT(s,u,k.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case M:return s=Zn(31,u,i,m),s.elementType=M,s.lanes=v,s;case _:return ks(u.children,m,v,i);case b:N=8,m|=24;break;case T:return s=Zn(12,u,i,m|2),s.elementType=T,s.lanes=v,s;case F:return s=Zn(13,u,i,m),s.elementType=F,s.lanes=v,s;case K:return s=Zn(19,u,i,m),s.elementType=K,s.lanes=v,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case S:case C:N=10;break e;case E:N=9;break e;case A:N=11;break e;case D:N=14;break e;case H:N=16,x=null;break e}N=29,u=Error(a(130,s===null?"null":typeof s,"")),x=null}return i=Zn(N,u,i,m),i.elementType=s,i.type=x,i.lanes=v,i}function ks(s,i,u,x){return s=Zn(7,s,x,i),s.lanes=u,s}function Of(s,i,u){return s=Zn(6,s,null,i),s.lanes=u,s}function Mf(s,i,u){return i=Zn(4,s.children!==null?s.children:[],s.key,i),i.lanes=u,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}var Si=[],Ni=0,Wc=null,Gc=0,ga=[],ma=0,js=null,lr=1,or="";function As(s,i){Si[Ni++]=Gc,Si[Ni++]=Wc,Wc=s,Gc=i}function zg(s,i,u){ga[ma++]=lr,ga[ma++]=or,ga[ma++]=js,js=s;var x=lr;s=or;var m=32-gn(x)-1;x&=~(1<<m),u+=1;var v=32-gn(i)+m;if(30<v){var N=m-m%5;v=(x&(1<<N)-1).toString(32),x>>=N,m-=N,lr=1<<32-gn(i)+m|u<<m|x,or=v+s}else lr=1<<v|u<<m|x,or=s}function Rf(s){s.return!==null&&(As(s,1),zg(s,1,0))}function Ff(s){for(;s===Wc;)Wc=Si[--Ni],Si[Ni]=null,Gc=Si[--Ni],Si[Ni]=null;for(;s===js;)js=ga[--ma],ga[ma]=null,or=ga[--ma],ga[ma]=null,lr=ga[--ma],ga[ma]=null}var Ln=null,Ht=null,ut=!1,Ds=null,Va=!1,Lf=Error(a(519));function Os(s){var i=Error(a(418,""));throw Bl(da(i,s)),Lf}function Ug(s){var i=s.stateNode,u=s.type,x=s.memoizedProps;switch(i[sn]=s,i[ln]=x,u){case"dialog":at("cancel",i),at("close",i);break;case"iframe":case"object":case"embed":at("load",i);break;case"video":case"audio":for(u=0;u<lo.length;u++)at(lo[u],i);break;case"source":at("error",i);break;case"img":case"image":case"link":at("error",i),at("load",i);break;case"details":at("toggle",i);break;case"input":at("invalid",i),ag(i,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),Oc(i);break;case"select":at("invalid",i);break;case"textarea":at("invalid",i),sg(i,x.value,x.defaultValue,x.children),Oc(i)}u=x.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||i.textContent===""+u||x.suppressHydrationWarning===!0||s1(i.textContent,u)?(x.popover!=null&&(at("beforetoggle",i),at("toggle",i)),x.onScroll!=null&&at("scroll",i),x.onScrollEnd!=null&&at("scrollend",i),x.onClick!=null&&(i.onclick=Eu),i=!0):i=!1,i||Os(s)}function Vg(s){for(Ln=s.return;Ln;)switch(Ln.tag){case 5:case 13:Va=!1;return;case 27:case 3:Va=!0;return;default:Ln=Ln.return}}function Fl(s){if(s!==Ln)return!1;if(!ut)return Vg(s),ut=!0,!1;var i=s.tag,u;if((u=i!==3&&i!==27)&&((u=i===5)&&(u=s.type,u=!(u!=="form"&&u!=="button")||Z0(s.type,s.memoizedProps)),u=!u),u&&Ht&&Os(s),Vg(s),i===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8)if(u=s.data,u==="/$"){if(i===0){Ht=Oa(s.nextSibling);break e}i--}else u!=="$"&&u!=="$!"&&u!=="$?"||i++;s=s.nextSibling}Ht=null}}else i===27?(i=Ht,es(s.type)?(s=nd,nd=null,Ht=s):Ht=i):Ht=Ln?Oa(s.stateNode.nextSibling):null;return!0}function Ll(){Ht=Ln=null,ut=!1}function Kg(){var s=Ds;return s!==null&&(Vn===null?Vn=s:Vn.push.apply(Vn,s),Ds=null),s}function Bl(s){Ds===null?Ds=[s]:Ds.push(s)}var Bf=de(null),Ms=null,cr=null;function Pr(s,i,u){Z(Bf,i._currentValue),i._currentValue=u}function ur(s){s._currentValue=Bf.current,P(Bf)}function Hf(s,i,u){for(;s!==null;){var x=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,x!==null&&(x.childLanes|=i)):x!==null&&(x.childLanes&i)!==i&&(x.childLanes|=i),s===u)break;s=s.return}}function Pf(s,i,u,x){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var v=m.dependencies;if(v!==null){var N=m.child;v=v.firstContext;e:for(;v!==null;){var R=v;v=m;for(var J=0;J<i.length;J++)if(R.context===i[J]){v.lanes|=u,R=v.alternate,R!==null&&(R.lanes|=u),Hf(v.return,u,s),x||(N=null);break e}v=R.next}}else if(m.tag===18){if(N=m.return,N===null)throw Error(a(341));N.lanes|=u,v=N.alternate,v!==null&&(v.lanes|=u),Hf(N,u,s),N=null}else N=m.child;if(N!==null)N.return=m;else for(N=m;N!==null;){if(N===s){N=null;break}if(m=N.sibling,m!==null){m.return=N.return,N=m;break}N=N.return}m=N}}function Hl(s,i,u,x){s=null;for(var m=i,v=!1;m!==null;){if(!v){if((m.flags&524288)!==0)v=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var N=m.alternate;if(N===null)throw Error(a(387));if(N=N.memoizedProps,N!==null){var R=m.type;Qn(m.pendingProps.value,N.value)||(s!==null?s.push(R):s=[R])}}else if(m===Te.current){if(N=m.alternate,N===null)throw Error(a(387));N.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(xo):s=[xo])}m=m.return}s!==null&&Pf(i,s,u,x),i.flags|=262144}function Xc(s){for(s=s.firstContext;s!==null;){if(!Qn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Rs(s){Ms=s,cr=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function kn(s){return Wg(Ms,s)}function Yc(s,i){return Ms===null&&Rs(s),Wg(s,i)}function Wg(s,i){var u=i._currentValue;if(i={context:i,memoizedValue:u,next:null},cr===null){if(s===null)throw Error(a(308));cr=i,s.dependencies={lanes:0,firstContext:i},s.flags|=524288}else cr=cr.next=i;return u}var K_=typeof AbortController<"u"?AbortController:function(){var s=[],i=this.signal={aborted:!1,addEventListener:function(u,x){s.push(x)}};this.abort=function(){i.aborted=!0,s.forEach(function(u){return u()})}},W_=e.unstable_scheduleCallback,G_=e.unstable_NormalPriority,en={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function If(){return{controller:new K_,data:new Map,refCount:0}}function Pl(s){s.refCount--,s.refCount===0&&W_(G_,function(){s.controller.abort()})}var Il=null,zf=0,Ei=0,Ci=null;function X_(s,i){if(Il===null){var u=Il=[];zf=0,Ei=V0(),Ci={status:"pending",value:void 0,then:function(x){u.push(x)}}}return zf++,i.then(Gg,Gg),i}function Gg(){if(--zf===0&&Il!==null){Ci!==null&&(Ci.status="fulfilled");var s=Il;Il=null,Ei=0,Ci=null;for(var i=0;i<s.length;i++)(0,s[i])()}}function Y_(s,i){var u=[],x={status:"pending",value:null,reason:null,then:function(m){u.push(m)}};return s.then(function(){x.status="fulfilled",x.value=i;for(var m=0;m<u.length;m++)(0,u[m])(i)},function(m){for(x.status="rejected",x.reason=m,m=0;m<u.length;m++)(0,u[m])(void 0)}),x}var Xg=ee.S;ee.S=function(s,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&X_(s,i),Xg!==null&&Xg(s,i)};var Fs=de(null);function Uf(){var s=Fs.current;return s!==null?s:Ot.pooledCache}function qc(s,i){i===null?Z(Fs,Fs.current):Z(Fs,i.pool)}function Yg(){var s=Uf();return s===null?null:{parent:en._currentValue,pool:s}}var zl=Error(a(460)),qg=Error(a(474)),$c=Error(a(542)),Vf={then:function(){}};function $g(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Qc(){}function Qg(s,i,u){switch(u=s[u],u===void 0?s.push(i):u!==i&&(i.then(Qc,Qc),i=u),i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,Jg(s),s;default:if(typeof i.status=="string")i.then(Qc,Qc);else{if(s=Ot,s!==null&&100<s.shellSuspendCounter)throw Error(a(482));s=i,s.status="pending",s.then(function(x){if(i.status==="pending"){var m=i;m.status="fulfilled",m.value=x}},function(x){if(i.status==="pending"){var m=i;m.status="rejected",m.reason=x}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,Jg(s),s}throw Ul=i,zl}}var Ul=null;function Zg(){if(Ul===null)throw Error(a(459));var s=Ul;return Ul=null,s}function Jg(s){if(s===zl||s===$c)throw Error(a(483))}var Ir=!1;function Kf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Wf(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function zr(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ur(s,i,u){var x=s.updateQueue;if(x===null)return null;if(x=x.shared,(gt&2)!==0){var m=x.pending;return m===null?i.next=i:(i.next=m.next,m.next=i),x.pending=i,i=Vc(s),Pg(s,null,u),i}return Uc(s,x,i,u),Vc(s)}function Vl(s,i,u){if(i=i.updateQueue,i!==null&&(i=i.shared,(u&4194048)!==0)){var x=i.lanes;x&=s.pendingLanes,u|=x,i.lanes=u,Ac(s,u)}}function Gf(s,i){var u=s.updateQueue,x=s.alternate;if(x!==null&&(x=x.updateQueue,u===x)){var m=null,v=null;if(u=u.firstBaseUpdate,u!==null){do{var N={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};v===null?m=v=N:v=v.next=N,u=u.next}while(u!==null);v===null?m=v=i:v=v.next=i}else m=v=i;u={baseState:x.baseState,firstBaseUpdate:m,lastBaseUpdate:v,shared:x.shared,callbacks:x.callbacks},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=i:s.next=i,u.lastBaseUpdate=i}var Xf=!1;function Kl(){if(Xf){var s=Ci;if(s!==null)throw s}}function Wl(s,i,u,x){Xf=!1;var m=s.updateQueue;Ir=!1;var v=m.firstBaseUpdate,N=m.lastBaseUpdate,R=m.shared.pending;if(R!==null){m.shared.pending=null;var J=R,ce=J.next;J.next=null,N===null?v=ce:N.next=ce,N=J;var _e=s.alternate;_e!==null&&(_e=_e.updateQueue,R=_e.lastBaseUpdate,R!==N&&(R===null?_e.firstBaseUpdate=ce:R.next=ce,_e.lastBaseUpdate=J))}if(v!==null){var Ee=m.baseState;N=0,_e=ce=J=null,R=v;do{var fe=R.lane&-536870913,ge=fe!==R.lane;if(ge?(it&fe)===fe:(x&fe)===fe){fe!==0&&fe===Ei&&(Xf=!0),_e!==null&&(_e=_e.next={lane:0,tag:R.tag,payload:R.payload,callback:null,next:null});e:{var Ge=s,Ke=R;fe=i;var Ct=u;switch(Ke.tag){case 1:if(Ge=Ke.payload,typeof Ge=="function"){Ee=Ge.call(Ct,Ee,fe);break e}Ee=Ge;break e;case 3:Ge.flags=Ge.flags&-65537|128;case 0:if(Ge=Ke.payload,fe=typeof Ge=="function"?Ge.call(Ct,Ee,fe):Ge,fe==null)break e;Ee=g({},Ee,fe);break e;case 2:Ir=!0}}fe=R.callback,fe!==null&&(s.flags|=64,ge&&(s.flags|=8192),ge=m.callbacks,ge===null?m.callbacks=[fe]:ge.push(fe))}else ge={lane:fe,tag:R.tag,payload:R.payload,callback:R.callback,next:null},_e===null?(ce=_e=ge,J=Ee):_e=_e.next=ge,N|=fe;if(R=R.next,R===null){if(R=m.shared.pending,R===null)break;ge=R,R=ge.next,ge.next=null,m.lastBaseUpdate=ge,m.shared.pending=null}}while(!0);_e===null&&(J=Ee),m.baseState=J,m.firstBaseUpdate=ce,m.lastBaseUpdate=_e,v===null&&(m.shared.lanes=0),$r|=N,s.lanes=N,s.memoizedState=Ee}}function em(s,i){if(typeof s!="function")throw Error(a(191,s));s.call(i)}function tm(s,i){var u=s.callbacks;if(u!==null)for(s.callbacks=null,s=0;s<u.length;s++)em(u[s],i)}var ki=de(null),Zc=de(0);function nm(s,i){s=pr,Z(Zc,s),Z(ki,i),pr=s|i.baseLanes}function Yf(){Z(Zc,pr),Z(ki,ki.current)}function qf(){pr=Zc.current,P(ki),P(Zc)}var Vr=0,Qe=null,Nt=null,Xt=null,Jc=!1,ji=!1,Ls=!1,eu=0,Gl=0,Ai=null,q_=0;function Wt(){throw Error(a(321))}function $f(s,i){if(i===null)return!1;for(var u=0;u<i.length&&u<s.length;u++)if(!Qn(s[u],i[u]))return!1;return!0}function Qf(s,i,u,x,m,v){return Vr=v,Qe=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,ee.H=s===null||s.memoizedState===null?Pm:Im,Ls=!1,v=u(x,m),Ls=!1,ji&&(v=rm(i,u,x,m)),am(s),v}function am(s){ee.H=iu;var i=Nt!==null&&Nt.next!==null;if(Vr=0,Xt=Nt=Qe=null,Jc=!1,Gl=0,Ai=null,i)throw Error(a(300));s===null||on||(s=s.dependencies,s!==null&&Xc(s)&&(on=!0))}function rm(s,i,u,x){Qe=s;var m=0;do{if(ji&&(Ai=null),Gl=0,ji=!1,25<=m)throw Error(a(301));if(m+=1,Xt=Nt=null,s.updateQueue!=null){var v=s.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}ee.H=nT,v=i(u,x)}while(ji);return v}function $_(){var s=ee.H,i=s.useState()[0];return i=typeof i.then=="function"?Xl(i):i,s=s.useState()[0],(Nt!==null?Nt.memoizedState:null)!==s&&(Qe.flags|=1024),i}function Zf(){var s=eu!==0;return eu=0,s}function Jf(s,i,u){i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~u}function e0(s){if(Jc){for(s=s.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}Jc=!1}Vr=0,Xt=Nt=Qe=null,ji=!1,Gl=eu=0,Ai=null}function zn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xt===null?Qe.memoizedState=Xt=s:Xt=Xt.next=s,Xt}function Yt(){if(Nt===null){var s=Qe.alternate;s=s!==null?s.memoizedState:null}else s=Nt.next;var i=Xt===null?Qe.memoizedState:Xt.next;if(i!==null)Xt=i,Nt=s;else{if(s===null)throw Qe.alternate===null?Error(a(467)):Error(a(310));Nt=s,s={memoizedState:Nt.memoizedState,baseState:Nt.baseState,baseQueue:Nt.baseQueue,queue:Nt.queue,next:null},Xt===null?Qe.memoizedState=Xt=s:Xt=Xt.next=s}return Xt}function t0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Xl(s){var i=Gl;return Gl+=1,Ai===null&&(Ai=[]),s=Qg(Ai,s,i),i=Qe,(Xt===null?i.memoizedState:Xt.next)===null&&(i=i.alternate,ee.H=i===null||i.memoizedState===null?Pm:Im),s}function tu(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Xl(s);if(s.$$typeof===C)return kn(s)}throw Error(a(438,String(s)))}function n0(s){var i=null,u=Qe.updateQueue;if(u!==null&&(i=u.memoCache),i==null){var x=Qe.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(i={data:x.data.map(function(m){return m.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),u===null&&(u=t0(),Qe.updateQueue=u),u.memoCache=i,u=i.data[i.index],u===void 0)for(u=i.data[i.index]=Array(s),x=0;x<s;x++)u[x]=B;return i.index++,u}function hr(s,i){return typeof i=="function"?i(s):i}function nu(s){var i=Yt();return a0(i,Nt,s)}function a0(s,i,u){var x=s.queue;if(x===null)throw Error(a(311));x.lastRenderedReducer=u;var m=s.baseQueue,v=x.pending;if(v!==null){if(m!==null){var N=m.next;m.next=v.next,v.next=N}i.baseQueue=m=v,x.pending=null}if(v=s.baseState,m===null)s.memoizedState=v;else{i=m.next;var R=N=null,J=null,ce=i,_e=!1;do{var Ee=ce.lane&-536870913;if(Ee!==ce.lane?(it&Ee)===Ee:(Vr&Ee)===Ee){var fe=ce.revertLane;if(fe===0)J!==null&&(J=J.next={lane:0,revertLane:0,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null}),Ee===Ei&&(_e=!0);else if((Vr&fe)===fe){ce=ce.next,fe===Ei&&(_e=!0);continue}else Ee={lane:0,revertLane:ce.revertLane,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},J===null?(R=J=Ee,N=v):J=J.next=Ee,Qe.lanes|=fe,$r|=fe;Ee=ce.action,Ls&&u(v,Ee),v=ce.hasEagerState?ce.eagerState:u(v,Ee)}else fe={lane:Ee,revertLane:ce.revertLane,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},J===null?(R=J=fe,N=v):J=J.next=fe,Qe.lanes|=Ee,$r|=Ee;ce=ce.next}while(ce!==null&&ce!==i);if(J===null?N=v:J.next=R,!Qn(v,s.memoizedState)&&(on=!0,_e&&(u=Ci,u!==null)))throw u;s.memoizedState=v,s.baseState=N,s.baseQueue=J,x.lastRenderedState=v}return m===null&&(x.lanes=0),[s.memoizedState,x.dispatch]}function r0(s){var i=Yt(),u=i.queue;if(u===null)throw Error(a(311));u.lastRenderedReducer=s;var x=u.dispatch,m=u.pending,v=i.memoizedState;if(m!==null){u.pending=null;var N=m=m.next;do v=s(v,N.action),N=N.next;while(N!==m);Qn(v,i.memoizedState)||(on=!0),i.memoizedState=v,i.baseQueue===null&&(i.baseState=v),u.lastRenderedState=v}return[v,x]}function sm(s,i,u){var x=Qe,m=Yt(),v=ut;if(v){if(u===void 0)throw Error(a(407));u=u()}else u=i();var N=!Qn((Nt||m).memoizedState,u);N&&(m.memoizedState=u,on=!0),m=m.queue;var R=om.bind(null,x,m,s);if(Yl(2048,8,R,[s]),m.getSnapshot!==i||N||Xt!==null&&Xt.memoizedState.tag&1){if(x.flags|=2048,Di(9,au(),lm.bind(null,x,m,u,i),null),Ot===null)throw Error(a(349));v||(Vr&124)!==0||im(x,i,u)}return u}function im(s,i,u){s.flags|=16384,s={getSnapshot:i,value:u},i=Qe.updateQueue,i===null?(i=t0(),Qe.updateQueue=i,i.stores=[s]):(u=i.stores,u===null?i.stores=[s]:u.push(s))}function lm(s,i,u,x){i.value=u,i.getSnapshot=x,cm(i)&&um(s)}function om(s,i,u){return u(function(){cm(i)&&um(s)})}function cm(s){var i=s.getSnapshot;s=s.value;try{var u=i();return!Qn(s,u)}catch{return!0}}function um(s){var i=_i(s,2);i!==null&&aa(i,s,2)}function s0(s){var i=zn();if(typeof s=="function"){var u=s;if(s=u(),Ls){tt(!0);try{u()}finally{tt(!1)}}}return i.memoizedState=i.baseState=s,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:s},i}function hm(s,i,u,x){return s.baseState=u,a0(s,Nt,typeof x=="function"?x:hr)}function Q_(s,i,u,x,m){if(su(s))throw Error(a(485));if(s=i.action,s!==null){var v={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){v.listeners.push(N)}};ee.T!==null?u(!0):v.isTransition=!1,x(v),u=i.pending,u===null?(v.next=i.pending=v,fm(i,v)):(v.next=u.next,i.pending=u.next=v)}}function fm(s,i){var u=i.action,x=i.payload,m=s.state;if(i.isTransition){var v=ee.T,N={};ee.T=N;try{var R=u(m,x),J=ee.S;J!==null&&J(N,R),dm(s,i,R)}catch(ce){i0(s,i,ce)}finally{ee.T=v}}else try{v=u(m,x),dm(s,i,v)}catch(ce){i0(s,i,ce)}}function dm(s,i,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(x){xm(s,i,x)},function(x){return i0(s,i,x)}):xm(s,i,u)}function xm(s,i,u){i.status="fulfilled",i.value=u,gm(i),s.state=u,i=s.pending,i!==null&&(u=i.next,u===i?s.pending=null:(u=u.next,i.next=u,fm(s,u)))}function i0(s,i,u){var x=s.pending;if(s.pending=null,x!==null){x=x.next;do i.status="rejected",i.reason=u,gm(i),i=i.next;while(i!==x)}s.action=null}function gm(s){s=s.listeners;for(var i=0;i<s.length;i++)(0,s[i])()}function mm(s,i){return i}function pm(s,i){if(ut){var u=Ot.formState;if(u!==null){e:{var x=Qe;if(ut){if(Ht){t:{for(var m=Ht,v=Va;m.nodeType!==8;){if(!v){m=null;break t}if(m=Oa(m.nextSibling),m===null){m=null;break t}}v=m.data,m=v==="F!"||v==="F"?m:null}if(m){Ht=Oa(m.nextSibling),x=m.data==="F!";break e}}Os(x)}x=!1}x&&(i=u[0])}}return u=zn(),u.memoizedState=u.baseState=i,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mm,lastRenderedState:i},u.queue=x,u=Lm.bind(null,Qe,x),x.dispatch=u,x=s0(!1),v=h0.bind(null,Qe,!1,x.queue),x=zn(),m={state:i,dispatch:null,action:s,pending:null},x.queue=m,u=Q_.bind(null,Qe,m,v,u),m.dispatch=u,x.memoizedState=s,[i,u,!1]}function ym(s){var i=Yt();return vm(i,Nt,s)}function vm(s,i,u){if(i=a0(s,i,mm)[0],s=nu(hr)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var x=Xl(i)}catch(N){throw N===zl?$c:N}else x=i;i=Yt();var m=i.queue,v=m.dispatch;return u!==i.memoizedState&&(Qe.flags|=2048,Di(9,au(),Z_.bind(null,m,u),null)),[x,v,s]}function Z_(s,i){s.action=i}function bm(s){var i=Yt(),u=Nt;if(u!==null)return vm(i,u,s);Yt(),i=i.memoizedState,u=Yt();var x=u.queue.dispatch;return u.memoizedState=s,[i,x,!1]}function Di(s,i,u,x){return s={tag:s,create:u,deps:x,inst:i,next:null},i=Qe.updateQueue,i===null&&(i=t0(),Qe.updateQueue=i),u=i.lastEffect,u===null?i.lastEffect=s.next=s:(x=u.next,u.next=s,s.next=x,i.lastEffect=s),s}function au(){return{destroy:void 0,resource:void 0}}function wm(){return Yt().memoizedState}function ru(s,i,u,x){var m=zn();x=x===void 0?null:x,Qe.flags|=s,m.memoizedState=Di(1|i,au(),u,x)}function Yl(s,i,u,x){var m=Yt();x=x===void 0?null:x;var v=m.memoizedState.inst;Nt!==null&&x!==null&&$f(x,Nt.memoizedState.deps)?m.memoizedState=Di(i,v,u,x):(Qe.flags|=s,m.memoizedState=Di(1|i,v,u,x))}function _m(s,i){ru(8390656,8,s,i)}function Tm(s,i){Yl(2048,8,s,i)}function Sm(s,i){return Yl(4,2,s,i)}function Nm(s,i){return Yl(4,4,s,i)}function Em(s,i){if(typeof i=="function"){s=s();var u=i(s);return function(){typeof u=="function"?u():i(null)}}if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function Cm(s,i,u){u=u!=null?u.concat([s]):null,Yl(4,4,Em.bind(null,i,s),u)}function l0(){}function km(s,i){var u=Yt();i=i===void 0?null:i;var x=u.memoizedState;return i!==null&&$f(i,x[1])?x[0]:(u.memoizedState=[s,i],s)}function jm(s,i){var u=Yt();i=i===void 0?null:i;var x=u.memoizedState;if(i!==null&&$f(i,x[1]))return x[0];if(x=s(),Ls){tt(!0);try{s()}finally{tt(!1)}}return u.memoizedState=[x,i],x}function o0(s,i,u){return u===void 0||(Vr&1073741824)!==0?s.memoizedState=i:(s.memoizedState=u,s=Op(),Qe.lanes|=s,$r|=s,u)}function Am(s,i,u,x){return Qn(u,i)?u:ki.current!==null?(s=o0(s,u,x),Qn(s,i)||(on=!0),s):(Vr&42)===0?(on=!0,s.memoizedState=u):(s=Op(),Qe.lanes|=s,$r|=s,i)}function Dm(s,i,u,x,m){var v=Q.p;Q.p=v!==0&&8>v?v:8;var N=ee.T,R={};ee.T=R,h0(s,!1,i,u);try{var J=m(),ce=ee.S;if(ce!==null&&ce(R,J),J!==null&&typeof J=="object"&&typeof J.then=="function"){var _e=Y_(J,x);ql(s,i,_e,na(s))}else ql(s,i,x,na(s))}catch(Ee){ql(s,i,{then:function(){},status:"rejected",reason:Ee},na())}finally{Q.p=v,ee.T=N}}function J_(){}function c0(s,i,u,x){if(s.tag!==5)throw Error(a(476));var m=Om(s).queue;Dm(s,m,i,pe,u===null?J_:function(){return Mm(s),u(x)})}function Om(s){var i=s.memoizedState;if(i!==null)return i;i={memoizedState:pe,baseState:pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:pe},next:null};var u={};return i.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:u},next:null},s.memoizedState=i,s=s.alternate,s!==null&&(s.memoizedState=i),i}function Mm(s){var i=Om(s).next.queue;ql(s,i,{},na())}function u0(){return kn(xo)}function Rm(){return Yt().memoizedState}function Fm(){return Yt().memoizedState}function eT(s){for(var i=s.return;i!==null;){switch(i.tag){case 24:case 3:var u=na();s=zr(u);var x=Ur(i,s,u);x!==null&&(aa(x,i,u),Vl(x,i,u)),i={cache:If()},s.payload=i;return}i=i.return}}function tT(s,i,u){var x=na();u={lane:x,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},su(s)?Bm(i,u):(u=Af(s,i,u,x),u!==null&&(aa(u,s,x),Hm(u,i,x)))}function Lm(s,i,u){var x=na();ql(s,i,u,x)}function ql(s,i,u,x){var m={lane:x,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(su(s))Bm(i,m);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=i.lastRenderedReducer,v!==null))try{var N=i.lastRenderedState,R=v(N,u);if(m.hasEagerState=!0,m.eagerState=R,Qn(R,N))return Uc(s,i,m,0),Ot===null&&zc(),!1}catch{}finally{}if(u=Af(s,i,m,x),u!==null)return aa(u,s,x),Hm(u,i,x),!0}return!1}function h0(s,i,u,x){if(x={lane:2,revertLane:V0(),action:x,hasEagerState:!1,eagerState:null,next:null},su(s)){if(i)throw Error(a(479))}else i=Af(s,u,x,2),i!==null&&aa(i,s,2)}function su(s){var i=s.alternate;return s===Qe||i!==null&&i===Qe}function Bm(s,i){ji=Jc=!0;var u=s.pending;u===null?i.next=i:(i.next=u.next,u.next=i),s.pending=i}function Hm(s,i,u){if((u&4194048)!==0){var x=i.lanes;x&=s.pendingLanes,u|=x,i.lanes=u,Ac(s,u)}}var iu={readContext:kn,use:tu,useCallback:Wt,useContext:Wt,useEffect:Wt,useImperativeHandle:Wt,useLayoutEffect:Wt,useInsertionEffect:Wt,useMemo:Wt,useReducer:Wt,useRef:Wt,useState:Wt,useDebugValue:Wt,useDeferredValue:Wt,useTransition:Wt,useSyncExternalStore:Wt,useId:Wt,useHostTransitionStatus:Wt,useFormState:Wt,useActionState:Wt,useOptimistic:Wt,useMemoCache:Wt,useCacheRefresh:Wt},Pm={readContext:kn,use:tu,useCallback:function(s,i){return zn().memoizedState=[s,i===void 0?null:i],s},useContext:kn,useEffect:_m,useImperativeHandle:function(s,i,u){u=u!=null?u.concat([s]):null,ru(4194308,4,Em.bind(null,i,s),u)},useLayoutEffect:function(s,i){return ru(4194308,4,s,i)},useInsertionEffect:function(s,i){ru(4,2,s,i)},useMemo:function(s,i){var u=zn();i=i===void 0?null:i;var x=s();if(Ls){tt(!0);try{s()}finally{tt(!1)}}return u.memoizedState=[x,i],x},useReducer:function(s,i,u){var x=zn();if(u!==void 0){var m=u(i);if(Ls){tt(!0);try{u(i)}finally{tt(!1)}}}else m=i;return x.memoizedState=x.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},x.queue=s,s=s.dispatch=tT.bind(null,Qe,s),[x.memoizedState,s]},useRef:function(s){var i=zn();return s={current:s},i.memoizedState=s},useState:function(s){s=s0(s);var i=s.queue,u=Lm.bind(null,Qe,i);return i.dispatch=u,[s.memoizedState,u]},useDebugValue:l0,useDeferredValue:function(s,i){var u=zn();return o0(u,s,i)},useTransition:function(){var s=s0(!1);return s=Dm.bind(null,Qe,s.queue,!0,!1),zn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,i,u){var x=Qe,m=zn();if(ut){if(u===void 0)throw Error(a(407));u=u()}else{if(u=i(),Ot===null)throw Error(a(349));(it&124)!==0||im(x,i,u)}m.memoizedState=u;var v={value:u,getSnapshot:i};return m.queue=v,_m(om.bind(null,x,v,s),[s]),x.flags|=2048,Di(9,au(),lm.bind(null,x,v,u,i),null),u},useId:function(){var s=zn(),i=Ot.identifierPrefix;if(ut){var u=or,x=lr;u=(x&~(1<<32-gn(x)-1)).toString(32)+u,i="«"+i+"R"+u,u=eu++,0<u&&(i+="H"+u.toString(32)),i+="»"}else u=q_++,i="«"+i+"r"+u.toString(32)+"»";return s.memoizedState=i},useHostTransitionStatus:u0,useFormState:pm,useActionState:pm,useOptimistic:function(s){var i=zn();i.memoizedState=i.baseState=s;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=u,i=h0.bind(null,Qe,!0,u),u.dispatch=i,[s,i]},useMemoCache:n0,useCacheRefresh:function(){return zn().memoizedState=eT.bind(null,Qe)}},Im={readContext:kn,use:tu,useCallback:km,useContext:kn,useEffect:Tm,useImperativeHandle:Cm,useInsertionEffect:Sm,useLayoutEffect:Nm,useMemo:jm,useReducer:nu,useRef:wm,useState:function(){return nu(hr)},useDebugValue:l0,useDeferredValue:function(s,i){var u=Yt();return Am(u,Nt.memoizedState,s,i)},useTransition:function(){var s=nu(hr)[0],i=Yt().memoizedState;return[typeof s=="boolean"?s:Xl(s),i]},useSyncExternalStore:sm,useId:Rm,useHostTransitionStatus:u0,useFormState:ym,useActionState:ym,useOptimistic:function(s,i){var u=Yt();return hm(u,Nt,s,i)},useMemoCache:n0,useCacheRefresh:Fm},nT={readContext:kn,use:tu,useCallback:km,useContext:kn,useEffect:Tm,useImperativeHandle:Cm,useInsertionEffect:Sm,useLayoutEffect:Nm,useMemo:jm,useReducer:r0,useRef:wm,useState:function(){return r0(hr)},useDebugValue:l0,useDeferredValue:function(s,i){var u=Yt();return Nt===null?o0(u,s,i):Am(u,Nt.memoizedState,s,i)},useTransition:function(){var s=r0(hr)[0],i=Yt().memoizedState;return[typeof s=="boolean"?s:Xl(s),i]},useSyncExternalStore:sm,useId:Rm,useHostTransitionStatus:u0,useFormState:bm,useActionState:bm,useOptimistic:function(s,i){var u=Yt();return Nt!==null?hm(u,Nt,s,i):(u.baseState=s,[s,u.queue.dispatch])},useMemoCache:n0,useCacheRefresh:Fm},Oi=null,$l=0;function lu(s){var i=$l;return $l+=1,Oi===null&&(Oi=[]),Qg(Oi,s,i)}function Ql(s,i){i=i.props.ref,s.ref=i!==void 0?i:null}function ou(s,i){throw i.$$typeof===p?Error(a(525)):(s=Object.prototype.toString.call(i),Error(a(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)))}function zm(s){var i=s._init;return i(s._payload)}function Um(s){function i(se,ne){if(s){var oe=se.deletions;oe===null?(se.deletions=[ne],se.flags|=16):oe.push(ne)}}function u(se,ne){if(!s)return null;for(;ne!==null;)i(se,ne),ne=ne.sibling;return null}function x(se){for(var ne=new Map;se!==null;)se.key!==null?ne.set(se.key,se):ne.set(se.index,se),se=se.sibling;return ne}function m(se,ne){return se=ir(se,ne),se.index=0,se.sibling=null,se}function v(se,ne,oe){return se.index=oe,s?(oe=se.alternate,oe!==null?(oe=oe.index,oe<ne?(se.flags|=67108866,ne):oe):(se.flags|=67108866,ne)):(se.flags|=1048576,ne)}function N(se){return s&&se.alternate===null&&(se.flags|=67108866),se}function R(se,ne,oe,Se){return ne===null||ne.tag!==6?(ne=Of(oe,se.mode,Se),ne.return=se,ne):(ne=m(ne,oe),ne.return=se,ne)}function J(se,ne,oe,Se){var Pe=oe.type;return Pe===_?_e(se,ne,oe.props.children,Se,oe.key):ne!==null&&(ne.elementType===Pe||typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===H&&zm(Pe)===ne.type)?(ne=m(ne,oe.props),Ql(ne,oe),ne.return=se,ne):(ne=Kc(oe.type,oe.key,oe.props,null,se.mode,Se),Ql(ne,oe),ne.return=se,ne)}function ce(se,ne,oe,Se){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==oe.containerInfo||ne.stateNode.implementation!==oe.implementation?(ne=Mf(oe,se.mode,Se),ne.return=se,ne):(ne=m(ne,oe.children||[]),ne.return=se,ne)}function _e(se,ne,oe,Se,Pe){return ne===null||ne.tag!==7?(ne=ks(oe,se.mode,Se,Pe),ne.return=se,ne):(ne=m(ne,oe),ne.return=se,ne)}function Ee(se,ne,oe){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return ne=Of(""+ne,se.mode,oe),ne.return=se,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case y:return oe=Kc(ne.type,ne.key,ne.props,null,se.mode,oe),Ql(oe,ne),oe.return=se,oe;case w:return ne=Mf(ne,se.mode,oe),ne.return=se,ne;case H:var Se=ne._init;return ne=Se(ne._payload),Ee(se,ne,oe)}if(re(ne)||te(ne))return ne=ks(ne,se.mode,oe,null),ne.return=se,ne;if(typeof ne.then=="function")return Ee(se,lu(ne),oe);if(ne.$$typeof===C)return Ee(se,Yc(se,ne),oe);ou(se,ne)}return null}function fe(se,ne,oe,Se){var Pe=ne!==null?ne.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return Pe!==null?null:R(se,ne,""+oe,Se);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case y:return oe.key===Pe?J(se,ne,oe,Se):null;case w:return oe.key===Pe?ce(se,ne,oe,Se):null;case H:return Pe=oe._init,oe=Pe(oe._payload),fe(se,ne,oe,Se)}if(re(oe)||te(oe))return Pe!==null?null:_e(se,ne,oe,Se,null);if(typeof oe.then=="function")return fe(se,ne,lu(oe),Se);if(oe.$$typeof===C)return fe(se,ne,Yc(se,oe),Se);ou(se,oe)}return null}function ge(se,ne,oe,Se,Pe){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return se=se.get(oe)||null,R(ne,se,""+Se,Pe);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case y:return se=se.get(Se.key===null?oe:Se.key)||null,J(ne,se,Se,Pe);case w:return se=se.get(Se.key===null?oe:Se.key)||null,ce(ne,se,Se,Pe);case H:var Je=Se._init;return Se=Je(Se._payload),ge(se,ne,oe,Se,Pe)}if(re(Se)||te(Se))return se=se.get(oe)||null,_e(ne,se,Se,Pe,null);if(typeof Se.then=="function")return ge(se,ne,oe,lu(Se),Pe);if(Se.$$typeof===C)return ge(se,ne,oe,Yc(ne,Se),Pe);ou(ne,Se)}return null}function Ge(se,ne,oe,Se){for(var Pe=null,Je=null,Ve=ne,We=ne=0,un=null;Ve!==null&&We<oe.length;We++){Ve.index>We?(un=Ve,Ve=null):un=Ve.sibling;var ot=fe(se,Ve,oe[We],Se);if(ot===null){Ve===null&&(Ve=un);break}s&&Ve&&ot.alternate===null&&i(se,Ve),ne=v(ot,ne,We),Je===null?Pe=ot:Je.sibling=ot,Je=ot,Ve=un}if(We===oe.length)return u(se,Ve),ut&&As(se,We),Pe;if(Ve===null){for(;We<oe.length;We++)Ve=Ee(se,oe[We],Se),Ve!==null&&(ne=v(Ve,ne,We),Je===null?Pe=Ve:Je.sibling=Ve,Je=Ve);return ut&&As(se,We),Pe}for(Ve=x(Ve);We<oe.length;We++)un=ge(Ve,se,We,oe[We],Se),un!==null&&(s&&un.alternate!==null&&Ve.delete(un.key===null?We:un.key),ne=v(un,ne,We),Je===null?Pe=un:Je.sibling=un,Je=un);return s&&Ve.forEach(function(ss){return i(se,ss)}),ut&&As(se,We),Pe}function Ke(se,ne,oe,Se){if(oe==null)throw Error(a(151));for(var Pe=null,Je=null,Ve=ne,We=ne=0,un=null,ot=oe.next();Ve!==null&&!ot.done;We++,ot=oe.next()){Ve.index>We?(un=Ve,Ve=null):un=Ve.sibling;var ss=fe(se,Ve,ot.value,Se);if(ss===null){Ve===null&&(Ve=un);break}s&&Ve&&ss.alternate===null&&i(se,Ve),ne=v(ss,ne,We),Je===null?Pe=ss:Je.sibling=ss,Je=ss,Ve=un}if(ot.done)return u(se,Ve),ut&&As(se,We),Pe;if(Ve===null){for(;!ot.done;We++,ot=oe.next())ot=Ee(se,ot.value,Se),ot!==null&&(ne=v(ot,ne,We),Je===null?Pe=ot:Je.sibling=ot,Je=ot);return ut&&As(se,We),Pe}for(Ve=x(Ve);!ot.done;We++,ot=oe.next())ot=ge(Ve,se,We,ot.value,Se),ot!==null&&(s&&ot.alternate!==null&&Ve.delete(ot.key===null?We:ot.key),ne=v(ot,ne,We),Je===null?Pe=ot:Je.sibling=ot,Je=ot);return s&&Ve.forEach(function(aS){return i(se,aS)}),ut&&As(se,We),Pe}function Ct(se,ne,oe,Se){if(typeof oe=="object"&&oe!==null&&oe.type===_&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case y:e:{for(var Pe=oe.key;ne!==null;){if(ne.key===Pe){if(Pe=oe.type,Pe===_){if(ne.tag===7){u(se,ne.sibling),Se=m(ne,oe.props.children),Se.return=se,se=Se;break e}}else if(ne.elementType===Pe||typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===H&&zm(Pe)===ne.type){u(se,ne.sibling),Se=m(ne,oe.props),Ql(Se,oe),Se.return=se,se=Se;break e}u(se,ne);break}else i(se,ne);ne=ne.sibling}oe.type===_?(Se=ks(oe.props.children,se.mode,Se,oe.key),Se.return=se,se=Se):(Se=Kc(oe.type,oe.key,oe.props,null,se.mode,Se),Ql(Se,oe),Se.return=se,se=Se)}return N(se);case w:e:{for(Pe=oe.key;ne!==null;){if(ne.key===Pe)if(ne.tag===4&&ne.stateNode.containerInfo===oe.containerInfo&&ne.stateNode.implementation===oe.implementation){u(se,ne.sibling),Se=m(ne,oe.children||[]),Se.return=se,se=Se;break e}else{u(se,ne);break}else i(se,ne);ne=ne.sibling}Se=Mf(oe,se.mode,Se),Se.return=se,se=Se}return N(se);case H:return Pe=oe._init,oe=Pe(oe._payload),Ct(se,ne,oe,Se)}if(re(oe))return Ge(se,ne,oe,Se);if(te(oe)){if(Pe=te(oe),typeof Pe!="function")throw Error(a(150));return oe=Pe.call(oe),Ke(se,ne,oe,Se)}if(typeof oe.then=="function")return Ct(se,ne,lu(oe),Se);if(oe.$$typeof===C)return Ct(se,ne,Yc(se,oe),Se);ou(se,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,ne!==null&&ne.tag===6?(u(se,ne.sibling),Se=m(ne,oe),Se.return=se,se=Se):(u(se,ne),Se=Of(oe,se.mode,Se),Se.return=se,se=Se),N(se)):u(se,ne)}return function(se,ne,oe,Se){try{$l=0;var Pe=Ct(se,ne,oe,Se);return Oi=null,Pe}catch(Ve){if(Ve===zl||Ve===$c)throw Ve;var Je=Zn(29,Ve,null,se.mode);return Je.lanes=Se,Je.return=se,Je}finally{}}}var Mi=Um(!0),Vm=Um(!1),pa=de(null),Ka=null;function Kr(s){var i=s.alternate;Z(tn,tn.current&1),Z(pa,s),Ka===null&&(i===null||ki.current!==null||i.memoizedState!==null)&&(Ka=s)}function Km(s){if(s.tag===22){if(Z(tn,tn.current),Z(pa,s),Ka===null){var i=s.alternate;i!==null&&i.memoizedState!==null&&(Ka=s)}}else Wr()}function Wr(){Z(tn,tn.current),Z(pa,pa.current)}function fr(s){P(pa),Ka===s&&(Ka=null),P(tn)}var tn=de(0);function cu(s){for(var i=s;i!==null;){if(i.tag===13){var u=i.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||td(u)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function f0(s,i,u,x){i=s.memoizedState,u=u(x,i),u=u==null?i:g({},i,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var d0={enqueueSetState:function(s,i,u){s=s._reactInternals;var x=na(),m=zr(x);m.payload=i,u!=null&&(m.callback=u),i=Ur(s,m,x),i!==null&&(aa(i,s,x),Vl(i,s,x))},enqueueReplaceState:function(s,i,u){s=s._reactInternals;var x=na(),m=zr(x);m.tag=1,m.payload=i,u!=null&&(m.callback=u),i=Ur(s,m,x),i!==null&&(aa(i,s,x),Vl(i,s,x))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var u=na(),x=zr(u);x.tag=2,i!=null&&(x.callback=i),i=Ur(s,x,u),i!==null&&(aa(i,s,u),Vl(i,s,u))}};function Wm(s,i,u,x,m,v,N){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(x,v,N):i.prototype&&i.prototype.isPureReactComponent?!Ml(u,x)||!Ml(m,v):!0}function Gm(s,i,u,x){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(u,x),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(u,x),i.state!==s&&d0.enqueueReplaceState(i,i.state,null)}function Bs(s,i){var u=i;if("ref"in i){u={};for(var x in i)x!=="ref"&&(u[x]=i[x])}if(s=s.defaultProps){u===i&&(u=g({},u));for(var m in s)u[m]===void 0&&(u[m]=s[m])}return u}var uu=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Xm(s){uu(s)}function Ym(s){console.error(s)}function qm(s){uu(s)}function hu(s,i){try{var u=s.onUncaughtError;u(i.value,{componentStack:i.stack})}catch(x){setTimeout(function(){throw x})}}function $m(s,i,u){try{var x=s.onCaughtError;x(u.value,{componentStack:u.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function x0(s,i,u){return u=zr(u),u.tag=3,u.payload={element:null},u.callback=function(){hu(s,i)},u}function Qm(s){return s=zr(s),s.tag=3,s}function Zm(s,i,u,x){var m=u.type.getDerivedStateFromError;if(typeof m=="function"){var v=x.value;s.payload=function(){return m(v)},s.callback=function(){$m(i,u,x)}}var N=u.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(s.callback=function(){$m(i,u,x),typeof m!="function"&&(Qr===null?Qr=new Set([this]):Qr.add(this));var R=x.stack;this.componentDidCatch(x.value,{componentStack:R!==null?R:""})})}function aT(s,i,u,x,m){if(u.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(i=u.alternate,i!==null&&Hl(i,u,m,!0),u=pa.current,u!==null){switch(u.tag){case 13:return Ka===null?H0():u.alternate===null&&Pt===0&&(Pt=3),u.flags&=-257,u.flags|=65536,u.lanes=m,x===Vf?u.flags|=16384:(i=u.updateQueue,i===null?u.updateQueue=new Set([x]):i.add(x),I0(s,x,m)),!1;case 22:return u.flags|=65536,x===Vf?u.flags|=16384:(i=u.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([x])},u.updateQueue=i):(u=i.retryQueue,u===null?i.retryQueue=new Set([x]):u.add(x)),I0(s,x,m)),!1}throw Error(a(435,u.tag))}return I0(s,x,m),H0(),!1}if(ut)return i=pa.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=m,x!==Lf&&(s=Error(a(422),{cause:x}),Bl(da(s,u)))):(x!==Lf&&(i=Error(a(423),{cause:x}),Bl(da(i,u))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,x=da(x,u),m=x0(s.stateNode,x,m),Gf(s,m),Pt!==4&&(Pt=2)),!1;var v=Error(a(520),{cause:x});if(v=da(v,u),ro===null?ro=[v]:ro.push(v),Pt!==4&&(Pt=2),i===null)return!0;x=da(x,u),u=i;do{switch(u.tag){case 3:return u.flags|=65536,s=m&-m,u.lanes|=s,s=x0(u.stateNode,x,s),Gf(u,s),!1;case 1:if(i=u.type,v=u.stateNode,(u.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Qr===null||!Qr.has(v))))return u.flags|=65536,m&=-m,u.lanes|=m,m=Qm(m),Zm(m,s,u,x),Gf(u,m),!1}u=u.return}while(u!==null);return!1}var Jm=Error(a(461)),on=!1;function mn(s,i,u,x){i.child=s===null?Vm(i,null,u,x):Mi(i,s.child,u,x)}function ep(s,i,u,x,m){u=u.render;var v=i.ref;if("ref"in x){var N={};for(var R in x)R!=="ref"&&(N[R]=x[R])}else N=x;return Rs(i),x=Qf(s,i,u,N,v,m),R=Zf(),s!==null&&!on?(Jf(s,i,m),dr(s,i,m)):(ut&&R&&Rf(i),i.flags|=1,mn(s,i,x,m),i.child)}function tp(s,i,u,x,m){if(s===null){var v=u.type;return typeof v=="function"&&!Df(v)&&v.defaultProps===void 0&&u.compare===null?(i.tag=15,i.type=v,np(s,i,v,x,m)):(s=Kc(u.type,null,x,i,i.mode,m),s.ref=i.ref,s.return=i,i.child=s)}if(v=s.child,!_0(s,m)){var N=v.memoizedProps;if(u=u.compare,u=u!==null?u:Ml,u(N,x)&&s.ref===i.ref)return dr(s,i,m)}return i.flags|=1,s=ir(v,x),s.ref=i.ref,s.return=i,i.child=s}function np(s,i,u,x,m){if(s!==null){var v=s.memoizedProps;if(Ml(v,x)&&s.ref===i.ref)if(on=!1,i.pendingProps=x=v,_0(s,m))(s.flags&131072)!==0&&(on=!0);else return i.lanes=s.lanes,dr(s,i,m)}return g0(s,i,u,x,m)}function ap(s,i,u){var x=i.pendingProps,m=x.children,v=s!==null?s.memoizedState:null;if(x.mode==="hidden"){if((i.flags&128)!==0){if(x=v!==null?v.baseLanes|u:u,s!==null){for(m=i.child=s.child,v=0;m!==null;)v=v|m.lanes|m.childLanes,m=m.sibling;i.childLanes=v&~x}else i.childLanes=0,i.child=null;return rp(s,i,x,u)}if((u&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},s!==null&&qc(i,v!==null?v.cachePool:null),v!==null?nm(i,v):Yf(),Km(i);else return i.lanes=i.childLanes=536870912,rp(s,i,v!==null?v.baseLanes|u:u,u)}else v!==null?(qc(i,v.cachePool),nm(i,v),Wr(),i.memoizedState=null):(s!==null&&qc(i,null),Yf(),Wr());return mn(s,i,m,u),i.child}function rp(s,i,u,x){var m=Uf();return m=m===null?null:{parent:en._currentValue,pool:m},i.memoizedState={baseLanes:u,cachePool:m},s!==null&&qc(i,null),Yf(),Km(i),s!==null&&Hl(s,i,x,!0),null}function fu(s,i){var u=i.ref;if(u===null)s!==null&&s.ref!==null&&(i.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(a(284));(s===null||s.ref!==u)&&(i.flags|=4194816)}}function g0(s,i,u,x,m){return Rs(i),u=Qf(s,i,u,x,void 0,m),x=Zf(),s!==null&&!on?(Jf(s,i,m),dr(s,i,m)):(ut&&x&&Rf(i),i.flags|=1,mn(s,i,u,m),i.child)}function sp(s,i,u,x,m,v){return Rs(i),i.updateQueue=null,u=rm(i,x,u,m),am(s),x=Zf(),s!==null&&!on?(Jf(s,i,v),dr(s,i,v)):(ut&&x&&Rf(i),i.flags|=1,mn(s,i,u,v),i.child)}function ip(s,i,u,x,m){if(Rs(i),i.stateNode===null){var v=Ti,N=u.contextType;typeof N=="object"&&N!==null&&(v=kn(N)),v=new u(x,v),i.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=d0,i.stateNode=v,v._reactInternals=i,v=i.stateNode,v.props=x,v.state=i.memoizedState,v.refs={},Kf(i),N=u.contextType,v.context=typeof N=="object"&&N!==null?kn(N):Ti,v.state=i.memoizedState,N=u.getDerivedStateFromProps,typeof N=="function"&&(f0(i,u,N,x),v.state=i.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(N=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),N!==v.state&&d0.enqueueReplaceState(v,v.state,null),Wl(i,x,v,m),Kl(),v.state=i.memoizedState),typeof v.componentDidMount=="function"&&(i.flags|=4194308),x=!0}else if(s===null){v=i.stateNode;var R=i.memoizedProps,J=Bs(u,R);v.props=J;var ce=v.context,_e=u.contextType;N=Ti,typeof _e=="object"&&_e!==null&&(N=kn(_e));var Ee=u.getDerivedStateFromProps;_e=typeof Ee=="function"||typeof v.getSnapshotBeforeUpdate=="function",R=i.pendingProps!==R,_e||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(R||ce!==N)&&Gm(i,v,x,N),Ir=!1;var fe=i.memoizedState;v.state=fe,Wl(i,x,v,m),Kl(),ce=i.memoizedState,R||fe!==ce||Ir?(typeof Ee=="function"&&(f0(i,u,Ee,x),ce=i.memoizedState),(J=Ir||Wm(i,u,J,x,fe,ce,N))?(_e||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(i.flags|=4194308)):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=x,i.memoizedState=ce),v.props=x,v.state=ce,v.context=N,x=J):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),x=!1)}else{v=i.stateNode,Wf(s,i),N=i.memoizedProps,_e=Bs(u,N),v.props=_e,Ee=i.pendingProps,fe=v.context,ce=u.contextType,J=Ti,typeof ce=="object"&&ce!==null&&(J=kn(ce)),R=u.getDerivedStateFromProps,(ce=typeof R=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(N!==Ee||fe!==J)&&Gm(i,v,x,J),Ir=!1,fe=i.memoizedState,v.state=fe,Wl(i,x,v,m),Kl();var ge=i.memoizedState;N!==Ee||fe!==ge||Ir||s!==null&&s.dependencies!==null&&Xc(s.dependencies)?(typeof R=="function"&&(f0(i,u,R,x),ge=i.memoizedState),(_e=Ir||Wm(i,u,_e,x,fe,ge,J)||s!==null&&s.dependencies!==null&&Xc(s.dependencies))?(ce||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(x,ge,J),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(x,ge,J)),typeof v.componentDidUpdate=="function"&&(i.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof v.componentDidUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(i.flags|=1024),i.memoizedProps=x,i.memoizedState=ge),v.props=x,v.state=ge,v.context=J,x=_e):(typeof v.componentDidUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&fe===s.memoizedState||(i.flags|=1024),x=!1)}return v=x,fu(s,i),x=(i.flags&128)!==0,v||x?(v=i.stateNode,u=x&&typeof u.getDerivedStateFromError!="function"?null:v.render(),i.flags|=1,s!==null&&x?(i.child=Mi(i,s.child,null,m),i.child=Mi(i,null,u,m)):mn(s,i,u,m),i.memoizedState=v.state,s=i.child):s=dr(s,i,m),s}function lp(s,i,u,x){return Ll(),i.flags|=256,mn(s,i,u,x),i.child}var m0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function p0(s){return{baseLanes:s,cachePool:Yg()}}function y0(s,i,u){return s=s!==null?s.childLanes&~u:0,i&&(s|=ya),s}function op(s,i,u){var x=i.pendingProps,m=!1,v=(i.flags&128)!==0,N;if((N=v)||(N=s!==null&&s.memoizedState===null?!1:(tn.current&2)!==0),N&&(m=!0,i.flags&=-129),N=(i.flags&32)!==0,i.flags&=-33,s===null){if(ut){if(m?Kr(i):Wr(),ut){var R=Ht,J;if(J=R){e:{for(J=R,R=Va;J.nodeType!==8;){if(!R){R=null;break e}if(J=Oa(J.nextSibling),J===null){R=null;break e}}R=J}R!==null?(i.memoizedState={dehydrated:R,treeContext:js!==null?{id:lr,overflow:or}:null,retryLane:536870912,hydrationErrors:null},J=Zn(18,null,null,0),J.stateNode=R,J.return=i,i.child=J,Ln=i,Ht=null,J=!0):J=!1}J||Os(i)}if(R=i.memoizedState,R!==null&&(R=R.dehydrated,R!==null))return td(R)?i.lanes=32:i.lanes=536870912,null;fr(i)}return R=x.children,x=x.fallback,m?(Wr(),m=i.mode,R=du({mode:"hidden",children:R},m),x=ks(x,m,u,null),R.return=i,x.return=i,R.sibling=x,i.child=R,m=i.child,m.memoizedState=p0(u),m.childLanes=y0(s,N,u),i.memoizedState=m0,x):(Kr(i),v0(i,R))}if(J=s.memoizedState,J!==null&&(R=J.dehydrated,R!==null)){if(v)i.flags&256?(Kr(i),i.flags&=-257,i=b0(s,i,u)):i.memoizedState!==null?(Wr(),i.child=s.child,i.flags|=128,i=null):(Wr(),m=x.fallback,R=i.mode,x=du({mode:"visible",children:x.children},R),m=ks(m,R,u,null),m.flags|=2,x.return=i,m.return=i,x.sibling=m,i.child=x,Mi(i,s.child,null,u),x=i.child,x.memoizedState=p0(u),x.childLanes=y0(s,N,u),i.memoizedState=m0,i=m);else if(Kr(i),td(R)){if(N=R.nextSibling&&R.nextSibling.dataset,N)var ce=N.dgst;N=ce,x=Error(a(419)),x.stack="",x.digest=N,Bl({value:x,source:null,stack:null}),i=b0(s,i,u)}else if(on||Hl(s,i,u,!1),N=(u&s.childLanes)!==0,on||N){if(N=Ot,N!==null&&(x=u&-u,x=(x&42)!==0?1:Tl(x),x=(x&(N.suspendedLanes|u))!==0?0:x,x!==0&&x!==J.retryLane))throw J.retryLane=x,_i(s,x),aa(N,s,x),Jm;R.data==="$?"||H0(),i=b0(s,i,u)}else R.data==="$?"?(i.flags|=192,i.child=s.child,i=null):(s=J.treeContext,Ht=Oa(R.nextSibling),Ln=i,ut=!0,Ds=null,Va=!1,s!==null&&(ga[ma++]=lr,ga[ma++]=or,ga[ma++]=js,lr=s.id,or=s.overflow,js=i),i=v0(i,x.children),i.flags|=4096);return i}return m?(Wr(),m=x.fallback,R=i.mode,J=s.child,ce=J.sibling,x=ir(J,{mode:"hidden",children:x.children}),x.subtreeFlags=J.subtreeFlags&65011712,ce!==null?m=ir(ce,m):(m=ks(m,R,u,null),m.flags|=2),m.return=i,x.return=i,x.sibling=m,i.child=x,x=m,m=i.child,R=s.child.memoizedState,R===null?R=p0(u):(J=R.cachePool,J!==null?(ce=en._currentValue,J=J.parent!==ce?{parent:ce,pool:ce}:J):J=Yg(),R={baseLanes:R.baseLanes|u,cachePool:J}),m.memoizedState=R,m.childLanes=y0(s,N,u),i.memoizedState=m0,x):(Kr(i),u=s.child,s=u.sibling,u=ir(u,{mode:"visible",children:x.children}),u.return=i,u.sibling=null,s!==null&&(N=i.deletions,N===null?(i.deletions=[s],i.flags|=16):N.push(s)),i.child=u,i.memoizedState=null,u)}function v0(s,i){return i=du({mode:"visible",children:i},s.mode),i.return=s,s.child=i}function du(s,i){return s=Zn(22,s,null,i),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function b0(s,i,u){return Mi(i,s.child,null,u),s=v0(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function cp(s,i,u){s.lanes|=i;var x=s.alternate;x!==null&&(x.lanes|=i),Hf(s.return,i,u)}function w0(s,i,u,x,m){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:x,tail:u,tailMode:m}:(v.isBackwards=i,v.rendering=null,v.renderingStartTime=0,v.last=x,v.tail=u,v.tailMode=m)}function up(s,i,u){var x=i.pendingProps,m=x.revealOrder,v=x.tail;if(mn(s,i,x.children,u),x=tn.current,(x&2)!==0)x=x&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&cp(s,u,i);else if(s.tag===19)cp(s,u,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}x&=1}switch(Z(tn,x),m){case"forwards":for(u=i.child,m=null;u!==null;)s=u.alternate,s!==null&&cu(s)===null&&(m=u),u=u.sibling;u=m,u===null?(m=i.child,i.child=null):(m=u.sibling,u.sibling=null),w0(i,!1,m,u,v);break;case"backwards":for(u=null,m=i.child,i.child=null;m!==null;){if(s=m.alternate,s!==null&&cu(s)===null){i.child=m;break}s=m.sibling,m.sibling=u,u=m,m=s}w0(i,!0,u,null,v);break;case"together":w0(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function dr(s,i,u){if(s!==null&&(i.dependencies=s.dependencies),$r|=i.lanes,(u&i.childLanes)===0)if(s!==null){if(Hl(s,i,u,!1),(u&i.childLanes)===0)return null}else return null;if(s!==null&&i.child!==s.child)throw Error(a(153));if(i.child!==null){for(s=i.child,u=ir(s,s.pendingProps),i.child=u,u.return=i;s.sibling!==null;)s=s.sibling,u=u.sibling=ir(s,s.pendingProps),u.return=i;u.sibling=null}return i.child}function _0(s,i){return(s.lanes&i)!==0?!0:(s=s.dependencies,!!(s!==null&&Xc(s)))}function rT(s,i,u){switch(i.tag){case 3:ie(i,i.stateNode.containerInfo),Pr(i,en,s.memoizedState.cache),Ll();break;case 27:case 5:Ne(i);break;case 4:ie(i,i.stateNode.containerInfo);break;case 10:Pr(i,i.type,i.memoizedProps.value);break;case 13:var x=i.memoizedState;if(x!==null)return x.dehydrated!==null?(Kr(i),i.flags|=128,null):(u&i.child.childLanes)!==0?op(s,i,u):(Kr(i),s=dr(s,i,u),s!==null?s.sibling:null);Kr(i);break;case 19:var m=(s.flags&128)!==0;if(x=(u&i.childLanes)!==0,x||(Hl(s,i,u,!1),x=(u&i.childLanes)!==0),m){if(x)return up(s,i,u);i.flags|=128}if(m=i.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Z(tn,tn.current),x)break;return null;case 22:case 23:return i.lanes=0,ap(s,i,u);case 24:Pr(i,en,s.memoizedState.cache)}return dr(s,i,u)}function hp(s,i,u){if(s!==null)if(s.memoizedProps!==i.pendingProps)on=!0;else{if(!_0(s,u)&&(i.flags&128)===0)return on=!1,rT(s,i,u);on=(s.flags&131072)!==0}else on=!1,ut&&(i.flags&1048576)!==0&&zg(i,Gc,i.index);switch(i.lanes=0,i.tag){case 16:e:{s=i.pendingProps;var x=i.elementType,m=x._init;if(x=m(x._payload),i.type=x,typeof x=="function")Df(x)?(s=Bs(x,s),i.tag=1,i=ip(null,i,x,s,u)):(i.tag=0,i=g0(null,i,x,s,u));else{if(x!=null){if(m=x.$$typeof,m===A){i.tag=11,i=ep(null,i,x,s,u);break e}else if(m===D){i.tag=14,i=tp(null,i,x,s,u);break e}}throw i=ae(x)||x,Error(a(306,i,""))}}return i;case 0:return g0(s,i,i.type,i.pendingProps,u);case 1:return x=i.type,m=Bs(x,i.pendingProps),ip(s,i,x,m,u);case 3:e:{if(ie(i,i.stateNode.containerInfo),s===null)throw Error(a(387));x=i.pendingProps;var v=i.memoizedState;m=v.element,Wf(s,i),Wl(i,x,null,u);var N=i.memoizedState;if(x=N.cache,Pr(i,en,x),x!==v.cache&&Pf(i,[en],u,!0),Kl(),x=N.element,v.isDehydrated)if(v={element:x,isDehydrated:!1,cache:N.cache},i.updateQueue.baseState=v,i.memoizedState=v,i.flags&256){i=lp(s,i,x,u);break e}else if(x!==m){m=da(Error(a(424)),i),Bl(m),i=lp(s,i,x,u);break e}else{switch(s=i.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Ht=Oa(s.firstChild),Ln=i,ut=!0,Ds=null,Va=!0,u=Vm(i,null,x,u),i.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Ll(),x===m){i=dr(s,i,u);break e}mn(s,i,x,u)}i=i.child}return i;case 26:return fu(s,i),s===null?(u=g1(i.type,null,i.pendingProps,null))?i.memoizedState=u:ut||(u=i.type,s=i.pendingProps,x=Cu(U.current).createElement(u),x[sn]=i,x[ln]=s,yn(x,u,s),le(x),i.stateNode=x):i.memoizedState=g1(i.type,s.memoizedProps,i.pendingProps,s.memoizedState),null;case 27:return Ne(i),s===null&&ut&&(x=i.stateNode=f1(i.type,i.pendingProps,U.current),Ln=i,Va=!0,m=Ht,es(i.type)?(nd=m,Ht=Oa(x.firstChild)):Ht=m),mn(s,i,i.pendingProps.children,u),fu(s,i),s===null&&(i.flags|=4194304),i.child;case 5:return s===null&&ut&&((m=x=Ht)&&(x=OT(x,i.type,i.pendingProps,Va),x!==null?(i.stateNode=x,Ln=i,Ht=Oa(x.firstChild),Va=!1,m=!0):m=!1),m||Os(i)),Ne(i),m=i.type,v=i.pendingProps,N=s!==null?s.memoizedProps:null,x=v.children,Z0(m,v)?x=null:N!==null&&Z0(m,N)&&(i.flags|=32),i.memoizedState!==null&&(m=Qf(s,i,$_,null,null,u),xo._currentValue=m),fu(s,i),mn(s,i,x,u),i.child;case 6:return s===null&&ut&&((s=u=Ht)&&(u=MT(u,i.pendingProps,Va),u!==null?(i.stateNode=u,Ln=i,Ht=null,s=!0):s=!1),s||Os(i)),null;case 13:return op(s,i,u);case 4:return ie(i,i.stateNode.containerInfo),x=i.pendingProps,s===null?i.child=Mi(i,null,x,u):mn(s,i,x,u),i.child;case 11:return ep(s,i,i.type,i.pendingProps,u);case 7:return mn(s,i,i.pendingProps,u),i.child;case 8:return mn(s,i,i.pendingProps.children,u),i.child;case 12:return mn(s,i,i.pendingProps.children,u),i.child;case 10:return x=i.pendingProps,Pr(i,i.type,x.value),mn(s,i,x.children,u),i.child;case 9:return m=i.type._context,x=i.pendingProps.children,Rs(i),m=kn(m),x=x(m),i.flags|=1,mn(s,i,x,u),i.child;case 14:return tp(s,i,i.type,i.pendingProps,u);case 15:return np(s,i,i.type,i.pendingProps,u);case 19:return up(s,i,u);case 31:return x=i.pendingProps,u=i.mode,x={mode:x.mode,children:x.children},s===null?(u=du(x,u),u.ref=i.ref,i.child=u,u.return=i,i=u):(u=ir(s.child,x),u.ref=i.ref,i.child=u,u.return=i,i=u),i;case 22:return ap(s,i,u);case 24:return Rs(i),x=kn(en),s===null?(m=Uf(),m===null&&(m=Ot,v=If(),m.pooledCache=v,v.refCount++,v!==null&&(m.pooledCacheLanes|=u),m=v),i.memoizedState={parent:x,cache:m},Kf(i),Pr(i,en,m)):((s.lanes&u)!==0&&(Wf(s,i),Wl(i,null,null,u),Kl()),m=s.memoizedState,v=i.memoizedState,m.parent!==x?(m={parent:x,cache:x},i.memoizedState=m,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=m),Pr(i,en,x)):(x=v.cache,Pr(i,en,x),x!==m.cache&&Pf(i,[en],u,!0))),mn(s,i,i.pendingProps.children,u),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function xr(s){s.flags|=4}function fp(s,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!b1(i)){if(i=pa.current,i!==null&&((it&4194048)===it?Ka!==null:(it&62914560)!==it&&(it&536870912)===0||i!==Ka))throw Ul=Vf,qg;s.flags|=8192}}function xu(s,i){i!==null&&(s.flags|=4),s.flags&16384&&(i=s.tag!==22?wl():536870912,s.lanes|=i,Bi|=i)}function Zl(s,i){if(!ut)switch(s.tailMode){case"hidden":i=s.tail;for(var u=null;i!==null;)i.alternate!==null&&(u=i),i=i.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var x=null;u!==null;)u.alternate!==null&&(x=u),u=u.sibling;x===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:x.sibling=null}}function Bt(s){var i=s.alternate!==null&&s.alternate.child===s.child,u=0,x=0;if(i)for(var m=s.child;m!==null;)u|=m.lanes|m.childLanes,x|=m.subtreeFlags&65011712,x|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)u|=m.lanes|m.childLanes,x|=m.subtreeFlags,x|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=x,s.childLanes=u,i}function sT(s,i,u){var x=i.pendingProps;switch(Ff(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bt(i),null;case 1:return Bt(i),null;case 3:return u=i.stateNode,x=null,s!==null&&(x=s.memoizedState.cache),i.memoizedState.cache!==x&&(i.flags|=2048),ur(en),we(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(s===null||s.child===null)&&(Fl(i)?xr(i):s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Kg())),Bt(i),null;case 26:return u=i.memoizedState,s===null?(xr(i),u!==null?(Bt(i),fp(i,u)):(Bt(i),i.flags&=-16777217)):u?u!==s.memoizedState?(xr(i),Bt(i),fp(i,u)):(Bt(i),i.flags&=-16777217):(s.memoizedProps!==x&&xr(i),Bt(i),i.flags&=-16777217),null;case 27:ze(i),u=U.current;var m=i.type;if(s!==null&&i.stateNode!=null)s.memoizedProps!==x&&xr(i);else{if(!x){if(i.stateNode===null)throw Error(a(166));return Bt(i),null}s=k.current,Fl(i)?Ug(i):(s=f1(m,x,u),i.stateNode=s,xr(i))}return Bt(i),null;case 5:if(ze(i),u=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==x&&xr(i);else{if(!x){if(i.stateNode===null)throw Error(a(166));return Bt(i),null}if(s=k.current,Fl(i))Ug(i);else{switch(m=Cu(U.current),s){case 1:s=m.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:s=m.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":s=m.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":s=m.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":s=m.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof x.is=="string"?m.createElement("select",{is:x.is}):m.createElement("select"),x.multiple?s.multiple=!0:x.size&&(s.size=x.size);break;default:s=typeof x.is=="string"?m.createElement(u,{is:x.is}):m.createElement(u)}}s[sn]=i,s[ln]=x;e:for(m=i.child;m!==null;){if(m.tag===5||m.tag===6)s.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===i)break e;for(;m.sibling===null;){if(m.return===null||m.return===i)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}i.stateNode=s;e:switch(yn(s,u,x),u){case"button":case"input":case"select":case"textarea":s=!!x.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&xr(i)}}return Bt(i),i.flags&=-16777217,null;case 6:if(s&&i.stateNode!=null)s.memoizedProps!==x&&xr(i);else{if(typeof x!="string"&&i.stateNode===null)throw Error(a(166));if(s=U.current,Fl(i)){if(s=i.stateNode,u=i.memoizedProps,x=null,m=Ln,m!==null)switch(m.tag){case 27:case 5:x=m.memoizedProps}s[sn]=i,s=!!(s.nodeValue===u||x!==null&&x.suppressHydrationWarning===!0||s1(s.nodeValue,u)),s||Os(i)}else s=Cu(s).createTextNode(x),s[sn]=i,i.stateNode=s}return Bt(i),null;case 13:if(x=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=Fl(i),x!==null&&x.dehydrated!==null){if(s===null){if(!m)throw Error(a(318));if(m=i.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(a(317));m[sn]=i}else Ll(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Bt(i),m=!1}else m=Kg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return i.flags&256?(fr(i),i):(fr(i),null)}if(fr(i),(i.flags&128)!==0)return i.lanes=u,i;if(u=x!==null,s=s!==null&&s.memoizedState!==null,u){x=i.child,m=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(m=x.alternate.memoizedState.cachePool.pool);var v=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(v=x.memoizedState.cachePool.pool),v!==m&&(x.flags|=2048)}return u!==s&&u&&(i.child.flags|=8192),xu(i,i.updateQueue),Bt(i),null;case 4:return we(),s===null&&X0(i.stateNode.containerInfo),Bt(i),null;case 10:return ur(i.type),Bt(i),null;case 19:if(P(tn),m=i.memoizedState,m===null)return Bt(i),null;if(x=(i.flags&128)!==0,v=m.rendering,v===null)if(x)Zl(m,!1);else{if(Pt!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(v=cu(s),v!==null){for(i.flags|=128,Zl(m,!1),s=v.updateQueue,i.updateQueue=s,xu(i,s),i.subtreeFlags=0,s=u,u=i.child;u!==null;)Ig(u,s),u=u.sibling;return Z(tn,tn.current&1|2),i.child}s=s.sibling}m.tail!==null&&Fe()>pu&&(i.flags|=128,x=!0,Zl(m,!1),i.lanes=4194304)}else{if(!x)if(s=cu(v),s!==null){if(i.flags|=128,x=!0,s=s.updateQueue,i.updateQueue=s,xu(i,s),Zl(m,!0),m.tail===null&&m.tailMode==="hidden"&&!v.alternate&&!ut)return Bt(i),null}else 2*Fe()-m.renderingStartTime>pu&&u!==536870912&&(i.flags|=128,x=!0,Zl(m,!1),i.lanes=4194304);m.isBackwards?(v.sibling=i.child,i.child=v):(s=m.last,s!==null?s.sibling=v:i.child=v,m.last=v)}return m.tail!==null?(i=m.tail,m.rendering=i,m.tail=i.sibling,m.renderingStartTime=Fe(),i.sibling=null,s=tn.current,Z(tn,x?s&1|2:s&1),i):(Bt(i),null);case 22:case 23:return fr(i),qf(),x=i.memoizedState!==null,s!==null?s.memoizedState!==null!==x&&(i.flags|=8192):x&&(i.flags|=8192),x?(u&536870912)!==0&&(i.flags&128)===0&&(Bt(i),i.subtreeFlags&6&&(i.flags|=8192)):Bt(i),u=i.updateQueue,u!==null&&xu(i,u.retryQueue),u=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),x=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(x=i.memoizedState.cachePool.pool),x!==u&&(i.flags|=2048),s!==null&&P(Fs),null;case 24:return u=null,s!==null&&(u=s.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),ur(en),Bt(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function iT(s,i){switch(Ff(i),i.tag){case 1:return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return ur(en),we(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 26:case 27:case 5:return ze(i),null;case 13:if(fr(i),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(a(340));Ll()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return P(tn),null;case 4:return we(),null;case 10:return ur(i.type),null;case 22:case 23:return fr(i),qf(),s!==null&&P(Fs),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 24:return ur(en),null;case 25:return null;default:return null}}function dp(s,i){switch(Ff(i),i.tag){case 3:ur(en),we();break;case 26:case 27:case 5:ze(i);break;case 4:we();break;case 13:fr(i);break;case 19:P(tn);break;case 10:ur(i.type);break;case 22:case 23:fr(i),qf(),s!==null&&P(Fs);break;case 24:ur(en)}}function Jl(s,i){try{var u=i.updateQueue,x=u!==null?u.lastEffect:null;if(x!==null){var m=x.next;u=m;do{if((u.tag&s)===s){x=void 0;var v=u.create,N=u.inst;x=v(),N.destroy=x}u=u.next}while(u!==m)}}catch(R){jt(i,i.return,R)}}function Gr(s,i,u){try{var x=i.updateQueue,m=x!==null?x.lastEffect:null;if(m!==null){var v=m.next;x=v;do{if((x.tag&s)===s){var N=x.inst,R=N.destroy;if(R!==void 0){N.destroy=void 0,m=i;var J=u,ce=R;try{ce()}catch(_e){jt(m,J,_e)}}}x=x.next}while(x!==v)}}catch(_e){jt(i,i.return,_e)}}function xp(s){var i=s.updateQueue;if(i!==null){var u=s.stateNode;try{tm(i,u)}catch(x){jt(s,s.return,x)}}}function gp(s,i,u){u.props=Bs(s.type,s.memoizedProps),u.state=s.memoizedState;try{u.componentWillUnmount()}catch(x){jt(s,i,x)}}function eo(s,i){try{var u=s.ref;if(u!==null){switch(s.tag){case 26:case 27:case 5:var x=s.stateNode;break;case 30:x=s.stateNode;break;default:x=s.stateNode}typeof u=="function"?s.refCleanup=u(x):u.current=x}}catch(m){jt(s,i,m)}}function Wa(s,i){var u=s.ref,x=s.refCleanup;if(u!==null)if(typeof x=="function")try{x()}catch(m){jt(s,i,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(m){jt(s,i,m)}else u.current=null}function mp(s){var i=s.type,u=s.memoizedProps,x=s.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":u.autoFocus&&x.focus();break e;case"img":u.src?x.src=u.src:u.srcSet&&(x.srcset=u.srcSet)}}catch(m){jt(s,s.return,m)}}function T0(s,i,u){try{var x=s.stateNode;CT(x,s.type,u,i),x[ln]=i}catch(m){jt(s,s.return,m)}}function pp(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&es(s.type)||s.tag===4}function S0(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||pp(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&es(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function N0(s,i,u){var x=s.tag;if(x===5||x===6)s=s.stateNode,i?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(s,i):(i=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,i.appendChild(s),u=u._reactRootContainer,u!=null||i.onclick!==null||(i.onclick=Eu));else if(x!==4&&(x===27&&es(s.type)&&(u=s.stateNode,i=null),s=s.child,s!==null))for(N0(s,i,u),s=s.sibling;s!==null;)N0(s,i,u),s=s.sibling}function gu(s,i,u){var x=s.tag;if(x===5||x===6)s=s.stateNode,i?u.insertBefore(s,i):u.appendChild(s);else if(x!==4&&(x===27&&es(s.type)&&(u=s.stateNode),s=s.child,s!==null))for(gu(s,i,u),s=s.sibling;s!==null;)gu(s,i,u),s=s.sibling}function yp(s){var i=s.stateNode,u=s.memoizedProps;try{for(var x=s.type,m=i.attributes;m.length;)i.removeAttributeNode(m[0]);yn(i,x,u),i[sn]=s,i[ln]=u}catch(v){jt(s,s.return,v)}}var gr=!1,Gt=!1,E0=!1,vp=typeof WeakSet=="function"?WeakSet:Set,cn=null;function lT(s,i){if(s=s.containerInfo,$0=Mu,s=Ag(s),Sf(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var x=u.getSelection&&u.getSelection();if(x&&x.rangeCount!==0){u=x.anchorNode;var m=x.anchorOffset,v=x.focusNode;x=x.focusOffset;try{u.nodeType,v.nodeType}catch{u=null;break e}var N=0,R=-1,J=-1,ce=0,_e=0,Ee=s,fe=null;t:for(;;){for(var ge;Ee!==u||m!==0&&Ee.nodeType!==3||(R=N+m),Ee!==v||x!==0&&Ee.nodeType!==3||(J=N+x),Ee.nodeType===3&&(N+=Ee.nodeValue.length),(ge=Ee.firstChild)!==null;)fe=Ee,Ee=ge;for(;;){if(Ee===s)break t;if(fe===u&&++ce===m&&(R=N),fe===v&&++_e===x&&(J=N),(ge=Ee.nextSibling)!==null)break;Ee=fe,fe=Ee.parentNode}Ee=ge}u=R===-1||J===-1?null:{start:R,end:J}}else u=null}u=u||{start:0,end:0}}else u=null;for(Q0={focusedElem:s,selectionRange:u},Mu=!1,cn=i;cn!==null;)if(i=cn,s=i.child,(i.subtreeFlags&1024)!==0&&s!==null)s.return=i,cn=s;else for(;cn!==null;){switch(i=cn,v=i.alternate,s=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&v!==null){s=void 0,u=i,m=v.memoizedProps,v=v.memoizedState,x=u.stateNode;try{var Ge=Bs(u.type,m,u.elementType===u.type);s=x.getSnapshotBeforeUpdate(Ge,v),x.__reactInternalSnapshotBeforeUpdate=s}catch(Ke){jt(u,u.return,Ke)}}break;case 3:if((s&1024)!==0){if(s=i.stateNode.containerInfo,u=s.nodeType,u===9)ed(s);else if(u===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":ed(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(a(163))}if(s=i.sibling,s!==null){s.return=i.return,cn=s;break}cn=i.return}}function bp(s,i,u){var x=u.flags;switch(u.tag){case 0:case 11:case 15:Xr(s,u),x&4&&Jl(5,u);break;case 1:if(Xr(s,u),x&4)if(s=u.stateNode,i===null)try{s.componentDidMount()}catch(N){jt(u,u.return,N)}else{var m=Bs(u.type,i.memoizedProps);i=i.memoizedState;try{s.componentDidUpdate(m,i,s.__reactInternalSnapshotBeforeUpdate)}catch(N){jt(u,u.return,N)}}x&64&&xp(u),x&512&&eo(u,u.return);break;case 3:if(Xr(s,u),x&64&&(s=u.updateQueue,s!==null)){if(i=null,u.child!==null)switch(u.child.tag){case 27:case 5:i=u.child.stateNode;break;case 1:i=u.child.stateNode}try{tm(s,i)}catch(N){jt(u,u.return,N)}}break;case 27:i===null&&x&4&&yp(u);case 26:case 5:Xr(s,u),i===null&&x&4&&mp(u),x&512&&eo(u,u.return);break;case 12:Xr(s,u);break;case 13:Xr(s,u),x&4&&Tp(s,u),x&64&&(s=u.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(u=mT.bind(null,u),RT(s,u))));break;case 22:if(x=u.memoizedState!==null||gr,!x){i=i!==null&&i.memoizedState!==null||Gt,m=gr;var v=Gt;gr=x,(Gt=i)&&!v?Yr(s,u,(u.subtreeFlags&8772)!==0):Xr(s,u),gr=m,Gt=v}break;case 30:break;default:Xr(s,u)}}function wp(s){var i=s.alternate;i!==null&&(s.alternate=null,wp(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&z(i)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Rt=null,Un=!1;function mr(s,i,u){for(u=u.child;u!==null;)_p(s,i,u),u=u.sibling}function _p(s,i,u){if(_t&&typeof _t.onCommitFiberUnmount=="function")try{_t.onCommitFiberUnmount(wt,u)}catch{}switch(u.tag){case 26:Gt||Wa(u,i),mr(s,i,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Gt||Wa(u,i);var x=Rt,m=Un;es(u.type)&&(Rt=u.stateNode,Un=!1),mr(s,i,u),co(u.stateNode),Rt=x,Un=m;break;case 5:Gt||Wa(u,i);case 6:if(x=Rt,m=Un,Rt=null,mr(s,i,u),Rt=x,Un=m,Rt!==null)if(Un)try{(Rt.nodeType===9?Rt.body:Rt.nodeName==="HTML"?Rt.ownerDocument.body:Rt).removeChild(u.stateNode)}catch(v){jt(u,i,v)}else try{Rt.removeChild(u.stateNode)}catch(v){jt(u,i,v)}break;case 18:Rt!==null&&(Un?(s=Rt,u1(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,u.stateNode),yo(s)):u1(Rt,u.stateNode));break;case 4:x=Rt,m=Un,Rt=u.stateNode.containerInfo,Un=!0,mr(s,i,u),Rt=x,Un=m;break;case 0:case 11:case 14:case 15:Gt||Gr(2,u,i),Gt||Gr(4,u,i),mr(s,i,u);break;case 1:Gt||(Wa(u,i),x=u.stateNode,typeof x.componentWillUnmount=="function"&&gp(u,i,x)),mr(s,i,u);break;case 21:mr(s,i,u);break;case 22:Gt=(x=Gt)||u.memoizedState!==null,mr(s,i,u),Gt=x;break;default:mr(s,i,u)}}function Tp(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{yo(s)}catch(u){jt(i,i.return,u)}}function oT(s){switch(s.tag){case 13:case 19:var i=s.stateNode;return i===null&&(i=s.stateNode=new vp),i;case 22:return s=s.stateNode,i=s._retryCache,i===null&&(i=s._retryCache=new vp),i;default:throw Error(a(435,s.tag))}}function C0(s,i){var u=oT(s);i.forEach(function(x){var m=pT.bind(null,s,x);u.has(x)||(u.add(x),x.then(m,m))})}function Jn(s,i){var u=i.deletions;if(u!==null)for(var x=0;x<u.length;x++){var m=u[x],v=s,N=i,R=N;e:for(;R!==null;){switch(R.tag){case 27:if(es(R.type)){Rt=R.stateNode,Un=!1;break e}break;case 5:Rt=R.stateNode,Un=!1;break e;case 3:case 4:Rt=R.stateNode.containerInfo,Un=!0;break e}R=R.return}if(Rt===null)throw Error(a(160));_p(v,N,m),Rt=null,Un=!1,v=m.alternate,v!==null&&(v.return=null),m.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)Sp(i,s),i=i.sibling}var Da=null;function Sp(s,i){var u=s.alternate,x=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Jn(i,s),ea(s),x&4&&(Gr(3,s,s.return),Jl(3,s),Gr(5,s,s.return));break;case 1:Jn(i,s),ea(s),x&512&&(Gt||u===null||Wa(u,u.return)),x&64&&gr&&(s=s.updateQueue,s!==null&&(x=s.callbacks,x!==null&&(u=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=u===null?x:u.concat(x))));break;case 26:var m=Da;if(Jn(i,s),ea(s),x&512&&(Gt||u===null||Wa(u,u.return)),x&4){var v=u!==null?u.memoizedState:null;if(x=s.memoizedState,u===null)if(x===null)if(s.stateNode===null){e:{x=s.type,u=s.memoizedProps,m=m.ownerDocument||m;t:switch(x){case"title":v=m.getElementsByTagName("title")[0],(!v||v[L]||v[sn]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=m.createElement(x),m.head.insertBefore(v,m.querySelector("head > title"))),yn(v,x,u),v[sn]=s,le(v),x=v;break e;case"link":var N=y1("link","href",m).get(x+(u.href||""));if(N){for(var R=0;R<N.length;R++)if(v=N[R],v.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&v.getAttribute("rel")===(u.rel==null?null:u.rel)&&v.getAttribute("title")===(u.title==null?null:u.title)&&v.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){N.splice(R,1);break t}}v=m.createElement(x),yn(v,x,u),m.head.appendChild(v);break;case"meta":if(N=y1("meta","content",m).get(x+(u.content||""))){for(R=0;R<N.length;R++)if(v=N[R],v.getAttribute("content")===(u.content==null?null:""+u.content)&&v.getAttribute("name")===(u.name==null?null:u.name)&&v.getAttribute("property")===(u.property==null?null:u.property)&&v.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&v.getAttribute("charset")===(u.charSet==null?null:u.charSet)){N.splice(R,1);break t}}v=m.createElement(x),yn(v,x,u),m.head.appendChild(v);break;default:throw Error(a(468,x))}v[sn]=s,le(v),x=v}s.stateNode=x}else v1(m,s.type,s.stateNode);else s.stateNode=p1(m,x,s.memoizedProps);else v!==x?(v===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):v.count--,x===null?v1(m,s.type,s.stateNode):p1(m,x,s.memoizedProps)):x===null&&s.stateNode!==null&&T0(s,s.memoizedProps,u.memoizedProps)}break;case 27:Jn(i,s),ea(s),x&512&&(Gt||u===null||Wa(u,u.return)),u!==null&&x&4&&T0(s,s.memoizedProps,u.memoizedProps);break;case 5:if(Jn(i,s),ea(s),x&512&&(Gt||u===null||Wa(u,u.return)),s.flags&32){m=s.stateNode;try{gi(m,"")}catch(ge){jt(s,s.return,ge)}}x&4&&s.stateNode!=null&&(m=s.memoizedProps,T0(s,m,u!==null?u.memoizedProps:m)),x&1024&&(E0=!0);break;case 6:if(Jn(i,s),ea(s),x&4){if(s.stateNode===null)throw Error(a(162));x=s.memoizedProps,u=s.stateNode;try{u.nodeValue=x}catch(ge){jt(s,s.return,ge)}}break;case 3:if(Au=null,m=Da,Da=ku(i.containerInfo),Jn(i,s),Da=m,ea(s),x&4&&u!==null&&u.memoizedState.isDehydrated)try{yo(i.containerInfo)}catch(ge){jt(s,s.return,ge)}E0&&(E0=!1,Np(s));break;case 4:x=Da,Da=ku(s.stateNode.containerInfo),Jn(i,s),ea(s),Da=x;break;case 12:Jn(i,s),ea(s);break;case 13:Jn(i,s),ea(s),s.child.flags&8192&&s.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(M0=Fe()),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,C0(s,x)));break;case 22:m=s.memoizedState!==null;var J=u!==null&&u.memoizedState!==null,ce=gr,_e=Gt;if(gr=ce||m,Gt=_e||J,Jn(i,s),Gt=_e,gr=ce,ea(s),x&8192)e:for(i=s.stateNode,i._visibility=m?i._visibility&-2:i._visibility|1,m&&(u===null||J||gr||Gt||Hs(s)),u=null,i=s;;){if(i.tag===5||i.tag===26){if(u===null){J=u=i;try{if(v=J.stateNode,m)N=v.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{R=J.stateNode;var Ee=J.memoizedProps.style,fe=Ee!=null&&Ee.hasOwnProperty("display")?Ee.display:null;R.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(ge){jt(J,J.return,ge)}}}else if(i.tag===6){if(u===null){J=i;try{J.stateNode.nodeValue=m?"":J.memoizedProps}catch(ge){jt(J,J.return,ge)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===s)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;u===i&&(u=null),i=i.return}u===i&&(u=null),i.sibling.return=i.return,i=i.sibling}x&4&&(x=s.updateQueue,x!==null&&(u=x.retryQueue,u!==null&&(x.retryQueue=null,C0(s,u))));break;case 19:Jn(i,s),ea(s),x&4&&(x=s.updateQueue,x!==null&&(s.updateQueue=null,C0(s,x)));break;case 30:break;case 21:break;default:Jn(i,s),ea(s)}}function ea(s){var i=s.flags;if(i&2){try{for(var u,x=s.return;x!==null;){if(pp(x)){u=x;break}x=x.return}if(u==null)throw Error(a(160));switch(u.tag){case 27:var m=u.stateNode,v=S0(s);gu(s,v,m);break;case 5:var N=u.stateNode;u.flags&32&&(gi(N,""),u.flags&=-33);var R=S0(s);gu(s,R,N);break;case 3:case 4:var J=u.stateNode.containerInfo,ce=S0(s);N0(s,ce,J);break;default:throw Error(a(161))}}catch(_e){jt(s,s.return,_e)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function Np(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var i=s;Np(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),s=s.sibling}}function Xr(s,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)bp(s,i.alternate,i),i=i.sibling}function Hs(s){for(s=s.child;s!==null;){var i=s;switch(i.tag){case 0:case 11:case 14:case 15:Gr(4,i,i.return),Hs(i);break;case 1:Wa(i,i.return);var u=i.stateNode;typeof u.componentWillUnmount=="function"&&gp(i,i.return,u),Hs(i);break;case 27:co(i.stateNode);case 26:case 5:Wa(i,i.return),Hs(i);break;case 22:i.memoizedState===null&&Hs(i);break;case 30:Hs(i);break;default:Hs(i)}s=s.sibling}}function Yr(s,i,u){for(u=u&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var x=i.alternate,m=s,v=i,N=v.flags;switch(v.tag){case 0:case 11:case 15:Yr(m,v,u),Jl(4,v);break;case 1:if(Yr(m,v,u),x=v,m=x.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(ce){jt(x,x.return,ce)}if(x=v,m=x.updateQueue,m!==null){var R=x.stateNode;try{var J=m.shared.hiddenCallbacks;if(J!==null)for(m.shared.hiddenCallbacks=null,m=0;m<J.length;m++)em(J[m],R)}catch(ce){jt(x,x.return,ce)}}u&&N&64&&xp(v),eo(v,v.return);break;case 27:yp(v);case 26:case 5:Yr(m,v,u),u&&x===null&&N&4&&mp(v),eo(v,v.return);break;case 12:Yr(m,v,u);break;case 13:Yr(m,v,u),u&&N&4&&Tp(m,v);break;case 22:v.memoizedState===null&&Yr(m,v,u),eo(v,v.return);break;case 30:break;default:Yr(m,v,u)}i=i.sibling}}function k0(s,i){var u=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),s=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==u&&(s!=null&&s.refCount++,u!=null&&Pl(u))}function j0(s,i){s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Pl(s))}function Ga(s,i,u,x){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Ep(s,i,u,x),i=i.sibling}function Ep(s,i,u,x){var m=i.flags;switch(i.tag){case 0:case 11:case 15:Ga(s,i,u,x),m&2048&&Jl(9,i);break;case 1:Ga(s,i,u,x);break;case 3:Ga(s,i,u,x),m&2048&&(s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Pl(s)));break;case 12:if(m&2048){Ga(s,i,u,x),s=i.stateNode;try{var v=i.memoizedProps,N=v.id,R=v.onPostCommit;typeof R=="function"&&R(N,i.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(J){jt(i,i.return,J)}}else Ga(s,i,u,x);break;case 13:Ga(s,i,u,x);break;case 23:break;case 22:v=i.stateNode,N=i.alternate,i.memoizedState!==null?v._visibility&2?Ga(s,i,u,x):to(s,i):v._visibility&2?Ga(s,i,u,x):(v._visibility|=2,Ri(s,i,u,x,(i.subtreeFlags&10256)!==0)),m&2048&&k0(N,i);break;case 24:Ga(s,i,u,x),m&2048&&j0(i.alternate,i);break;default:Ga(s,i,u,x)}}function Ri(s,i,u,x,m){for(m=m&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var v=s,N=i,R=u,J=x,ce=N.flags;switch(N.tag){case 0:case 11:case 15:Ri(v,N,R,J,m),Jl(8,N);break;case 23:break;case 22:var _e=N.stateNode;N.memoizedState!==null?_e._visibility&2?Ri(v,N,R,J,m):to(v,N):(_e._visibility|=2,Ri(v,N,R,J,m)),m&&ce&2048&&k0(N.alternate,N);break;case 24:Ri(v,N,R,J,m),m&&ce&2048&&j0(N.alternate,N);break;default:Ri(v,N,R,J,m)}i=i.sibling}}function to(s,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var u=s,x=i,m=x.flags;switch(x.tag){case 22:to(u,x),m&2048&&k0(x.alternate,x);break;case 24:to(u,x),m&2048&&j0(x.alternate,x);break;default:to(u,x)}i=i.sibling}}var no=8192;function Fi(s){if(s.subtreeFlags&no)for(s=s.child;s!==null;)Cp(s),s=s.sibling}function Cp(s){switch(s.tag){case 26:Fi(s),s.flags&no&&s.memoizedState!==null&&XT(Da,s.memoizedState,s.memoizedProps);break;case 5:Fi(s);break;case 3:case 4:var i=Da;Da=ku(s.stateNode.containerInfo),Fi(s),Da=i;break;case 22:s.memoizedState===null&&(i=s.alternate,i!==null&&i.memoizedState!==null?(i=no,no=16777216,Fi(s),no=i):Fi(s));break;default:Fi(s)}}function kp(s){var i=s.alternate;if(i!==null&&(s=i.child,s!==null)){i.child=null;do i=s.sibling,s.sibling=null,s=i;while(s!==null)}}function ao(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var u=0;u<i.length;u++){var x=i[u];cn=x,Ap(x,s)}kp(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)jp(s),s=s.sibling}function jp(s){switch(s.tag){case 0:case 11:case 15:ao(s),s.flags&2048&&Gr(9,s,s.return);break;case 3:ao(s);break;case 12:ao(s);break;case 22:var i=s.stateNode;s.memoizedState!==null&&i._visibility&2&&(s.return===null||s.return.tag!==13)?(i._visibility&=-3,mu(s)):ao(s);break;default:ao(s)}}function mu(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var u=0;u<i.length;u++){var x=i[u];cn=x,Ap(x,s)}kp(s)}for(s=s.child;s!==null;){switch(i=s,i.tag){case 0:case 11:case 15:Gr(8,i,i.return),mu(i);break;case 22:u=i.stateNode,u._visibility&2&&(u._visibility&=-3,mu(i));break;default:mu(i)}s=s.sibling}}function Ap(s,i){for(;cn!==null;){var u=cn;switch(u.tag){case 0:case 11:case 15:Gr(8,u,i);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var x=u.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Pl(u.memoizedState.cache)}if(x=u.child,x!==null)x.return=u,cn=x;else e:for(u=s;cn!==null;){x=cn;var m=x.sibling,v=x.return;if(wp(x),x===u){cn=null;break e}if(m!==null){m.return=v,cn=m;break e}cn=v}}}var cT={getCacheForType:function(s){var i=kn(en),u=i.data.get(s);return u===void 0&&(u=s(),i.data.set(s,u)),u}},uT=typeof WeakMap=="function"?WeakMap:Map,gt=0,Ot=null,nt=null,it=0,mt=0,ta=null,qr=!1,Li=!1,A0=!1,pr=0,Pt=0,$r=0,Ps=0,D0=0,ya=0,Bi=0,ro=null,Vn=null,O0=!1,M0=0,pu=1/0,yu=null,Qr=null,pn=0,Zr=null,Hi=null,Pi=0,R0=0,F0=null,Dp=null,so=0,L0=null;function na(){if((gt&2)!==0&&it!==0)return it&-it;if(ee.T!==null){var s=Ei;return s!==0?s:V0()}return Dc()}function Op(){ya===0&&(ya=(it&536870912)===0||ut?bl():536870912);var s=pa.current;return s!==null&&(s.flags|=32),ya}function aa(s,i,u){(s===Ot&&(mt===2||mt===9)||s.cancelPendingCommit!==null)&&(Ii(s,0),Jr(s,it,ya,!1)),Ts(s,u),((gt&2)===0||s!==Ot)&&(s===Ot&&((gt&2)===0&&(Ps|=u),Pt===4&&Jr(s,it,ya,!1)),Xa(s))}function Mp(s,i,u){if((gt&6)!==0)throw Error(a(327));var x=!u&&(i&124)===0&&(i&s.expiredLanes)===0||_s(s,i),m=x?dT(s,i):P0(s,i,!0),v=x;do{if(m===0){Li&&!x&&Jr(s,i,0,!1);break}else{if(u=s.current.alternate,v&&!hT(u)){m=P0(s,i,!1),v=!1;continue}if(m===2){if(v=i,s.errorRecoveryDisabledLanes&v)var N=0;else N=s.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){i=N;e:{var R=s;m=ro;var J=R.current.memoizedState.isDehydrated;if(J&&(Ii(R,N).flags|=256),N=P0(R,N,!1),N!==2){if(A0&&!J){R.errorRecoveryDisabledLanes|=v,Ps|=v,m=4;break e}v=Vn,Vn=m,v!==null&&(Vn===null?Vn=v:Vn.push.apply(Vn,v))}m=N}if(v=!1,m!==2)continue}}if(m===1){Ii(s,0),Jr(s,i,0,!0);break}e:{switch(x=s,v=m,v){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:Jr(x,i,ya,!qr);break e;case 2:Vn=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(m=M0+300-Fe(),10<m)){if(Jr(x,i,ya,!qr),fi(x,0,!0)!==0)break e;x.timeoutHandle=o1(Rp.bind(null,x,u,Vn,yu,O0,i,ya,Ps,Bi,qr,v,2,-0,0),m);break e}Rp(x,u,Vn,yu,O0,i,ya,Ps,Bi,qr,v,0,-0,0)}}break}while(!0);Xa(s)}function Rp(s,i,u,x,m,v,N,R,J,ce,_e,Ee,fe,ge){if(s.timeoutHandle=-1,Ee=i.subtreeFlags,(Ee&8192||(Ee&16785408)===16785408)&&(fo={stylesheets:null,count:0,unsuspend:GT},Cp(i),Ee=YT(),Ee!==null)){s.cancelPendingCommit=Ee(zp.bind(null,s,i,v,u,x,m,N,R,J,_e,1,fe,ge)),Jr(s,v,N,!ce);return}zp(s,i,v,u,x,m,N,R,J)}function hT(s){for(var i=s;;){var u=i.tag;if((u===0||u===11||u===15)&&i.flags&16384&&(u=i.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var x=0;x<u.length;x++){var m=u[x],v=m.getSnapshot;m=m.value;try{if(!Qn(v(),m))return!1}catch{return!1}}if(u=i.child,i.subtreeFlags&16384&&u!==null)u.return=i,i=u;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Jr(s,i,u,x){i&=~D0,i&=~Ps,s.suspendedLanes|=i,s.pingedLanes&=~i,x&&(s.warmLanes|=i),x=s.expirationTimes;for(var m=i;0<m;){var v=31-gn(m),N=1<<v;x[v]=-1,m&=~N}u!==0&&jc(s,u,i)}function vu(){return(gt&6)===0?(io(0),!1):!0}function B0(){if(nt!==null){if(mt===0)var s=nt.return;else s=nt,cr=Ms=null,e0(s),Oi=null,$l=0,s=nt;for(;s!==null;)dp(s.alternate,s),s=s.return;nt=null}}function Ii(s,i){var u=s.timeoutHandle;u!==-1&&(s.timeoutHandle=-1,jT(u)),u=s.cancelPendingCommit,u!==null&&(s.cancelPendingCommit=null,u()),B0(),Ot=s,nt=u=ir(s.current,null),it=i,mt=0,ta=null,qr=!1,Li=_s(s,i),A0=!1,Bi=ya=D0=Ps=$r=Pt=0,Vn=ro=null,O0=!1,(i&8)!==0&&(i|=i&32);var x=s.entangledLanes;if(x!==0)for(s=s.entanglements,x&=i;0<x;){var m=31-gn(x),v=1<<m;i|=s[m],x&=~v}return pr=i,zc(),u}function Fp(s,i){Qe=null,ee.H=iu,i===zl||i===$c?(i=Zg(),mt=3):i===qg?(i=Zg(),mt=4):mt=i===Jm?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,ta=i,nt===null&&(Pt=1,hu(s,da(i,s.current)))}function Lp(){var s=ee.H;return ee.H=iu,s===null?iu:s}function Bp(){var s=ee.A;return ee.A=cT,s}function H0(){Pt=4,qr||(it&4194048)!==it&&pa.current!==null||(Li=!0),($r&134217727)===0&&(Ps&134217727)===0||Ot===null||Jr(Ot,it,ya,!1)}function P0(s,i,u){var x=gt;gt|=2;var m=Lp(),v=Bp();(Ot!==s||it!==i)&&(yu=null,Ii(s,i)),i=!1;var N=Pt;e:do try{if(mt!==0&&nt!==null){var R=nt,J=ta;switch(mt){case 8:B0(),N=6;break e;case 3:case 2:case 9:case 6:pa.current===null&&(i=!0);var ce=mt;if(mt=0,ta=null,zi(s,R,J,ce),u&&Li){N=0;break e}break;default:ce=mt,mt=0,ta=null,zi(s,R,J,ce)}}fT(),N=Pt;break}catch(_e){Fp(s,_e)}while(!0);return i&&s.shellSuspendCounter++,cr=Ms=null,gt=x,ee.H=m,ee.A=v,nt===null&&(Ot=null,it=0,zc()),N}function fT(){for(;nt!==null;)Hp(nt)}function dT(s,i){var u=gt;gt|=2;var x=Lp(),m=Bp();Ot!==s||it!==i?(yu=null,pu=Fe()+500,Ii(s,i)):Li=_s(s,i);e:do try{if(mt!==0&&nt!==null){i=nt;var v=ta;t:switch(mt){case 1:mt=0,ta=null,zi(s,i,v,1);break;case 2:case 9:if($g(v)){mt=0,ta=null,Pp(i);break}i=function(){mt!==2&&mt!==9||Ot!==s||(mt=7),Xa(s)},v.then(i,i);break e;case 3:mt=7;break e;case 4:mt=5;break e;case 7:$g(v)?(mt=0,ta=null,Pp(i)):(mt=0,ta=null,zi(s,i,v,7));break;case 5:var N=null;switch(nt.tag){case 26:N=nt.memoizedState;case 5:case 27:var R=nt;if(!N||b1(N)){mt=0,ta=null;var J=R.sibling;if(J!==null)nt=J;else{var ce=R.return;ce!==null?(nt=ce,bu(ce)):nt=null}break t}}mt=0,ta=null,zi(s,i,v,5);break;case 6:mt=0,ta=null,zi(s,i,v,6);break;case 8:B0(),Pt=6;break e;default:throw Error(a(462))}}xT();break}catch(_e){Fp(s,_e)}while(!0);return cr=Ms=null,ee.H=x,ee.A=m,gt=u,nt!==null?0:(Ot=null,it=0,zc(),Pt)}function xT(){for(;nt!==null&&!rn();)Hp(nt)}function Hp(s){var i=hp(s.alternate,s,pr);s.memoizedProps=s.pendingProps,i===null?bu(s):nt=i}function Pp(s){var i=s,u=i.alternate;switch(i.tag){case 15:case 0:i=sp(u,i,i.pendingProps,i.type,void 0,it);break;case 11:i=sp(u,i,i.pendingProps,i.type.render,i.ref,it);break;case 5:e0(i);default:dp(u,i),i=nt=Ig(i,pr),i=hp(u,i,pr)}s.memoizedProps=s.pendingProps,i===null?bu(s):nt=i}function zi(s,i,u,x){cr=Ms=null,e0(i),Oi=null,$l=0;var m=i.return;try{if(aT(s,m,i,u,it)){Pt=1,hu(s,da(u,s.current)),nt=null;return}}catch(v){if(m!==null)throw nt=m,v;Pt=1,hu(s,da(u,s.current)),nt=null;return}i.flags&32768?(ut||x===1?s=!0:Li||(it&536870912)!==0?s=!1:(qr=s=!0,(x===2||x===9||x===3||x===6)&&(x=pa.current,x!==null&&x.tag===13&&(x.flags|=16384))),Ip(i,s)):bu(i)}function bu(s){var i=s;do{if((i.flags&32768)!==0){Ip(i,qr);return}s=i.return;var u=sT(i.alternate,i,pr);if(u!==null){nt=u;return}if(i=i.sibling,i!==null){nt=i;return}nt=i=s}while(i!==null);Pt===0&&(Pt=5)}function Ip(s,i){do{var u=iT(s.alternate,s);if(u!==null){u.flags&=32767,nt=u;return}if(u=s.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!i&&(s=s.sibling,s!==null)){nt=s;return}nt=s=u}while(s!==null);Pt=6,nt=null}function zp(s,i,u,x,m,v,N,R,J){s.cancelPendingCommit=null;do wu();while(pn!==0);if((gt&6)!==0)throw Error(a(327));if(i!==null){if(i===s.current)throw Error(a(177));if(v=i.lanes|i.childLanes,v|=jf,di(s,u,v,N,R,J),s===Ot&&(nt=Ot=null,it=0),Hi=i,Zr=s,Pi=u,R0=v,F0=m,Dp=x,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,yT(Cn,function(){return Gp(),null})):(s.callbackNode=null,s.callbackPriority=0),x=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||x){x=ee.T,ee.T=null,m=Q.p,Q.p=2,N=gt,gt|=4;try{lT(s,i,u)}finally{gt=N,Q.p=m,ee.T=x}}pn=1,Up(),Vp(),Kp()}}function Up(){if(pn===1){pn=0;var s=Zr,i=Hi,u=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||u){u=ee.T,ee.T=null;var x=Q.p;Q.p=2;var m=gt;gt|=4;try{Sp(i,s);var v=Q0,N=Ag(s.containerInfo),R=v.focusedElem,J=v.selectionRange;if(N!==R&&R&&R.ownerDocument&&jg(R.ownerDocument.documentElement,R)){if(J!==null&&Sf(R)){var ce=J.start,_e=J.end;if(_e===void 0&&(_e=ce),"selectionStart"in R)R.selectionStart=ce,R.selectionEnd=Math.min(_e,R.value.length);else{var Ee=R.ownerDocument||document,fe=Ee&&Ee.defaultView||window;if(fe.getSelection){var ge=fe.getSelection(),Ge=R.textContent.length,Ke=Math.min(J.start,Ge),Ct=J.end===void 0?Ke:Math.min(J.end,Ge);!ge.extend&&Ke>Ct&&(N=Ct,Ct=Ke,Ke=N);var se=kg(R,Ke),ne=kg(R,Ct);if(se&&ne&&(ge.rangeCount!==1||ge.anchorNode!==se.node||ge.anchorOffset!==se.offset||ge.focusNode!==ne.node||ge.focusOffset!==ne.offset)){var oe=Ee.createRange();oe.setStart(se.node,se.offset),ge.removeAllRanges(),Ke>Ct?(ge.addRange(oe),ge.extend(ne.node,ne.offset)):(oe.setEnd(ne.node,ne.offset),ge.addRange(oe))}}}}for(Ee=[],ge=R;ge=ge.parentNode;)ge.nodeType===1&&Ee.push({element:ge,left:ge.scrollLeft,top:ge.scrollTop});for(typeof R.focus=="function"&&R.focus(),R=0;R<Ee.length;R++){var Se=Ee[R];Se.element.scrollLeft=Se.left,Se.element.scrollTop=Se.top}}Mu=!!$0,Q0=$0=null}finally{gt=m,Q.p=x,ee.T=u}}s.current=i,pn=2}}function Vp(){if(pn===2){pn=0;var s=Zr,i=Hi,u=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||u){u=ee.T,ee.T=null;var x=Q.p;Q.p=2;var m=gt;gt|=4;try{bp(s,i.alternate,i)}finally{gt=m,Q.p=x,ee.T=u}}pn=3}}function Kp(){if(pn===4||pn===3){pn=0,xt();var s=Zr,i=Hi,u=Pi,x=Dp;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?pn=5:(pn=0,Hi=Zr=null,Wp(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(Qr=null),Sl(u),i=i.stateNode,_t&&typeof _t.onCommitFiberRoot=="function")try{_t.onCommitFiberRoot(wt,i,void 0,(i.current.flags&128)===128)}catch{}if(x!==null){i=ee.T,m=Q.p,Q.p=2,ee.T=null;try{for(var v=s.onRecoverableError,N=0;N<x.length;N++){var R=x[N];v(R.value,{componentStack:R.stack})}}finally{ee.T=i,Q.p=m}}(Pi&3)!==0&&wu(),Xa(s),m=s.pendingLanes,(u&4194090)!==0&&(m&42)!==0?s===L0?so++:(so=0,L0=s):so=0,io(0)}}function Wp(s,i){(s.pooledCacheLanes&=i)===0&&(i=s.pooledCache,i!=null&&(s.pooledCache=null,Pl(i)))}function wu(s){return Up(),Vp(),Kp(),Gp()}function Gp(){if(pn!==5)return!1;var s=Zr,i=R0;R0=0;var u=Sl(Pi),x=ee.T,m=Q.p;try{Q.p=32>u?32:u,ee.T=null,u=F0,F0=null;var v=Zr,N=Pi;if(pn=0,Hi=Zr=null,Pi=0,(gt&6)!==0)throw Error(a(331));var R=gt;if(gt|=4,jp(v.current),Ep(v,v.current,N,u),gt=R,io(0,!1),_t&&typeof _t.onPostCommitFiberRoot=="function")try{_t.onPostCommitFiberRoot(wt,v)}catch{}return!0}finally{Q.p=m,ee.T=x,Wp(s,i)}}function Xp(s,i,u){i=da(u,i),i=x0(s.stateNode,i,2),s=Ur(s,i,2),s!==null&&(Ts(s,2),Xa(s))}function jt(s,i,u){if(s.tag===3)Xp(s,s,u);else for(;i!==null;){if(i.tag===3){Xp(i,s,u);break}else if(i.tag===1){var x=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Qr===null||!Qr.has(x))){s=da(u,s),u=Qm(2),x=Ur(i,u,2),x!==null&&(Zm(u,x,i,s),Ts(x,2),Xa(x));break}}i=i.return}}function I0(s,i,u){var x=s.pingCache;if(x===null){x=s.pingCache=new uT;var m=new Set;x.set(i,m)}else m=x.get(i),m===void 0&&(m=new Set,x.set(i,m));m.has(u)||(A0=!0,m.add(u),s=gT.bind(null,s,i,u),i.then(s,s))}function gT(s,i,u){var x=s.pingCache;x!==null&&x.delete(i),s.pingedLanes|=s.suspendedLanes&u,s.warmLanes&=~u,Ot===s&&(it&u)===u&&(Pt===4||Pt===3&&(it&62914560)===it&&300>Fe()-M0?(gt&2)===0&&Ii(s,0):D0|=u,Bi===it&&(Bi=0)),Xa(s)}function Yp(s,i){i===0&&(i=wl()),s=_i(s,i),s!==null&&(Ts(s,i),Xa(s))}function mT(s){var i=s.memoizedState,u=0;i!==null&&(u=i.retryLane),Yp(s,u)}function pT(s,i){var u=0;switch(s.tag){case 13:var x=s.stateNode,m=s.memoizedState;m!==null&&(u=m.retryLane);break;case 19:x=s.stateNode;break;case 22:x=s.stateNode._retryCache;break;default:throw Error(a(314))}x!==null&&x.delete(i),Yp(s,u)}function yT(s,i){return rt(s,i)}var _u=null,Ui=null,z0=!1,Tu=!1,U0=!1,Is=0;function Xa(s){s!==Ui&&s.next===null&&(Ui===null?_u=Ui=s:Ui=Ui.next=s),Tu=!0,z0||(z0=!0,bT())}function io(s,i){if(!U0&&Tu){U0=!0;do for(var u=!1,x=_u;x!==null;){if(s!==0){var m=x.pendingLanes;if(m===0)var v=0;else{var N=x.suspendedLanes,R=x.pingedLanes;v=(1<<31-gn(42|s)+1)-1,v&=m&~(N&~R),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(u=!0,Zp(x,v))}else v=it,v=fi(x,x===Ot?v:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(v&3)===0||_s(x,v)||(u=!0,Zp(x,v));x=x.next}while(u);U0=!1}}function vT(){qp()}function qp(){Tu=z0=!1;var s=0;Is!==0&&(kT()&&(s=Is),Is=0);for(var i=Fe(),u=null,x=_u;x!==null;){var m=x.next,v=$p(x,i);v===0?(x.next=null,u===null?_u=m:u.next=m,m===null&&(Ui=u)):(u=x,(s!==0||(v&3)!==0)&&(Tu=!0)),x=m}io(s)}function $p(s,i){for(var u=s.suspendedLanes,x=s.pingedLanes,m=s.expirationTimes,v=s.pendingLanes&-62914561;0<v;){var N=31-gn(v),R=1<<N,J=m[N];J===-1?((R&u)===0||(R&x)!==0)&&(m[N]=kc(R,i)):J<=i&&(s.expiredLanes|=R),v&=~R}if(i=Ot,u=it,u=fi(s,s===i?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x=s.callbackNode,u===0||s===i&&(mt===2||mt===9)||s.cancelPendingCommit!==null)return x!==null&&x!==null&&Ye(x),s.callbackNode=null,s.callbackPriority=0;if((u&3)===0||_s(s,u)){if(i=u&-u,i===s.callbackPriority)return i;switch(x!==null&&Ye(x),Sl(u)){case 2:case 8:u=Fn;break;case 32:u=Cn;break;case 268435456:u=ke;break;default:u=Cn}return x=Qp.bind(null,s),u=rt(u,x),s.callbackPriority=i,s.callbackNode=u,i}return x!==null&&x!==null&&Ye(x),s.callbackPriority=2,s.callbackNode=null,2}function Qp(s,i){if(pn!==0&&pn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var u=s.callbackNode;if(wu()&&s.callbackNode!==u)return null;var x=it;return x=fi(s,s===Ot?x:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),x===0?null:(Mp(s,x,i),$p(s,Fe()),s.callbackNode!=null&&s.callbackNode===u?Qp.bind(null,s):null)}function Zp(s,i){if(wu())return null;Mp(s,i,!0)}function bT(){AT(function(){(gt&6)!==0?rt(Jt,vT):qp()})}function V0(){return Is===0&&(Is=bl()),Is}function Jp(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Rc(""+s)}function e1(s,i){var u=i.ownerDocument.createElement("input");return u.name=i.name,u.value=i.value,s.id&&u.setAttribute("form",s.id),i.parentNode.insertBefore(u,i),s=new FormData(s),u.parentNode.removeChild(u),s}function wT(s,i,u,x,m){if(i==="submit"&&u&&u.stateNode===m){var v=Jp((m[ln]||null).action),N=x.submitter;N&&(i=(i=N[ln]||null)?Jp(i.formAction):N.getAttribute("formAction"),i!==null&&(v=i,N=null));var R=new Hc("action","action",null,x,m);s.push({event:R,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Is!==0){var J=N?e1(m,N):new FormData(m);c0(u,{pending:!0,data:J,method:m.method,action:v},null,J)}}else typeof v=="function"&&(R.preventDefault(),J=N?e1(m,N):new FormData(m),c0(u,{pending:!0,data:J,method:m.method,action:v},v,J))},currentTarget:m}]})}}for(var K0=0;K0<kf.length;K0++){var W0=kf[K0],_T=W0.toLowerCase(),TT=W0[0].toUpperCase()+W0.slice(1);Aa(_T,"on"+TT)}Aa(Mg,"onAnimationEnd"),Aa(Rg,"onAnimationIteration"),Aa(Fg,"onAnimationStart"),Aa("dblclick","onDoubleClick"),Aa("focusin","onFocus"),Aa("focusout","onBlur"),Aa(I_,"onTransitionRun"),Aa(z_,"onTransitionStart"),Aa(U_,"onTransitionCancel"),Aa(Lg,"onTransitionEnd"),Oe("onMouseEnter",["mouseout","mouseover"]),Oe("onMouseLeave",["mouseout","mouseover"]),Oe("onPointerEnter",["pointerout","pointerover"]),Oe("onPointerLeave",["pointerout","pointerover"]),je("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),je("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),je("onBeforeInput",["compositionend","keypress","textInput","paste"]),je("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),je("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),je("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ST=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(lo));function t1(s,i){i=(i&4)!==0;for(var u=0;u<s.length;u++){var x=s[u],m=x.event;x=x.listeners;e:{var v=void 0;if(i)for(var N=x.length-1;0<=N;N--){var R=x[N],J=R.instance,ce=R.currentTarget;if(R=R.listener,J!==v&&m.isPropagationStopped())break e;v=R,m.currentTarget=ce;try{v(m)}catch(_e){uu(_e)}m.currentTarget=null,v=J}else for(N=0;N<x.length;N++){if(R=x[N],J=R.instance,ce=R.currentTarget,R=R.listener,J!==v&&m.isPropagationStopped())break e;v=R,m.currentTarget=ce;try{v(m)}catch(_e){uu(_e)}m.currentTarget=null,v=J}}}}function at(s,i){var u=i[Nl];u===void 0&&(u=i[Nl]=new Set);var x=s+"__bubble";u.has(x)||(n1(i,s,2,!1),u.add(x))}function G0(s,i,u){var x=0;i&&(x|=4),n1(u,s,x,i)}var Su="_reactListening"+Math.random().toString(36).slice(2);function X0(s){if(!s[Su]){s[Su]=!0,he.forEach(function(u){u!=="selectionchange"&&(ST.has(u)||G0(u,!1,s),G0(u,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[Su]||(i[Su]=!0,G0("selectionchange",!1,i))}}function n1(s,i,u,x){switch(E1(i)){case 2:var m=QT;break;case 8:m=ZT;break;default:m=ld}u=m.bind(null,i,u,s),m=void 0,!gf||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(m=!0),x?m!==void 0?s.addEventListener(i,u,{capture:!0,passive:m}):s.addEventListener(i,u,!0):m!==void 0?s.addEventListener(i,u,{passive:m}):s.addEventListener(i,u,!1)}function Y0(s,i,u,x,m){var v=x;if((i&1)===0&&(i&2)===0&&x!==null)e:for(;;){if(x===null)return;var N=x.tag;if(N===3||N===4){var R=x.stateNode.containerInfo;if(R===m)break;if(N===4)for(N=x.return;N!==null;){var J=N.tag;if((J===3||J===4)&&N.stateNode.containerInfo===m)return;N=N.return}for(;R!==null;){if(N=W(R),N===null)return;if(J=N.tag,J===5||J===6||J===26||J===27){x=v=N;continue e}R=R.parentNode}}x=x.return}cg(function(){var ce=v,_e=df(u),Ee=[];e:{var fe=Bg.get(s);if(fe!==void 0){var ge=Hc,Ge=s;switch(s){case"keypress":if(Lc(u)===0)break e;case"keydown":case"keyup":ge=y_;break;case"focusin":Ge="focus",ge=vf;break;case"focusout":Ge="blur",ge=vf;break;case"beforeblur":case"afterblur":ge=vf;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=fg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=i_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=w_;break;case Mg:case Rg:case Fg:ge=c_;break;case Lg:ge=T_;break;case"scroll":case"scrollend":ge=r_;break;case"wheel":ge=N_;break;case"copy":case"cut":case"paste":ge=h_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=xg;break;case"toggle":case"beforetoggle":ge=C_}var Ke=(i&4)!==0,Ct=!Ke&&(s==="scroll"||s==="scrollend"),se=Ke?fe!==null?fe+"Capture":null:fe;Ke=[];for(var ne=ce,oe;ne!==null;){var Se=ne;if(oe=Se.stateNode,Se=Se.tag,Se!==5&&Se!==26&&Se!==27||oe===null||se===null||(Se=El(ne,se),Se!=null&&Ke.push(oo(ne,Se,oe))),Ct)break;ne=ne.return}0<Ke.length&&(fe=new ge(fe,Ge,null,u,_e),Ee.push({event:fe,listeners:Ke}))}}if((i&7)===0){e:{if(fe=s==="mouseover"||s==="pointerover",ge=s==="mouseout"||s==="pointerout",fe&&u!==ff&&(Ge=u.relatedTarget||u.fromElement)&&(W(Ge)||Ge[Lr]))break e;if((ge||fe)&&(fe=_e.window===_e?_e:(fe=_e.ownerDocument)?fe.defaultView||fe.parentWindow:window,ge?(Ge=u.relatedTarget||u.toElement,ge=ce,Ge=Ge?W(Ge):null,Ge!==null&&(Ct=l(Ge),Ke=Ge.tag,Ge!==Ct||Ke!==5&&Ke!==27&&Ke!==6)&&(Ge=null)):(ge=null,Ge=ce),ge!==Ge)){if(Ke=fg,Se="onMouseLeave",se="onMouseEnter",ne="mouse",(s==="pointerout"||s==="pointerover")&&(Ke=xg,Se="onPointerLeave",se="onPointerEnter",ne="pointer"),Ct=ge==null?fe:ue(ge),oe=Ge==null?fe:ue(Ge),fe=new Ke(Se,ne+"leave",ge,u,_e),fe.target=Ct,fe.relatedTarget=oe,Se=null,W(_e)===ce&&(Ke=new Ke(se,ne+"enter",Ge,u,_e),Ke.target=oe,Ke.relatedTarget=Ct,Se=Ke),Ct=Se,ge&&Ge)t:{for(Ke=ge,se=Ge,ne=0,oe=Ke;oe;oe=Vi(oe))ne++;for(oe=0,Se=se;Se;Se=Vi(Se))oe++;for(;0<ne-oe;)Ke=Vi(Ke),ne--;for(;0<oe-ne;)se=Vi(se),oe--;for(;ne--;){if(Ke===se||se!==null&&Ke===se.alternate)break t;Ke=Vi(Ke),se=Vi(se)}Ke=null}else Ke=null;ge!==null&&a1(Ee,fe,ge,Ke,!1),Ge!==null&&Ct!==null&&a1(Ee,Ct,Ge,Ke,!0)}}e:{if(fe=ce?ue(ce):window,ge=fe.nodeName&&fe.nodeName.toLowerCase(),ge==="select"||ge==="input"&&fe.type==="file")var Pe=_g;else if(bg(fe))if(Tg)Pe=B_;else{Pe=F_;var Je=R_}else ge=fe.nodeName,!ge||ge.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?ce&&hf(ce.elementType)&&(Pe=_g):Pe=L_;if(Pe&&(Pe=Pe(s,ce))){wg(Ee,Pe,u,_e);break e}Je&&Je(s,fe,ce),s==="focusout"&&ce&&fe.type==="number"&&ce.memoizedProps.value!=null&&uf(fe,"number",fe.value)}switch(Je=ce?ue(ce):window,s){case"focusin":(bg(Je)||Je.contentEditable==="true")&&(vi=Je,Nf=ce,Rl=null);break;case"focusout":Rl=Nf=vi=null;break;case"mousedown":Ef=!0;break;case"contextmenu":case"mouseup":case"dragend":Ef=!1,Dg(Ee,u,_e);break;case"selectionchange":if(P_)break;case"keydown":case"keyup":Dg(Ee,u,_e)}var Ve;if(wf)e:{switch(s){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else yi?yg(s,u)&&(We="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(We="onCompositionStart");We&&(gg&&u.locale!=="ko"&&(yi||We!=="onCompositionStart"?We==="onCompositionEnd"&&yi&&(Ve=ug()):(Hr=_e,mf="value"in Hr?Hr.value:Hr.textContent,yi=!0)),Je=Nu(ce,We),0<Je.length&&(We=new dg(We,s,null,u,_e),Ee.push({event:We,listeners:Je}),Ve?We.data=Ve:(Ve=vg(u),Ve!==null&&(We.data=Ve)))),(Ve=j_?A_(s,u):D_(s,u))&&(We=Nu(ce,"onBeforeInput"),0<We.length&&(Je=new dg("onBeforeInput","beforeinput",null,u,_e),Ee.push({event:Je,listeners:We}),Je.data=Ve)),wT(Ee,s,ce,u,_e)}t1(Ee,i)})}function oo(s,i,u){return{instance:s,listener:i,currentTarget:u}}function Nu(s,i){for(var u=i+"Capture",x=[];s!==null;){var m=s,v=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||v===null||(m=El(s,u),m!=null&&x.unshift(oo(s,m,v)),m=El(s,i),m!=null&&x.push(oo(s,m,v))),s.tag===3)return x;s=s.return}return[]}function Vi(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function a1(s,i,u,x,m){for(var v=i._reactName,N=[];u!==null&&u!==x;){var R=u,J=R.alternate,ce=R.stateNode;if(R=R.tag,J!==null&&J===x)break;R!==5&&R!==26&&R!==27||ce===null||(J=ce,m?(ce=El(u,v),ce!=null&&N.unshift(oo(u,ce,J))):m||(ce=El(u,v),ce!=null&&N.push(oo(u,ce,J)))),u=u.return}N.length!==0&&s.push({event:i,listeners:N})}var NT=/\r\n?/g,ET=/\u0000|\uFFFD/g;function r1(s){return(typeof s=="string"?s:""+s).replace(NT,`
`).replace(ET,"")}function s1(s,i){return i=r1(i),r1(s)===i}function Eu(){}function Et(s,i,u,x,m,v){switch(u){case"children":typeof x=="string"?i==="body"||i==="textarea"&&x===""||gi(s,x):(typeof x=="number"||typeof x=="bigint")&&i!=="body"&&gi(s,""+x);break;case"className":St(s,"class",x);break;case"tabIndex":St(s,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":St(s,u,x);break;case"style":lg(s,x,v);break;case"data":if(i!=="object"){St(s,"data",x);break}case"src":case"href":if(x===""&&(i!=="a"||u!=="href")){s.removeAttribute(u);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(u);break}x=Rc(""+x),s.setAttribute(u,x);break;case"action":case"formAction":if(typeof x=="function"){s.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(u==="formAction"?(i!=="input"&&Et(s,i,"name",m.name,m,null),Et(s,i,"formEncType",m.formEncType,m,null),Et(s,i,"formMethod",m.formMethod,m,null),Et(s,i,"formTarget",m.formTarget,m,null)):(Et(s,i,"encType",m.encType,m,null),Et(s,i,"method",m.method,m,null),Et(s,i,"target",m.target,m,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){s.removeAttribute(u);break}x=Rc(""+x),s.setAttribute(u,x);break;case"onClick":x!=null&&(s.onclick=Eu);break;case"onScroll":x!=null&&at("scroll",s);break;case"onScrollEnd":x!=null&&at("scrollend",s);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(a(61));if(u=x.__html,u!=null){if(m.children!=null)throw Error(a(60));s.innerHTML=u}}break;case"multiple":s.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":s.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){s.removeAttribute("xlink:href");break}u=Rc(""+x),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(u,""+x):s.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(u,""):s.removeAttribute(u);break;case"capture":case"download":x===!0?s.setAttribute(u,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?s.setAttribute(u,x):s.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?s.setAttribute(u,x):s.removeAttribute(u);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?s.removeAttribute(u):s.setAttribute(u,x);break;case"popover":at("beforetoggle",s),at("toggle",s),Tt(s,"popover",x);break;case"xlinkActuate":Dt(s,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":Dt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":Dt(s,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":Dt(s,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":Dt(s,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":Dt(s,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":Dt(s,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":Dt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":Dt(s,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":Tt(s,"is",x);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=n_.get(u)||u,Tt(s,u,x))}}function q0(s,i,u,x,m,v){switch(u){case"style":lg(s,x,v);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(a(61));if(u=x.__html,u!=null){if(m.children!=null)throw Error(a(60));s.innerHTML=u}}break;case"children":typeof x=="string"?gi(s,x):(typeof x=="number"||typeof x=="bigint")&&gi(s,""+x);break;case"onScroll":x!=null&&at("scroll",s);break;case"onScrollEnd":x!=null&&at("scrollend",s);break;case"onClick":x!=null&&(s.onclick=Eu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xe.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(m=u.endsWith("Capture"),i=u.slice(2,m?u.length-7:void 0),v=s[ln]||null,v=v!=null?v[u]:null,typeof v=="function"&&s.removeEventListener(i,v,m),typeof x=="function")){typeof v!="function"&&v!==null&&(u in s?s[u]=null:s.hasAttribute(u)&&s.removeAttribute(u)),s.addEventListener(i,x,m);break e}u in s?s[u]=x:x===!0?s.setAttribute(u,""):Tt(s,u,x)}}}function yn(s,i,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":at("error",s),at("load",s);var x=!1,m=!1,v;for(v in u)if(u.hasOwnProperty(v)){var N=u[v];if(N!=null)switch(v){case"src":x=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:Et(s,i,v,N,u,null)}}m&&Et(s,i,"srcSet",u.srcSet,u,null),x&&Et(s,i,"src",u.src,u,null);return;case"input":at("invalid",s);var R=v=N=m=null,J=null,ce=null;for(x in u)if(u.hasOwnProperty(x)){var _e=u[x];if(_e!=null)switch(x){case"name":m=_e;break;case"type":N=_e;break;case"checked":J=_e;break;case"defaultChecked":ce=_e;break;case"value":v=_e;break;case"defaultValue":R=_e;break;case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(a(137,i));break;default:Et(s,i,x,_e,u,null)}}ag(s,v,R,J,ce,N,m,!1),Oc(s);return;case"select":at("invalid",s),x=N=v=null;for(m in u)if(u.hasOwnProperty(m)&&(R=u[m],R!=null))switch(m){case"value":v=R;break;case"defaultValue":N=R;break;case"multiple":x=R;default:Et(s,i,m,R,u,null)}i=v,u=N,s.multiple=!!x,i!=null?xi(s,!!x,i,!1):u!=null&&xi(s,!!x,u,!0);return;case"textarea":at("invalid",s),v=m=x=null;for(N in u)if(u.hasOwnProperty(N)&&(R=u[N],R!=null))switch(N){case"value":x=R;break;case"defaultValue":m=R;break;case"children":v=R;break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(a(91));break;default:Et(s,i,N,R,u,null)}sg(s,x,m,v),Oc(s);return;case"option":for(J in u)if(u.hasOwnProperty(J)&&(x=u[J],x!=null))switch(J){case"selected":s.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:Et(s,i,J,x,u,null)}return;case"dialog":at("beforetoggle",s),at("toggle",s),at("cancel",s),at("close",s);break;case"iframe":case"object":at("load",s);break;case"video":case"audio":for(x=0;x<lo.length;x++)at(lo[x],s);break;case"image":at("error",s),at("load",s);break;case"details":at("toggle",s);break;case"embed":case"source":case"link":at("error",s),at("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ce in u)if(u.hasOwnProperty(ce)&&(x=u[ce],x!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:Et(s,i,ce,x,u,null)}return;default:if(hf(i)){for(_e in u)u.hasOwnProperty(_e)&&(x=u[_e],x!==void 0&&q0(s,i,_e,x,u,void 0));return}}for(R in u)u.hasOwnProperty(R)&&(x=u[R],x!=null&&Et(s,i,R,x,u,null))}function CT(s,i,u,x){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,v=null,N=null,R=null,J=null,ce=null,_e=null;for(ge in u){var Ee=u[ge];if(u.hasOwnProperty(ge)&&Ee!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":J=Ee;default:x.hasOwnProperty(ge)||Et(s,i,ge,null,x,Ee)}}for(var fe in x){var ge=x[fe];if(Ee=u[fe],x.hasOwnProperty(fe)&&(ge!=null||Ee!=null))switch(fe){case"type":v=ge;break;case"name":m=ge;break;case"checked":ce=ge;break;case"defaultChecked":_e=ge;break;case"value":N=ge;break;case"defaultValue":R=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(a(137,i));break;default:ge!==Ee&&Et(s,i,fe,ge,x,Ee)}}cf(s,N,R,J,ce,_e,v,m);return;case"select":ge=N=R=fe=null;for(v in u)if(J=u[v],u.hasOwnProperty(v)&&J!=null)switch(v){case"value":break;case"multiple":ge=J;default:x.hasOwnProperty(v)||Et(s,i,v,null,x,J)}for(m in x)if(v=x[m],J=u[m],x.hasOwnProperty(m)&&(v!=null||J!=null))switch(m){case"value":fe=v;break;case"defaultValue":R=v;break;case"multiple":N=v;default:v!==J&&Et(s,i,m,v,x,J)}i=R,u=N,x=ge,fe!=null?xi(s,!!u,fe,!1):!!x!=!!u&&(i!=null?xi(s,!!u,i,!0):xi(s,!!u,u?[]:"",!1));return;case"textarea":ge=fe=null;for(R in u)if(m=u[R],u.hasOwnProperty(R)&&m!=null&&!x.hasOwnProperty(R))switch(R){case"value":break;case"children":break;default:Et(s,i,R,null,x,m)}for(N in x)if(m=x[N],v=u[N],x.hasOwnProperty(N)&&(m!=null||v!=null))switch(N){case"value":fe=m;break;case"defaultValue":ge=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(a(91));break;default:m!==v&&Et(s,i,N,m,x,v)}rg(s,fe,ge);return;case"option":for(var Ge in u)if(fe=u[Ge],u.hasOwnProperty(Ge)&&fe!=null&&!x.hasOwnProperty(Ge))switch(Ge){case"selected":s.selected=!1;break;default:Et(s,i,Ge,null,x,fe)}for(J in x)if(fe=x[J],ge=u[J],x.hasOwnProperty(J)&&fe!==ge&&(fe!=null||ge!=null))switch(J){case"selected":s.selected=fe&&typeof fe!="function"&&typeof fe!="symbol";break;default:Et(s,i,J,fe,x,ge)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ke in u)fe=u[Ke],u.hasOwnProperty(Ke)&&fe!=null&&!x.hasOwnProperty(Ke)&&Et(s,i,Ke,null,x,fe);for(ce in x)if(fe=x[ce],ge=u[ce],x.hasOwnProperty(ce)&&fe!==ge&&(fe!=null||ge!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(a(137,i));break;default:Et(s,i,ce,fe,x,ge)}return;default:if(hf(i)){for(var Ct in u)fe=u[Ct],u.hasOwnProperty(Ct)&&fe!==void 0&&!x.hasOwnProperty(Ct)&&q0(s,i,Ct,void 0,x,fe);for(_e in x)fe=x[_e],ge=u[_e],!x.hasOwnProperty(_e)||fe===ge||fe===void 0&&ge===void 0||q0(s,i,_e,fe,x,ge);return}}for(var se in u)fe=u[se],u.hasOwnProperty(se)&&fe!=null&&!x.hasOwnProperty(se)&&Et(s,i,se,null,x,fe);for(Ee in x)fe=x[Ee],ge=u[Ee],!x.hasOwnProperty(Ee)||fe===ge||fe==null&&ge==null||Et(s,i,Ee,fe,x,ge)}var $0=null,Q0=null;function Cu(s){return s.nodeType===9?s:s.ownerDocument}function i1(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function l1(s,i){if(s===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&i==="foreignObject"?0:s}function Z0(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var J0=null;function kT(){var s=window.event;return s&&s.type==="popstate"?s===J0?!1:(J0=s,!0):(J0=null,!1)}var o1=typeof setTimeout=="function"?setTimeout:void 0,jT=typeof clearTimeout=="function"?clearTimeout:void 0,c1=typeof Promise=="function"?Promise:void 0,AT=typeof queueMicrotask=="function"?queueMicrotask:typeof c1<"u"?function(s){return c1.resolve(null).then(s).catch(DT)}:o1;function DT(s){setTimeout(function(){throw s})}function es(s){return s==="head"}function u1(s,i){var u=i,x=0,m=0;do{var v=u.nextSibling;if(s.removeChild(u),v&&v.nodeType===8)if(u=v.data,u==="/$"){if(0<x&&8>x){u=x;var N=s.ownerDocument;if(u&1&&co(N.documentElement),u&2&&co(N.body),u&4)for(u=N.head,co(u),N=u.firstChild;N;){var R=N.nextSibling,J=N.nodeName;N[L]||J==="SCRIPT"||J==="STYLE"||J==="LINK"&&N.rel.toLowerCase()==="stylesheet"||u.removeChild(N),N=R}}if(m===0){s.removeChild(v),yo(i);return}m--}else u==="$"||u==="$?"||u==="$!"?m++:x=u.charCodeAt(0)-48;else x=0;u=v}while(u);yo(i)}function ed(s){var i=s.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var u=i;switch(i=i.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":ed(u),z(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}s.removeChild(u)}}function OT(s,i,u,x){for(;s.nodeType===1;){var m=u;if(s.nodeName.toLowerCase()!==i.toLowerCase()){if(!x&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(x){if(!s[L])switch(i){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(v=s.getAttribute("rel"),v==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(v!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(v=s.getAttribute("src"),(v!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&v&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(i==="input"&&s.type==="hidden"){var v=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===v)return s}else return s;if(s=Oa(s.nextSibling),s===null)break}return null}function MT(s,i,u){if(i==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!u||(s=Oa(s.nextSibling),s===null))return null;return s}function td(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function RT(s,i){var u=s.ownerDocument;if(s.data!=="$?"||u.readyState==="complete")i();else{var x=function(){i(),u.removeEventListener("DOMContentLoaded",x)};u.addEventListener("DOMContentLoaded",x),s._reactRetry=x}}function Oa(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return s}var nd=null;function h1(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(i===0)return s;i--}else u==="/$"&&i++}s=s.previousSibling}return null}function f1(s,i,u){switch(i=Cu(u),s){case"html":if(s=i.documentElement,!s)throw Error(a(452));return s;case"head":if(s=i.head,!s)throw Error(a(453));return s;case"body":if(s=i.body,!s)throw Error(a(454));return s;default:throw Error(a(451))}}function co(s){for(var i=s.attributes;i.length;)s.removeAttributeNode(i[0]);z(s)}var va=new Map,d1=new Set;function ku(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var yr=Q.d;Q.d={f:FT,r:LT,D:BT,C:HT,L:PT,m:IT,X:UT,S:zT,M:VT};function FT(){var s=yr.f(),i=vu();return s||i}function LT(s){var i=X(s);i!==null&&i.tag===5&&i.type==="form"?Mm(i):yr.r(s)}var Ki=typeof document>"u"?null:document;function x1(s,i,u){var x=Ki;if(x&&typeof i=="string"&&i){var m=fa(i);m='link[rel="'+s+'"][href="'+m+'"]',typeof u=="string"&&(m+='[crossorigin="'+u+'"]'),d1.has(m)||(d1.add(m),s={rel:s,crossOrigin:u,href:i},x.querySelector(m)===null&&(i=x.createElement("link"),yn(i,"link",s),le(i),x.head.appendChild(i)))}}function BT(s){yr.D(s),x1("dns-prefetch",s,null)}function HT(s,i){yr.C(s,i),x1("preconnect",s,i)}function PT(s,i,u){yr.L(s,i,u);var x=Ki;if(x&&s&&i){var m='link[rel="preload"][as="'+fa(i)+'"]';i==="image"&&u&&u.imageSrcSet?(m+='[imagesrcset="'+fa(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(m+='[imagesizes="'+fa(u.imageSizes)+'"]')):m+='[href="'+fa(s)+'"]';var v=m;switch(i){case"style":v=Wi(s);break;case"script":v=Gi(s)}va.has(v)||(s=g({rel:"preload",href:i==="image"&&u&&u.imageSrcSet?void 0:s,as:i},u),va.set(v,s),x.querySelector(m)!==null||i==="style"&&x.querySelector(uo(v))||i==="script"&&x.querySelector(ho(v))||(i=x.createElement("link"),yn(i,"link",s),le(i),x.head.appendChild(i)))}}function IT(s,i){yr.m(s,i);var u=Ki;if(u&&s){var x=i&&typeof i.as=="string"?i.as:"script",m='link[rel="modulepreload"][as="'+fa(x)+'"][href="'+fa(s)+'"]',v=m;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=Gi(s)}if(!va.has(v)&&(s=g({rel:"modulepreload",href:s},i),va.set(v,s),u.querySelector(m)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(ho(v)))return}x=u.createElement("link"),yn(x,"link",s),le(x),u.head.appendChild(x)}}}function zT(s,i,u){yr.S(s,i,u);var x=Ki;if(x&&s){var m=ve(x).hoistableStyles,v=Wi(s);i=i||"default";var N=m.get(v);if(!N){var R={loading:0,preload:null};if(N=x.querySelector(uo(v)))R.loading=5;else{s=g({rel:"stylesheet",href:s,"data-precedence":i},u),(u=va.get(v))&&ad(s,u);var J=N=x.createElement("link");le(J),yn(J,"link",s),J._p=new Promise(function(ce,_e){J.onload=ce,J.onerror=_e}),J.addEventListener("load",function(){R.loading|=1}),J.addEventListener("error",function(){R.loading|=2}),R.loading|=4,ju(N,i,x)}N={type:"stylesheet",instance:N,count:1,state:R},m.set(v,N)}}}function UT(s,i){yr.X(s,i);var u=Ki;if(u&&s){var x=ve(u).hoistableScripts,m=Gi(s),v=x.get(m);v||(v=u.querySelector(ho(m)),v||(s=g({src:s,async:!0},i),(i=va.get(m))&&rd(s,i),v=u.createElement("script"),le(v),yn(v,"link",s),u.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},x.set(m,v))}}function VT(s,i){yr.M(s,i);var u=Ki;if(u&&s){var x=ve(u).hoistableScripts,m=Gi(s),v=x.get(m);v||(v=u.querySelector(ho(m)),v||(s=g({src:s,async:!0,type:"module"},i),(i=va.get(m))&&rd(s,i),v=u.createElement("script"),le(v),yn(v,"link",s),u.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},x.set(m,v))}}function g1(s,i,u,x){var m=(m=U.current)?ku(m):null;if(!m)throw Error(a(446));switch(s){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(i=Wi(u.href),u=ve(m).hoistableStyles,x=u.get(i),x||(x={type:"style",instance:null,count:0,state:null},u.set(i,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){s=Wi(u.href);var v=ve(m).hoistableStyles,N=v.get(s);if(N||(m=m.ownerDocument||m,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(s,N),(v=m.querySelector(uo(s)))&&!v._p&&(N.instance=v,N.state.loading=5),va.has(s)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},va.set(s,u),v||KT(m,s,u,N.state))),i&&x===null)throw Error(a(528,""));return N}if(i&&x!==null)throw Error(a(529,""));return null;case"script":return i=u.async,u=u.src,typeof u=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Gi(u),u=ve(m).hoistableScripts,x=u.get(i),x||(x={type:"script",instance:null,count:0,state:null},u.set(i,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,s))}}function Wi(s){return'href="'+fa(s)+'"'}function uo(s){return'link[rel="stylesheet"]['+s+"]"}function m1(s){return g({},s,{"data-precedence":s.precedence,precedence:null})}function KT(s,i,u,x){s.querySelector('link[rel="preload"][as="style"]['+i+"]")?x.loading=1:(i=s.createElement("link"),x.preload=i,i.addEventListener("load",function(){return x.loading|=1}),i.addEventListener("error",function(){return x.loading|=2}),yn(i,"link",u),le(i),s.head.appendChild(i))}function Gi(s){return'[src="'+fa(s)+'"]'}function ho(s){return"script[async]"+s}function p1(s,i,u){if(i.count++,i.instance===null)switch(i.type){case"style":var x=s.querySelector('style[data-href~="'+fa(u.href)+'"]');if(x)return i.instance=x,le(x),x;var m=g({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return x=(s.ownerDocument||s).createElement("style"),le(x),yn(x,"style",m),ju(x,u.precedence,s),i.instance=x;case"stylesheet":m=Wi(u.href);var v=s.querySelector(uo(m));if(v)return i.state.loading|=4,i.instance=v,le(v),v;x=m1(u),(m=va.get(m))&&ad(x,m),v=(s.ownerDocument||s).createElement("link"),le(v);var N=v;return N._p=new Promise(function(R,J){N.onload=R,N.onerror=J}),yn(v,"link",x),i.state.loading|=4,ju(v,u.precedence,s),i.instance=v;case"script":return v=Gi(u.src),(m=s.querySelector(ho(v)))?(i.instance=m,le(m),m):(x=u,(m=va.get(v))&&(x=g({},u),rd(x,m)),s=s.ownerDocument||s,m=s.createElement("script"),le(m),yn(m,"link",x),s.head.appendChild(m),i.instance=m);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(x=i.instance,i.state.loading|=4,ju(x,u.precedence,s));return i.instance}function ju(s,i,u){for(var x=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=x.length?x[x.length-1]:null,v=m,N=0;N<x.length;N++){var R=x[N];if(R.dataset.precedence===i)v=R;else if(v!==m)break}v?v.parentNode.insertBefore(s,v.nextSibling):(i=u.nodeType===9?u.head:u,i.insertBefore(s,i.firstChild))}function ad(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.title==null&&(s.title=i.title)}function rd(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.integrity==null&&(s.integrity=i.integrity)}var Au=null;function y1(s,i,u){if(Au===null){var x=new Map,m=Au=new Map;m.set(u,x)}else m=Au,x=m.get(u),x||(x=new Map,m.set(u,x));if(x.has(s))return x;for(x.set(s,null),u=u.getElementsByTagName(s),m=0;m<u.length;m++){var v=u[m];if(!(v[L]||v[sn]||s==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var N=v.getAttribute(i)||"";N=s+N;var R=x.get(N);R?R.push(v):x.set(N,[v])}}return x}function v1(s,i,u){s=s.ownerDocument||s,s.head.insertBefore(u,i==="title"?s.querySelector("head > title"):null)}function WT(s,i,u){if(u===1||i.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return s=i.disabled,typeof i.precedence=="string"&&s==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function b1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var fo=null;function GT(){}function XT(s,i,u){if(fo===null)throw Error(a(475));var x=fo;if(i.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var m=Wi(u.href),v=s.querySelector(uo(m));if(v){s=v._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(x.count++,x=Du.bind(x),s.then(x,x)),i.state.loading|=4,i.instance=v,le(v);return}v=s.ownerDocument||s,u=m1(u),(m=va.get(m))&&ad(u,m),v=v.createElement("link"),le(v);var N=v;N._p=new Promise(function(R,J){N.onload=R,N.onerror=J}),yn(v,"link",u),i.instance=v}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(i,s),(s=i.state.preload)&&(i.state.loading&3)===0&&(x.count++,i=Du.bind(x),s.addEventListener("load",i),s.addEventListener("error",i))}}function YT(){if(fo===null)throw Error(a(475));var s=fo;return s.stylesheets&&s.count===0&&sd(s,s.stylesheets),0<s.count?function(i){var u=setTimeout(function(){if(s.stylesheets&&sd(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4);return s.unsuspend=i,function(){s.unsuspend=null,clearTimeout(u)}}:null}function Du(){if(this.count--,this.count===0){if(this.stylesheets)sd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Ou=null;function sd(s,i){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Ou=new Map,i.forEach(qT,s),Ou=null,Du.call(s))}function qT(s,i){if(!(i.state.loading&4)){var u=Ou.get(s);if(u)var x=u.get(null);else{u=new Map,Ou.set(s,u);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<m.length;v++){var N=m[v];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(u.set(N.dataset.precedence,N),x=N)}x&&u.set(null,x)}m=i.instance,N=m.getAttribute("data-precedence"),v=u.get(N)||x,v===x&&u.set(null,m),u.set(N,m),this.count++,x=Du.bind(this),m.addEventListener("load",x),m.addEventListener("error",x),v?v.parentNode.insertBefore(m,v.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),i.state.loading|=4}}var xo={$$typeof:C,Provider:null,Consumer:null,_currentValue:pe,_currentValue2:pe,_threadCount:0};function $T(s,i,u,x,m,v,N,R){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=_l(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_l(0),this.hiddenUpdates=_l(null),this.identifierPrefix=x,this.onUncaughtError=m,this.onCaughtError=v,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=R,this.incompleteTransitions=new Map}function w1(s,i,u,x,m,v,N,R,J,ce,_e,Ee){return s=new $T(s,i,u,N,R,J,ce,Ee),i=1,v===!0&&(i|=24),v=Zn(3,null,null,i),s.current=v,v.stateNode=s,i=If(),i.refCount++,s.pooledCache=i,i.refCount++,v.memoizedState={element:x,isDehydrated:u,cache:i},Kf(v),s}function _1(s){return s?(s=Ti,s):Ti}function T1(s,i,u,x,m,v){m=_1(m),x.context===null?x.context=m:x.pendingContext=m,x=zr(i),x.payload={element:u},v=v===void 0?null:v,v!==null&&(x.callback=v),u=Ur(s,x,i),u!==null&&(aa(u,s,i),Vl(u,s,i))}function S1(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<i?u:i}}function id(s,i){S1(s,i),(s=s.alternate)&&S1(s,i)}function N1(s){if(s.tag===13){var i=_i(s,67108864);i!==null&&aa(i,s,67108864),id(s,67108864)}}var Mu=!0;function QT(s,i,u,x){var m=ee.T;ee.T=null;var v=Q.p;try{Q.p=2,ld(s,i,u,x)}finally{Q.p=v,ee.T=m}}function ZT(s,i,u,x){var m=ee.T;ee.T=null;var v=Q.p;try{Q.p=8,ld(s,i,u,x)}finally{Q.p=v,ee.T=m}}function ld(s,i,u,x){if(Mu){var m=od(x);if(m===null)Y0(s,i,x,Ru,u),C1(s,x);else if(eS(m,s,i,u,x))x.stopPropagation();else if(C1(s,x),i&4&&-1<JT.indexOf(s)){for(;m!==null;){var v=X(m);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var N=za(v.pendingLanes);if(N!==0){var R=v;for(R.pendingLanes|=2,R.entangledLanes|=2;N;){var J=1<<31-gn(N);R.entanglements[1]|=J,N&=~J}Xa(v),(gt&6)===0&&(pu=Fe()+500,io(0))}}break;case 13:R=_i(v,2),R!==null&&aa(R,v,2),vu(),id(v,2)}if(v=od(x),v===null&&Y0(s,i,x,Ru,u),v===m)break;m=v}m!==null&&x.stopPropagation()}else Y0(s,i,x,null,u)}}function od(s){return s=df(s),cd(s)}var Ru=null;function cd(s){if(Ru=null,s=W(s),s!==null){var i=l(s);if(i===null)s=null;else{var u=i.tag;if(u===13){if(s=o(i),s!==null)return s;s=null}else if(u===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null)}}return Ru=s,null}function E1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ft()){case Jt:return 2;case Fn:return 8;case Cn:case me:return 32;case ke:return 268435456;default:return 32}default:return 32}}var ud=!1,ts=null,ns=null,as=null,go=new Map,mo=new Map,rs=[],JT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function C1(s,i){switch(s){case"focusin":case"focusout":ts=null;break;case"dragenter":case"dragleave":ns=null;break;case"mouseover":case"mouseout":as=null;break;case"pointerover":case"pointerout":go.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":mo.delete(i.pointerId)}}function po(s,i,u,x,m,v){return s===null||s.nativeEvent!==v?(s={blockedOn:i,domEventName:u,eventSystemFlags:x,nativeEvent:v,targetContainers:[m]},i!==null&&(i=X(i),i!==null&&N1(i)),s):(s.eventSystemFlags|=x,i=s.targetContainers,m!==null&&i.indexOf(m)===-1&&i.push(m),s)}function eS(s,i,u,x,m){switch(i){case"focusin":return ts=po(ts,s,i,u,x,m),!0;case"dragenter":return ns=po(ns,s,i,u,x,m),!0;case"mouseover":return as=po(as,s,i,u,x,m),!0;case"pointerover":var v=m.pointerId;return go.set(v,po(go.get(v)||null,s,i,u,x,m)),!0;case"gotpointercapture":return v=m.pointerId,mo.set(v,po(mo.get(v)||null,s,i,u,x,m)),!0}return!1}function k1(s){var i=W(s.target);if(i!==null){var u=l(i);if(u!==null){if(i=u.tag,i===13){if(i=o(u),i!==null){s.blockedOn=i,lf(s.priority,function(){if(u.tag===13){var x=na();x=Tl(x);var m=_i(u,x);m!==null&&aa(m,u,x),id(u,x)}});return}}else if(i===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Fu(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var u=od(s.nativeEvent);if(u===null){u=s.nativeEvent;var x=new u.constructor(u.type,u);ff=x,u.target.dispatchEvent(x),ff=null}else return i=X(u),i!==null&&N1(i),s.blockedOn=u,!1;i.shift()}return!0}function j1(s,i,u){Fu(s)&&u.delete(i)}function tS(){ud=!1,ts!==null&&Fu(ts)&&(ts=null),ns!==null&&Fu(ns)&&(ns=null),as!==null&&Fu(as)&&(as=null),go.forEach(j1),mo.forEach(j1)}function Lu(s,i){s.blockedOn===i&&(s.blockedOn=null,ud||(ud=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,tS)))}var Bu=null;function A1(s){Bu!==s&&(Bu=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Bu===s&&(Bu=null);for(var i=0;i<s.length;i+=3){var u=s[i],x=s[i+1],m=s[i+2];if(typeof x!="function"){if(cd(x||u)===null)continue;break}var v=X(u);v!==null&&(s.splice(i,3),i-=3,c0(v,{pending:!0,data:m,method:u.method,action:x},x,m))}}))}function yo(s){function i(J){return Lu(J,s)}ts!==null&&Lu(ts,s),ns!==null&&Lu(ns,s),as!==null&&Lu(as,s),go.forEach(i),mo.forEach(i);for(var u=0;u<rs.length;u++){var x=rs[u];x.blockedOn===s&&(x.blockedOn=null)}for(;0<rs.length&&(u=rs[0],u.blockedOn===null);)k1(u),u.blockedOn===null&&rs.shift();if(u=(s.ownerDocument||s).$$reactFormReplay,u!=null)for(x=0;x<u.length;x+=3){var m=u[x],v=u[x+1],N=m[ln]||null;if(typeof v=="function")N||A1(u);else if(N){var R=null;if(v&&v.hasAttribute("formAction")){if(m=v,N=v[ln]||null)R=N.formAction;else if(cd(m)!==null)continue}else R=N.action;typeof R=="function"?u[x+1]=R:(u.splice(x,3),x-=3),A1(u)}}}function hd(s){this._internalRoot=s}Hu.prototype.render=hd.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(a(409));var u=i.current,x=na();T1(u,x,s,i,null,null)},Hu.prototype.unmount=hd.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;T1(s.current,2,null,s,null,null),vu(),i[Lr]=null}};function Hu(s){this._internalRoot=s}Hu.prototype.unstable_scheduleHydration=function(s){if(s){var i=Dc();s={blockedOn:null,target:s,priority:i};for(var u=0;u<rs.length&&i!==0&&i<rs[u].priority;u++);rs.splice(u,0,s),u===0&&k1(s)}};var D1=t.version;if(D1!=="19.1.0")throw Error(a(527,D1,"19.1.0"));Q.findDOMNode=function(s){var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(a(188)):(s=Object.keys(s).join(","),Error(a(268,s)));return s=f(i),s=s!==null?d(s):null,s=s===null?null:s.stateNode,s};var nS={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ee,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pu.isDisabled&&Pu.supportsFiber)try{wt=Pu.inject(nS),_t=Pu}catch{}}return bo.createRoot=function(s,i){if(!r(s))throw Error(a(299));var u=!1,x="",m=Xm,v=Ym,N=qm,R=null;return i!=null&&(i.unstable_strictMode===!0&&(u=!0),i.identifierPrefix!==void 0&&(x=i.identifierPrefix),i.onUncaughtError!==void 0&&(m=i.onUncaughtError),i.onCaughtError!==void 0&&(v=i.onCaughtError),i.onRecoverableError!==void 0&&(N=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(R=i.unstable_transitionCallbacks)),i=w1(s,1,!1,null,null,u,x,m,v,N,R,null),s[Lr]=i.current,X0(s),new hd(i)},bo.hydrateRoot=function(s,i,u){if(!r(s))throw Error(a(299));var x=!1,m="",v=Xm,N=Ym,R=qm,J=null,ce=null;return u!=null&&(u.unstable_strictMode===!0&&(x=!0),u.identifierPrefix!==void 0&&(m=u.identifierPrefix),u.onUncaughtError!==void 0&&(v=u.onUncaughtError),u.onCaughtError!==void 0&&(N=u.onCaughtError),u.onRecoverableError!==void 0&&(R=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(J=u.unstable_transitionCallbacks),u.formState!==void 0&&(ce=u.formState)),i=w1(s,1,!0,i,u??null,x,m,v,N,R,J,ce),i.context=_1(null),u=i.current,x=na(),x=Tl(x),m=zr(x),m.callback=null,Ur(u,m,x),u=x,i.current.lanes=u,Ts(i,u),Xa(i),s[Lr]=i.current,X0(s),new Hu(i)},bo.version="19.1.0",bo}var z1;function xS(){if(z1)return xd.exports;z1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),xd.exports=dS(),xd.exports}var gS=xS(),wo={},U1;function mS(){if(U1)return wo;U1=1,Object.defineProperty(wo,"__esModule",{value:!0}),wo.parse=o,wo.serialize=d;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,a=/^[\u0020-\u003A\u003D-\u007E]*$/,r=Object.prototype.toString,l=(()=>{const y=function(){};return y.prototype=Object.create(null),y})();function o(y,w){const _=new l,b=y.length;if(b<2)return _;const T=(w==null?void 0:w.decode)||g;let S=0;do{const E=y.indexOf("=",S);if(E===-1)break;const C=y.indexOf(";",S),A=C===-1?b:C;if(E>A){S=y.lastIndexOf(";",E-1)+1;continue}const F=h(y,S,E),K=f(y,E,F),D=y.slice(F,K);if(_[D]===void 0){let H=h(y,E+1,A),M=f(y,A,H);const B=T(y.slice(H,M));_[D]=B}S=A+1}while(S<b);return _}function h(y,w,_){do{const b=y.charCodeAt(w);if(b!==32&&b!==9)return w}while(++w<_);return _}function f(y,w,_){for(;w>_;){const b=y.charCodeAt(--w);if(b!==32&&b!==9)return w+1}return _}function d(y,w,_){const b=(_==null?void 0:_.encode)||encodeURIComponent;if(!e.test(y))throw new TypeError(`argument name is invalid: ${y}`);const T=b(w);if(!t.test(T))throw new TypeError(`argument val is invalid: ${w}`);let S=y+"="+T;if(!_)return S;if(_.maxAge!==void 0){if(!Number.isInteger(_.maxAge))throw new TypeError(`option maxAge is invalid: ${_.maxAge}`);S+="; Max-Age="+_.maxAge}if(_.domain){if(!n.test(_.domain))throw new TypeError(`option domain is invalid: ${_.domain}`);S+="; Domain="+_.domain}if(_.path){if(!a.test(_.path))throw new TypeError(`option path is invalid: ${_.path}`);S+="; Path="+_.path}if(_.expires){if(!p(_.expires)||!Number.isFinite(_.expires.valueOf()))throw new TypeError(`option expires is invalid: ${_.expires}`);S+="; Expires="+_.expires.toUTCString()}if(_.httpOnly&&(S+="; HttpOnly"),_.secure&&(S+="; Secure"),_.partitioned&&(S+="; Partitioned"),_.priority)switch(typeof _.priority=="string"?_.priority.toLowerCase():void 0){case"low":S+="; Priority=Low";break;case"medium":S+="; Priority=Medium";break;case"high":S+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${_.priority}`)}if(_.sameSite)switch(typeof _.sameSite=="string"?_.sameSite.toLowerCase():_.sameSite){case!0:case"strict":S+="; SameSite=Strict";break;case"lax":S+="; SameSite=Lax";break;case"none":S+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${_.sameSite}`)}return S}function g(y){if(y.indexOf("%")===-1)return y;try{return decodeURIComponent(y)}catch{return y}}function p(y){return r.call(y)==="[object Date]"}return wo}mS();var V1="popstate";function pS(e={}){function t(a,r){let{pathname:l,search:o,hash:h}=a.location;return Vd("",{pathname:l,search:o,hash:h},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(a,r){return typeof r=="string"?r:$o(r)}return vS(t,n,null,e)}function Lt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Ha(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function yS(){return Math.random().toString(36).substring(2,10)}function K1(e,t){return{usr:e.state,key:e.key,idx:t}}function Vd(e,t,n=null,a){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?fl(t):t,state:n,key:t&&t.key||a||yS()}}function $o({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function fl(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let a=e.indexOf("?");a>=0&&(t.search=e.substring(a),e=e.substring(0,a)),e&&(t.pathname=e)}return t}function vS(e,t,n,a={}){let{window:r=document.defaultView,v5Compat:l=!1}=a,o=r.history,h="POP",f=null,d=g();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function g(){return(o.state||{idx:null}).idx}function p(){h="POP";let T=g(),S=T==null?null:T-d;d=T,f&&f({action:h,location:b.location,delta:S})}function y(T,S){h="PUSH";let E=Vd(b.location,T,S);d=g()+1;let C=K1(E,d),A=b.createHref(E);try{o.pushState(C,"",A)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;r.location.assign(A)}l&&f&&f({action:h,location:b.location,delta:1})}function w(T,S){h="REPLACE";let E=Vd(b.location,T,S);d=g();let C=K1(E,d),A=b.createHref(E);o.replaceState(C,"",A),l&&f&&f({action:h,location:b.location,delta:0})}function _(T){return bS(T)}let b={get action(){return h},get location(){return e(r,o)},listen(T){if(f)throw new Error("A history only accepts one active listener");return r.addEventListener(V1,p),f=T,()=>{r.removeEventListener(V1,p),f=null}},createHref(T){return t(r,T)},createURL:_,encodeLocation(T){let S=_(T);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:y,replace:w,go(T){return o.go(T)}};return b}function bS(e,t=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Lt(n,"No window.location.(origin|href) available to create URL");let a=typeof e=="string"?e:$o(e);return a=a.replace(/ $/,"%20"),!t&&a.startsWith("//")&&(a=n+a),new URL(a,n)}function a2(e,t,n="/"){return wS(e,t,n,!1)}function wS(e,t,n,a){let r=typeof t=="string"?fl(t):t,l=Dr(r.pathname||"/",n);if(l==null)return null;let o=r2(e);_S(o);let h=null;for(let f=0;h==null&&f<o.length;++f){let d=MS(l);h=DS(o[f],d,a)}return h}function r2(e,t=[],n=[],a=""){let r=(l,o,h)=>{let f={relativePath:h===void 0?l.path||"":h,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};f.relativePath.startsWith("/")&&(Lt(f.relativePath.startsWith(a),`Absolute route path "${f.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(a.length));let d=Er([a,f.relativePath]),g=n.concat(f);l.children&&l.children.length>0&&(Lt(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),r2(l.children,t,g,d)),!(l.path==null&&!l.index)&&t.push({path:d,score:jS(d,l.index),routesMeta:g})};return e.forEach((l,o)=>{var h;if(l.path===""||!((h=l.path)!=null&&h.includes("?")))r(l,o);else for(let f of s2(l.path))r(l,o,f)}),t}function s2(e){let t=e.split("/");if(t.length===0)return[];let[n,...a]=t,r=n.endsWith("?"),l=n.replace(/\?$/,"");if(a.length===0)return r?[l,""]:[l];let o=s2(a.join("/")),h=[];return h.push(...o.map(f=>f===""?l:[l,f].join("/"))),r&&h.push(...o),h.map(f=>e.startsWith("/")&&f===""?"/":f)}function _S(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:AS(t.routesMeta.map(a=>a.childrenIndex),n.routesMeta.map(a=>a.childrenIndex)))}var TS=/^:[\w-]+$/,SS=3,NS=2,ES=1,CS=10,kS=-2,W1=e=>e==="*";function jS(e,t){let n=e.split("/"),a=n.length;return n.some(W1)&&(a+=kS),t&&(a+=NS),n.filter(r=>!W1(r)).reduce((r,l)=>r+(TS.test(l)?SS:l===""?ES:CS),a)}function AS(e,t){return e.length===t.length&&e.slice(0,-1).every((a,r)=>a===t[r])?e[e.length-1]-t[t.length-1]:0}function DS(e,t,n=!1){let{routesMeta:a}=e,r={},l="/",o=[];for(let h=0;h<a.length;++h){let f=a[h],d=h===a.length-1,g=l==="/"?t:t.slice(l.length)||"/",p=bh({path:f.relativePath,caseSensitive:f.caseSensitive,end:d},g),y=f.route;if(!p&&d&&n&&!a[a.length-1].route.index&&(p=bh({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},g)),!p)return null;Object.assign(r,p.params),o.push({params:r,pathname:Er([l,p.pathname]),pathnameBase:BS(Er([l,p.pathnameBase])),route:y}),p.pathnameBase!=="/"&&(l=Er([l,p.pathnameBase]))}return o}function bh(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,a]=OS(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let l=r[0],o=l.replace(/(.)\/+$/,"$1"),h=r.slice(1);return{params:a.reduce((d,{paramName:g,isOptional:p},y)=>{if(g==="*"){let _=h[y]||"";o=l.slice(0,l.length-_.length).replace(/(.)\/+$/,"$1")}const w=h[y];return p&&!w?d[g]=void 0:d[g]=(w||"").replace(/%2F/g,"/"),d},{}),pathname:l,pathnameBase:o,pattern:e}}function OS(e,t=!1,n=!0){Ha(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let a=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,h,f)=>(a.push({paramName:h,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(a.push({paramName:"*"}),r+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":e!==""&&e!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),a]}function MS(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Ha(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Dr(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,a=e.charAt(n);return a&&a!=="/"?null:e.slice(n)||"/"}function RS(e,t="/"){let{pathname:n,search:a="",hash:r=""}=typeof e=="string"?fl(e):e;return{pathname:n?n.startsWith("/")?n:FS(n,t):t,search:HS(a),hash:PS(r)}}function FS(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function yd(e,t,n,a){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function LS(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function ix(e){let t=LS(e);return t.map((n,a)=>a===t.length-1?n.pathname:n.pathnameBase)}function lx(e,t,n,a=!1){let r;typeof e=="string"?r=fl(e):(r={...e},Lt(!r.pathname||!r.pathname.includes("?"),yd("?","pathname","search",r)),Lt(!r.pathname||!r.pathname.includes("#"),yd("#","pathname","hash",r)),Lt(!r.search||!r.search.includes("#"),yd("#","search","hash",r)));let l=e===""||r.pathname==="",o=l?"/":r.pathname,h;if(o==null)h=n;else{let p=t.length-1;if(!a&&o.startsWith("..")){let y=o.split("/");for(;y[0]==="..";)y.shift(),p-=1;r.pathname=y.join("/")}h=p>=0?t[p]:"/"}let f=RS(r,h),d=o&&o!=="/"&&o.endsWith("/"),g=(l||o===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(d||g)&&(f.pathname+="/"),f}var Er=e=>e.join("/").replace(/\/\/+/g,"/"),BS=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),HS=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,PS=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function IS(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var i2=["POST","PUT","PATCH","DELETE"];new Set(i2);var zS=["GET",...i2];new Set(zS);var dl=j.createContext(null);dl.displayName="DataRouter";var Kh=j.createContext(null);Kh.displayName="DataRouterState";var l2=j.createContext({isTransitioning:!1});l2.displayName="ViewTransition";var US=j.createContext(new Map);US.displayName="Fetchers";var VS=j.createContext(null);VS.displayName="Await";var Ia=j.createContext(null);Ia.displayName="Navigation";var gc=j.createContext(null);gc.displayName="Location";var nr=j.createContext({outlet:null,matches:[],isDataRoute:!1});nr.displayName="Route";var ox=j.createContext(null);ox.displayName="RouteError";function KS(e,{relative:t}={}){Lt(xl(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:a}=j.useContext(Ia),{hash:r,pathname:l,search:o}=pc(e,{relative:t}),h=l;return n!=="/"&&(h=l==="/"?n:Er([n,l])),a.createHref({pathname:h,search:o,hash:r})}function xl(){return j.useContext(gc)!=null}function Rr(){return Lt(xl(),"useLocation() may be used only in the context of a <Router> component."),j.useContext(gc).location}var o2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function c2(e){j.useContext(Ia).static||j.useLayoutEffect(e)}function mc(){let{isDataRoute:e}=j.useContext(nr);return e?a4():WS()}function WS(){Lt(xl(),"useNavigate() may be used only in the context of a <Router> component.");let e=j.useContext(dl),{basename:t,navigator:n}=j.useContext(Ia),{matches:a}=j.useContext(nr),{pathname:r}=Rr(),l=JSON.stringify(ix(a)),o=j.useRef(!1);return c2(()=>{o.current=!0}),j.useCallback((f,d={})=>{if(Ha(o.current,o2),!o.current)return;if(typeof f=="number"){n.go(f);return}let g=lx(f,JSON.parse(l),r,d.relative==="path");e==null&&t!=="/"&&(g.pathname=g.pathname==="/"?t:Er([t,g.pathname])),(d.replace?n.replace:n.push)(g,d.state,d)},[t,n,l,r,e])}j.createContext(null);function pc(e,{relative:t}={}){let{matches:n}=j.useContext(nr),{pathname:a}=Rr(),r=JSON.stringify(ix(n));return j.useMemo(()=>lx(e,JSON.parse(r),a,t==="path"),[e,r,a,t])}function GS(e,t){return u2(e,t)}function u2(e,t,n,a){var S;Lt(xl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r}=j.useContext(Ia),{matches:l}=j.useContext(nr),o=l[l.length-1],h=o?o.params:{},f=o?o.pathname:"/",d=o?o.pathnameBase:"/",g=o&&o.route;{let E=g&&g.path||"";h2(f,!g||E.endsWith("*")||E.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${E}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${E}"> to <Route path="${E==="/"?"*":`${E}/*`}">.`)}let p=Rr(),y;if(t){let E=typeof t=="string"?fl(t):t;Lt(d==="/"||((S=E.pathname)==null?void 0:S.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${E.pathname}" was given in the \`location\` prop.`),y=E}else y=p;let w=y.pathname||"/",_=w;if(d!=="/"){let E=d.replace(/^\//,"").split("/");_="/"+w.replace(/^\//,"").split("/").slice(E.length).join("/")}let b=a2(e,{pathname:_});Ha(g||b!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),Ha(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=QS(b&&b.map(E=>Object.assign({},E,{params:Object.assign({},h,E.params),pathname:Er([d,r.encodeLocation?r.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?d:Er([d,r.encodeLocation?r.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),l,n,a);return t&&T?j.createElement(gc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},T):T}function XS(){let e=n4(),t=IS(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:a},l={padding:"2px 4px",backgroundColor:a},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=j.createElement(j.Fragment,null,j.createElement("p",null,"💿 Hey developer 👋"),j.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",j.createElement("code",{style:l},"ErrorBoundary")," or"," ",j.createElement("code",{style:l},"errorElement")," prop on your route.")),j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},t),n?j.createElement("pre",{style:r},n):null,o)}var YS=j.createElement(XS,null),qS=class extends j.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?j.createElement(nr.Provider,{value:this.props.routeContext},j.createElement(ox.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function $S({routeContext:e,match:t,children:n}){let a=j.useContext(dl);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),j.createElement(nr.Provider,{value:e},n)}function QS(e,t=[],n=null,a=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let r=e,l=n==null?void 0:n.errors;if(l!=null){let f=r.findIndex(d=>d.route.id&&(l==null?void 0:l[d.route.id])!==void 0);Lt(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),r=r.slice(0,Math.min(r.length,f+1))}let o=!1,h=-1;if(n)for(let f=0;f<r.length;f++){let d=r[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(h=f),d.route.id){let{loaderData:g,errors:p}=n,y=d.route.loader&&!g.hasOwnProperty(d.route.id)&&(!p||p[d.route.id]===void 0);if(d.route.lazy||y){o=!0,h>=0?r=r.slice(0,h+1):r=[r[0]];break}}}return r.reduceRight((f,d,g)=>{let p,y=!1,w=null,_=null;n&&(p=l&&d.route.id?l[d.route.id]:void 0,w=d.route.errorElement||YS,o&&(h<0&&g===0?(h2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,_=null):h===g&&(y=!0,_=d.route.hydrateFallbackElement||null)));let b=t.concat(r.slice(0,g+1)),T=()=>{let S;return p?S=w:y?S=_:d.route.Component?S=j.createElement(d.route.Component,null):d.route.element?S=d.route.element:S=f,j.createElement($S,{match:d,routeContext:{outlet:f,matches:b,isDataRoute:n!=null},children:S})};return n&&(d.route.ErrorBoundary||d.route.errorElement||g===0)?j.createElement(qS,{location:n.location,revalidation:n.revalidation,component:w,error:p,children:T(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):T()},null)}function cx(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ZS(e){let t=j.useContext(dl);return Lt(t,cx(e)),t}function JS(e){let t=j.useContext(Kh);return Lt(t,cx(e)),t}function e4(e){let t=j.useContext(nr);return Lt(t,cx(e)),t}function ux(e){let t=e4(e),n=t.matches[t.matches.length-1];return Lt(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function t4(){return ux("useRouteId")}function n4(){var a;let e=j.useContext(ox),t=JS("useRouteError"),n=ux("useRouteError");return e!==void 0?e:(a=t.errors)==null?void 0:a[n]}function a4(){let{router:e}=ZS("useNavigate"),t=ux("useNavigate"),n=j.useRef(!1);return c2(()=>{n.current=!0}),j.useCallback(async(r,l={})=>{Ha(n.current,o2),n.current&&(typeof r=="number"?e.navigate(r):await e.navigate(r,{fromRouteId:t,...l}))},[e,t])}var G1={};function h2(e,t,n){!t&&!G1[e]&&(G1[e]=!0,Ha(!1,n))}j.memo(r4);function r4({routes:e,future:t,state:n}){return u2(e,void 0,n,t)}function Ji({to:e,replace:t,state:n,relative:a}){Lt(xl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:r}=j.useContext(Ia);Ha(!r,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=j.useContext(nr),{pathname:o}=Rr(),h=mc(),f=lx(e,ix(l),o,a==="path"),d=JSON.stringify(f);return j.useEffect(()=>{h(JSON.parse(d),{replace:t,state:n,relative:a})},[h,d,a,t,n]),null}function hn(e){Lt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function s4({basename:e="/",children:t=null,location:n,navigationType:a="POP",navigator:r,static:l=!1}){Lt(!xl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),h=j.useMemo(()=>({basename:o,navigator:r,static:l,future:{}}),[o,r,l]);typeof n=="string"&&(n=fl(n));let{pathname:f="/",search:d="",hash:g="",state:p=null,key:y="default"}=n,w=j.useMemo(()=>{let _=Dr(f,o);return _==null?null:{location:{pathname:_,search:d,hash:g,state:p,key:y},navigationType:a}},[o,f,d,g,p,y,a]);return Ha(w!=null,`<Router basename="${o}"> is not able to match the URL "${f}${d}${g}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:j.createElement(Ia.Provider,{value:h},j.createElement(gc.Provider,{children:t,value:w}))}function i4({children:e,location:t}){return GS(Kd(e),t)}function Kd(e,t=[]){let n=[];return j.Children.forEach(e,(a,r)=>{if(!j.isValidElement(a))return;let l=[...t,r];if(a.type===j.Fragment){n.push.apply(n,Kd(a.props.children,l));return}Lt(a.type===hn,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Lt(!a.props.index||!a.props.children,"An index route cannot have child routes.");let o={id:a.props.id||l.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(o.children=Kd(a.props.children,l)),n.push(o)}),n}var xh="get",gh="application/x-www-form-urlencoded";function Wh(e){return e!=null&&typeof e.tagName=="string"}function l4(e){return Wh(e)&&e.tagName.toLowerCase()==="button"}function o4(e){return Wh(e)&&e.tagName.toLowerCase()==="form"}function c4(e){return Wh(e)&&e.tagName.toLowerCase()==="input"}function u4(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function h4(e,t){return e.button===0&&(!t||t==="_self")&&!u4(e)}var Iu=null;function f4(){if(Iu===null)try{new FormData(document.createElement("form"),0),Iu=!1}catch{Iu=!0}return Iu}var d4=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function vd(e){return e!=null&&!d4.has(e)?(Ha(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${gh}"`),null):e}function x4(e,t){let n,a,r,l,o;if(o4(e)){let h=e.getAttribute("action");a=h?Dr(h,t):null,n=e.getAttribute("method")||xh,r=vd(e.getAttribute("enctype"))||gh,l=new FormData(e)}else if(l4(e)||c4(e)&&(e.type==="submit"||e.type==="image")){let h=e.form;if(h==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=e.getAttribute("formaction")||h.getAttribute("action");if(a=f?Dr(f,t):null,n=e.getAttribute("formmethod")||h.getAttribute("method")||xh,r=vd(e.getAttribute("formenctype"))||vd(h.getAttribute("enctype"))||gh,l=new FormData(h,e),!f4()){let{name:d,type:g,value:p}=e;if(g==="image"){let y=d?`${d}.`:"";l.append(`${y}x`,"0"),l.append(`${y}y`,"0")}else d&&l.append(d,p)}}else{if(Wh(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=xh,a=null,r=gh,o=e}return l&&r==="text/plain"&&(o=l,l=void 0),{action:a,method:n.toLowerCase(),encType:r,formData:l,body:o}}function hx(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function g4(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function m4(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function p4(e,t,n){let a=await Promise.all(e.map(async r=>{let l=t.routes[r.route.id];if(l){let o=await g4(l,n);return o.links?o.links():[]}return[]}));return w4(a.flat(1).filter(m4).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function X1(e,t,n,a,r,l){let o=(f,d)=>n[d]?f.route.id!==n[d].route.id:!0,h=(f,d)=>{var g;return n[d].pathname!==f.pathname||((g=n[d].route.path)==null?void 0:g.endsWith("*"))&&n[d].params["*"]!==f.params["*"]};return l==="assets"?t.filter((f,d)=>o(f,d)||h(f,d)):l==="data"?t.filter((f,d)=>{var p;let g=a.routes[f.route.id];if(!g||!g.hasLoader)return!1;if(o(f,d)||h(f,d))return!0;if(f.route.shouldRevalidate){let y=f.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((p=n[0])==null?void 0:p.params)||{},nextUrl:new URL(e,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function y4(e,t,{includeHydrateFallback:n}={}){return v4(e.map(a=>{let r=t.routes[a.route.id];if(!r)return[];let l=[r.module];return r.clientActionModule&&(l=l.concat(r.clientActionModule)),r.clientLoaderModule&&(l=l.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(l=l.concat(r.hydrateFallbackModule)),r.imports&&(l=l.concat(r.imports)),l}).flat(1))}function v4(e){return[...new Set(e)]}function b4(e){let t={},n=Object.keys(e).sort();for(let a of n)t[a]=e[a];return t}function w4(e,t){let n=new Set;return new Set(t),e.reduce((a,r)=>{let l=JSON.stringify(b4(r));return n.has(l)||(n.add(l),a.push({key:l,link:r})),a},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var _4=new Set([100,101,204,205]);function T4(e,t){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname="_root.data":t&&Dr(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function f2(){let e=j.useContext(dl);return hx(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function S4(){let e=j.useContext(Kh);return hx(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var fx=j.createContext(void 0);fx.displayName="FrameworkContext";function d2(){let e=j.useContext(fx);return hx(e,"You must render this element inside a <HydratedRouter> element"),e}function N4(e,t){let n=j.useContext(fx),[a,r]=j.useState(!1),[l,o]=j.useState(!1),{onFocus:h,onBlur:f,onMouseEnter:d,onMouseLeave:g,onTouchStart:p}=t,y=j.useRef(null);j.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let b=S=>{S.forEach(E=>{o(E.isIntersecting)})},T=new IntersectionObserver(b,{threshold:.5});return y.current&&T.observe(y.current),()=>{T.disconnect()}}},[e]),j.useEffect(()=>{if(a){let b=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(b)}}},[a]);let w=()=>{r(!0)},_=()=>{r(!1),o(!1)};return n?e!=="intent"?[l,y,{}]:[l,y,{onFocus:_o(h,w),onBlur:_o(f,_),onMouseEnter:_o(d,w),onMouseLeave:_o(g,_),onTouchStart:_o(p,w)}]:[!1,y,{}]}function _o(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function E4({page:e,...t}){let{router:n}=f2(),a=j.useMemo(()=>a2(n.routes,e,n.basename),[n.routes,e,n.basename]);return a?j.createElement(k4,{page:e,matches:a,...t}):null}function C4(e){let{manifest:t,routeModules:n}=d2(),[a,r]=j.useState([]);return j.useEffect(()=>{let l=!1;return p4(e,t,n).then(o=>{l||r(o)}),()=>{l=!0}},[e,t,n]),a}function k4({page:e,matches:t,...n}){let a=Rr(),{manifest:r,routeModules:l}=d2(),{basename:o}=f2(),{loaderData:h,matches:f}=S4(),d=j.useMemo(()=>X1(e,t,f,r,a,"data"),[e,t,f,r,a]),g=j.useMemo(()=>X1(e,t,f,r,a,"assets"),[e,t,f,r,a]),p=j.useMemo(()=>{if(e===a.pathname+a.search+a.hash)return[];let _=new Set,b=!1;if(t.forEach(S=>{var C;let E=r.routes[S.route.id];!E||!E.hasLoader||(!d.some(A=>A.route.id===S.route.id)&&S.route.id in h&&((C=l[S.route.id])!=null&&C.shouldRevalidate)||E.hasClientLoader?b=!0:_.add(S.route.id))}),_.size===0)return[];let T=T4(e,o);return b&&_.size>0&&T.searchParams.set("_routes",t.filter(S=>_.has(S.route.id)).map(S=>S.route.id).join(",")),[T.pathname+T.search]},[o,h,a,r,d,t,e,l]),y=j.useMemo(()=>y4(g,r),[g,r]),w=C4(g);return j.createElement(j.Fragment,null,p.map(_=>j.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...n})),y.map(_=>j.createElement("link",{key:_,rel:"modulepreload",href:_,...n})),w.map(({key:_,link:b})=>j.createElement("link",{key:_,...b})))}function j4(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var x2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{x2&&(window.__reactRouterVersion="7.6.1")}catch{}function A4({basename:e,children:t,window:n}){let a=j.useRef();a.current==null&&(a.current=pS({window:n,v5Compat:!0}));let r=a.current,[l,o]=j.useState({action:r.action,location:r.location}),h=j.useCallback(f=>{j.startTransition(()=>o(f))},[o]);return j.useLayoutEffect(()=>r.listen(h),[r,h]),j.createElement(s4,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:r})}var g2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Gh=j.forwardRef(function({onClick:t,discover:n="render",prefetch:a="none",relative:r,reloadDocument:l,replace:o,state:h,target:f,to:d,preventScrollReset:g,viewTransition:p,...y},w){let{basename:_}=j.useContext(Ia),b=typeof d=="string"&&g2.test(d),T,S=!1;if(typeof d=="string"&&b&&(T=d,x2))try{let M=new URL(window.location.href),B=d.startsWith("//")?new URL(M.protocol+d):new URL(d),I=Dr(B.pathname,_);B.origin===M.origin&&I!=null?d=I+B.search+B.hash:S=!0}catch{Ha(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=KS(d,{relative:r}),[C,A,F]=N4(a,y),K=R4(d,{replace:o,state:h,target:f,preventScrollReset:g,relative:r,viewTransition:p});function D(M){t&&t(M),M.defaultPrevented||K(M)}let H=j.createElement("a",{...y,...F,href:T||E,onClick:S||l?t:D,ref:j4(w,A),target:f,"data-discover":!b&&n==="render"?"true":void 0});return C&&!b?j.createElement(j.Fragment,null,H,j.createElement(E4,{page:E})):H});Gh.displayName="Link";var D4=j.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:a="",end:r=!1,style:l,to:o,viewTransition:h,children:f,...d},g){let p=pc(o,{relative:d.relative}),y=Rr(),w=j.useContext(Kh),{navigator:_,basename:b}=j.useContext(Ia),T=w!=null&&P4(p)&&h===!0,S=_.encodeLocation?_.encodeLocation(p).pathname:p.pathname,E=y.pathname,C=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;n||(E=E.toLowerCase(),C=C?C.toLowerCase():null,S=S.toLowerCase()),C&&b&&(C=Dr(C,b)||C);const A=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let F=E===S||!r&&E.startsWith(S)&&E.charAt(A)==="/",K=C!=null&&(C===S||!r&&C.startsWith(S)&&C.charAt(S.length)==="/"),D={isActive:F,isPending:K,isTransitioning:T},H=F?t:void 0,M;typeof a=="function"?M=a(D):M=[a,F?"active":null,K?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let B=typeof l=="function"?l(D):l;return j.createElement(Gh,{...d,"aria-current":H,className:M,ref:g,style:B,to:o,viewTransition:h},typeof f=="function"?f(D):f)});D4.displayName="NavLink";var O4=j.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:a,replace:r,state:l,method:o=xh,action:h,onSubmit:f,relative:d,preventScrollReset:g,viewTransition:p,...y},w)=>{let _=B4(),b=H4(h,{relative:d}),T=o.toLowerCase()==="get"?"get":"post",S=typeof h=="string"&&g2.test(h),E=C=>{if(f&&f(C),C.defaultPrevented)return;C.preventDefault();let A=C.nativeEvent.submitter,F=(A==null?void 0:A.getAttribute("formmethod"))||o;_(A||C.currentTarget,{fetcherKey:t,method:F,navigate:n,replace:r,state:l,relative:d,preventScrollReset:g,viewTransition:p})};return j.createElement("form",{ref:w,method:T,action:b,onSubmit:a?f:E,...y,"data-discover":!S&&e==="render"?"true":void 0})});O4.displayName="Form";function M4(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function m2(e){let t=j.useContext(dl);return Lt(t,M4(e)),t}function R4(e,{target:t,replace:n,state:a,preventScrollReset:r,relative:l,viewTransition:o}={}){let h=mc(),f=Rr(),d=pc(e,{relative:l});return j.useCallback(g=>{if(h4(g,t)){g.preventDefault();let p=n!==void 0?n:$o(f)===$o(d);h(e,{replace:p,state:a,preventScrollReset:r,relative:l,viewTransition:o})}},[f,h,d,n,a,t,e,r,l,o])}var F4=0,L4=()=>`__${String(++F4)}__`;function B4(){let{router:e}=m2("useSubmit"),{basename:t}=j.useContext(Ia),n=t4();return j.useCallback(async(a,r={})=>{let{action:l,method:o,encType:h,formData:f,body:d}=x4(a,t);if(r.navigate===!1){let g=r.fetcherKey||L4();await e.fetch(g,n,r.action||l,{preventScrollReset:r.preventScrollReset,formData:f,body:d,formMethod:r.method||o,formEncType:r.encType||h,flushSync:r.flushSync})}else await e.navigate(r.action||l,{preventScrollReset:r.preventScrollReset,formData:f,body:d,formMethod:r.method||o,formEncType:r.encType||h,replace:r.replace,state:r.state,fromRouteId:n,flushSync:r.flushSync,viewTransition:r.viewTransition})},[e,t,n])}function H4(e,{relative:t}={}){let{basename:n}=j.useContext(Ia),a=j.useContext(nr);Lt(a,"useFormAction must be used inside a RouteContext");let[r]=a.matches.slice(-1),l={...pc(e||".",{relative:t})},o=Rr();if(e==null){l.search=o.search;let h=new URLSearchParams(l.search),f=h.getAll("index");if(f.some(g=>g==="")){h.delete("index"),f.filter(p=>p).forEach(p=>h.append("index",p));let g=h.toString();l.search=g?`?${g}`:""}}return(!e||e===".")&&r.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:Er([n,l.pathname])),$o(l)}function P4(e,t={}){let n=j.useContext(l2);Lt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=m2("useViewTransitionState"),r=pc(e,{relative:t.relative});if(!n.isTransitioning)return!1;let l=Dr(n.currentLocation.pathname,a)||n.currentLocation.pathname,o=Dr(n.nextLocation.pathname,a)||n.nextLocation.pathname;return bh(r.pathname,o)!=null||bh(r.pathname,l)!=null}[..._4];var I4=n2();const dx="/KTPM_FE/assets/logo-BqDv4dgE.png",z4="http://localhost:8000/api",U4=e=>{try{const t=JSON.parse(atob(e.split(".")[1])),n=Date.now()/1e3;return t.exp<n}catch(t){return console.error("Error parsing token:",t),!0}},V4=()=>{const e=localStorage.getItem("authToken");return e?U4(e)?(console.log("🔑 Token expired, clearing storage"),localStorage.removeItem("authToken"),localStorage.removeItem("user"),null):e:(console.log("🔑 No token found"),null)},p2=e=>{localStorage.setItem("authToken",e)},K4=()=>{localStorage.removeItem("authToken")},De=async(e,t={})=>{var o;const n=`${z4}${e}`,a=V4(),r={"Content-Type":"application/json"};a?(r.Authorization=`Bearer ${a}`,console.log("🔑 Using valid token for request:",a.substring(0,20)+"...")):console.log("⚠️  No valid token available");const l={headers:{...r,...t.headers},...t};try{console.log("Making API request to:",n),console.log("Request headers:",l.headers);const h=await fetch(n,l);console.log("Response status:",h.status),console.log("Response OK:",h.ok);const f=await h.json();if(console.log("Response data:",f),!h.ok){if(console.error("API Response not OK:",{status:h.status,statusText:h.statusText,data:f}),h.status===401&&((o=f.message)!=null&&o.includes("Token"))){console.log("🔑 Token invalid, clearing auth data"),localStorage.removeItem("authToken"),localStorage.removeItem("user"),window.location.href="/login";return}if(h.status===400||h.status===422)return console.log("Business logic error, returning data with error info"),f;throw new Error(f.message||`HTTP error! status: ${h.status}`)}return console.log("API request successful, returning data:",f),f}catch(h){throw console.error("API Request Error Details:"),console.error("Error type:",typeof h),console.error("Error message:",h.message),console.error("Error stack:",h.stack),console.error("Full error object:",h),h}},W4={login:async(e,t)=>{const n=await De("/auth/login",{method:"POST",body:JSON.stringify({username:e,password:t})});return n.token&&p2(n.token),n},logout:async()=>{try{await De("/auth/logout",{method:"POST"})}finally{K4()}},register:async(e,t)=>De("/auth/register",{method:"POST",body:JSON.stringify({username:e,password:t})})},G4={getAll:async()=>De("/vehicles"),getById:async e=>De(`/vehicles/${e}`),getTypes:async()=>De("/vehicles/types"),getStatistics:async()=>De("/vehicles/statistics"),create:async e=>De("/vehicles",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>De(`/vehicles/${e}`,{method:"PUT",body:JSON.stringify(t)}),delete:async e=>De(`/vehicles/${e}`,{method:"DELETE"})},Na={getAll:async e=>{const t=e?new URLSearchParams(e).toString():"";return De(`/households${t?`?${t}`:""}`)},getById:async e=>De(`/households/${e}`),getAvailable:async()=>De("/households/available"),create:async e=>De("/households",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>De(`/households/${e}`,{method:"PUT",body:JSON.stringify(t)}),delete:async e=>De(`/households/${e}`,{method:"DELETE"}),assignHead:async(e,t)=>De("/households/assign-head",{method:"POST",body:JSON.stringify({householdId:e,newHeadId:t})})},Xn={getAll:async e=>{const t=e?new URLSearchParams(e).toString():"";return De(`/residents${t?`?${t}`:""}`)},getAvailable:async e=>{const t=e?new URLSearchParams({search:e}).toString():"";return De(`/residents/available${t?`?${t}`:""}`)},getById:async e=>De(`/residents/${e}`),create:async e=>De("/residents",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>De(`/residents/${e}`,{method:"PUT",body:JSON.stringify(t)}),delete:async e=>De(`/residents/${e}`,{method:"DELETE"}),addToHousehold:async e=>De("/residents/add-to-household",{method:"POST",body:JSON.stringify(e)}),separateHousehold:async e=>De("/residents/separate-household",{method:"POST",body:JSON.stringify(e)}),getHouseholdInfo:async e=>De(`/residents/${e}/household-info`),getHouseholdChangeHistory:async e=>{const t={};e&&(e.page!==void 0&&(t.page=e.page.toString()),e.limit!==void 0&&(t.limit=e.limit.toString()),e.fromDate!==void 0&&e.fromDate&&(t.fromDate=e.fromDate),e.toDate!==void 0&&e.toDate&&(t.toDate=e.toDate),e.changeType!==void 0&&(t.changeType=e.changeType.toString()));const n=Object.keys(t).length?new URLSearchParams(t).toString():"";return De(`/residents/household-changes${n?`?${n}`:""}`)}},Do={getGenderStatistics:async()=>De("/population/gender"),getAgeStatistics:async e=>{const t=e?new URLSearchParams({customAgeGroups:e}).toString():"";return De(`/population/age${t?`?${t}`:""}`)},getPopulationMovement:async(e,t)=>{const n={};e&&(n.fromDate=e),t&&(n.toDate=t);const a=Object.keys(n).length?new URLSearchParams(n).toString():"";return De(`/population/movement${a?`?${a}`:""}`)},getTotalResidents:async()=>De("/residents?limit=1"),getTemporaryStatusStatistics:async()=>De("/population/temporary-status")},X4={getAll:async e=>{const t=new URLSearchParams;(e==null?void 0:e.page)!==void 0&&t.append("page",e.page.toString()),(e==null?void 0:e.size)!==void 0&&t.append("size",e.size.toString()),e!=null&&e.sortBy&&t.append("sortBy",e.sortBy),e!=null&&e.sortDir&&t.append("sortDir",e.sortDir),e!=null&&e.search&&t.append("search",e.search);const n=t.toString(),a=`/dot-thu${n?`?${n}`:""}`;return await De(a)},getAllWithKhoanThu:async e=>{const t=new URLSearchParams;(e==null?void 0:e.page)!==void 0&&t.append("page",e.page.toString()),(e==null?void 0:e.size)!==void 0&&t.append("size",e.size.toString()),e!=null&&e.sortBy&&t.append("sortBy",e.sortBy),e!=null&&e.sortDir&&t.append("sortDir",e.sortDir),e!=null&&e.search&&t.append("search",e.search);const n=t.toString(),a=`/dot-thu/with-khoan-thu${n?`?${n}`:""}`;return await De(a)},getById:async e=>await De(`/dot-thu/${e}`),create:async e=>await De("/dot-thu",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await De(`/dot-thu/${e}`,{method:"PUT",body:JSON.stringify(t)}),delete:async e=>await De(`/dot-thu/${e}`,{method:"DELETE"}),getStatistics:async()=>await De("/dot-thu/statistics"),getPaymentStatistics:async e=>await De(`/dot-thu/${e}/payment-statistics`),getPaymentInfo:async(e,t)=>await De(`/dot-thu/${e}/payment-info/${t}`),recordPayment:async e=>await De("/dot-thu/record-payment",{method:"POST",body:JSON.stringify(e)}),close:async e=>await De(`/dot-thu/${e}/close`,{method:"PATCH"}),reopen:async e=>await De(`/dot-thu/${e}/reopen`,{method:"PATCH"}),markCompleted:async e=>await De(`/dot-thu/${e}/complete`,{method:"PATCH"}),autoClose:async()=>await De("/dot-thu/auto-close",{method:"POST"})},y2={getAll:async()=>await De("/khoan-thu"),getById:async e=>await De(`/khoan-thu/${e}`),create:async e=>await De("/khoan-thu",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await De(`/khoan-thu/${e}`,{method:"PUT",body:JSON.stringify(t)}),delete:async e=>await De(`/khoan-thu/${e}`,{method:"DELETE"})},Y4={create:async e=>await De("/payments",{method:"POST",body:JSON.stringify(e)}),getAll:async e=>{const t=e?new URLSearchParams(e).toString():"";return await De(`/payments${t?`?${t}`:""}`)},getById:async e=>await De(`/payments/${e}`),update:async(e,t)=>await De(`/payments/${e}`,{method:"PUT",body:JSON.stringify(t)}),delete:async e=>await De(`/payments/${e}`,{method:"DELETE"}),restore:async(e,t)=>await De(`/payments/${e}/restore`,{method:"POST",body:JSON.stringify({restoreReason:t})}),getStatistics:async e=>{const t=e?new URLSearchParams(e).toString():"";return await De(`/payments/statistics${t?`?${t}`:""}`)}},bn={auth:W4,vehicles:G4,households:Na,residents:Xn,population:Do,dotThu:X4,khoanThu:y2,payment:Y4},q4=e=>{try{const t=JSON.parse(atob(e.split(".")[1])),n=Date.now()/1e3;return t.exp<n}catch(t){return console.error("Error parsing token:",t),!0}},qs={async login(e){const t=await fetch("http://localhost:8000/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await t.json();if(!t.ok)throw new Error(n.message||`HTTP error! status: ${t.status}`);return n.token&&(p2(n.token),localStorage.setItem("user",JSON.stringify(n.user))),n},logout(){localStorage.removeItem("authToken"),localStorage.removeItem("user")},getCurrentUser(){const e=localStorage.getItem("user");return e?JSON.parse(e):null},isAuthenticated(){const e=localStorage.getItem("authToken");return e?q4(e)?(localStorage.removeItem("authToken"),localStorage.removeItem("user"),!1):!0:!1},hasRole(e){const t=this.getCurrentUser();return t?e.includes(t.role):!1}},Y1=[{label:"Kế toán",value:"ketoan"},{label:"Tổ trưởng/Tổ phó",value:"totruong"}],$4=()=>{const[e,t]=j.useState(""),[n,a]=j.useState(""),[r,l]=j.useState(Y1[0].value),[o,h]=j.useState(""),[f,d]=j.useState(!1),[g,p]=j.useState(!1),[y,w]=j.useState(!1),_=mc();j.useEffect(()=>{if(qs.isAuthenticated()){const S=qs.getCurrentUser();(S==null?void 0:S.role)==="admin"||(S==null?void 0:S.role)==="accountant"?_("/homepage-ketoan",{replace:!0}):(S==null?void 0:S.role)==="manager"&&_("/homepage-totruong",{replace:!0})}const T=localStorage.getItem("loginInfo");if(T){const{username:S,role:E}=JSON.parse(T);t(S),l(E),p(!0)}},[_]);const b=async T=>{if(T.preventDefault(),!e||!n||!r){h("Vui lòng nhập đầy đủ thông tin và chọn vai trò.");return}h(""),w(!0);try{const E=(await qs.login({username:e,password:n})).user.role;if(!(r==="ketoan"&&(E==="admin"||E==="accountant")||r==="totruong"&&(E==="admin"||E==="manager"))){h("Vai trò được chọn không phù hợp với tài khoản.");return}g?localStorage.setItem("loginInfo",JSON.stringify({username:e,role:r})):localStorage.removeItem("loginInfo"),_(r==="ketoan"?"/homepage-ketoan":"/homepage-totruong")}catch(S){console.error("Login error:",S),h(S.message||"Đăng nhập thất bại. Vui lòng kiểm tra thông tin đăng nhập.")}finally{w(!1)}};return c.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-[#f6f7fa] py-8 px-2",children:[c.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-black/10 w-full max-w-[600px] p-8 flex flex-col gap-3",children:[c.jsxs("div",{className:"flex flex-col items-center mb-2",children:[c.jsx("img",{src:dx,alt:"Bluemoon Logo",className:"w-16 h-16 mb-2"}),c.jsx("h1",{className:"text-center text-[22px] font-bold text-[#000000] leading-tight font-['Roboto'] tracking-wide uppercase mb-1",children:"Đăng nhập"}),c.jsx("span",{className:"text-center text-[16px] font-semibold text-[#1976D2] font-['Roboto'] mb-2",children:"HỆ THỐNG QUẢN LÝ THU PHÍ CHUNG CƯ"})]}),c.jsxs("form",{className:"flex flex-col gap-3",onSubmit:b,children:[c.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-end",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("label",{className:"block text-[14px] font-bold text-black mb-1 font-['Roboto']",htmlFor:"username",children:"Tên đăng nhập"}),c.jsx("input",{id:"username",name:"username",type:"text",className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#2196F3] text-[16px] placeholder-gray-400 shadow-sm font-['Roboto'] font-normal",autoComplete:"username",value:e,onChange:T=>t(T.target.value),placeholder:"Nhập tên đăng nhập",required:!0})]}),c.jsxs("div",{className:"flex-1 sm:max-w-[220px]",children:[c.jsx("label",{className:"block text-[14px] font-bold text-black mb-1 font-['Roboto']",htmlFor:"role",children:"Vai trò"}),c.jsxs("select",{id:"role",name:"role",className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#2196F3] text-[16px] shadow-sm font-['Roboto'] font-normal",value:r,onChange:T=>l(T.target.value),required:!0,children:[c.jsx("option",{value:"",disabled:!0,children:"Chọn vai trò"}),Y1.map(T=>c.jsx("option",{value:T.value,children:T.label},T.value))]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-[14px] font-bold text-black mb-1 font-['Roboto']",htmlFor:"password",children:"Mật khẩu"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{id:"password",name:"password",type:f?"text":"password",className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#2196F3] text-[16px] placeholder-gray-400 shadow-sm font-['Roboto'] font-normal",autoComplete:"current-password",value:n,onChange:T=>a(T.target.value),placeholder:"Nhập mật khẩu",required:!0}),c.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-[#1976D2] text-xs font-semibold focus:outline-none",onClick:()=>d(T=>!T),tabIndex:-1,children:f?"Ẩn":"Hiện"})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{id:"rememberMe",type:"checkbox",checked:g,onChange:T=>p(T.target.checked),className:"h-4 w-4 text-[#2196F3] border-gray-300 rounded focus:ring-[#2196F3]"}),c.jsx("label",{htmlFor:"rememberMe",className:"text-[14px] font-normal text-black font-['Roboto'] cursor-pointer",children:"Ghi nhớ đăng nhập"})]}),o&&c.jsx("div",{className:"text-red-500 text-sm",children:o}),c.jsx("button",{type:"submit",disabled:y,className:"w-full bg-[#2196F3] text-white font-medium text-[14px] py-2 rounded-lg shadow-md hover:bg-[#1976D2] transition uppercase tracking-wider font-['Roboto'] disabled:opacity-50 disabled:cursor-not-allowed",children:y?"Đang đăng nhập...":"Đăng nhập"}),c.jsx("div",{className:"flex items-center justify-between",children:c.jsx(Gh,{to:"/forget-password",className:"text-[15px] font-bold text-[#2196F3] hover:underline font-['Roboto']",children:"Quên mật khẩu?"})})]})]}),c.jsx("footer",{className:"mt-6 text-[#746565] text-[16px] text-center font-['Roboto'] font-normal",children:"@2025 Hệ thống Quản lý Thu phí Chung cư BlueMoon"})]})},Q4=()=>{const[e,t]=j.useState(""),[n,a]=j.useState(""),[r,l]=j.useState(""),[o,h]=j.useState(""),[f,d]=j.useState(""),[g,p]=j.useState(!1),[y,w]=j.useState(!1),[_,b]=j.useState(!1),[T,S]=j.useState(""),E=mc(),C=D=>{if(D.preventDefault(),!e){d("Vui lòng nhập tên đăng nhập.");return}d(""),p(!0),alert("Mã xác thực đã được gửi đến email/số điện thoại liên kết với tài khoản của bạn.")},A=D=>{if(D.preventDefault(),!n||!r||!o){d("Vui lòng nhập đầy đủ thông tin xác nhận.");return}if(r!==o){d("Mật khẩu mới và xác nhận mật khẩu không khớp.");return}d(""),alert("Mật khẩu của bạn đã được đặt lại thành công."),E("/KTPM_FE/login")},F=D=>D.length<8?"Yếu (tối thiểu 8 ký tự)":/[A-Z]/.test(D)?/[0-9]/.test(D)?/[^A-Za-z0-9]/.test(D)?"Mạnh":"Yếu (cần ký tự đặc biệt)":"Yếu (cần số)":"Yếu (cần chữ hoa)",K=D=>{l(D.target.value),S(F(D.target.value))};return c.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-[#f6f7fa] py-12 px-2",children:[c.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-black/10 w-full max-w-[600px] p-12 flex flex-col gap-4",children:[c.jsxs("div",{className:"flex flex-col items-center mb-2",children:[c.jsx("img",{src:dx,alt:"Bluemoon Logo",className:"w-16 h-16 mb-2"}),c.jsx("h1",{className:"text-center text-[22px] font-bold text-[#000000] leading-tight mb-1 font-['Roboto'] tracking-wide uppercase",children:"Khôi phục mật khẩu"}),c.jsx("span",{className:"text-center text-[16px] font-semibold text-[#1976D2] font-['Roboto'] mb-2",children:"HỆ THỐNG QUẢN LÝ THU PHÍ CHUNG CƯ"})]}),!g&&c.jsxs("form",{className:"flex flex-col gap-2 mt-0",onSubmit:C,children:[c.jsx("label",{className:"text-[14px] font-bold text-black font-['Roboto']",htmlFor:"username",children:"Tên đăng nhập"}),c.jsx("input",{id:"username",name:"username",type:"text",className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#2196F3] text-[16px] placeholder-gray-400 shadow-sm mt-1 font-['Roboto'] font-normal",autoComplete:"username",value:e,onChange:D=>t(D.target.value),placeholder:"Nhập tên đăng nhập",required:!0}),!g&&f&&e===""&&c.jsx("div",{className:"text-red-500 text-sm mt-1 mb-2",children:f}),c.jsx("button",{type:"submit",className:"mt-4 w-full bg-[#2196F3] text-white font-medium text-[14px] py-2 rounded-lg shadow-md hover:bg-[#1976D2] transition uppercase tracking-wider font-['Roboto']",children:"GỬI MÃ XÁC THỰC"}),c.jsx("div",{className:"flex items-center justify-between mt-2",children:c.jsx("button",{type:"button",className:"text-[15px] font-bold text-[#2196F3] hover:underline font-['Roboto']",onClick:()=>E("/login"),children:"Quay lại đăng nhập"})})]}),g&&c.jsxs("form",{className:"flex flex-col gap-2 mt-4",onSubmit:A,children:[c.jsx("label",{className:"text-[14px] font-medium text-black font-['Roboto']",htmlFor:"authCode",children:"Mã xác thực"}),c.jsx("input",{id:"authCode",name:"authCode",type:"text",className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#2196F3] text-[16px] placeholder-gray-400 shadow-sm mt-1 font-['Roboto'] font-normal",value:n,onChange:D=>a(D.target.value),placeholder:"Nhập mã xác thực",required:!0}),g&&f&&n===""&&c.jsx("div",{className:"text-red-500 text-sm mt-1 mb-2",children:f}),c.jsx("label",{className:"text-[14px] font-medium text-black mt-2 font-['Roboto']",htmlFor:"newPassword",children:"Mật khẩu mới"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{id:"newPassword",name:"newPassword",type:y?"text":"password",className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#2196F3] text-[16px] placeholder-gray-400 shadow-sm mt-1 font-['Roboto'] font-normal",value:r,onChange:K,placeholder:"Nhập mật khẩu mới của bạn",required:!0}),c.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-[#1976D2] text-xs font-semibold focus:outline-none",onClick:()=>w(D=>!D),tabIndex:-1,children:y?"Ẩn":"Hiện"})]}),r&&c.jsx("div",{className:`text-xs mt-1 mb-1 ${T==="Mạnh"?"text-green-600":"text-red-500"}`,children:T}),c.jsx("label",{className:"text-[14px] font-medium text-black mt-2 font-['Roboto']",htmlFor:"confirmPassword",children:"Xác nhận mật khẩu"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:_?"text":"password",className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#2196F3] text-[16px] placeholder-gray-400 shadow-sm mt-1 font-['Roboto'] font-normal",value:o,onChange:D=>h(D.target.value),placeholder:"Xác nhận mật khẩu",required:!0}),c.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-[#1976D2] text-xs font-semibold focus:outline-none",onClick:()=>b(D=>!D),tabIndex:-1,children:_?"Ẩn":"Hiện"})]}),g&&f&&o===""&&c.jsx("div",{className:"text-red-500 text-sm mt-1 mb-2",children:f}),g&&f&&r!==o&&c.jsx("div",{className:"text-red-500 text-sm mt-1 mb-2",children:f}),c.jsx("button",{type:"submit",className:"mt-4 w-full bg-[#2196F3] text-white font-medium text-[14px] py-2 rounded-lg shadow-md hover:bg-[#1976D2] transition uppercase tracking-wider font-['Roboto']",children:"XÁC NHẬN"}),c.jsx("div",{className:"flex items-center justify-between mt-2",children:c.jsx("button",{type:"button",className:"text-[15px] font-bold text-[#2196F3] hover:underline font-['Roboto']",onClick:()=>E("/login"),children:"Quay lại đăng nhập"})})]})]}),c.jsx("footer",{className:"mt-8 text-[#746565] text-[16px] text-center font-['Roboto'] font-normal",children:"@2025 Hệ thống Quản lý Thu phí Chung cư BlueMoon"})]})},On=({children:e,role:t})=>{const n=Rr(),a=mc(),[r,l]=Vh.useState(!1),o=()=>{qs.logout(),l(!1),a("/login")},h=t==="ketoan"?[{path:"/homepage-ketoan",label:"Trang chủ"},{path:"/quan-ly-khoan-thu",label:"Quản lý Khoản thu"},{path:"/quan-ly-dot-thu-phi",label:"Quản lý Đợt thu phí"},{path:"/thong-ke-khoan-thu",label:"Thống kê Thu phí"}]:[{path:"/homepage-totruong",label:"Trang chủ"},{path:"/quan-ly-ho-khau",label:"Quản lý Hộ khẩu"},{path:"/quan-ly-nhan-khau",label:"Quản lý Nhân khẩu"},{path:"/quan-ly-phong",label:"Quản lý Phòng"},{path:"/quan-ly-xe",label:"Quản lý Xe"},{path:"/quan-ly-tam-tru",label:"Quản lý Tạm trú/ Tạm vắng"},{path:"/lich-su-thay-doi-nhan-khau",label:"Lịch sử thay đổi Nhân khẩu"},{path:"/thong-ke-nhan-khau",label:"Thống kê Nhân khẩu"}];return c.jsxs("div",{className:"flex flex-col min-h-screen bg-[#f3f4f6]",children:[c.jsx("header",{className:"bg-gradient-to-r from-blue-600 to-blue-700 shadow-lg border-b border-blue-800 fixed top-0 left-0 right-0 z-10",children:c.jsxs("div",{className:"px-6 py-4 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("img",{src:dx,alt:"Bluemoon Logo",className:"w-10 h-10 rounded-lg shadow-sm"}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("h1",{className:"text-white font-bold text-lg tracking-wide",children:"CHUNG CƯ BLUEMOON"}),c.jsx("p",{className:"text-blue-100 text-sm font-medium",children:"Hệ thống quản lý cư dân"})]})]}),c.jsxs("div",{className:"relative",children:[c.jsxs("button",{className:"bg-white/10 backdrop-blur-sm text-white font-medium py-2 px-4 rounded-lg border border-white/20 hover:bg-white/20 transition-all duration-200 flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-white/30",onClick:()=>l(f=>!f),children:[c.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:c.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),c.jsxs("div",{className:"text-left",children:[c.jsxs("div",{className:"text-sm font-semibold",children:["Xin chào, ",c.jsx("span",{className:"text-blue-100",children:"totruong"})]}),c.jsxs("div",{className:"text-xs text-blue-200",children:["(",t==="ketoan"?"Kế toán viên":"Tổ trưởng",")"]})]}),c.jsx("svg",{className:`w-4 h-4 text-white transition-transform duration-200 ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r&&c.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white border border-gray-200 rounded-lg shadow-xl z-20 overflow-hidden",children:[c.jsxs("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900",children:"totruong"}),c.jsx("p",{className:"text-xs text-gray-500",children:t==="ketoan"?"Kế toán viên":"Tổ trưởng"})]}),c.jsxs("button",{className:"block w-full text-left px-4 py-3 text-sm text-red-600 font-medium hover:bg-red-50 transition-colors duration-150 flex items-center gap-2",onClick:o,children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Đăng xuất"]})]})]})]})}),c.jsxs("div",{className:"flex flex-1 pt-20",children:[c.jsx("div",{className:"w-64 bg-white shadow-lg flex flex-col fixed top-20 bottom-0 border-r border-gray-200",children:c.jsx("nav",{className:"mt-2 flex-1 overflow-y-auto",children:c.jsxs("ul",{className:"flex flex-col h-full",children:[h.map(f=>{const d=n.pathname===f.path;return c.jsx("li",{children:c.jsx(Gh,{to:f.path,className:`block text-sm transition-all duration-200 border-l-4 ${d?"border-blue-500 bg-blue-50 text-blue-700 font-semibold":"border-transparent text-gray-700 hover:bg-gray-50 hover:text-blue-600 font-medium"}`,style:{padding:"14px 20px"},children:f.label})},f.path)}),c.jsx("li",{className:"mt-auto border-t border-gray-200",children:c.jsxs("button",{onClick:o,className:"block w-full text-left text-sm text-red-600 font-medium hover:bg-red-50 transition-all duration-200 flex items-center gap-2",style:{padding:"14px 20px"},children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Đăng xuất"]})})]})})}),c.jsx("div",{className:"flex-1 flex flex-col pl-64",children:c.jsx("main",{className:"flex-1 p-4 overflow-y-auto",children:e})})]})]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function yc(e){return e+.5|0}const cs=(e,t,n)=>Math.max(Math.min(e,n),t);function Oo(e){return cs(yc(e*2.55),0,255)}function xs(e){return cs(yc(e*255),0,255)}function _r(e){return cs(yc(e/2.55)/100,0,1)}function q1(e){return cs(yc(e*100),0,100)}const ba={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Wd=[..."0123456789ABCDEF"],Z4=e=>Wd[e&15],J4=e=>Wd[(e&240)>>4]+Wd[e&15],zu=e=>(e&240)>>4===(e&15),eN=e=>zu(e.r)&&zu(e.g)&&zu(e.b)&&zu(e.a);function tN(e){var t=e.length,n;return e[0]==="#"&&(t===4||t===5?n={r:255&ba[e[1]]*17,g:255&ba[e[2]]*17,b:255&ba[e[3]]*17,a:t===5?ba[e[4]]*17:255}:(t===7||t===9)&&(n={r:ba[e[1]]<<4|ba[e[2]],g:ba[e[3]]<<4|ba[e[4]],b:ba[e[5]]<<4|ba[e[6]],a:t===9?ba[e[7]]<<4|ba[e[8]]:255})),n}const nN=(e,t)=>e<255?t(e):"";function aN(e){var t=eN(e)?Z4:J4;return e?"#"+t(e.r)+t(e.g)+t(e.b)+nN(e.a,t):void 0}const rN=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function v2(e,t,n){const a=t*Math.min(n,1-n),r=(l,o=(l+e/30)%12)=>n-a*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function sN(e,t,n){const a=(r,l=(r+e/60)%6)=>n-n*t*Math.max(Math.min(l,4-l,1),0);return[a(5),a(3),a(1)]}function iN(e,t,n){const a=v2(e,1,.5);let r;for(t+n>1&&(r=1/(t+n),t*=r,n*=r),r=0;r<3;r++)a[r]*=1-t-n,a[r]+=t;return a}function lN(e,t,n,a,r){return e===r?(t-n)/a+(t<n?6:0):t===r?(n-e)/a+2:(e-t)/a+4}function xx(e){const n=e.r/255,a=e.g/255,r=e.b/255,l=Math.max(n,a,r),o=Math.min(n,a,r),h=(l+o)/2;let f,d,g;return l!==o&&(g=l-o,d=h>.5?g/(2-l-o):g/(l+o),f=lN(n,a,r,g,l),f=f*60+.5),[f|0,d||0,h]}function gx(e,t,n,a){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,a)).map(xs)}function mx(e,t,n){return gx(v2,e,t,n)}function oN(e,t,n){return gx(iN,e,t,n)}function cN(e,t,n){return gx(sN,e,t,n)}function b2(e){return(e%360+360)%360}function uN(e){const t=rN.exec(e);let n=255,a;if(!t)return;t[5]!==a&&(n=t[6]?Oo(+t[5]):xs(+t[5]));const r=b2(+t[2]),l=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?a=oN(r,l,o):t[1]==="hsv"?a=cN(r,l,o):a=mx(r,l,o),{r:a[0],g:a[1],b:a[2],a:n}}function hN(e,t){var n=xx(e);n[0]=b2(n[0]+t),n=mx(n),e.r=n[0],e.g=n[1],e.b=n[2]}function fN(e){if(!e)return;const t=xx(e),n=t[0],a=q1(t[1]),r=q1(t[2]);return e.a<255?`hsla(${n}, ${a}%, ${r}%, ${_r(e.a)})`:`hsl(${n}, ${a}%, ${r}%)`}const $1={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Q1={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function dN(){const e={},t=Object.keys(Q1),n=Object.keys($1);let a,r,l,o,h;for(a=0;a<t.length;a++){for(o=h=t[a],r=0;r<n.length;r++)l=n[r],h=h.replace(l,$1[l]);l=parseInt(Q1[o],16),e[h]=[l>>16&255,l>>8&255,l&255]}return e}let Uu;function xN(e){Uu||(Uu=dN(),Uu.transparent=[0,0,0,0]);const t=Uu[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const gN=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function mN(e){const t=gN.exec(e);let n=255,a,r,l;if(t){if(t[7]!==a){const o=+t[7];n=t[8]?Oo(o):cs(o*255,0,255)}return a=+t[1],r=+t[3],l=+t[5],a=255&(t[2]?Oo(a):cs(a,0,255)),r=255&(t[4]?Oo(r):cs(r,0,255)),l=255&(t[6]?Oo(l):cs(l,0,255)),{r:a,g:r,b:l,a:n}}}function pN(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${_r(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const bd=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,Xi=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function yN(e,t,n){const a=Xi(_r(e.r)),r=Xi(_r(e.g)),l=Xi(_r(e.b));return{r:xs(bd(a+n*(Xi(_r(t.r))-a))),g:xs(bd(r+n*(Xi(_r(t.g))-r))),b:xs(bd(l+n*(Xi(_r(t.b))-l))),a:e.a+n*(t.a-e.a)}}function Vu(e,t,n){if(e){let a=xx(e);a[t]=Math.max(0,Math.min(a[t]+a[t]*n,t===0?360:1)),a=mx(a),e.r=a[0],e.g=a[1],e.b=a[2]}}function w2(e,t){return e&&Object.assign(t||{},e)}function Z1(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=xs(e[3]))):(t=w2(e,{r:0,g:0,b:0,a:1}),t.a=xs(t.a)),t}function vN(e){return e.charAt(0)==="r"?mN(e):uN(e)}class Qo{constructor(t){if(t instanceof Qo)return t;const n=typeof t;let a;n==="object"?a=Z1(t):n==="string"&&(a=tN(t)||xN(t)||vN(t)),this._rgb=a,this._valid=!!a}get valid(){return this._valid}get rgb(){var t=w2(this._rgb);return t&&(t.a=_r(t.a)),t}set rgb(t){this._rgb=Z1(t)}rgbString(){return this._valid?pN(this._rgb):void 0}hexString(){return this._valid?aN(this._rgb):void 0}hslString(){return this._valid?fN(this._rgb):void 0}mix(t,n){if(t){const a=this.rgb,r=t.rgb;let l;const o=n===l?.5:n,h=2*o-1,f=a.a-r.a,d=((h*f===-1?h:(h+f)/(1+h*f))+1)/2;l=1-d,a.r=255&d*a.r+l*r.r+.5,a.g=255&d*a.g+l*r.g+.5,a.b=255&d*a.b+l*r.b+.5,a.a=o*a.a+(1-o)*r.a,this.rgb=a}return this}interpolate(t,n){return t&&(this._rgb=yN(this._rgb,t._rgb,n)),this}clone(){return new Qo(this.rgb)}alpha(t){return this._rgb.a=xs(t),this}clearer(t){const n=this._rgb;return n.a*=1-t,this}greyscale(){const t=this._rgb,n=yc(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=n,this}opaquer(t){const n=this._rgb;return n.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Vu(this._rgb,2,t),this}darken(t){return Vu(this._rgb,2,-t),this}saturate(t){return Vu(this._rgb,1,t),this}desaturate(t){return Vu(this._rgb,1,-t),this}rotate(t){return hN(this._rgb,t),this}}/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function vr(){}const bN=(()=>{let e=0;return()=>e++})();function st(e){return e==null}function $t(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function lt(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function Ea(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function Ya(e,t){return Ea(e)?e:t}function et(e,t){return typeof e>"u"?t:e}const wN=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:+e/t,_2=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function At(e,t,n){if(e&&typeof e.call=="function")return e.apply(n,t)}function dt(e,t,n,a){let r,l,o;if($t(e))for(l=e.length,r=0;r<l;r++)t.call(n,e[r],r);else if(lt(e))for(o=Object.keys(e),l=o.length,r=0;r<l;r++)t.call(n,e[o[r]],o[r])}function wh(e,t){let n,a,r,l;if(!e||!t||e.length!==t.length)return!1;for(n=0,a=e.length;n<a;++n)if(r=e[n],l=t[n],r.datasetIndex!==l.datasetIndex||r.index!==l.index)return!1;return!0}function _h(e){if($t(e))return e.map(_h);if(lt(e)){const t=Object.create(null),n=Object.keys(e),a=n.length;let r=0;for(;r<a;++r)t[n[r]]=_h(e[n[r]]);return t}return e}function T2(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function _N(e,t,n,a){if(!T2(e))return;const r=t[e],l=n[e];lt(r)&&lt(l)?er(r,l,a):t[e]=_h(l)}function er(e,t,n){const a=$t(t)?t:[t],r=a.length;if(!lt(e))return e;n=n||{};const l=n.merger||_N;let o;for(let h=0;h<r;++h){if(o=a[h],!lt(o))continue;const f=Object.keys(o);for(let d=0,g=f.length;d<g;++d)l(f[d],e,o,n)}return e}function Ho(e,t){return er(e,t,{merger:TN})}function TN(e,t,n){if(!T2(e))return;const a=t[e],r=n[e];lt(a)&&lt(r)?Ho(a,r):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=_h(r))}const J1={"":e=>e,x:e=>e.x,y:e=>e.y};function SN(e){const t=e.split("."),n=[];let a="";for(const r of t)a+=r,a.endsWith("\\")?a=a.slice(0,-1)+".":(n.push(a),a="");return n}function NN(e){const t=SN(e);return n=>{for(const a of t){if(a==="")break;n=n&&n[a]}return n}}function ei(e,t){return(J1[t]||(J1[t]=NN(t)))(e)}function px(e){return e.charAt(0).toUpperCase()+e.slice(1)}const Zo=e=>typeof e<"u",gs=e=>typeof e=="function",ey=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};function EN(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const Vt=Math.PI,zt=2*Vt,CN=zt+Vt,Th=Number.POSITIVE_INFINITY,kN=Vt/180,an=Vt/2,zs=Vt/4,ty=Vt*2/3,S2=Math.log10,Ja=Math.sign;function Po(e,t,n){return Math.abs(e-t)<n}function ny(e){const t=Math.round(e);e=Po(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(S2(e))),a=e/n;return(a<=1?1:a<=2?2:a<=5?5:10)*n}function jN(e){const t=[],n=Math.sqrt(e);let a;for(a=1;a<n;a++)e%a===0&&(t.push(a),t.push(e/a));return n===(n|0)&&t.push(n),t.sort((r,l)=>r-l).pop(),t}function AN(e){return typeof e=="symbol"||typeof e=="object"&&e!==null&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}function Jo(e){return!AN(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function DN(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}function ON(e,t,n){let a,r,l;for(a=0,r=e.length;a<r;a++)l=e[a][n],isNaN(l)||(t.min=Math.min(t.min,l),t.max=Math.max(t.max,l))}function Tr(e){return e*(Vt/180)}function MN(e){return e*(180/Vt)}function ay(e){if(!Ea(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function N2(e,t){const n=t.x-e.x,a=t.y-e.y,r=Math.sqrt(n*n+a*a);let l=Math.atan2(a,n);return l<-.5*Vt&&(l+=zt),{angle:l,distance:r}}function Gd(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function RN(e,t){return(e-t+CN)%zt-Vt}function os(e){return(e%zt+zt)%zt}function ec(e,t,n,a){const r=os(e),l=os(t),o=os(n),h=os(l-r),f=os(o-r),d=os(r-l),g=os(r-o);return r===l||r===o||a&&l===o||h>f&&d<g}function Dn(e,t,n){return Math.max(t,Math.min(n,e))}function FN(e){return Dn(e,-32768,32767)}function us(e,t,n,a=1e-6){return e>=Math.min(t,n)-a&&e<=Math.max(t,n)+a}function yx(e,t,n){n=n||(o=>e[o]<t);let a=e.length-1,r=0,l;for(;a-r>1;)l=r+a>>1,n(l)?r=l:a=l;return{lo:r,hi:a}}const Ys=(e,t,n,a)=>yx(e,n,a?r=>{const l=e[r][t];return l<n||l===n&&e[r+1][t]===n}:r=>e[r][t]<n),LN=(e,t,n)=>yx(e,n,a=>e[a][t]>=n);function BN(e,t,n){let a=0,r=e.length;for(;a<r&&e[a]<t;)a++;for(;r>a&&e[r-1]>n;)r--;return a>0||r<e.length?e.slice(a,r):e}const E2=["push","pop","shift","splice","unshift"];function HN(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),E2.forEach(n=>{const a="_onData"+px(n),r=e[n];Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value(...l){const o=r.apply(this,l);return e._chartjs.listeners.forEach(h=>{typeof h[a]=="function"&&h[a](...l)}),o}})})}function ry(e,t){const n=e._chartjs;if(!n)return;const a=n.listeners,r=a.indexOf(t);r!==-1&&a.splice(r,1),!(a.length>0)&&(E2.forEach(l=>{delete e[l]}),delete e._chartjs)}function C2(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const k2=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function j2(e,t){let n=[],a=!1;return function(...r){n=r,a||(a=!0,k2.call(window,()=>{a=!1,e.apply(t,n)}))}}function PN(e,t){let n;return function(...a){return t?(clearTimeout(n),n=setTimeout(e,t,a)):e.apply(this,a),t}}const vx=e=>e==="start"?"left":e==="end"?"right":"center",An=(e,t,n)=>e==="start"?t:e==="end"?n:(t+n)/2,IN=(e,t,n,a)=>e===(a?"left":"right")?n:e==="center"?(t+n)/2:t;function zN(e,t,n){const a=t.length;let r=0,l=a;if(e._sorted){const{iScale:o,vScale:h,_parsed:f}=e,d=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,g=o.axis,{min:p,max:y,minDefined:w,maxDefined:_}=o.getUserBounds();if(w){if(r=Math.min(Ys(f,g,p).lo,n?a:Ys(t,g,o.getPixelForValue(p)).lo),d){const b=f.slice(0,r+1).reverse().findIndex(T=>!st(T[h.axis]));r-=Math.max(0,b)}r=Dn(r,0,a-1)}if(_){let b=Math.max(Ys(f,o.axis,y,!0).hi+1,n?0:Ys(t,g,o.getPixelForValue(y),!0).hi+1);if(d){const T=f.slice(b-1).findIndex(S=>!st(S[h.axis]));b+=Math.max(0,T)}l=Dn(b,r,a)-r}else l=a-r}return{start:r,count:l}}function UN(e){const{xScale:t,yScale:n,_scaleRanges:a}=e,r={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!a)return e._scaleRanges=r,!0;const l=a.xmin!==t.min||a.xmax!==t.max||a.ymin!==n.min||a.ymax!==n.max;return Object.assign(a,r),l}const Ku=e=>e===0||e===1,sy=(e,t,n)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*zt/n)),iy=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*zt/n)+1,Io={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*an)+1,easeOutSine:e=>Math.sin(e*an),easeInOutSine:e=>-.5*(Math.cos(Vt*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>Ku(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>Ku(e)?e:sy(e,.075,.3),easeOutElastic:e=>Ku(e)?e:iy(e,.075,.3),easeInOutElastic(e){return Ku(e)?e:e<.5?.5*sy(e*2,.1125,.45):.5+.5*iy(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-Io.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?Io.easeInBounce(e*2)*.5:Io.easeOutBounce(e*2-1)*.5+.5};function bx(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function ly(e){return bx(e)?e:new Qo(e)}function wd(e){return bx(e)?e:new Qo(e).saturate(.5).darken(.1).hexString()}const VN=["x","y","borderWidth","radius","tension"],KN=["color","borderColor","backgroundColor"];function WN(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:KN},numbers:{type:"number",properties:VN}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function GN(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const oy=new Map;function XN(e,t){t=t||{};const n=e+JSON.stringify(t);let a=oy.get(n);return a||(a=new Intl.NumberFormat(e,t),oy.set(n,a)),a}function wx(e,t,n){return XN(t,n).format(e)}const YN={values(e){return $t(e)?e:""+e},numeric(e,t,n){if(e===0)return"0";const a=this.chart.options.locale;let r,l=e;if(n.length>1){const d=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(d<1e-4||d>1e15)&&(r="scientific"),l=qN(e,n)}const o=S2(Math.abs(l)),h=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),f={notation:r,minimumFractionDigits:h,maximumFractionDigits:h};return Object.assign(f,this.options.ticks.format),wx(e,a,f)}};function qN(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e)),n}var A2={formatters:YN};function $N(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,n)=>n.lineWidth,tickColor:(t,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:A2.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const ti=Object.create(null),Xd=Object.create(null);function zo(e,t){if(!t)return e;const n=t.split(".");for(let a=0,r=n.length;a<r;++a){const l=n[a];e=e[l]||(e[l]=Object.create(null))}return e}function _d(e,t,n){return typeof t=="string"?er(zo(e,t),n):er(zo(e,""),t)}class QN{constructor(t,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=a=>a.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(a,r)=>wd(r.backgroundColor),this.hoverBorderColor=(a,r)=>wd(r.borderColor),this.hoverColor=(a,r)=>wd(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(n)}set(t,n){return _d(this,t,n)}get(t){return zo(this,t)}describe(t,n){return _d(Xd,t,n)}override(t,n){return _d(ti,t,n)}route(t,n,a,r){const l=zo(this,t),o=zo(this,a),h="_"+n;Object.defineProperties(l,{[h]:{value:l[n],writable:!0},[n]:{enumerable:!0,get(){const f=this[h],d=o[r];return lt(f)?Object.assign({},d,f):et(f,d)},set(f){this[h]=f}}})}apply(t){t.forEach(n=>n(this))}}var Ut=new QN({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[WN,GN,$N]);function ZN(e){return!e||st(e.size)||st(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function cy(e,t,n,a,r){let l=t[r];return l||(l=t[r]=e.measureText(r).width,n.push(r)),l>a&&(a=l),a}function Us(e,t,n){const a=e.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((t-r)*a)/a+r}function uy(e,t){!t&&!e||(t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function Yd(e,t,n,a){D2(e,t,n,a,null)}function D2(e,t,n,a,r){let l,o,h,f,d,g,p,y;const w=t.pointStyle,_=t.rotation,b=t.radius;let T=(_||0)*kN;if(w&&typeof w=="object"&&(l=w.toString(),l==="[object HTMLImageElement]"||l==="[object HTMLCanvasElement]")){e.save(),e.translate(n,a),e.rotate(T),e.drawImage(w,-w.width/2,-w.height/2,w.width,w.height),e.restore();return}if(!(isNaN(b)||b<=0)){switch(e.beginPath(),w){default:r?e.ellipse(n,a,r/2,b,0,0,zt):e.arc(n,a,b,0,zt),e.closePath();break;case"triangle":g=r?r/2:b,e.moveTo(n+Math.sin(T)*g,a-Math.cos(T)*b),T+=ty,e.lineTo(n+Math.sin(T)*g,a-Math.cos(T)*b),T+=ty,e.lineTo(n+Math.sin(T)*g,a-Math.cos(T)*b),e.closePath();break;case"rectRounded":d=b*.516,f=b-d,o=Math.cos(T+zs)*f,p=Math.cos(T+zs)*(r?r/2-d:f),h=Math.sin(T+zs)*f,y=Math.sin(T+zs)*(r?r/2-d:f),e.arc(n-p,a-h,d,T-Vt,T-an),e.arc(n+y,a-o,d,T-an,T),e.arc(n+p,a+h,d,T,T+an),e.arc(n-y,a+o,d,T+an,T+Vt),e.closePath();break;case"rect":if(!_){f=Math.SQRT1_2*b,g=r?r/2:f,e.rect(n-g,a-f,2*g,2*f);break}T+=zs;case"rectRot":p=Math.cos(T)*(r?r/2:b),o=Math.cos(T)*b,h=Math.sin(T)*b,y=Math.sin(T)*(r?r/2:b),e.moveTo(n-p,a-h),e.lineTo(n+y,a-o),e.lineTo(n+p,a+h),e.lineTo(n-y,a+o),e.closePath();break;case"crossRot":T+=zs;case"cross":p=Math.cos(T)*(r?r/2:b),o=Math.cos(T)*b,h=Math.sin(T)*b,y=Math.sin(T)*(r?r/2:b),e.moveTo(n-p,a-h),e.lineTo(n+p,a+h),e.moveTo(n+y,a-o),e.lineTo(n-y,a+o);break;case"star":p=Math.cos(T)*(r?r/2:b),o=Math.cos(T)*b,h=Math.sin(T)*b,y=Math.sin(T)*(r?r/2:b),e.moveTo(n-p,a-h),e.lineTo(n+p,a+h),e.moveTo(n+y,a-o),e.lineTo(n-y,a+o),T+=zs,p=Math.cos(T)*(r?r/2:b),o=Math.cos(T)*b,h=Math.sin(T)*b,y=Math.sin(T)*(r?r/2:b),e.moveTo(n-p,a-h),e.lineTo(n+p,a+h),e.moveTo(n+y,a-o),e.lineTo(n-y,a+o);break;case"line":o=r?r/2:Math.cos(T)*b,h=Math.sin(T)*b,e.moveTo(n-o,a-h),e.lineTo(n+o,a+h);break;case"dash":e.moveTo(n,a),e.lineTo(n+Math.cos(T)*(r?r/2:b),a+Math.sin(T)*b);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function tc(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function _x(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function Tx(e){e.restore()}function JN(e,t,n,a,r){if(!t)return e.lineTo(n.x,n.y);if(r==="middle"){const l=(t.x+n.x)/2;e.lineTo(l,t.y),e.lineTo(l,n.y)}else r==="after"!=!!a?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function eE(e,t,n,a){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(a?t.cp1x:t.cp2x,a?t.cp1y:t.cp2y,a?n.cp2x:n.cp1x,a?n.cp2y:n.cp1y,n.x,n.y)}function tE(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),st(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function nE(e,t,n,a,r){if(r.strikethrough||r.underline){const l=e.measureText(a),o=t-l.actualBoundingBoxLeft,h=t+l.actualBoundingBoxRight,f=n-l.actualBoundingBoxAscent,d=n+l.actualBoundingBoxDescent,g=r.strikethrough?(f+d)/2:d;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=r.decorationWidth||2,e.moveTo(o,g),e.lineTo(h,g),e.stroke()}}function aE(e,t){const n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function nc(e,t,n,a,r,l={}){const o=$t(t)?t:[t],h=l.strokeWidth>0&&l.strokeColor!=="";let f,d;for(e.save(),e.font=r.string,tE(e,l),f=0;f<o.length;++f)d=o[f],l.backdrop&&aE(e,l.backdrop),h&&(l.strokeColor&&(e.strokeStyle=l.strokeColor),st(l.strokeWidth)||(e.lineWidth=l.strokeWidth),e.strokeText(d,n,a,l.maxWidth)),e.fillText(d,n,a,l.maxWidth),nE(e,n,a,d,l),a+=Number(r.lineHeight);e.restore()}function Sh(e,t){const{x:n,y:a,w:r,h:l,radius:o}=t;e.arc(n+o.topLeft,a+o.topLeft,o.topLeft,1.5*Vt,Vt,!0),e.lineTo(n,a+l-o.bottomLeft),e.arc(n+o.bottomLeft,a+l-o.bottomLeft,o.bottomLeft,Vt,an,!0),e.lineTo(n+r-o.bottomRight,a+l),e.arc(n+r-o.bottomRight,a+l-o.bottomRight,o.bottomRight,an,0,!0),e.lineTo(n+r,a+o.topRight),e.arc(n+r-o.topRight,a+o.topRight,o.topRight,0,-an,!0),e.lineTo(n+o.topLeft,a)}const rE=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,sE=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function iE(e,t){const n=(""+e).match(rE);if(!n||n[1]==="normal")return t*1.2;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100;break}return t*e}const lE=e=>+e||0;function Sx(e,t){const n={},a=lt(t),r=a?Object.keys(t):t,l=lt(e)?a?o=>et(e[o],e[t[o]]):o=>e[o]:()=>e;for(const o of r)n[o]=lE(l(o));return n}function O2(e){return Sx(e,{top:"y",right:"x",bottom:"y",left:"x"})}function nl(e){return Sx(e,["topLeft","topRight","bottomLeft","bottomRight"])}function oa(e){const t=O2(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Sn(e,t){e=e||{},t=t||Ut.font;let n=et(e.size,t.size);typeof n=="string"&&(n=parseInt(n,10));let a=et(e.style,t.style);a&&!(""+a).match(sE)&&(console.warn('Invalid font style specified: "'+a+'"'),a=void 0);const r={family:et(e.family,t.family),lineHeight:iE(et(e.lineHeight,t.lineHeight),n),size:n,style:a,weight:et(e.weight,t.weight),string:""};return r.string=ZN(r),r}function Ft(e,t,n,a){let r,l,o;for(r=0,l=e.length;r<l;++r)if(o=e[r],o!==void 0&&(t!==void 0&&typeof o=="function"&&(o=o(t)),n!==void 0&&$t(o)&&(o=o[n%o.length]),o!==void 0))return o}function oE(e,t,n){const{min:a,max:r}=e,l=_2(t,(r-a)/2),o=(h,f)=>n&&h===0?0:h+f;return{min:o(a,-Math.abs(l)),max:o(r,l)}}function si(e,t){return Object.assign(Object.create(e),t)}function Nx(e,t=[""],n,a,r=()=>e[0]){const l=n||e;typeof a>"u"&&(a=L2("_fallback",e));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:l,_fallback:a,_getTarget:r,override:h=>Nx([h,...e],t,l,a)};return new Proxy(o,{deleteProperty(h,f){return delete h[f],delete h._keys,delete e[0][f],!0},get(h,f){return R2(h,f,()=>mE(f,t,e,h))},getOwnPropertyDescriptor(h,f){return Reflect.getOwnPropertyDescriptor(h._scopes[0],f)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(h,f){return fy(h).includes(f)},ownKeys(h){return fy(h)},set(h,f,d){const g=h._storage||(h._storage=r());return h[f]=g[f]=d,delete h._keys,!0}})}function cl(e,t,n,a){const r={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:M2(e,a),setContext:l=>cl(e,l,n,a),override:l=>cl(e.override(l),t,n,a)};return new Proxy(r,{deleteProperty(l,o){return delete l[o],delete e[o],!0},get(l,o,h){return R2(l,o,()=>uE(l,o,h))},getOwnPropertyDescriptor(l,o){return l._descriptors.allKeys?Reflect.has(e,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,o)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(l,o){return Reflect.has(e,o)},ownKeys(){return Reflect.ownKeys(e)},set(l,o,h){return e[o]=h,delete l[o],!0}})}function M2(e,t={scriptable:!0,indexable:!0}){const{_scriptable:n=t.scriptable,_indexable:a=t.indexable,_allKeys:r=t.allKeys}=e;return{allKeys:r,scriptable:n,indexable:a,isScriptable:gs(n)?n:()=>n,isIndexable:gs(a)?a:()=>a}}const cE=(e,t)=>e?e+px(t):t,Ex=(e,t)=>lt(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function R2(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||t==="constructor")return e[t];const a=n();return e[t]=a,a}function uE(e,t,n){const{_proxy:a,_context:r,_subProxy:l,_descriptors:o}=e;let h=a[t];return gs(h)&&o.isScriptable(t)&&(h=hE(t,h,e,n)),$t(h)&&h.length&&(h=fE(t,h,e,o.isIndexable)),Ex(t,h)&&(h=cl(h,r,l&&l[t],o)),h}function hE(e,t,n,a){const{_proxy:r,_context:l,_subProxy:o,_stack:h}=n;if(h.has(e))throw new Error("Recursion detected: "+Array.from(h).join("->")+"->"+e);h.add(e);let f=t(l,o||a);return h.delete(e),Ex(e,f)&&(f=Cx(r._scopes,r,e,f)),f}function fE(e,t,n,a){const{_proxy:r,_context:l,_subProxy:o,_descriptors:h}=n;if(typeof l.index<"u"&&a(e))return t[l.index%t.length];if(lt(t[0])){const f=t,d=r._scopes.filter(g=>g!==f);t=[];for(const g of f){const p=Cx(d,r,e,g);t.push(cl(p,l,o&&o[e],h))}}return t}function F2(e,t,n){return gs(e)?e(t,n):e}const dE=(e,t)=>e===!0?t:typeof e=="string"?ei(t,e):void 0;function xE(e,t,n,a,r){for(const l of t){const o=dE(n,l);if(o){e.add(o);const h=F2(o._fallback,n,r);if(typeof h<"u"&&h!==n&&h!==a)return h}else if(o===!1&&typeof a<"u"&&n!==a)return null}return!1}function Cx(e,t,n,a){const r=t._rootScopes,l=F2(t._fallback,n,a),o=[...e,...r],h=new Set;h.add(a);let f=hy(h,o,n,l||n,a);return f===null||typeof l<"u"&&l!==n&&(f=hy(h,o,l,f,a),f===null)?!1:Nx(Array.from(h),[""],r,l,()=>gE(t,n,a))}function hy(e,t,n,a,r){for(;n;)n=xE(e,t,n,a,r);return n}function gE(e,t,n){const a=e._getTarget();t in a||(a[t]={});const r=a[t];return $t(r)&&lt(n)?n:r||{}}function mE(e,t,n,a){let r;for(const l of t)if(r=L2(cE(l,e),n),typeof r<"u")return Ex(e,r)?Cx(n,a,e,r):r}function L2(e,t){for(const n of t){if(!n)continue;const a=n[e];if(typeof a<"u")return a}}function fy(e){let t=e._keys;return t||(t=e._keys=pE(e._scopes)),t}function pE(e){const t=new Set;for(const n of e)for(const a of Object.keys(n).filter(r=>!r.startsWith("_")))t.add(a);return Array.from(t)}const yE=Number.EPSILON||1e-14,ul=(e,t)=>t<e.length&&!e[t].skip&&e[t],B2=e=>e==="x"?"y":"x";function vE(e,t,n,a){const r=e.skip?t:e,l=t,o=n.skip?t:n,h=Gd(l,r),f=Gd(o,l);let d=h/(h+f),g=f/(h+f);d=isNaN(d)?0:d,g=isNaN(g)?0:g;const p=a*d,y=a*g;return{previous:{x:l.x-p*(o.x-r.x),y:l.y-p*(o.y-r.y)},next:{x:l.x+y*(o.x-r.x),y:l.y+y*(o.y-r.y)}}}function bE(e,t,n){const a=e.length;let r,l,o,h,f,d=ul(e,0);for(let g=0;g<a-1;++g)if(f=d,d=ul(e,g+1),!(!f||!d)){if(Po(t[g],0,yE)){n[g]=n[g+1]=0;continue}r=n[g]/t[g],l=n[g+1]/t[g],h=Math.pow(r,2)+Math.pow(l,2),!(h<=9)&&(o=3/Math.sqrt(h),n[g]=r*o*t[g],n[g+1]=l*o*t[g])}}function wE(e,t,n="x"){const a=B2(n),r=e.length;let l,o,h,f=ul(e,0);for(let d=0;d<r;++d){if(o=h,h=f,f=ul(e,d+1),!h)continue;const g=h[n],p=h[a];o&&(l=(g-o[n])/3,h[`cp1${n}`]=g-l,h[`cp1${a}`]=p-l*t[d]),f&&(l=(f[n]-g)/3,h[`cp2${n}`]=g+l,h[`cp2${a}`]=p+l*t[d])}}function _E(e,t="x"){const n=B2(t),a=e.length,r=Array(a).fill(0),l=Array(a);let o,h,f,d=ul(e,0);for(o=0;o<a;++o)if(h=f,f=d,d=ul(e,o+1),!!f){if(d){const g=d[t]-f[t];r[o]=g!==0?(d[n]-f[n])/g:0}l[o]=h?d?Ja(r[o-1])!==Ja(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}bE(e,r,l),wE(e,l,t)}function Wu(e,t,n){return Math.max(Math.min(e,n),t)}function TE(e,t){let n,a,r,l,o,h=tc(e[0],t);for(n=0,a=e.length;n<a;++n)o=l,l=h,h=n<a-1&&tc(e[n+1],t),l&&(r=e[n],o&&(r.cp1x=Wu(r.cp1x,t.left,t.right),r.cp1y=Wu(r.cp1y,t.top,t.bottom)),h&&(r.cp2x=Wu(r.cp2x,t.left,t.right),r.cp2y=Wu(r.cp2y,t.top,t.bottom)))}function SE(e,t,n,a,r){let l,o,h,f;if(t.spanGaps&&(e=e.filter(d=>!d.skip)),t.cubicInterpolationMode==="monotone")_E(e,r);else{let d=a?e[e.length-1]:e[0];for(l=0,o=e.length;l<o;++l)h=e[l],f=vE(d,h,e[Math.min(l+1,o-(a?0:1))%o],t.tension),h.cp1x=f.previous.x,h.cp1y=f.previous.y,h.cp2x=f.next.x,h.cp2y=f.next.y,d=h}t.capBezierPoints&&TE(e,n)}function kx(){return typeof window<"u"&&typeof document<"u"}function jx(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function Nh(e,t,n){let a;return typeof e=="string"?(a=parseInt(e,10),e.indexOf("%")!==-1&&(a=a/100*t.parentNode[n])):a=e,a}const Xh=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function NE(e,t){return Xh(e).getPropertyValue(t)}const EE=["top","right","bottom","left"];function $s(e,t,n){const a={};n=n?"-"+n:"";for(let r=0;r<4;r++){const l=EE[r];a[l]=parseFloat(e[t+"-"+l+n])||0}return a.width=a.left+a.right,a.height=a.top+a.bottom,a}const CE=(e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot);function kE(e,t){const n=e.touches,a=n&&n.length?n[0]:e,{offsetX:r,offsetY:l}=a;let o=!1,h,f;if(CE(r,l,e.target))h=r,f=l;else{const d=t.getBoundingClientRect();h=a.clientX-d.left,f=a.clientY-d.top,o=!0}return{x:h,y:f,box:o}}function Ws(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:a}=t,r=Xh(n),l=r.boxSizing==="border-box",o=$s(r,"padding"),h=$s(r,"border","width"),{x:f,y:d,box:g}=kE(e,n),p=o.left+(g&&h.left),y=o.top+(g&&h.top);let{width:w,height:_}=t;return l&&(w-=o.width+h.width,_-=o.height+h.height),{x:Math.round((f-p)/w*n.width/a),y:Math.round((d-y)/_*n.height/a)}}function jE(e,t,n){let a,r;if(t===void 0||n===void 0){const l=e&&jx(e);if(!l)t=e.clientWidth,n=e.clientHeight;else{const o=l.getBoundingClientRect(),h=Xh(l),f=$s(h,"border","width"),d=$s(h,"padding");t=o.width-d.width-f.width,n=o.height-d.height-f.height,a=Nh(h.maxWidth,l,"clientWidth"),r=Nh(h.maxHeight,l,"clientHeight")}}return{width:t,height:n,maxWidth:a||Th,maxHeight:r||Th}}const Gu=e=>Math.round(e*10)/10;function AE(e,t,n,a){const r=Xh(e),l=$s(r,"margin"),o=Nh(r.maxWidth,e,"clientWidth")||Th,h=Nh(r.maxHeight,e,"clientHeight")||Th,f=jE(e,t,n);let{width:d,height:g}=f;if(r.boxSizing==="content-box"){const y=$s(r,"border","width"),w=$s(r,"padding");d-=w.width+y.width,g-=w.height+y.height}return d=Math.max(0,d-l.width),g=Math.max(0,a?d/a:g-l.height),d=Gu(Math.min(d,o,f.maxWidth)),g=Gu(Math.min(g,h,f.maxHeight)),d&&!g&&(g=Gu(d/2)),(t!==void 0||n!==void 0)&&a&&f.height&&g>f.height&&(g=f.height,d=Gu(Math.floor(g*a))),{width:d,height:g}}function dy(e,t,n){const a=t||1,r=Math.floor(e.height*a),l=Math.floor(e.width*a);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const o=e.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${e.height}px`,o.style.width=`${e.width}px`),e.currentDevicePixelRatio!==a||o.height!==r||o.width!==l?(e.currentDevicePixelRatio=a,o.height=r,o.width=l,e.ctx.setTransform(a,0,0,a,0,0),!0):!1}const DE=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};kx()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e}();function xy(e,t){const n=NE(e,t),a=n&&n.match(/^(\d+)(\.\d+)?px$/);return a?+a[1]:void 0}function Gs(e,t,n,a){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function OE(e,t,n,a){return{x:e.x+n*(t.x-e.x),y:a==="middle"?n<.5?e.y:t.y:a==="after"?n<1?e.y:t.y:n>0?t.y:e.y}}function ME(e,t,n,a){const r={x:e.cp2x,y:e.cp2y},l={x:t.cp1x,y:t.cp1y},o=Gs(e,r,n),h=Gs(r,l,n),f=Gs(l,t,n),d=Gs(o,h,n),g=Gs(h,f,n);return Gs(d,g,n)}const RE=function(e,t){return{x(n){return e+e+t-n},setWidth(n){t=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,a){return n-a},leftForLtr(n,a){return n-a}}},FE=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function al(e,t,n){return e?RE(t,n):FE()}function H2(e,t){let n,a;(t==="ltr"||t==="rtl")&&(n=e.canvas.style,a=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=a)}function P2(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function I2(e){return e==="angle"?{between:ec,compare:RN,normalize:os}:{between:us,compare:(t,n)=>t-n,normalize:t=>t}}function gy({start:e,end:t,count:n,loop:a,style:r}){return{start:e%n,end:t%n,loop:a&&(t-e+1)%n===0,style:r}}function LE(e,t,n){const{property:a,start:r,end:l}=n,{between:o,normalize:h}=I2(a),f=t.length;let{start:d,end:g,loop:p}=e,y,w;if(p){for(d+=f,g+=f,y=0,w=f;y<w&&o(h(t[d%f][a]),r,l);++y)d--,g--;d%=f,g%=f}return g<d&&(g+=f),{start:d,end:g,loop:p,style:e.style}}function BE(e,t,n){if(!n)return[e];const{property:a,start:r,end:l}=n,o=t.length,{compare:h,between:f,normalize:d}=I2(a),{start:g,end:p,loop:y,style:w}=LE(e,t,n),_=[];let b=!1,T=null,S,E,C;const A=()=>f(r,C,S)&&h(r,C)!==0,F=()=>h(l,S)===0||f(l,C,S),K=()=>b||A(),D=()=>!b||F();for(let H=g,M=g;H<=p;++H)E=t[H%o],!E.skip&&(S=d(E[a]),S!==C&&(b=f(S,r,l),T===null&&K()&&(T=h(S,r)===0?H:M),T!==null&&D()&&(_.push(gy({start:T,end:H,loop:y,count:o,style:w})),T=null),M=H,C=S));return T!==null&&_.push(gy({start:T,end:p,loop:y,count:o,style:w})),_}function HE(e,t){const n=[],a=e.segments;for(let r=0;r<a.length;r++){const l=BE(a[r],e.points,t);l.length&&n.push(...l)}return n}function PE(e,t,n,a){let r=0,l=t-1;if(n&&!a)for(;r<t&&!e[r].skip;)r++;for(;r<t&&e[r].skip;)r++;for(r%=t,n&&(l+=r);l>r&&e[l%t].skip;)l--;return l%=t,{start:r,end:l}}function IE(e,t,n,a){const r=e.length,l=[];let o=t,h=e[t],f;for(f=t+1;f<=n;++f){const d=e[f%r];d.skip||d.stop?h.skip||(a=!1,l.push({start:t%r,end:(f-1)%r,loop:a}),t=o=d.stop?f:null):(o=f,h.skip&&(t=f)),h=d}return o!==null&&l.push({start:t%r,end:o%r,loop:a}),l}function zE(e,t){const n=e.points,a=e.options.spanGaps,r=n.length;if(!r)return[];const l=!!e._loop,{start:o,end:h}=PE(n,r,l,a);if(a===!0)return my(e,[{start:o,end:h,loop:l}],n,t);const f=h<o?h+r:h,d=!!e._fullLoop&&o===0&&h===r-1;return my(e,IE(n,o,f,d),n,t)}function my(e,t,n,a){return!a||!a.setContext||!n?t:UE(e,t,n,a)}function UE(e,t,n,a){const r=e._chart.getContext(),l=py(e.options),{_datasetIndex:o,options:{spanGaps:h}}=e,f=n.length,d=[];let g=l,p=t[0].start,y=p;function w(_,b,T,S){const E=h?-1:1;if(_!==b){for(_+=f;n[_%f].skip;)_-=E;for(;n[b%f].skip;)b+=E;_%f!==b%f&&(d.push({start:_%f,end:b%f,loop:T,style:S}),g=S,p=b%f)}}for(const _ of t){p=h?p:_.start;let b=n[p%f],T;for(y=p+1;y<=_.end;y++){const S=n[y%f];T=py(a.setContext(si(r,{type:"segment",p0:b,p1:S,p0DataIndex:(y-1)%f,p1DataIndex:y%f,datasetIndex:o}))),VE(T,g)&&w(p,y-1,_.loop,g),b=S,g=T}p<y-1&&w(p,y-1,_.loop,g)}return d}function py(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function VE(e,t){if(!t)return!1;const n=[],a=function(r,l){return bx(l)?(n.includes(l)||n.push(l),n.indexOf(l)):l};return JSON.stringify(e,a)!==JSON.stringify(t,a)}function Xu(e,t,n){return e.options.clip?e[n]:t[n]}function KE(e,t){const{xScale:n,yScale:a}=e;return n&&a?{left:Xu(n,t,"left"),right:Xu(n,t,"right"),top:Xu(a,t,"top"),bottom:Xu(a,t,"bottom")}:t}function WE(e,t){const n=t._clip;if(n.disabled)return!1;const a=KE(t,e.chartArea);return{left:n.left===!1?0:a.left-(n.left===!0?0:n.left),right:n.right===!1?e.width:a.right+(n.right===!0?0:n.right),top:n.top===!1?0:a.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?e.height:a.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class GE{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,n,a,r){const l=n.listeners[r],o=n.duration;l.forEach(h=>h({chart:t,initial:n.initial,numSteps:o,currentStep:Math.min(a-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=k2.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let n=0;this._charts.forEach((a,r)=>{if(!a.running||!a.items.length)return;const l=a.items;let o=l.length-1,h=!1,f;for(;o>=0;--o)f=l[o],f._active?(f._total>a.duration&&(a.duration=f._total),f.tick(t),h=!0):(l[o]=l[l.length-1],l.pop());h&&(r.draw(),this._notify(r,a,t,"progress")),l.length||(a.running=!1,this._notify(r,a,t,"complete"),a.initial=!1),n+=l.length}),this._lastDate=t,n===0&&(this._running=!1)}_getAnims(t){const n=this._charts;let a=n.get(t);return a||(a={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(t,a)),a}listen(t,n,a){this._getAnims(t).listeners[n].push(a)}add(t,n){!n||!n.length||this._getAnims(t).items.push(...n)}has(t){return this._getAnims(t).items.length>0}start(t){const n=this._charts.get(t);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((a,r)=>Math.max(a,r._duration),0),this._refresh())}running(t){if(!this._running)return!1;const n=this._charts.get(t);return!(!n||!n.running||!n.items.length)}stop(t){const n=this._charts.get(t);if(!n||!n.items.length)return;const a=n.items;let r=a.length-1;for(;r>=0;--r)a[r].cancel();n.items=[],this._notify(t,n,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var br=new GE;const yy="transparent",XE={boolean(e,t,n){return n>.5?t:e},color(e,t,n){const a=ly(e||yy),r=a.valid&&ly(t||yy);return r&&r.valid?r.mix(a,n).hexString():t},number(e,t,n){return e+(t-e)*n}};class YE{constructor(t,n,a,r){const l=n[a];r=Ft([t.to,r,l,t.from]);const o=Ft([t.from,l,r]);this._active=!0,this._fn=t.fn||XE[t.type||typeof o],this._easing=Io[t.easing]||Io.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=a,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(t,n,a){if(this._active){this._notify(!1);const r=this._target[this._prop],l=a-this._start,o=this._duration-l;this._start=a,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=l,this._loop=!!t.loop,this._to=Ft([t.to,n,r,t.from]),this._from=Ft([t.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const n=t-this._start,a=this._duration,r=this._prop,l=this._from,o=this._loop,h=this._to;let f;if(this._active=l!==h&&(o||n<a),!this._active){this._target[r]=h,this._notify(!0);return}if(n<0){this._target[r]=l;return}f=n/a%2,f=o&&f>1?2-f:f,f=this._easing(Math.min(1,Math.max(0,f))),this._target[r]=this._fn(l,h,f)}wait(){const t=this._promises||(this._promises=[]);return new Promise((n,a)=>{t.push({res:n,rej:a})})}_notify(t){const n=t?"res":"rej",a=this._promises||[];for(let r=0;r<a.length;r++)a[r][n]()}}class z2{constructor(t,n){this._chart=t,this._properties=new Map,this.configure(n)}configure(t){if(!lt(t))return;const n=Object.keys(Ut.animation),a=this._properties;Object.getOwnPropertyNames(t).forEach(r=>{const l=t[r];if(!lt(l))return;const o={};for(const h of n)o[h]=l[h];($t(l.properties)&&l.properties||[r]).forEach(h=>{(h===r||!a.has(h))&&a.set(h,o)})})}_animateOptions(t,n){const a=n.options,r=$E(t,a);if(!r)return[];const l=this._createAnimations(r,a);return a.$shared&&qE(t.options.$animations,a).then(()=>{t.options=a},()=>{}),l}_createAnimations(t,n){const a=this._properties,r=[],l=t.$animations||(t.$animations={}),o=Object.keys(n),h=Date.now();let f;for(f=o.length-1;f>=0;--f){const d=o[f];if(d.charAt(0)==="$")continue;if(d==="options"){r.push(...this._animateOptions(t,n));continue}const g=n[d];let p=l[d];const y=a.get(d);if(p)if(y&&p.active()){p.update(y,g,h);continue}else p.cancel();if(!y||!y.duration){t[d]=g;continue}l[d]=p=new YE(y,t,d,g),r.push(p)}return r}update(t,n){if(this._properties.size===0){Object.assign(t,n);return}const a=this._createAnimations(t,n);if(a.length)return br.add(this._chart,a),!0}}function qE(e,t){const n=[],a=Object.keys(t);for(let r=0;r<a.length;r++){const l=e[a[r]];l&&l.active()&&n.push(l.wait())}return Promise.all(n)}function $E(e,t){if(!t)return;let n=e.options;if(!n){e.options=t;return}return n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function vy(e,t){const n=e&&e.options||{},a=n.reverse,r=n.min===void 0?t:0,l=n.max===void 0?t:0;return{start:a?l:r,end:a?r:l}}function QE(e,t,n){if(n===!1)return!1;const a=vy(e,n),r=vy(t,n);return{top:r.end,right:a.end,bottom:r.start,left:a.start}}function ZE(e){let t,n,a,r;return lt(e)?(t=e.top,n=e.right,a=e.bottom,r=e.left):t=n=a=r=e,{top:t,right:n,bottom:a,left:r,disabled:e===!1}}function U2(e,t){const n=[],a=e._getSortedDatasetMetas(t);let r,l;for(r=0,l=a.length;r<l;++r)n.push(a[r].index);return n}function by(e,t,n,a={}){const r=e.keys,l=a.mode==="single";let o,h,f,d;if(t===null)return;let g=!1;for(o=0,h=r.length;o<h;++o){if(f=+r[o],f===n){if(g=!0,a.all)continue;break}d=e.values[f],Ea(d)&&(l||t===0||Ja(t)===Ja(d))&&(t+=d)}return!g&&!a.all?0:t}function JE(e,t){const{iScale:n,vScale:a}=t,r=n.axis==="x"?"x":"y",l=a.axis==="x"?"x":"y",o=Object.keys(e),h=new Array(o.length);let f,d,g;for(f=0,d=o.length;f<d;++f)g=o[f],h[f]={[r]:g,[l]:e[g]};return h}function Td(e,t){const n=e&&e.options.stacked;return n||n===void 0&&t.stack!==void 0}function e3(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}function t3(e){const{min:t,max:n,minDefined:a,maxDefined:r}=e.getUserBounds();return{min:a?t:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function n3(e,t,n){const a=e[t]||(e[t]={});return a[n]||(a[n]={})}function wy(e,t,n,a){for(const r of t.getMatchingVisibleMetas(a).reverse()){const l=e[r.index];if(n&&l>0||!n&&l<0)return r.index}return null}function _y(e,t){const{chart:n,_cachedMeta:a}=e,r=n._stacks||(n._stacks={}),{iScale:l,vScale:o,index:h}=a,f=l.axis,d=o.axis,g=e3(l,o,a),p=t.length;let y;for(let w=0;w<p;++w){const _=t[w],{[f]:b,[d]:T}=_,S=_._stacks||(_._stacks={});y=S[d]=n3(r,g,b),y[h]=T,y._top=wy(y,o,!0,a.type),y._bottom=wy(y,o,!1,a.type);const E=y._visualValues||(y._visualValues={});E[h]=T}}function Sd(e,t){const n=e.scales;return Object.keys(n).filter(a=>n[a].axis===t).shift()}function a3(e,t){return si(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function r3(e,t,n){return si(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}function To(e,t){const n=e.controller.index,a=e.vScale&&e.vScale.axis;if(a){t=t||e._parsed;for(const r of t){const l=r._stacks;if(!l||l[a]===void 0||l[a][n]===void 0)return;delete l[a][n],l[a]._visualValues!==void 0&&l[a]._visualValues[n]!==void 0&&delete l[a]._visualValues[n]}}}const Nd=e=>e==="reset"||e==="none",Ty=(e,t)=>t?e:Object.assign({},e),s3=(e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:U2(n,!0),values:null};class Qs{constructor(t,n){this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Td(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&To(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,n=this._cachedMeta,a=this.getDataset(),r=(p,y,w,_)=>p==="x"?y:p==="r"?_:w,l=n.xAxisID=et(a.xAxisID,Sd(t,"x")),o=n.yAxisID=et(a.yAxisID,Sd(t,"y")),h=n.rAxisID=et(a.rAxisID,Sd(t,"r")),f=n.indexAxis,d=n.iAxisID=r(f,l,o,h),g=n.vAxisID=r(f,o,l,h);n.xScale=this.getScaleForId(l),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(h),n.iScale=this.getScaleForId(d),n.vScale=this.getScaleForId(g)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const n=this._cachedMeta;return t===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&ry(this._data,this),t._stacked&&To(t)}_dataCheck(){const t=this.getDataset(),n=t.data||(t.data=[]),a=this._data;if(lt(n)){const r=this._cachedMeta;this._data=JE(n,r)}else if(a!==n){if(a){ry(a,this);const r=this._cachedMeta;To(r),r._parsed=[]}n&&Object.isExtensible(n)&&HN(n,this),this._syncList=[],this._data=n}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const n=this._cachedMeta,a=this.getDataset();let r=!1;this._dataCheck();const l=n._stacked;n._stacked=Td(n.vScale,n),n.stack!==a.stack&&(r=!0,To(n),n.stack=a.stack),this._resyncElements(t),(r||l!==n._stacked)&&(_y(this,n._parsed),n._stacked=Td(n.vScale,n))}configure(){const t=this.chart.config,n=t.datasetScopeKeys(this._type),a=t.getOptionScopes(this.getDataset(),n,!0);this.options=t.createResolver(a,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,n){const{_cachedMeta:a,_data:r}=this,{iScale:l,_stacked:o}=a,h=l.axis;let f=t===0&&n===r.length?!0:a._sorted,d=t>0&&a._parsed[t-1],g,p,y;if(this._parsing===!1)a._parsed=r,a._sorted=!0,y=r;else{$t(r[t])?y=this.parseArrayData(a,r,t,n):lt(r[t])?y=this.parseObjectData(a,r,t,n):y=this.parsePrimitiveData(a,r,t,n);const w=()=>p[h]===null||d&&p[h]<d[h];for(g=0;g<n;++g)a._parsed[g+t]=p=y[g],f&&(w()&&(f=!1),d=p);a._sorted=f}o&&_y(this,y)}parsePrimitiveData(t,n,a,r){const{iScale:l,vScale:o}=t,h=l.axis,f=o.axis,d=l.getLabels(),g=l===o,p=new Array(r);let y,w,_;for(y=0,w=r;y<w;++y)_=y+a,p[y]={[h]:g||l.parse(d[_],_),[f]:o.parse(n[_],_)};return p}parseArrayData(t,n,a,r){const{xScale:l,yScale:o}=t,h=new Array(r);let f,d,g,p;for(f=0,d=r;f<d;++f)g=f+a,p=n[g],h[f]={x:l.parse(p[0],g),y:o.parse(p[1],g)};return h}parseObjectData(t,n,a,r){const{xScale:l,yScale:o}=t,{xAxisKey:h="x",yAxisKey:f="y"}=this._parsing,d=new Array(r);let g,p,y,w;for(g=0,p=r;g<p;++g)y=g+a,w=n[y],d[g]={x:l.parse(ei(w,h),y),y:o.parse(ei(w,f),y)};return d}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,n,a){const r=this.chart,l=this._cachedMeta,o=n[t.axis],h={keys:U2(r,!0),values:n._stacks[t.axis]._visualValues};return by(h,o,l.index,{mode:a})}updateRangeFromParsed(t,n,a,r){const l=a[n.axis];let o=l===null?NaN:l;const h=r&&a._stacks[n.axis];r&&h&&(r.values=h,o=by(r,l,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,n){const a=this._cachedMeta,r=a._parsed,l=a._sorted&&t===a.iScale,o=r.length,h=this._getOtherScale(t),f=s3(n,a,this.chart),d={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:g,max:p}=t3(h);let y,w;function _(){w=r[y];const b=w[h.axis];return!Ea(w[t.axis])||g>b||p<b}for(y=0;y<o&&!(!_()&&(this.updateRangeFromParsed(d,t,w,f),l));++y);if(l){for(y=o-1;y>=0;--y)if(!_()){this.updateRangeFromParsed(d,t,w,f);break}}return d}getAllParsedValues(t){const n=this._cachedMeta._parsed,a=[];let r,l,o;for(r=0,l=n.length;r<l;++r)o=n[r][t.axis],Ea(o)&&a.push(o);return a}getMaxOverflow(){return!1}getLabelAndValue(t){const n=this._cachedMeta,a=n.iScale,r=n.vScale,l=this.getParsed(t);return{label:a?""+a.getLabelForValue(l[a.axis]):"",value:r?""+r.getLabelForValue(l[r.axis]):""}}_update(t){const n=this._cachedMeta;this.update(t||"default"),n._clip=ZE(et(this.options.clip,QE(n.xScale,n.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,n=this.chart,a=this._cachedMeta,r=a.data||[],l=n.chartArea,o=[],h=this._drawStart||0,f=this._drawCount||r.length-h,d=this.options.drawActiveElementsOnTop;let g;for(a.dataset&&a.dataset.draw(t,l,h,f),g=h;g<h+f;++g){const p=r[g];p.hidden||(p.active&&d?o.push(p):p.draw(t,l))}for(g=0;g<o.length;++g)o[g].draw(t,l)}getStyle(t,n){const a=n?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(a):this.resolveDataElementOptions(t||0,a)}getContext(t,n,a){const r=this.getDataset();let l;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];l=o.$context||(o.$context=r3(this.getContext(),t,o)),l.parsed=this.getParsed(t),l.raw=r.data[t],l.index=l.dataIndex=t}else l=this.$context||(this.$context=a3(this.chart.getContext(),this.index)),l.dataset=r,l.index=l.datasetIndex=this.index;return l.active=!!n,l.mode=a,l}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,n){return this._resolveElementOptions(this.dataElementType.id,n,t)}_resolveElementOptions(t,n="default",a){const r=n==="active",l=this._cachedDataOpts,o=t+"-"+n,h=l[o],f=this.enableOptionSharing&&Zo(a);if(h)return Ty(h,f);const d=this.chart.config,g=d.datasetElementScopeKeys(this._type,t),p=r?[`${t}Hover`,"hover",t,""]:[t,""],y=d.getOptionScopes(this.getDataset(),g),w=Object.keys(Ut.elements[t]),_=()=>this.getContext(a,r,n),b=d.resolveNamedOptions(y,w,_,p);return b.$shared&&(b.$shared=f,l[o]=Object.freeze(Ty(b,f))),b}_resolveAnimations(t,n,a){const r=this.chart,l=this._cachedDataOpts,o=`animation-${n}`,h=l[o];if(h)return h;let f;if(r.options.animation!==!1){const g=this.chart.config,p=g.datasetAnimationScopeKeys(this._type,n),y=g.getOptionScopes(this.getDataset(),p);f=g.createResolver(y,this.getContext(t,a,n))}const d=new z2(r,f&&f.animations);return f&&f._cacheable&&(l[o]=Object.freeze(d)),d}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,n){return!n||Nd(t)||this.chart._animationsDisabled}_getSharedOptions(t,n){const a=this.resolveDataElementOptions(t,n),r=this._sharedOptions,l=this.getSharedOptions(a),o=this.includeOptions(n,l)||l!==r;return this.updateSharedOptions(l,n,a),{sharedOptions:l,includeOptions:o}}updateElement(t,n,a,r){Nd(r)?Object.assign(t,a):this._resolveAnimations(n,r).update(t,a)}updateSharedOptions(t,n,a){t&&!Nd(n)&&this._resolveAnimations(void 0,n).update(t,a)}_setStyle(t,n,a,r){t.active=r;const l=this.getStyle(n,r);this._resolveAnimations(n,a,r).update(t,{options:!r&&this.getSharedOptions(l)||l})}removeHoverStyle(t,n,a){this._setStyle(t,a,"active",!1)}setHoverStyle(t,n,a){this._setStyle(t,a,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const n=this._data,a=this._cachedMeta.data;for(const[h,f,d]of this._syncList)this[h](f,d);this._syncList=[];const r=a.length,l=n.length,o=Math.min(l,r);o&&this.parse(0,o),l>r?this._insertElements(r,l-r,t):l<r&&this._removeElements(l,r-l)}_insertElements(t,n,a=!0){const r=this._cachedMeta,l=r.data,o=t+n;let h;const f=d=>{for(d.length+=n,h=d.length-1;h>=o;h--)d[h]=d[h-n]};for(f(l),h=t;h<o;++h)l[h]=new this.dataElementType;this._parsing&&f(r._parsed),this.parse(t,n),a&&this.updateElements(l,t,n,"reset")}updateElements(t,n,a,r){}_removeElements(t,n){const a=this._cachedMeta;if(this._parsing){const r=a._parsed.splice(t,n);a._stacked&&To(a,r)}a.data.splice(t,n)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[n,a,r]=t;this[n](a,r)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,n){n&&this._sync(["_removeElements",t,n]);const a=arguments.length-2;a&&this._sync(["_insertElements",t,a])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Ie(Qs,"defaults",{}),Ie(Qs,"datasetElementType",null),Ie(Qs,"dataElementType",null);function i3(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let a=[];for(let r=0,l=n.length;r<l;r++)a=a.concat(n[r].controller.getAllParsedValues(e));e._cache.$bar=C2(a.sort((r,l)=>r-l))}return e._cache.$bar}function l3(e){const t=e.iScale,n=i3(t,e.type);let a=t._length,r,l,o,h;const f=()=>{o===32767||o===-32768||(Zo(h)&&(a=Math.min(a,Math.abs(o-h)||a)),h=o)};for(r=0,l=n.length;r<l;++r)o=t.getPixelForValue(n[r]),f();for(h=void 0,r=0,l=t.ticks.length;r<l;++r)o=t.getPixelForTick(r),f();return a}function o3(e,t,n,a){const r=n.barThickness;let l,o;return st(r)?(l=t.min*n.categoryPercentage,o=n.barPercentage):(l=r*a,o=1),{chunk:l/a,ratio:o,start:t.pixels[e]-l/2}}function c3(e,t,n,a){const r=t.pixels,l=r[e];let o=e>0?r[e-1]:null,h=e<r.length-1?r[e+1]:null;const f=n.categoryPercentage;o===null&&(o=l-(h===null?t.end-t.start:h-l)),h===null&&(h=l+l-o);const d=l-(l-Math.min(o,h))/2*f;return{chunk:Math.abs(h-o)/2*f/a,ratio:n.barPercentage,start:d}}function u3(e,t,n,a){const r=n.parse(e[0],a),l=n.parse(e[1],a),o=Math.min(r,l),h=Math.max(r,l);let f=o,d=h;Math.abs(o)>Math.abs(h)&&(f=h,d=o),t[n.axis]=d,t._custom={barStart:f,barEnd:d,start:r,end:l,min:o,max:h}}function V2(e,t,n,a){return $t(e)?u3(e,t,n,a):t[n.axis]=n.parse(e,a),t}function Sy(e,t,n,a){const r=e.iScale,l=e.vScale,o=r.getLabels(),h=r===l,f=[];let d,g,p,y;for(d=n,g=n+a;d<g;++d)y=t[d],p={},p[r.axis]=h||r.parse(o[d],d),f.push(V2(y,p,l,d));return f}function Ed(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function h3(e,t,n){return e!==0?Ja(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}function f3(e){let t,n,a,r,l;return e.horizontal?(t=e.base>e.x,n="left",a="right"):(t=e.base<e.y,n="bottom",a="top"),t?(r="end",l="start"):(r="start",l="end"),{start:n,end:a,reverse:t,top:r,bottom:l}}function d3(e,t,n,a){let r=t.borderSkipped;const l={};if(!r){e.borderSkipped=l;return}if(r===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:h,reverse:f,top:d,bottom:g}=f3(e);r==="middle"&&n&&(e.enableBorderRadius=!0,(n._top||0)===a?r=d:(n._bottom||0)===a?r=g:(l[Ny(g,o,h,f)]=!0,r=d)),l[Ny(r,o,h,f)]=!0,e.borderSkipped=l}function Ny(e,t,n,a){return a?(e=x3(e,t,n),e=Ey(e,n,t)):e=Ey(e,t,n),e}function x3(e,t,n){return e===t?n:e===n?t:e}function Ey(e,t,n){return e==="start"?t:e==="end"?n:e}function g3(e,{inflateAmount:t},n){e.inflateAmount=t==="auto"?n===1?.33:0:t}class mh extends Qs{parsePrimitiveData(t,n,a,r){return Sy(t,n,a,r)}parseArrayData(t,n,a,r){return Sy(t,n,a,r)}parseObjectData(t,n,a,r){const{iScale:l,vScale:o}=t,{xAxisKey:h="x",yAxisKey:f="y"}=this._parsing,d=l.axis==="x"?h:f,g=o.axis==="x"?h:f,p=[];let y,w,_,b;for(y=a,w=a+r;y<w;++y)b=n[y],_={},_[l.axis]=l.parse(ei(b,d),y),p.push(V2(ei(b,g),_,o,y));return p}updateRangeFromParsed(t,n,a,r){super.updateRangeFromParsed(t,n,a,r);const l=a._custom;l&&n===this._cachedMeta.vScale&&(t.min=Math.min(t.min,l.min),t.max=Math.max(t.max,l.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const n=this._cachedMeta,{iScale:a,vScale:r}=n,l=this.getParsed(t),o=l._custom,h=Ed(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(l[r.axis]);return{label:""+a.getLabelForValue(l[a.axis]),value:h}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,t)}updateElements(t,n,a,r){const l=r==="reset",{index:o,_cachedMeta:{vScale:h}}=this,f=h.getBasePixel(),d=h.isHorizontal(),g=this._getRuler(),{sharedOptions:p,includeOptions:y}=this._getSharedOptions(n,r);for(let w=n;w<n+a;w++){const _=this.getParsed(w),b=l||st(_[h.axis])?{base:f,head:f}:this._calculateBarValuePixels(w),T=this._calculateBarIndexPixels(w,g),S=(_._stacks||{})[h.axis],E={horizontal:d,base:b.base,enableBorderRadius:!S||Ed(_._custom)||o===S._top||o===S._bottom,x:d?b.head:T.center,y:d?T.center:b.head,height:d?T.size:Math.abs(b.size),width:d?Math.abs(b.size):T.size};y&&(E.options=p||this.resolveDataElementOptions(w,t[w].active?"active":r));const C=E.options||t[w].options;d3(E,C,S,o),g3(E,C,g.ratio),this.updateElement(t[w],w,E,r)}}_getStacks(t,n){const{iScale:a}=this._cachedMeta,r=a.getMatchingVisibleMetas(this._type).filter(g=>g.controller.options.grouped),l=a.options.stacked,o=[],h=this._cachedMeta.controller.getParsed(n),f=h&&h[a.axis],d=g=>{const p=g._parsed.find(w=>w[a.axis]===f),y=p&&p[g.vScale.axis];if(st(y)||isNaN(y))return!0};for(const g of r)if(!(n!==void 0&&d(g))&&((l===!1||o.indexOf(g.stack)===-1||l===void 0&&g.stack===void 0)&&o.push(g.stack),g.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,n,a){const r=this._getStacks(t,a),l=n!==void 0?r.indexOf(n):-1;return l===-1?r.length-1:l}_getRuler(){const t=this.options,n=this._cachedMeta,a=n.iScale,r=[];let l,o;for(l=0,o=n.data.length;l<o;++l)r.push(a.getPixelForValue(this.getParsed(l)[a.axis],l));const h=t.barThickness;return{min:h||l3(n),pixels:r,start:a._startPixel,end:a._endPixel,stackCount:this._getStackCount(),scale:a,grouped:t.grouped,ratio:h?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:n,_stacked:a,index:r},options:{base:l,minBarLength:o}}=this,h=l||0,f=this.getParsed(t),d=f._custom,g=Ed(d);let p=f[n.axis],y=0,w=a?this.applyStack(n,f,a):p,_,b;w!==p&&(y=w-p,w=p),g&&(p=d.barStart,w=d.barEnd-d.barStart,p!==0&&Ja(p)!==Ja(d.barEnd)&&(y=0),y+=p);const T=!st(l)&&!g?l:y;let S=n.getPixelForValue(T);if(this.chart.getDataVisibility(t)?_=n.getPixelForValue(y+w):_=S,b=_-S,Math.abs(b)<o){b=h3(b,n,h)*o,p===h&&(S-=b/2);const E=n.getPixelForDecimal(0),C=n.getPixelForDecimal(1),A=Math.min(E,C),F=Math.max(E,C);S=Math.max(Math.min(S,F),A),_=S+b,a&&!g&&(f._stacks[n.axis]._visualValues[r]=n.getValueForPixel(_)-n.getValueForPixel(S))}if(S===n.getPixelForValue(h)){const E=Ja(b)*n.getLineWidthForValue(h)/2;S+=E,b-=E}return{size:b,base:S,head:_,center:_+b/2}}_calculateBarIndexPixels(t,n){const a=n.scale,r=this.options,l=r.skipNull,o=et(r.maxBarThickness,1/0);let h,f;if(n.grouped){const d=l?this._getStackCount(t):n.stackCount,g=r.barThickness==="flex"?c3(t,n,r,d):o3(t,n,r,d),p=this._getStackIndex(this.index,this._cachedMeta.stack,l?t:void 0);h=g.start+g.chunk*p+g.chunk/2,f=Math.min(o,g.chunk*g.ratio)}else h=a.getPixelForValue(this.getParsed(t)[a.axis],t),f=Math.min(o,n.min*n.ratio);return{base:h-f/2,head:h+f/2,center:h,size:f}}draw(){const t=this._cachedMeta,n=t.vScale,a=t.data,r=a.length;let l=0;for(;l<r;++l)this.getParsed(l)[n.axis]!==null&&!a[l].hidden&&a[l].draw(this._ctx)}}Ie(mh,"id","bar"),Ie(mh,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Ie(mh,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function m3(e,t,n){let a=1,r=1,l=0,o=0;if(t<zt){const h=e,f=h+t,d=Math.cos(h),g=Math.sin(h),p=Math.cos(f),y=Math.sin(f),w=(C,A,F)=>ec(C,h,f,!0)?1:Math.max(A,A*n,F,F*n),_=(C,A,F)=>ec(C,h,f,!0)?-1:Math.min(A,A*n,F,F*n),b=w(0,d,p),T=w(an,g,y),S=_(Vt,d,p),E=_(Vt+an,g,y);a=(b-S)/2,r=(T-E)/2,l=-(b+S)/2,o=-(T+E)/2}return{ratioX:a,ratioY:r,offsetX:l,offsetY:o}}class Mo extends Qs{constructor(t,n){super(t,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,n){const a=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=a;else{let l=f=>+a[f];if(lt(a[t])){const{key:f="value"}=this._parsing;l=d=>+ei(a[d],f)}let o,h;for(o=t,h=t+n;o<h;++o)r._parsed[o]=l(o)}}_getRotation(){return Tr(this.options.rotation-90)}_getCircumference(){return Tr(this.options.circumference)}_getRotationExtents(){let t=zt,n=-zt;for(let a=0;a<this.chart.data.datasets.length;++a)if(this.chart.isDatasetVisible(a)&&this.chart.getDatasetMeta(a).type===this._type){const r=this.chart.getDatasetMeta(a).controller,l=r._getRotation(),o=r._getCircumference();t=Math.min(t,l),n=Math.max(n,l+o)}return{rotation:t,circumference:n-t}}update(t){const n=this.chart,{chartArea:a}=n,r=this._cachedMeta,l=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(l)+this.options.spacing,h=Math.max((Math.min(a.width,a.height)-o)/2,0),f=Math.min(wN(this.options.cutout,h),1),d=this._getRingWeight(this.index),{circumference:g,rotation:p}=this._getRotationExtents(),{ratioX:y,ratioY:w,offsetX:_,offsetY:b}=m3(p,g,f),T=(a.width-o)/y,S=(a.height-o)/w,E=Math.max(Math.min(T,S)/2,0),C=_2(this.options.radius,E),A=Math.max(C*f,0),F=(C-A)/this._getVisibleDatasetWeightTotal();this.offsetX=_*C,this.offsetY=b*C,r.total=this.calculateTotal(),this.outerRadius=C-F*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-F*d,0),this.updateElements(l,0,l.length,t)}_circumference(t,n){const a=this.options,r=this._cachedMeta,l=this._getCircumference();return n&&a.animation.animateRotate||!this.chart.getDataVisibility(t)||r._parsed[t]===null||r.data[t].hidden?0:this.calculateCircumference(r._parsed[t]*l/zt)}updateElements(t,n,a,r){const l=r==="reset",o=this.chart,h=o.chartArea,d=o.options.animation,g=(h.left+h.right)/2,p=(h.top+h.bottom)/2,y=l&&d.animateScale,w=y?0:this.innerRadius,_=y?0:this.outerRadius,{sharedOptions:b,includeOptions:T}=this._getSharedOptions(n,r);let S=this._getRotation(),E;for(E=0;E<n;++E)S+=this._circumference(E,l);for(E=n;E<n+a;++E){const C=this._circumference(E,l),A=t[E],F={x:g+this.offsetX,y:p+this.offsetY,startAngle:S,endAngle:S+C,circumference:C,outerRadius:_,innerRadius:w};T&&(F.options=b||this.resolveDataElementOptions(E,A.active?"active":r)),S+=C,this.updateElement(A,E,F,r)}}calculateTotal(){const t=this._cachedMeta,n=t.data;let a=0,r;for(r=0;r<n.length;r++){const l=t._parsed[r];l!==null&&!isNaN(l)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(a+=Math.abs(l))}return a}calculateCircumference(t){const n=this._cachedMeta.total;return n>0&&!isNaN(t)?zt*(Math.abs(t)/n):0}getLabelAndValue(t){const n=this._cachedMeta,a=this.chart,r=a.data.labels||[],l=wx(n._parsed[t],a.options.locale);return{label:r[t]||"",value:l}}getMaxBorderWidth(t){let n=0;const a=this.chart;let r,l,o,h,f;if(!t){for(r=0,l=a.data.datasets.length;r<l;++r)if(a.isDatasetVisible(r)){o=a.getDatasetMeta(r),t=o.data,h=o.controller;break}}if(!t)return 0;for(r=0,l=t.length;r<l;++r)f=h.resolveDataElementOptions(r),f.borderAlign!=="inner"&&(n=Math.max(n,f.borderWidth||0,f.hoverBorderWidth||0));return n}getMaxOffset(t){let n=0;for(let a=0,r=t.length;a<r;++a){const l=this.resolveDataElementOptions(a);n=Math.max(n,l.offset||0,l.hoverOffset||0)}return n}_getRingWeightOffset(t){let n=0;for(let a=0;a<t;++a)this.chart.isDatasetVisible(a)&&(n+=this._getRingWeight(a));return n}_getRingWeight(t){return Math.max(et(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Ie(Mo,"id","doughnut"),Ie(Mo,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Ie(Mo,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),Ie(Mo,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const n=t.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:a,color:r}}=t.legend.options;return n.labels.map((l,o)=>{const f=t.getDatasetMeta(0).controller.getStyle(o);return{text:l,fillStyle:f.backgroundColor,strokeStyle:f.borderColor,fontColor:r,lineWidth:f.borderWidth,pointStyle:a,hidden:!t.getDataVisibility(o),index:o}})}return[]}},onClick(t,n,a){a.chart.toggleDataVisibility(n.index),a.chart.update()}}}});class ph extends Qs{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const n=this._cachedMeta,{dataset:a,data:r=[],_dataset:l}=n,o=this.chart._animationsDisabled;let{start:h,count:f}=zN(n,r,o);this._drawStart=h,this._drawCount=f,UN(n)&&(h=0,f=r.length),a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!l._decimated,a.points=r;const d=this.resolveDatasetElementOptions(t);this.options.showLine||(d.borderWidth=0),d.segment=this.options.segment,this.updateElement(a,void 0,{animated:!o,options:d},t),this.updateElements(r,h,f,t)}updateElements(t,n,a,r){const l=r==="reset",{iScale:o,vScale:h,_stacked:f,_dataset:d}=this._cachedMeta,{sharedOptions:g,includeOptions:p}=this._getSharedOptions(n,r),y=o.axis,w=h.axis,{spanGaps:_,segment:b}=this.options,T=Jo(_)?_:Number.POSITIVE_INFINITY,S=this.chart._animationsDisabled||l||r==="none",E=n+a,C=t.length;let A=n>0&&this.getParsed(n-1);for(let F=0;F<C;++F){const K=t[F],D=S?K:{};if(F<n||F>=E){D.skip=!0;continue}const H=this.getParsed(F),M=st(H[w]),B=D[y]=o.getPixelForValue(H[y],F),I=D[w]=l||M?h.getBasePixel():h.getPixelForValue(f?this.applyStack(h,H,f):H[w],F);D.skip=isNaN(B)||isNaN(I)||M,D.stop=F>0&&Math.abs(H[y]-A[y])>T,b&&(D.parsed=H,D.raw=d.data[F]),p&&(D.options=g||this.resolveDataElementOptions(F,K.active?"active":r)),S||this.updateElement(K,F,D,r),A=H}}getMaxOverflow(){const t=this._cachedMeta,n=t.dataset,a=n.options&&n.options.borderWidth||0,r=t.data||[];if(!r.length)return a;const l=r[0].size(this.resolveDataElementOptions(0)),o=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(a,l,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}Ie(ph,"id","line"),Ie(ph,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Ie(ph,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class qd extends Mo{}Ie(qd,"id","pie"),Ie(qd,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});function Vs(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Ax{constructor(t){Ie(this,"options");this.options=t||{}}static override(t){Object.assign(Ax.prototype,t)}init(){}formats(){return Vs()}parse(){return Vs()}format(){return Vs()}add(){return Vs()}diff(){return Vs()}startOf(){return Vs()}endOf(){return Vs()}}var p3={_date:Ax};function y3(e,t,n,a){const{controller:r,data:l,_sorted:o}=e,h=r._cachedMeta.iScale,f=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(h&&t===h.axis&&t!=="r"&&o&&l.length){const d=h._reversePixels?LN:Ys;if(a){if(r._sharedOptions){const g=l[0],p=typeof g.getRange=="function"&&g.getRange(t);if(p){const y=d(l,t,n-p),w=d(l,t,n+p);return{lo:y.lo,hi:w.hi}}}}else{const g=d(l,t,n);if(f){const{vScale:p}=r._cachedMeta,{_parsed:y}=e,w=y.slice(0,g.lo+1).reverse().findIndex(b=>!st(b[p.axis]));g.lo-=Math.max(0,w);const _=y.slice(g.hi).findIndex(b=>!st(b[p.axis]));g.hi+=Math.max(0,_)}return g}}return{lo:0,hi:l.length-1}}function Yh(e,t,n,a,r){const l=e.getSortedVisibleDatasetMetas(),o=n[t];for(let h=0,f=l.length;h<f;++h){const{index:d,data:g}=l[h],{lo:p,hi:y}=y3(l[h],t,o,r);for(let w=p;w<=y;++w){const _=g[w];_.skip||a(_,d,w)}}}function v3(e){const t=e.indexOf("x")!==-1,n=e.indexOf("y")!==-1;return function(a,r){const l=t?Math.abs(a.x-r.x):0,o=n?Math.abs(a.y-r.y):0;return Math.sqrt(Math.pow(l,2)+Math.pow(o,2))}}function Cd(e,t,n,a,r){const l=[];return!r&&!e.isPointInArea(t)||Yh(e,n,t,function(h,f,d){!r&&!tc(h,e.chartArea,0)||h.inRange(t.x,t.y,a)&&l.push({element:h,datasetIndex:f,index:d})},!0),l}function b3(e,t,n,a){let r=[];function l(o,h,f){const{startAngle:d,endAngle:g}=o.getProps(["startAngle","endAngle"],a),{angle:p}=N2(o,{x:t.x,y:t.y});ec(p,d,g)&&r.push({element:o,datasetIndex:h,index:f})}return Yh(e,n,t,l),r}function w3(e,t,n,a,r,l){let o=[];const h=v3(n);let f=Number.POSITIVE_INFINITY;function d(g,p,y){const w=g.inRange(t.x,t.y,r);if(a&&!w)return;const _=g.getCenterPoint(r);if(!(!!l||e.isPointInArea(_))&&!w)return;const T=h(t,_);T<f?(o=[{element:g,datasetIndex:p,index:y}],f=T):T===f&&o.push({element:g,datasetIndex:p,index:y})}return Yh(e,n,t,d),o}function kd(e,t,n,a,r,l){return!l&&!e.isPointInArea(t)?[]:n==="r"&&!a?b3(e,t,n,r):w3(e,t,n,a,r,l)}function Cy(e,t,n,a,r){const l=[],o=n==="x"?"inXRange":"inYRange";let h=!1;return Yh(e,n,t,(f,d,g)=>{f[o]&&f[o](t[n],r)&&(l.push({element:f,datasetIndex:d,index:g}),h=h||f.inRange(t.x,t.y,r))}),a&&!h?[]:l}var _3={modes:{index(e,t,n,a){const r=Ws(t,e),l=n.axis||"x",o=n.includeInvisible||!1,h=n.intersect?Cd(e,r,l,a,o):kd(e,r,l,!1,a,o),f=[];return h.length?(e.getSortedVisibleDatasetMetas().forEach(d=>{const g=h[0].index,p=d.data[g];p&&!p.skip&&f.push({element:p,datasetIndex:d.index,index:g})}),f):[]},dataset(e,t,n,a){const r=Ws(t,e),l=n.axis||"xy",o=n.includeInvisible||!1;let h=n.intersect?Cd(e,r,l,a,o):kd(e,r,l,!1,a,o);if(h.length>0){const f=h[0].datasetIndex,d=e.getDatasetMeta(f).data;h=[];for(let g=0;g<d.length;++g)h.push({element:d[g],datasetIndex:f,index:g})}return h},point(e,t,n,a){const r=Ws(t,e),l=n.axis||"xy",o=n.includeInvisible||!1;return Cd(e,r,l,a,o)},nearest(e,t,n,a){const r=Ws(t,e),l=n.axis||"xy",o=n.includeInvisible||!1;return kd(e,r,l,n.intersect,a,o)},x(e,t,n,a){const r=Ws(t,e);return Cy(e,r,"x",n.intersect,a)},y(e,t,n,a){const r=Ws(t,e);return Cy(e,r,"y",n.intersect,a)}}};const K2=["left","top","right","bottom"];function So(e,t){return e.filter(n=>n.pos===t)}function ky(e,t){return e.filter(n=>K2.indexOf(n.pos)===-1&&n.box.axis===t)}function No(e,t){return e.sort((n,a)=>{const r=t?a:n,l=t?n:a;return r.weight===l.weight?r.index-l.index:r.weight-l.weight})}function T3(e){const t=[];let n,a,r,l,o,h;for(n=0,a=(e||[]).length;n<a;++n)r=e[n],{position:l,options:{stack:o,stackWeight:h=1}}=r,t.push({index:n,box:r,pos:l,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&l+o,stackWeight:h});return t}function S3(e){const t={};for(const n of e){const{stack:a,pos:r,stackWeight:l}=n;if(!a||!K2.includes(r))continue;const o=t[a]||(t[a]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=l}return t}function N3(e,t){const n=S3(e),{vBoxMaxWidth:a,hBoxMaxHeight:r}=t;let l,o,h;for(l=0,o=e.length;l<o;++l){h=e[l];const{fullSize:f}=h.box,d=n[h.stack],g=d&&h.stackWeight/d.weight;h.horizontal?(h.width=g?g*a:f&&t.availableWidth,h.height=r):(h.width=a,h.height=g?g*r:f&&t.availableHeight)}return n}function E3(e){const t=T3(e),n=No(t.filter(d=>d.box.fullSize),!0),a=No(So(t,"left"),!0),r=No(So(t,"right")),l=No(So(t,"top"),!0),o=No(So(t,"bottom")),h=ky(t,"x"),f=ky(t,"y");return{fullSize:n,leftAndTop:a.concat(l),rightAndBottom:r.concat(f).concat(o).concat(h),chartArea:So(t,"chartArea"),vertical:a.concat(r).concat(f),horizontal:l.concat(o).concat(h)}}function jy(e,t,n,a){return Math.max(e[n],t[n])+Math.max(e[a],t[a])}function W2(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function C3(e,t,n,a){const{pos:r,box:l}=n,o=e.maxPadding;if(!lt(r)){n.size&&(e[r]-=n.size);const p=a[n.stack]||{size:0,count:1};p.size=Math.max(p.size,n.horizontal?l.height:l.width),n.size=p.size/p.count,e[r]+=n.size}l.getPadding&&W2(o,l.getPadding());const h=Math.max(0,t.outerWidth-jy(o,e,"left","right")),f=Math.max(0,t.outerHeight-jy(o,e,"top","bottom")),d=h!==e.w,g=f!==e.h;return e.w=h,e.h=f,n.horizontal?{same:d,other:g}:{same:g,other:d}}function k3(e){const t=e.maxPadding;function n(a){const r=Math.max(t[a]-e[a],0);return e[a]+=r,r}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}function j3(e,t){const n=t.maxPadding;function a(r){const l={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{l[o]=Math.max(t[o],n[o])}),l}return a(e?["left","right"]:["top","bottom"])}function Ro(e,t,n,a){const r=[];let l,o,h,f,d,g;for(l=0,o=e.length,d=0;l<o;++l){h=e[l],f=h.box,f.update(h.width||t.w,h.height||t.h,j3(h.horizontal,t));const{same:p,other:y}=C3(t,n,h,a);d|=p&&r.length,g=g||y,f.fullSize||r.push(h)}return d&&Ro(r,t,n,a)||g}function Yu(e,t,n,a,r){e.top=n,e.left=t,e.right=t+a,e.bottom=n+r,e.width=a,e.height=r}function Ay(e,t,n,a){const r=n.padding;let{x:l,y:o}=t;for(const h of e){const f=h.box,d=a[h.stack]||{placed:0,weight:1},g=h.stackWeight/d.weight||1;if(h.horizontal){const p=t.w*g,y=d.size||f.height;Zo(d.start)&&(o=d.start),f.fullSize?Yu(f,r.left,o,n.outerWidth-r.right-r.left,y):Yu(f,t.left+d.placed,o,p,y),d.start=o,d.placed+=p,o=f.bottom}else{const p=t.h*g,y=d.size||f.width;Zo(d.start)&&(l=d.start),f.fullSize?Yu(f,l,r.top,y,n.outerHeight-r.bottom-r.top):Yu(f,l,t.top+d.placed,y,p),d.start=l,d.placed+=p,l=f.right}}t.x=l,t.y=o}var Sa={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(n){t.draw(n)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;n!==-1&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,a){if(!e)return;const r=oa(e.options.layout.padding),l=Math.max(t-r.width,0),o=Math.max(n-r.height,0),h=E3(e.boxes),f=h.vertical,d=h.horizontal;dt(e.boxes,b=>{typeof b.beforeLayout=="function"&&b.beforeLayout()});const g=f.reduce((b,T)=>T.box.options&&T.box.options.display===!1?b:b+1,0)||1,p=Object.freeze({outerWidth:t,outerHeight:n,padding:r,availableWidth:l,availableHeight:o,vBoxMaxWidth:l/2/g,hBoxMaxHeight:o/2}),y=Object.assign({},r);W2(y,oa(a));const w=Object.assign({maxPadding:y,w:l,h:o,x:r.left,y:r.top},r),_=N3(f.concat(d),p);Ro(h.fullSize,w,p,_),Ro(f,w,p,_),Ro(d,w,p,_)&&Ro(f,w,p,_),k3(w),Ay(h.leftAndTop,w,p,_),w.x+=w.w,w.y+=w.h,Ay(h.rightAndBottom,w,p,_),e.chartArea={left:w.left,top:w.top,right:w.left+w.w,bottom:w.top+w.h,height:w.h,width:w.w},dt(h.chartArea,b=>{const T=b.box;Object.assign(T,e.chartArea),T.update(w.w,w.h,{left:0,top:0,right:0,bottom:0})})}};class G2{acquireContext(t,n){}releaseContext(t){return!1}addEventListener(t,n,a){}removeEventListener(t,n,a){}getDevicePixelRatio(){return 1}getMaximumSize(t,n,a,r){return n=Math.max(0,n||t.width),a=a||t.height,{width:n,height:Math.max(0,r?Math.floor(n/r):a)}}isAttached(t){return!0}updateConfig(t){}}class A3 extends G2{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const yh="$chartjs",D3={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Dy=e=>e===null||e==="";function O3(e,t){const n=e.style,a=e.getAttribute("height"),r=e.getAttribute("width");if(e[yh]={initial:{height:a,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",Dy(r)){const l=xy(e,"width");l!==void 0&&(e.width=l)}if(Dy(a))if(e.style.height==="")e.height=e.width/(t||2);else{const l=xy(e,"height");l!==void 0&&(e.height=l)}return e}const X2=DE?{passive:!0}:!1;function M3(e,t,n){e&&e.addEventListener(t,n,X2)}function R3(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,X2)}function F3(e,t){const n=D3[e.type]||e.type,{x:a,y:r}=Ws(e,t);return{type:n,chart:t,native:e,x:a!==void 0?a:null,y:r!==void 0?r:null}}function Eh(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function L3(e,t,n){const a=e.canvas,r=new MutationObserver(l=>{let o=!1;for(const h of l)o=o||Eh(h.addedNodes,a),o=o&&!Eh(h.removedNodes,a);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function B3(e,t,n){const a=e.canvas,r=new MutationObserver(l=>{let o=!1;for(const h of l)o=o||Eh(h.removedNodes,a),o=o&&!Eh(h.addedNodes,a);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const ac=new Map;let Oy=0;function Y2(){const e=window.devicePixelRatio;e!==Oy&&(Oy=e,ac.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function H3(e,t){ac.size||window.addEventListener("resize",Y2),ac.set(e,t)}function P3(e){ac.delete(e),ac.size||window.removeEventListener("resize",Y2)}function I3(e,t,n){const a=e.canvas,r=a&&jx(a);if(!r)return;const l=j2((h,f)=>{const d=r.clientWidth;n(h,f),d<r.clientWidth&&n()},window),o=new ResizeObserver(h=>{const f=h[0],d=f.contentRect.width,g=f.contentRect.height;d===0&&g===0||l(d,g)});return o.observe(r),H3(e,l),o}function jd(e,t,n){n&&n.disconnect(),t==="resize"&&P3(e)}function z3(e,t,n){const a=e.canvas,r=j2(l=>{e.ctx!==null&&n(F3(l,e))},e);return M3(a,t,r),r}class U3 extends G2{acquireContext(t,n){const a=t&&t.getContext&&t.getContext("2d");return a&&a.canvas===t?(O3(t,n),a):null}releaseContext(t){const n=t.canvas;if(!n[yh])return!1;const a=n[yh].initial;["height","width"].forEach(l=>{const o=a[l];st(o)?n.removeAttribute(l):n.setAttribute(l,o)});const r=a.style||{};return Object.keys(r).forEach(l=>{n.style[l]=r[l]}),n.width=n.width,delete n[yh],!0}addEventListener(t,n,a){this.removeEventListener(t,n);const r=t.$proxies||(t.$proxies={}),o={attach:L3,detach:B3,resize:I3}[n]||z3;r[n]=o(t,n,a)}removeEventListener(t,n){const a=t.$proxies||(t.$proxies={}),r=a[n];if(!r)return;({attach:jd,detach:jd,resize:jd}[n]||R3)(t,n,r),a[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,n,a,r){return AE(t,n,a,r)}isAttached(t){const n=t&&jx(t);return!!(n&&n.isConnected)}}function V3(e){return!kx()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?A3:U3}class Pa{constructor(){Ie(this,"x");Ie(this,"y");Ie(this,"active",!1);Ie(this,"options");Ie(this,"$animations")}tooltipPosition(t){const{x:n,y:a}=this.getProps(["x","y"],t);return{x:n,y:a}}hasValue(){return Jo(this.x)&&Jo(this.y)}getProps(t,n){const a=this.$animations;if(!n||!a)return this;const r={};return t.forEach(l=>{r[l]=a[l]&&a[l].active()?a[l]._to:this[l]}),r}}Ie(Pa,"defaults",{}),Ie(Pa,"defaultRoutes");function K3(e,t){const n=e.options.ticks,a=W3(e),r=Math.min(n.maxTicksLimit||a,a),l=n.major.enabled?X3(t):[],o=l.length,h=l[0],f=l[o-1],d=[];if(o>r)return Y3(t,d,l,o/r),d;const g=G3(l,t,r);if(o>0){let p,y;const w=o>1?Math.round((f-h)/(o-1)):null;for(qu(t,d,g,st(w)?0:h-w,h),p=0,y=o-1;p<y;p++)qu(t,d,g,l[p],l[p+1]);return qu(t,d,g,f,st(w)?t.length:f+w),d}return qu(t,d,g),d}function W3(e){const t=e.options.offset,n=e._tickSize(),a=e._length/n+(t?0:1),r=e._maxLength/n;return Math.floor(Math.min(a,r))}function G3(e,t,n){const a=q3(e),r=t.length/n;if(!a)return Math.max(r,1);const l=jN(a);for(let o=0,h=l.length-1;o<h;o++){const f=l[o];if(f>r)return f}return Math.max(r,1)}function X3(e){const t=[];let n,a;for(n=0,a=e.length;n<a;n++)e[n].major&&t.push(n);return t}function Y3(e,t,n,a){let r=0,l=n[0],o;for(a=Math.ceil(a),o=0;o<e.length;o++)o===l&&(t.push(e[o]),r++,l=n[r*a])}function qu(e,t,n,a,r){const l=et(a,0),o=Math.min(et(r,e.length),e.length);let h=0,f,d,g;for(n=Math.ceil(n),r&&(f=r-a,n=f/Math.floor(f/n)),g=l;g<0;)h++,g=Math.round(l+h*n);for(d=Math.max(l,0);d<o;d++)d===g&&(t.push(e[d]),h++,g=Math.round(l+h*n))}function q3(e){const t=e.length;let n,a;if(t<2)return!1;for(a=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==a)return!1;return a}const $3=e=>e==="left"?"right":e==="right"?"left":e,My=(e,t,n)=>t==="top"||t==="left"?e[t]+n:e[t]-n,Ry=(e,t)=>Math.min(t||e,e);function Fy(e,t){const n=[],a=e.length/t,r=e.length;let l=0;for(;l<r;l+=a)n.push(e[Math.floor(l)]);return n}function Q3(e,t,n){const a=e.ticks.length,r=Math.min(t,a-1),l=e._startPixel,o=e._endPixel,h=1e-6;let f=e.getPixelForTick(r),d;if(!(n&&(a===1?d=Math.max(f-l,o-f):t===0?d=(e.getPixelForTick(1)-f)/2:d=(f-e.getPixelForTick(r-1))/2,f+=r<t?d:-d,f<l-h||f>o+h)))return f}function Z3(e,t){dt(e,n=>{const a=n.gc,r=a.length/2;let l;if(r>t){for(l=0;l<r;++l)delete n.data[a[l]];a.splice(0,r)}})}function Eo(e){return e.drawTicks?e.tickLength:0}function Ly(e,t){if(!e.display)return 0;const n=Sn(e.font,t),a=oa(e.padding);return($t(e.text)?e.text.length:1)*n.lineHeight+a.height}function J3(e,t){return si(e,{scale:t,type:"scale"})}function eC(e,t,n){return si(e,{tick:n,index:t,type:"tick"})}function tC(e,t,n){let a=vx(e);return(n&&t!=="right"||!n&&t==="right")&&(a=$3(a)),a}function nC(e,t,n,a){const{top:r,left:l,bottom:o,right:h,chart:f}=e,{chartArea:d,scales:g}=f;let p=0,y,w,_;const b=o-r,T=h-l;if(e.isHorizontal()){if(w=An(a,l,h),lt(n)){const S=Object.keys(n)[0],E=n[S];_=g[S].getPixelForValue(E)+b-t}else n==="center"?_=(d.bottom+d.top)/2+b-t:_=My(e,n,t);y=h-l}else{if(lt(n)){const S=Object.keys(n)[0],E=n[S];w=g[S].getPixelForValue(E)-T+t}else n==="center"?w=(d.left+d.right)/2-T+t:w=My(e,n,t);_=An(a,o,r),p=n==="left"?-an:an}return{titleX:w,titleY:_,maxWidth:y,rotation:p}}class gl extends Pa{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,n){return t}getUserBounds(){let{_userMin:t,_userMax:n,_suggestedMin:a,_suggestedMax:r}=this;return t=Ya(t,Number.POSITIVE_INFINITY),n=Ya(n,Number.NEGATIVE_INFINITY),a=Ya(a,Number.POSITIVE_INFINITY),r=Ya(r,Number.NEGATIVE_INFINITY),{min:Ya(t,a),max:Ya(n,r),minDefined:Ea(t),maxDefined:Ea(n)}}getMinMax(t){let{min:n,max:a,minDefined:r,maxDefined:l}=this.getUserBounds(),o;if(r&&l)return{min:n,max:a};const h=this.getMatchingVisibleMetas();for(let f=0,d=h.length;f<d;++f)o=h[f].controller.getMinMax(this,t),r||(n=Math.min(n,o.min)),l||(a=Math.max(a,o.max));return n=l&&n>a?a:n,a=r&&n>a?n:a,{min:Ya(n,Ya(a,n)),max:Ya(a,Ya(n,a))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){At(this.options.beforeUpdate,[this])}update(t,n,a){const{beginAtZero:r,grace:l,ticks:o}=this.options,h=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=n,this._margins=a=Object.assign({left:0,right:0,top:0,bottom:0},a),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+a.left+a.right:this.height+a.top+a.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=oE(this,l,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const f=h<this.ticks.length;this._convertTicksToLabels(f?Fy(this.ticks,h):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=K3(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),f&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,n,a;this.isHorizontal()?(n=this.left,a=this.right):(n=this.top,a=this.bottom,t=!t),this._startPixel=n,this._endPixel=a,this._reversePixels=t,this._length=a-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){At(this.options.afterUpdate,[this])}beforeSetDimensions(){At(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){At(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),At(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){At(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const n=this.options.ticks;let a,r,l;for(a=0,r=t.length;a<r;a++)l=t[a],l.label=At(n.callback,[l.value,a,t],this)}afterTickToLabelConversion(){At(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){At(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,n=t.ticks,a=Ry(this.ticks.length,t.ticks.maxTicksLimit),r=n.minRotation||0,l=n.maxRotation;let o=r,h,f,d;if(!this._isVisible()||!n.display||r>=l||a<=1||!this.isHorizontal()){this.labelRotation=r;return}const g=this._getLabelSizes(),p=g.widest.width,y=g.highest.height,w=Dn(this.chart.width-p,0,this.maxWidth);h=t.offset?this.maxWidth/a:w/(a-1),p+6>h&&(h=w/(a-(t.offset?.5:1)),f=this.maxHeight-Eo(t.grid)-n.padding-Ly(t.title,this.chart.options.font),d=Math.sqrt(p*p+y*y),o=MN(Math.min(Math.asin(Dn((g.highest.height+6)/h,-1,1)),Math.asin(Dn(f/d,-1,1))-Math.asin(Dn(y/d,-1,1)))),o=Math.max(r,Math.min(l,o))),this.labelRotation=o}afterCalculateLabelRotation(){At(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){At(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:n,options:{ticks:a,title:r,grid:l}}=this,o=this._isVisible(),h=this.isHorizontal();if(o){const f=Ly(r,n.options.font);if(h?(t.width=this.maxWidth,t.height=Eo(l)+f):(t.height=this.maxHeight,t.width=Eo(l)+f),a.display&&this.ticks.length){const{first:d,last:g,widest:p,highest:y}=this._getLabelSizes(),w=a.padding*2,_=Tr(this.labelRotation),b=Math.cos(_),T=Math.sin(_);if(h){const S=a.mirror?0:T*p.width+b*y.height;t.height=Math.min(this.maxHeight,t.height+S+w)}else{const S=a.mirror?0:b*p.width+T*y.height;t.width=Math.min(this.maxWidth,t.width+S+w)}this._calculatePadding(d,g,T,b)}}this._handleMargins(),h?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,n,a,r){const{ticks:{align:l,padding:o},position:h}=this.options,f=this.labelRotation!==0,d=h!=="top"&&this.axis==="x";if(this.isHorizontal()){const g=this.getPixelForTick(0)-this.left,p=this.right-this.getPixelForTick(this.ticks.length-1);let y=0,w=0;f?d?(y=r*t.width,w=a*n.height):(y=a*t.height,w=r*n.width):l==="start"?w=n.width:l==="end"?y=t.width:l!=="inner"&&(y=t.width/2,w=n.width/2),this.paddingLeft=Math.max((y-g+o)*this.width/(this.width-g),0),this.paddingRight=Math.max((w-p+o)*this.width/(this.width-p),0)}else{let g=n.height/2,p=t.height/2;l==="start"?(g=0,p=t.height):l==="end"&&(g=n.height,p=0),this.paddingTop=g+o,this.paddingBottom=p+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){At(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:n}=this.options;return n==="top"||n==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let n,a;for(n=0,a=t.length;n<a;n++)st(t[n].label)&&(t.splice(n,1),a--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const n=this.options.ticks.sampleSize;let a=this.ticks;n<a.length&&(a=Fy(a,n)),this._labelSizes=t=this._computeLabelSizes(a,a.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,n,a){const{ctx:r,_longestTextCache:l}=this,o=[],h=[],f=Math.floor(n/Ry(n,a));let d=0,g=0,p,y,w,_,b,T,S,E,C,A,F;for(p=0;p<n;p+=f){if(_=t[p].label,b=this._resolveTickFontOptions(p),r.font=T=b.string,S=l[T]=l[T]||{data:{},gc:[]},E=b.lineHeight,C=A=0,!st(_)&&!$t(_))C=cy(r,S.data,S.gc,C,_),A=E;else if($t(_))for(y=0,w=_.length;y<w;++y)F=_[y],!st(F)&&!$t(F)&&(C=cy(r,S.data,S.gc,C,F),A+=E);o.push(C),h.push(A),d=Math.max(C,d),g=Math.max(A,g)}Z3(l,n);const K=o.indexOf(d),D=h.indexOf(g),H=M=>({width:o[M]||0,height:h[M]||0});return{first:H(0),last:H(n-1),widest:H(K),highest:H(D),widths:o,heights:h}}getLabelForValue(t){return t}getPixelForValue(t,n){return NaN}getValueForPixel(t){}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const n=this._startPixel+t*this._length;return FN(this._alignToPixels?Us(this.chart,n,0):n)}getDecimalForPixel(t){const n=(t-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:n}=this;return t<0&&n<0?n:t>0&&n>0?t:0}getContext(t){const n=this.ticks||[];if(t>=0&&t<n.length){const a=n[t];return a.$context||(a.$context=eC(this.getContext(),t,a))}return this.$context||(this.$context=J3(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,n=Tr(this.labelRotation),a=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),l=this._getLabelSizes(),o=t.autoSkipPadding||0,h=l?l.widest.width+o:0,f=l?l.highest.height+o:0;return this.isHorizontal()?f*a>h*r?h/a:f/r:f*r<h*a?f/a:h/r}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const n=this.axis,a=this.chart,r=this.options,{grid:l,position:o,border:h}=r,f=l.offset,d=this.isHorizontal(),p=this.ticks.length+(f?1:0),y=Eo(l),w=[],_=h.setContext(this.getContext()),b=_.display?_.width:0,T=b/2,S=function(ee){return Us(a,ee,b)};let E,C,A,F,K,D,H,M,B,I,te,q;if(o==="top")E=S(this.bottom),D=this.bottom-y,M=E-T,I=S(t.top)+T,q=t.bottom;else if(o==="bottom")E=S(this.top),I=t.top,q=S(t.bottom)-T,D=E+T,M=this.top+y;else if(o==="left")E=S(this.right),K=this.right-y,H=E-T,B=S(t.left)+T,te=t.right;else if(o==="right")E=S(this.left),B=t.left,te=S(t.right)-T,K=E+T,H=this.left+y;else if(n==="x"){if(o==="center")E=S((t.top+t.bottom)/2+.5);else if(lt(o)){const ee=Object.keys(o)[0],Q=o[ee];E=S(this.chart.scales[ee].getPixelForValue(Q))}I=t.top,q=t.bottom,D=E+T,M=D+y}else if(n==="y"){if(o==="center")E=S((t.left+t.right)/2);else if(lt(o)){const ee=Object.keys(o)[0],Q=o[ee];E=S(this.chart.scales[ee].getPixelForValue(Q))}K=E-T,H=K-y,B=t.left,te=t.right}const ae=et(r.ticks.maxTicksLimit,p),re=Math.max(1,Math.ceil(p/ae));for(C=0;C<p;C+=re){const ee=this.getContext(C),Q=l.setContext(ee),pe=h.setContext(ee),ye=Q.lineWidth,Y=Q.color,de=pe.dash||[],P=pe.dashOffset,Z=Q.tickWidth,k=Q.tickColor,V=Q.tickBorderDash||[],U=Q.tickBorderDashOffset;A=Q3(this,C,f),A!==void 0&&(F=Us(a,A,ye),d?K=H=B=te=F:D=M=I=q=F,w.push({tx1:K,ty1:D,tx2:H,ty2:M,x1:B,y1:I,x2:te,y2:q,width:ye,color:Y,borderDash:de,borderDashOffset:P,tickWidth:Z,tickColor:k,tickBorderDash:V,tickBorderDashOffset:U}))}return this._ticksLength=p,this._borderValue=E,w}_computeLabelItems(t){const n=this.axis,a=this.options,{position:r,ticks:l}=a,o=this.isHorizontal(),h=this.ticks,{align:f,crossAlign:d,padding:g,mirror:p}=l,y=Eo(a.grid),w=y+g,_=p?-g:w,b=-Tr(this.labelRotation),T=[];let S,E,C,A,F,K,D,H,M,B,I,te,q="middle";if(r==="top")K=this.bottom-_,D=this._getXAxisLabelAlignment();else if(r==="bottom")K=this.top+_,D=this._getXAxisLabelAlignment();else if(r==="left"){const re=this._getYAxisLabelAlignment(y);D=re.textAlign,F=re.x}else if(r==="right"){const re=this._getYAxisLabelAlignment(y);D=re.textAlign,F=re.x}else if(n==="x"){if(r==="center")K=(t.top+t.bottom)/2+w;else if(lt(r)){const re=Object.keys(r)[0],ee=r[re];K=this.chart.scales[re].getPixelForValue(ee)+w}D=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")F=(t.left+t.right)/2-w;else if(lt(r)){const re=Object.keys(r)[0],ee=r[re];F=this.chart.scales[re].getPixelForValue(ee)}D=this._getYAxisLabelAlignment(y).textAlign}n==="y"&&(f==="start"?q="top":f==="end"&&(q="bottom"));const ae=this._getLabelSizes();for(S=0,E=h.length;S<E;++S){C=h[S],A=C.label;const re=l.setContext(this.getContext(S));H=this.getPixelForTick(S)+l.labelOffset,M=this._resolveTickFontOptions(S),B=M.lineHeight,I=$t(A)?A.length:1;const ee=I/2,Q=re.color,pe=re.textStrokeColor,ye=re.textStrokeWidth;let Y=D;o?(F=H,D==="inner"&&(S===E-1?Y=this.options.reverse?"left":"right":S===0?Y=this.options.reverse?"right":"left":Y="center"),r==="top"?d==="near"||b!==0?te=-I*B+B/2:d==="center"?te=-ae.highest.height/2-ee*B+B:te=-ae.highest.height+B/2:d==="near"||b!==0?te=B/2:d==="center"?te=ae.highest.height/2-ee*B:te=ae.highest.height-I*B,p&&(te*=-1),b!==0&&!re.showLabelBackdrop&&(F+=B/2*Math.sin(b))):(K=H,te=(1-I)*B/2);let de;if(re.showLabelBackdrop){const P=oa(re.backdropPadding),Z=ae.heights[S],k=ae.widths[S];let V=te-P.top,U=0-P.left;switch(q){case"middle":V-=Z/2;break;case"bottom":V-=Z;break}switch(D){case"center":U-=k/2;break;case"right":U-=k;break;case"inner":S===E-1?U-=k:S>0&&(U-=k/2);break}de={left:U,top:V,width:k+P.width,height:Z+P.height,color:re.backdropColor}}T.push({label:A,font:M,textOffset:te,options:{rotation:b,color:Q,strokeColor:pe,strokeWidth:ye,textAlign:Y,textBaseline:q,translation:[F,K],backdrop:de}})}return T}_getXAxisLabelAlignment(){const{position:t,ticks:n}=this.options;if(-Tr(this.labelRotation))return t==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(t){const{position:n,ticks:{crossAlign:a,mirror:r,padding:l}}=this.options,o=this._getLabelSizes(),h=t+l,f=o.widest.width;let d,g;return n==="left"?r?(g=this.right+l,a==="near"?d="left":a==="center"?(d="center",g+=f/2):(d="right",g+=f)):(g=this.right-h,a==="near"?d="right":a==="center"?(d="center",g-=f/2):(d="left",g=this.left)):n==="right"?r?(g=this.left+l,a==="near"?d="right":a==="center"?(d="center",g-=f/2):(d="left",g-=f)):(g=this.left+h,a==="near"?d="left":a==="center"?(d="center",g+=f/2):(d="right",g=this.right)):d="right",{textAlign:d,x:g}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:n},left:a,top:r,width:l,height:o}=this;n&&(t.save(),t.fillStyle=n,t.fillRect(a,r,l,o),t.restore())}getLineWidthForValue(t){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(l=>l.value===t);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(t){const n=this.options.grid,a=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let l,o;const h=(f,d,g)=>{!g.width||!g.color||(a.save(),a.lineWidth=g.width,a.strokeStyle=g.color,a.setLineDash(g.borderDash||[]),a.lineDashOffset=g.borderDashOffset,a.beginPath(),a.moveTo(f.x,f.y),a.lineTo(d.x,d.y),a.stroke(),a.restore())};if(n.display)for(l=0,o=r.length;l<o;++l){const f=r[l];n.drawOnChartArea&&h({x:f.x1,y:f.y1},{x:f.x2,y:f.y2},f),n.drawTicks&&h({x:f.tx1,y:f.ty1},{x:f.tx2,y:f.ty2},{color:f.tickColor,width:f.tickWidth,borderDash:f.tickBorderDash,borderDashOffset:f.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:n,options:{border:a,grid:r}}=this,l=a.setContext(this.getContext()),o=a.display?l.width:0;if(!o)return;const h=r.setContext(this.getContext(0)).lineWidth,f=this._borderValue;let d,g,p,y;this.isHorizontal()?(d=Us(t,this.left,o)-o/2,g=Us(t,this.right,h)+h/2,p=y=f):(p=Us(t,this.top,o)-o/2,y=Us(t,this.bottom,h)+h/2,d=g=f),n.save(),n.lineWidth=l.width,n.strokeStyle=l.color,n.beginPath(),n.moveTo(d,p),n.lineTo(g,y),n.stroke(),n.restore()}drawLabels(t){if(!this.options.ticks.display)return;const a=this.ctx,r=this._computeLabelArea();r&&_x(a,r);const l=this.getLabelItems(t);for(const o of l){const h=o.options,f=o.font,d=o.label,g=o.textOffset;nc(a,d,0,g,f,h)}r&&Tx(a)}drawTitle(){const{ctx:t,options:{position:n,title:a,reverse:r}}=this;if(!a.display)return;const l=Sn(a.font),o=oa(a.padding),h=a.align;let f=l.lineHeight/2;n==="bottom"||n==="center"||lt(n)?(f+=o.bottom,$t(a.text)&&(f+=l.lineHeight*(a.text.length-1))):f+=o.top;const{titleX:d,titleY:g,maxWidth:p,rotation:y}=nC(this,f,n,h);nc(t,a.text,0,0,l,{color:a.color,maxWidth:p,rotation:y,textAlign:tC(h,n,r),textBaseline:"middle",translation:[d,g]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,n=t.ticks&&t.ticks.z||0,a=et(t.grid&&t.grid.z,-1),r=et(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==gl.prototype.draw?[{z:n,draw:l=>{this.draw(l)}}]:[{z:a,draw:l=>{this.drawBackground(),this.drawGrid(l),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:l=>{this.drawLabels(l)}}]}getMatchingVisibleMetas(t){const n=this.chart.getSortedVisibleDatasetMetas(),a=this.axis+"AxisID",r=[];let l,o;for(l=0,o=n.length;l<o;++l){const h=n[l];h[a]===this.id&&(!t||h.type===t)&&r.push(h)}return r}_resolveTickFontOptions(t){const n=this.options.ticks.setContext(this.getContext(t));return Sn(n.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class $u{constructor(t,n,a){this.type=t,this.scope=n,this.override=a,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const n=Object.getPrototypeOf(t);let a;sC(n)&&(a=this.register(n));const r=this.items,l=t.id,o=this.scope+"."+l;if(!l)throw new Error("class does not have id: "+t);return l in r||(r[l]=t,aC(t,o,a),this.override&&Ut.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const n=this.items,a=t.id,r=this.scope;a in n&&delete n[a],r&&a in Ut[r]&&(delete Ut[r][a],this.override&&delete ti[a])}}function aC(e,t,n){const a=er(Object.create(null),[n?Ut.get(n):{},Ut.get(t),e.defaults]);Ut.set(t,a),e.defaultRoutes&&rC(t,e.defaultRoutes),e.descriptors&&Ut.describe(t,e.descriptors)}function rC(e,t){Object.keys(t).forEach(n=>{const a=n.split("."),r=a.pop(),l=[e].concat(a).join("."),o=t[n].split("."),h=o.pop(),f=o.join(".");Ut.route(l,r,f,h)})}function sC(e){return"id"in e&&"defaults"in e}class iC{constructor(){this.controllers=new $u(Qs,"datasets",!0),this.elements=new $u(Pa,"elements"),this.plugins=new $u(Object,"plugins"),this.scales=new $u(gl,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,n,a){[...n].forEach(r=>{const l=a||this._getRegistryForType(r);a||l.isForType(r)||l===this.plugins&&r.id?this._exec(t,l,r):dt(r,o=>{const h=a||this._getRegistryForType(o);this._exec(t,h,o)})})}_exec(t,n,a){const r=px(t);At(a["before"+r],[],a),n[t](a),At(a["after"+r],[],a)}_getRegistryForType(t){for(let n=0;n<this._typedRegistries.length;n++){const a=this._typedRegistries[n];if(a.isForType(t))return a}return this.plugins}_get(t,n,a){const r=n.get(t);if(r===void 0)throw new Error('"'+t+'" is not a registered '+a+".");return r}}var Za=new iC;class lC{constructor(){this._init=[]}notify(t,n,a,r){n==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const l=r?this._descriptors(t).filter(r):this._descriptors(t),o=this._notify(l,t,n,a);return n==="afterDestroy"&&(this._notify(l,t,"stop"),this._notify(this._init,t,"uninstall")),o}_notify(t,n,a,r){r=r||{};for(const l of t){const o=l.plugin,h=o[a],f=[n,r,l.options];if(At(h,f,o)===!1&&r.cancelable)return!1}return!0}invalidate(){st(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),n}_createDescriptors(t,n){const a=t&&t.config,r=et(a.options&&a.options.plugins,{}),l=oC(a);return r===!1&&!n?[]:uC(t,l,r,n)}_notifyStateChanges(t){const n=this._oldCache||[],a=this._cache,r=(l,o)=>l.filter(h=>!o.some(f=>h.plugin.id===f.plugin.id));this._notify(r(n,a),t,"stop"),this._notify(r(a,n),t,"start")}}function oC(e){const t={},n=[],a=Object.keys(Za.plugins.items);for(let l=0;l<a.length;l++)n.push(Za.getPlugin(a[l]));const r=e.plugins||[];for(let l=0;l<r.length;l++){const o=r[l];n.indexOf(o)===-1&&(n.push(o),t[o.id]=!0)}return{plugins:n,localIds:t}}function cC(e,t){return!t&&e===!1?null:e===!0?{}:e}function uC(e,{plugins:t,localIds:n},a,r){const l=[],o=e.getContext();for(const h of t){const f=h.id,d=cC(a[f],r);d!==null&&l.push({plugin:h,options:hC(e.config,{plugin:h,local:n[f]},d,o)})}return l}function hC(e,{plugin:t,local:n},a,r){const l=e.pluginScopeKeys(t),o=e.getOptionScopes(a,l);return n&&t.defaults&&o.push(t.defaults),e.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function $d(e,t){const n=Ut.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function fC(e,t){let n=e;return e==="_index_"?n=t:e==="_value_"&&(n=t==="x"?"y":"x"),n}function dC(e,t){return e===t?"_index_":"_value_"}function By(e){if(e==="x"||e==="y"||e==="r")return e}function xC(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function Qd(e,...t){if(By(e))return e;for(const n of t){const a=n.axis||xC(n.position)||e.length>1&&By(e[0].toLowerCase());if(a)return a}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function Hy(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function gC(e,t){if(t.data&&t.data.datasets){const n=t.data.datasets.filter(a=>a.xAxisID===e||a.yAxisID===e);if(n.length)return Hy(e,"x",n[0])||Hy(e,"y",n[0])}return{}}function mC(e,t){const n=ti[e.type]||{scales:{}},a=t.scales||{},r=$d(e.type,t),l=Object.create(null);return Object.keys(a).forEach(o=>{const h=a[o];if(!lt(h))return console.error(`Invalid scale configuration for scale: ${o}`);if(h._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const f=Qd(o,h,gC(o,e),Ut.scales[h.type]),d=dC(f,r),g=n.scales||{};l[o]=Ho(Object.create(null),[{axis:f},h,g[f],g[d]])}),e.data.datasets.forEach(o=>{const h=o.type||e.type,f=o.indexAxis||$d(h,t),g=(ti[h]||{}).scales||{};Object.keys(g).forEach(p=>{const y=fC(p,f),w=o[y+"AxisID"]||y;l[w]=l[w]||Object.create(null),Ho(l[w],[{axis:y},a[w],g[p]])})}),Object.keys(l).forEach(o=>{const h=l[o];Ho(h,[Ut.scales[h.type],Ut.scale])}),l}function q2(e){const t=e.options||(e.options={});t.plugins=et(t.plugins,{}),t.scales=mC(e,t)}function $2(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function pC(e){return e=e||{},e.data=$2(e.data),q2(e),e}const Py=new Map,Q2=new Set;function Qu(e,t){let n=Py.get(e);return n||(n=t(),Py.set(e,n),Q2.add(n)),n}const Co=(e,t,n)=>{const a=ei(t,n);a!==void 0&&e.add(a)};class yC{constructor(t){this._config=pC(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=$2(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),q2(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Qu(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,n){return Qu(`${t}.transition.${n}`,()=>[[`datasets.${t}.transitions.${n}`,`transitions.${n}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,n){return Qu(`${t}-${n}`,()=>[[`datasets.${t}.elements.${n}`,`datasets.${t}`,`elements.${n}`,""]])}pluginScopeKeys(t){const n=t.id,a=this.type;return Qu(`${a}-plugin-${n}`,()=>[[`plugins.${n}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,n){const a=this._scopeCache;let r=a.get(t);return(!r||n)&&(r=new Map,a.set(t,r)),r}getOptionScopes(t,n,a){const{options:r,type:l}=this,o=this._cachedScopes(t,a),h=o.get(n);if(h)return h;const f=new Set;n.forEach(g=>{t&&(f.add(t),g.forEach(p=>Co(f,t,p))),g.forEach(p=>Co(f,r,p)),g.forEach(p=>Co(f,ti[l]||{},p)),g.forEach(p=>Co(f,Ut,p)),g.forEach(p=>Co(f,Xd,p))});const d=Array.from(f);return d.length===0&&d.push(Object.create(null)),Q2.has(n)&&o.set(n,d),d}chartOptionScopes(){const{options:t,type:n}=this;return[t,ti[n]||{},Ut.datasets[n]||{},{type:n},Ut,Xd]}resolveNamedOptions(t,n,a,r=[""]){const l={$shared:!0},{resolver:o,subPrefixes:h}=Iy(this._resolverCache,t,r);let f=o;if(bC(o,n)){l.$shared=!1,a=gs(a)?a():a;const d=this.createResolver(t,a,h);f=cl(o,a,d)}for(const d of n)l[d]=f[d];return l}createResolver(t,n,a=[""],r){const{resolver:l}=Iy(this._resolverCache,t,a);return lt(n)?cl(l,n,void 0,r):l}}function Iy(e,t,n){let a=e.get(t);a||(a=new Map,e.set(t,a));const r=n.join();let l=a.get(r);return l||(l={resolver:Nx(t,n),subPrefixes:n.filter(h=>!h.toLowerCase().includes("hover"))},a.set(r,l)),l}const vC=e=>lt(e)&&Object.getOwnPropertyNames(e).some(t=>gs(e[t]));function bC(e,t){const{isScriptable:n,isIndexable:a}=M2(e);for(const r of t){const l=n(r),o=a(r),h=(o||l)&&e[r];if(l&&(gs(h)||vC(h))||o&&$t(h))return!0}return!1}var wC="4.4.9";const _C=["top","bottom","left","right","chartArea"];function zy(e,t){return e==="top"||e==="bottom"||_C.indexOf(e)===-1&&t==="x"}function Uy(e,t){return function(n,a){return n[e]===a[e]?n[t]-a[t]:n[e]-a[e]}}function Vy(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),At(n&&n.onComplete,[e],t)}function TC(e){const t=e.chart,n=t.options.animation;At(n&&n.onProgress,[e],t)}function Z2(e){return kx()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const vh={},Ky=e=>{const t=Z2(e);return Object.values(vh).filter(n=>n.canvas===t).pop()};function SC(e,t,n){const a=Object.keys(e);for(const r of a){const l=+r;if(l>=t){const o=e[r];delete e[r],(n>0||l>t)&&(e[l+n]=o)}}}function NC(e,t,n,a){return!n||e.type==="mouseout"?null:a?t:e}var ls;let ii=(ls=class{static register(...t){Za.add(...t),Wy()}static unregister(...t){Za.remove(...t),Wy()}constructor(t,n){const a=this.config=new yC(n),r=Z2(t),l=Ky(r);if(l)throw new Error("Canvas is already in use. Chart with ID '"+l.id+"' must be destroyed before the canvas with ID '"+l.canvas.id+"' can be reused.");const o=a.createResolver(a.chartOptionScopes(),this.getContext());this.platform=new(a.platform||V3(r)),this.platform.updateConfig(a);const h=this.platform.acquireContext(r,o.aspectRatio),f=h&&h.canvas,d=f&&f.height,g=f&&f.width;if(this.id=bN(),this.ctx=h,this.canvas=f,this.width=g,this.height=d,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new lC,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=PN(p=>this.update(p),o.resizeDelay||0),this._dataChanges=[],vh[this.id]=this,!h||!f){console.error("Failed to create chart: can't acquire context from the given item");return}br.listen(this,"complete",Vy),br.listen(this,"progress",TC),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:n},width:a,height:r,_aspectRatio:l}=this;return st(t)?n&&l?l:r?a/r:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return Za}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():dy(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return uy(this.canvas,this.ctx),this}stop(){return br.stop(this),this}resize(t,n){br.running(this)?this._resizeBeforeDraw={width:t,height:n}:this._resize(t,n)}_resize(t,n){const a=this.options,r=this.canvas,l=a.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,t,n,l),h=a.devicePixelRatio||this.platform.getDevicePixelRatio(),f=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,dy(this,h,!0)&&(this.notifyPlugins("resize",{size:o}),At(a.onResize,[this,o],this),this.attached&&this._doResize(f)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};dt(n,(a,r)=>{a.id=r})}buildOrUpdateScales(){const t=this.options,n=t.scales,a=this.scales,r=Object.keys(a).reduce((o,h)=>(o[h]=!1,o),{});let l=[];n&&(l=l.concat(Object.keys(n).map(o=>{const h=n[o],f=Qd(o,h),d=f==="r",g=f==="x";return{options:h,dposition:d?"chartArea":g?"bottom":"left",dtype:d?"radialLinear":g?"category":"linear"}}))),dt(l,o=>{const h=o.options,f=h.id,d=Qd(f,h),g=et(h.type,o.dtype);(h.position===void 0||zy(h.position,d)!==zy(o.dposition))&&(h.position=o.dposition),r[f]=!0;let p=null;if(f in a&&a[f].type===g)p=a[f];else{const y=Za.getScale(g);p=new y({id:f,type:g,ctx:this.ctx,chart:this}),a[p.id]=p}p.init(h,t)}),dt(r,(o,h)=>{o||delete a[h]}),dt(a,o=>{Sa.configure(this,o,o.options),Sa.addBox(this,o)})}_updateMetasets(){const t=this._metasets,n=this.data.datasets.length,a=t.length;if(t.sort((r,l)=>r.index-l.index),a>n){for(let r=n;r<a;++r)this._destroyDatasetMeta(r);t.splice(n,a-n)}this._sortedMetasets=t.slice(0).sort(Uy("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:n}}=this;t.length>n.length&&delete this._stacks,t.forEach((a,r)=>{n.filter(l=>l===a._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const t=[],n=this.data.datasets;let a,r;for(this._removeUnreferencedMetasets(),a=0,r=n.length;a<r;a++){const l=n[a];let o=this.getDatasetMeta(a);const h=l.type||this.config.type;if(o.type&&o.type!==h&&(this._destroyDatasetMeta(a),o=this.getDatasetMeta(a)),o.type=h,o.indexAxis=l.indexAxis||$d(h,this.options),o.order=l.order||0,o.index=a,o.label=""+l.label,o.visible=this.isDatasetVisible(a),o.controller)o.controller.updateIndex(a),o.controller.linkScales();else{const f=Za.getController(h),{datasetElementType:d,dataElementType:g}=Ut.datasets[h];Object.assign(f,{dataElementType:Za.getElement(g),datasetElementType:d&&Za.getElement(d)}),o.controller=new f(this,a),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){dt(this.data.datasets,(t,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const n=this.config;n.update();const a=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!a.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const l=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let d=0,g=this.data.datasets.length;d<g;d++){const{controller:p}=this.getDatasetMeta(d),y=!r&&l.indexOf(p)===-1;p.buildOrUpdateElements(y),o=Math.max(+p.getMaxOverflow(),o)}o=this._minPadding=a.layout.autoPadding?o:0,this._updateLayout(o),r||dt(l,d=>{d.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(Uy("z","_idx"));const{_active:h,_lastEvent:f}=this;f?this._eventHandler(f,!0):h.length&&this._updateHoverStyles(h,h,!0),this.render()}_updateScales(){dt(this.scales,t=>{Sa.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,n=new Set(Object.keys(this._listeners)),a=new Set(t.events);(!ey(n,a)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,n=this._getUniformDataChanges()||[];for(const{method:a,start:r,count:l}of n){const o=a==="_removeElements"?-l:l;SC(t,r,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const n=this.data.datasets.length,a=l=>new Set(t.filter(o=>o[0]===l).map((o,h)=>h+","+o.splice(1).join(","))),r=a(0);for(let l=1;l<n;l++)if(!ey(r,a(l)))return;return Array.from(r).map(l=>l.split(",")).map(l=>({method:l[1],start:+l[2],count:+l[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Sa.update(this,this.width,this.height,t);const n=this.chartArea,a=n.width<=0||n.height<=0;this._layers=[],dt(this.boxes,r=>{a&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,l)=>{r._idx=l}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let n=0,a=this.data.datasets.length;n<a;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,a=this.data.datasets.length;n<a;++n)this._updateDataset(n,gs(t)?t({datasetIndex:n}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,n){const a=this.getDatasetMeta(t),r={meta:a,index:t,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(a.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(br.has(this)?this.attached&&!br.running(this)&&br.start(this):(this.draw(),Vy({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:a,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(a,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(this.chartArea);for(this._drawDatasets();t<n.length;++t)n[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const n=this._sortedMetasets,a=[];let r,l;for(r=0,l=n.length;r<l;++r){const o=n[r];(!t||o.visible)&&a.push(o)}return a}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let n=t.length-1;n>=0;--n)this._drawDataset(t[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const n=this.ctx,a={meta:t,index:t.index,cancelable:!0},r=WE(this,t);this.notifyPlugins("beforeDatasetDraw",a)!==!1&&(r&&_x(n,r),t.controller.draw(),r&&Tx(n),a.cancelable=!1,this.notifyPlugins("afterDatasetDraw",a))}isPointInArea(t){return tc(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,n,a,r){const l=_3.modes[n];return typeof l=="function"?l(this,t,a,r):[]}getDatasetMeta(t){const n=this.data.datasets[t],a=this._metasets;let r=a.filter(l=>l&&l._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:t,_dataset:n,_parsed:[],_sorted:!1},a.push(r)),r}getContext(){return this.$context||(this.$context=si(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const n=this.data.datasets[t];if(!n)return!1;const a=this.getDatasetMeta(t);return typeof a.hidden=="boolean"?!a.hidden:!n.hidden}setDatasetVisibility(t,n){const a=this.getDatasetMeta(t);a.hidden=!n}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,n,a){const r=a?"show":"hide",l=this.getDatasetMeta(t),o=l.controller._resolveAnimations(void 0,r);Zo(n)?(l.data[n].hidden=!a,this.update()):(this.setDatasetVisibility(t,a),o.update(l,{visible:a}),this.update(h=>h.datasetIndex===t?r:void 0))}hide(t,n){this._updateVisibility(t,n,!1)}show(t,n){this._updateVisibility(t,n,!0)}_destroyDatasetMeta(t){const n=this._metasets[t];n&&n.controller&&n.controller._destroy(),delete this._metasets[t]}_stop(){let t,n;for(this.stop(),br.remove(this),t=0,n=this.data.datasets.length;t<n;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:n}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),uy(t,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete vh[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,n=this.platform,a=(l,o)=>{n.addEventListener(this,l,o),t[l]=o},r=(l,o,h)=>{l.offsetX=o,l.offsetY=h,this._eventHandler(l)};dt(this.options.events,l=>a(l,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,n=this.platform,a=(f,d)=>{n.addEventListener(this,f,d),t[f]=d},r=(f,d)=>{t[f]&&(n.removeEventListener(this,f,d),delete t[f])},l=(f,d)=>{this.canvas&&this.resize(f,d)};let o;const h=()=>{r("attach",h),this.attached=!0,this.resize(),a("resize",l),a("detach",o)};o=()=>{this.attached=!1,r("resize",l),this._stop(),this._resize(0,0),a("attach",h)},n.isAttached(this.canvas)?h():o()}unbindEvents(){dt(this._listeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._listeners={},dt(this._responsiveListeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,n,a){const r=a?"set":"remove";let l,o,h,f;for(n==="dataset"&&(l=this.getDatasetMeta(t[0].datasetIndex),l.controller["_"+r+"DatasetHoverStyle"]()),h=0,f=t.length;h<f;++h){o=t[h];const d=o&&this.getDatasetMeta(o.datasetIndex).controller;d&&d[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const n=this._active||[],a=t.map(({datasetIndex:l,index:o})=>{const h=this.getDatasetMeta(l);if(!h)throw new Error("No dataset found at index "+l);return{datasetIndex:l,element:h.data[o],index:o}});!wh(a,n)&&(this._active=a,this._lastEvent=null,this._updateHoverStyles(a,n))}notifyPlugins(t,n,a){return this._plugins.notify(this,t,n,a)}isPluginEnabled(t){return this._plugins._cache.filter(n=>n.plugin.id===t).length===1}_updateHoverStyles(t,n,a){const r=this.options.hover,l=(f,d)=>f.filter(g=>!d.some(p=>g.datasetIndex===p.datasetIndex&&g.index===p.index)),o=l(n,t),h=a?t:l(t,n);o.length&&this.updateHoverStyle(o,r.mode,!1),h.length&&r.mode&&this.updateHoverStyle(h,r.mode,!0)}_eventHandler(t,n){const a={event:t,replay:n,cancelable:!0,inChartArea:this.isPointInArea(t)},r=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",a,r)===!1)return;const l=this._handleEvent(t,n,a.inChartArea);return a.cancelable=!1,this.notifyPlugins("afterEvent",a,r),(l||a.changed)&&this.render(),this}_handleEvent(t,n,a){const{_active:r=[],options:l}=this,o=n,h=this._getActiveElements(t,r,a,o),f=EN(t),d=NC(t,this._lastEvent,a,f);a&&(this._lastEvent=null,At(l.onHover,[t,h,this],this),f&&At(l.onClick,[t,h,this],this));const g=!wh(h,r);return(g||n)&&(this._active=h,this._updateHoverStyles(h,r,n)),this._lastEvent=d,g}_getActiveElements(t,n,a,r){if(t.type==="mouseout")return[];if(!a)return n;const l=this.options.hover;return this.getElementsAtEventForMode(t,l.mode,l,r)}},Ie(ls,"defaults",Ut),Ie(ls,"instances",vh),Ie(ls,"overrides",ti),Ie(ls,"registry",Za),Ie(ls,"version",wC),Ie(ls,"getChart",Ky),ls);function Wy(){return dt(ii.instances,e=>e._plugins.invalidate())}function EC(e,t,n){const{startAngle:a,pixelMargin:r,x:l,y:o,outerRadius:h,innerRadius:f}=t;let d=r/h;e.beginPath(),e.arc(l,o,h,a-d,n+d),f>r?(d=r/f,e.arc(l,o,f,n+d,a-d,!0)):e.arc(l,o,r,n+an,a-an),e.closePath(),e.clip()}function CC(e){return Sx(e,["outerStart","outerEnd","innerStart","innerEnd"])}function kC(e,t,n,a){const r=CC(e.options.borderRadius),l=(n-t)/2,o=Math.min(l,a*t/2),h=f=>{const d=(n-Math.min(l,f))*a/2;return Dn(f,0,Math.min(l,d))};return{outerStart:h(r.outerStart),outerEnd:h(r.outerEnd),innerStart:Dn(r.innerStart,0,o),innerEnd:Dn(r.innerEnd,0,o)}}function Yi(e,t,n,a){return{x:n+e*Math.cos(t),y:a+e*Math.sin(t)}}function Ch(e,t,n,a,r,l){const{x:o,y:h,startAngle:f,pixelMargin:d,innerRadius:g}=t,p=Math.max(t.outerRadius+a+n-d,0),y=g>0?g+a+n+d:0;let w=0;const _=r-f;if(a){const re=g>0?g-a:0,ee=p>0?p-a:0,Q=(re+ee)/2,pe=Q!==0?_*Q/(Q+a):_;w=(_-pe)/2}const b=Math.max(.001,_*p-n/Vt)/p,T=(_-b)/2,S=f+T+w,E=r-T-w,{outerStart:C,outerEnd:A,innerStart:F,innerEnd:K}=kC(t,y,p,E-S),D=p-C,H=p-A,M=S+C/D,B=E-A/H,I=y+F,te=y+K,q=S+F/I,ae=E-K/te;if(e.beginPath(),l){const re=(M+B)/2;if(e.arc(o,h,p,M,re),e.arc(o,h,p,re,B),A>0){const ye=Yi(H,B,o,h);e.arc(ye.x,ye.y,A,B,E+an)}const ee=Yi(te,E,o,h);if(e.lineTo(ee.x,ee.y),K>0){const ye=Yi(te,ae,o,h);e.arc(ye.x,ye.y,K,E+an,ae+Math.PI)}const Q=(E-K/y+(S+F/y))/2;if(e.arc(o,h,y,E-K/y,Q,!0),e.arc(o,h,y,Q,S+F/y,!0),F>0){const ye=Yi(I,q,o,h);e.arc(ye.x,ye.y,F,q+Math.PI,S-an)}const pe=Yi(D,S,o,h);if(e.lineTo(pe.x,pe.y),C>0){const ye=Yi(D,M,o,h);e.arc(ye.x,ye.y,C,S-an,M)}}else{e.moveTo(o,h);const re=Math.cos(M)*p+o,ee=Math.sin(M)*p+h;e.lineTo(re,ee);const Q=Math.cos(B)*p+o,pe=Math.sin(B)*p+h;e.lineTo(Q,pe)}e.closePath()}function jC(e,t,n,a,r){const{fullCircles:l,startAngle:o,circumference:h}=t;let f=t.endAngle;if(l){Ch(e,t,n,a,f,r);for(let d=0;d<l;++d)e.fill();isNaN(h)||(f=o+(h%zt||zt))}return Ch(e,t,n,a,f,r),e.fill(),f}function AC(e,t,n,a,r){const{fullCircles:l,startAngle:o,circumference:h,options:f}=t,{borderWidth:d,borderJoinStyle:g,borderDash:p,borderDashOffset:y}=f,w=f.borderAlign==="inner";if(!d)return;e.setLineDash(p||[]),e.lineDashOffset=y,w?(e.lineWidth=d*2,e.lineJoin=g||"round"):(e.lineWidth=d,e.lineJoin=g||"bevel");let _=t.endAngle;if(l){Ch(e,t,n,a,_,r);for(let b=0;b<l;++b)e.stroke();isNaN(h)||(_=o+(h%zt||zt))}w&&EC(e,t,_),l||(Ch(e,t,n,a,_,r),e.stroke())}class Sr extends Pa{constructor(n){super();Ie(this,"circumference");Ie(this,"endAngle");Ie(this,"fullCircles");Ie(this,"innerRadius");Ie(this,"outerRadius");Ie(this,"pixelMargin");Ie(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,a,r){const l=this.getProps(["x","y"],r),{angle:o,distance:h}=N2(l,{x:n,y:a}),{startAngle:f,endAngle:d,innerRadius:g,outerRadius:p,circumference:y}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),w=(this.options.spacing+this.options.borderWidth)/2,_=et(y,d-f),b=ec(o,f,d)&&f!==d,T=_>=zt||b,S=us(h,g+w,p+w);return T&&S}getCenterPoint(n){const{x:a,y:r,startAngle:l,endAngle:o,innerRadius:h,outerRadius:f}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:d,spacing:g}=this.options,p=(l+o)/2,y=(h+f+g+d)/2;return{x:a+Math.cos(p)*y,y:r+Math.sin(p)*y}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:a,circumference:r}=this,l=(a.offset||0)/4,o=(a.spacing||0)/2,h=a.circular;if(this.pixelMargin=a.borderAlign==="inner"?.33:0,this.fullCircles=r>zt?Math.floor(r/zt):0,r===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const f=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(f)*l,Math.sin(f)*l);const d=1-Math.sin(Math.min(Vt,r||0)),g=l*d;n.fillStyle=a.backgroundColor,n.strokeStyle=a.borderColor,jC(n,this,g,o,h),AC(n,this,g,o,h),n.restore()}}Ie(Sr,"id","arc"),Ie(Sr,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),Ie(Sr,"defaultRoutes",{backgroundColor:"backgroundColor"}),Ie(Sr,"descriptors",{_scriptable:!0,_indexable:n=>n!=="borderDash"});function J2(e,t,n=t){e.lineCap=et(n.borderCapStyle,t.borderCapStyle),e.setLineDash(et(n.borderDash,t.borderDash)),e.lineDashOffset=et(n.borderDashOffset,t.borderDashOffset),e.lineJoin=et(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=et(n.borderWidth,t.borderWidth),e.strokeStyle=et(n.borderColor,t.borderColor)}function DC(e,t,n){e.lineTo(n.x,n.y)}function OC(e){return e.stepped?JN:e.tension||e.cubicInterpolationMode==="monotone"?eE:DC}function eb(e,t,n={}){const a=e.length,{start:r=0,end:l=a-1}=n,{start:o,end:h}=t,f=Math.max(r,o),d=Math.min(l,h),g=r<o&&l<o||r>h&&l>h;return{count:a,start:f,loop:t.loop,ilen:d<f&&!g?a+d-f:d-f}}function MC(e,t,n,a){const{points:r,options:l}=t,{count:o,start:h,loop:f,ilen:d}=eb(r,n,a),g=OC(l);let{move:p=!0,reverse:y}=a||{},w,_,b;for(w=0;w<=d;++w)_=r[(h+(y?d-w:w))%o],!_.skip&&(p?(e.moveTo(_.x,_.y),p=!1):g(e,b,_,y,l.stepped),b=_);return f&&(_=r[(h+(y?d:0))%o],g(e,b,_,y,l.stepped)),!!f}function RC(e,t,n,a){const r=t.points,{count:l,start:o,ilen:h}=eb(r,n,a),{move:f=!0,reverse:d}=a||{};let g=0,p=0,y,w,_,b,T,S;const E=A=>(o+(d?h-A:A))%l,C=()=>{b!==T&&(e.lineTo(g,T),e.lineTo(g,b),e.lineTo(g,S))};for(f&&(w=r[E(0)],e.moveTo(w.x,w.y)),y=0;y<=h;++y){if(w=r[E(y)],w.skip)continue;const A=w.x,F=w.y,K=A|0;K===_?(F<b?b=F:F>T&&(T=F),g=(p*g+A)/++p):(C(),e.lineTo(A,F),_=K,p=0,b=T=F),S=F}C()}function Zd(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!n?RC:MC}function FC(e){return e.stepped?OE:e.tension||e.cubicInterpolationMode==="monotone"?ME:Gs}function LC(e,t,n,a){let r=t._path;r||(r=t._path=new Path2D,t.path(r,n,a)&&r.closePath()),J2(e,t.options),e.stroke(r)}function BC(e,t,n,a){const{segments:r,options:l}=t,o=Zd(t);for(const h of r)J2(e,l,h.style),e.beginPath(),o(e,t,h,{start:n,end:n+a-1})&&e.closePath(),e.stroke()}const HC=typeof Path2D=="function";function PC(e,t,n,a){HC&&!t.options.segment?LC(e,t,n,a):BC(e,t,n,a)}class el extends Pa{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,n){const a=this.options;if((a.tension||a.cubicInterpolationMode==="monotone")&&!a.stepped&&!this._pointsUpdated){const r=a.spanGaps?this._loop:this._fullLoop;SE(this._points,a,t,r,n),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=zE(this,this.options.segment))}first(){const t=this.segments,n=this.points;return t.length&&n[t[0].start]}last(){const t=this.segments,n=this.points,a=t.length;return a&&n[t[a-1].end]}interpolate(t,n){const a=this.options,r=t[n],l=this.points,o=HE(this,{property:n,start:r,end:r});if(!o.length)return;const h=[],f=FC(a);let d,g;for(d=0,g=o.length;d<g;++d){const{start:p,end:y}=o[d],w=l[p],_=l[y];if(w===_){h.push(w);continue}const b=Math.abs((r-w[n])/(_[n]-w[n])),T=f(w,_,b,a.stepped);T[n]=t[n],h.push(T)}return h.length===1?h[0]:h}pathSegment(t,n,a){return Zd(this)(t,this,n,a)}path(t,n,a){const r=this.segments,l=Zd(this);let o=this._loop;n=n||0,a=a||this.points.length-n;for(const h of r)o&=l(t,this,h,{start:n,end:n+a-1});return!!o}draw(t,n,a,r){const l=this.options||{};(this.points||[]).length&&l.borderWidth&&(t.save(),PC(t,this,a,r),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Ie(el,"id","line"),Ie(el,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Ie(el,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Ie(el,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function Gy(e,t,n,a){const r=e.options,{[n]:l}=e.getProps([n],a);return Math.abs(t-l)<r.radius+r.hitRadius}class rl extends Pa{constructor(n){super();Ie(this,"parsed");Ie(this,"skip");Ie(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,a,r){const l=this.options,{x:o,y:h}=this.getProps(["x","y"],r);return Math.pow(n-o,2)+Math.pow(a-h,2)<Math.pow(l.hitRadius+l.radius,2)}inXRange(n,a){return Gy(this,n,"x",a)}inYRange(n,a){return Gy(this,n,"y",a)}getCenterPoint(n){const{x:a,y:r}=this.getProps(["x","y"],n);return{x:a,y:r}}size(n){n=n||this.options||{};let a=n.radius||0;a=Math.max(a,a&&n.hoverRadius||0);const r=a&&n.borderWidth||0;return(a+r)*2}draw(n,a){const r=this.options;this.skip||r.radius<.1||!tc(this,a,this.size(r)/2)||(n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.fillStyle=r.backgroundColor,Yd(n,r,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}Ie(rl,"id","point"),Ie(rl,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Ie(rl,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function tb(e,t){const{x:n,y:a,base:r,width:l,height:o}=e.getProps(["x","y","base","width","height"],t);let h,f,d,g,p;return e.horizontal?(p=o/2,h=Math.min(n,r),f=Math.max(n,r),d=a-p,g=a+p):(p=l/2,h=n-p,f=n+p,d=Math.min(a,r),g=Math.max(a,r)),{left:h,top:d,right:f,bottom:g}}function hs(e,t,n,a){return e?0:Dn(t,n,a)}function IC(e,t,n){const a=e.options.borderWidth,r=e.borderSkipped,l=O2(a);return{t:hs(r.top,l.top,0,n),r:hs(r.right,l.right,0,t),b:hs(r.bottom,l.bottom,0,n),l:hs(r.left,l.left,0,t)}}function zC(e,t,n){const{enableBorderRadius:a}=e.getProps(["enableBorderRadius"]),r=e.options.borderRadius,l=nl(r),o=Math.min(t,n),h=e.borderSkipped,f=a||lt(r);return{topLeft:hs(!f||h.top||h.left,l.topLeft,0,o),topRight:hs(!f||h.top||h.right,l.topRight,0,o),bottomLeft:hs(!f||h.bottom||h.left,l.bottomLeft,0,o),bottomRight:hs(!f||h.bottom||h.right,l.bottomRight,0,o)}}function UC(e){const t=tb(e),n=t.right-t.left,a=t.bottom-t.top,r=IC(e,n/2,a/2),l=zC(e,n/2,a/2);return{outer:{x:t.left,y:t.top,w:n,h:a,radius:l},inner:{x:t.left+r.l,y:t.top+r.t,w:n-r.l-r.r,h:a-r.t-r.b,radius:{topLeft:Math.max(0,l.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,l.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,l.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,l.bottomRight-Math.max(r.b,r.r))}}}}function Ad(e,t,n,a){const r=t===null,l=n===null,h=e&&!(r&&l)&&tb(e,a);return h&&(r||us(t,h.left,h.right))&&(l||us(n,h.top,h.bottom))}function VC(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function KC(e,t){e.rect(t.x,t.y,t.w,t.h)}function Dd(e,t,n={}){const a=e.x!==n.x?-t:0,r=e.y!==n.y?-t:0,l=(e.x+e.w!==n.x+n.w?t:0)-a,o=(e.y+e.h!==n.y+n.h?t:0)-r;return{x:e.x+a,y:e.y+r,w:e.w+l,h:e.h+o,radius:e.radius}}class Zs extends Pa{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:n,options:{borderColor:a,backgroundColor:r}}=this,{inner:l,outer:o}=UC(this),h=VC(o.radius)?Sh:KC;t.save(),(o.w!==l.w||o.h!==l.h)&&(t.beginPath(),h(t,Dd(o,n,l)),t.clip(),h(t,Dd(l,-n,o)),t.fillStyle=a,t.fill("evenodd")),t.beginPath(),h(t,Dd(l,n)),t.fillStyle=r,t.fill(),t.restore()}inRange(t,n,a){return Ad(this,t,n,a)}inXRange(t,n){return Ad(this,t,null,n)}inYRange(t,n){return Ad(this,null,t,n)}getCenterPoint(t){const{x:n,y:a,base:r,horizontal:l}=this.getProps(["x","y","base","horizontal"],t);return{x:l?(n+r)/2:n,y:l?a:(a+r)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}Ie(Zs,"id","bar"),Ie(Zs,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Ie(Zs,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const Xy=(e,t)=>{let{boxHeight:n=t,boxWidth:a=t}=e;return e.usePointStyle&&(n=Math.min(n,t),a=e.pointStyleWidth||Math.min(a,t)),{boxWidth:a,boxHeight:n,itemHeight:Math.max(t,n)}},WC=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class Yy extends Pa{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n,a){this.maxWidth=t,this.maxHeight=n,this._margins=a,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let n=At(t.generateLabels,[this.chart],this)||[];t.filter&&(n=n.filter(a=>t.filter(a,this.chart.data))),t.sort&&(n=n.sort((a,r)=>t.sort(a,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:t,ctx:n}=this;if(!t.display){this.width=this.height=0;return}const a=t.labels,r=Sn(a.font),l=r.size,o=this._computeTitleHeight(),{boxWidth:h,itemHeight:f}=Xy(a,l);let d,g;n.font=r.string,this.isHorizontal()?(d=this.maxWidth,g=this._fitRows(o,l,h,f)+10):(g=this.maxHeight,d=this._fitCols(o,r,h,f)+10),this.width=Math.min(d,t.maxWidth||this.maxWidth),this.height=Math.min(g,t.maxHeight||this.maxHeight)}_fitRows(t,n,a,r){const{ctx:l,maxWidth:o,options:{labels:{padding:h}}}=this,f=this.legendHitBoxes=[],d=this.lineWidths=[0],g=r+h;let p=t;l.textAlign="left",l.textBaseline="middle";let y=-1,w=-g;return this.legendItems.forEach((_,b)=>{const T=a+n/2+l.measureText(_.text).width;(b===0||d[d.length-1]+T+2*h>o)&&(p+=g,d[d.length-(b>0?0:1)]=0,w+=g,y++),f[b]={left:0,top:w,row:y,width:T,height:r},d[d.length-1]+=T+h}),p}_fitCols(t,n,a,r){const{ctx:l,maxHeight:o,options:{labels:{padding:h}}}=this,f=this.legendHitBoxes=[],d=this.columnSizes=[],g=o-t;let p=h,y=0,w=0,_=0,b=0;return this.legendItems.forEach((T,S)=>{const{itemWidth:E,itemHeight:C}=GC(a,n,l,T,r);S>0&&w+C+2*h>g&&(p+=y+h,d.push({width:y,height:w}),_+=y+h,b++,y=w=0),f[S]={left:_,top:w,col:b,width:E,height:C},y=Math.max(y,E),w+=C+h}),p+=y,d.push({width:y,height:w}),p}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:a,labels:{padding:r},rtl:l}}=this,o=al(l,this.left,this.width);if(this.isHorizontal()){let h=0,f=An(a,this.left+r,this.right-this.lineWidths[h]);for(const d of n)h!==d.row&&(h=d.row,f=An(a,this.left+r,this.right-this.lineWidths[h])),d.top+=this.top+t+r,d.left=o.leftForLtr(o.x(f),d.width),f+=d.width+r}else{let h=0,f=An(a,this.top+t+r,this.bottom-this.columnSizes[h].height);for(const d of n)d.col!==h&&(h=d.col,f=An(a,this.top+t+r,this.bottom-this.columnSizes[h].height)),d.top=f,d.left+=this.left+r,d.left=o.leftForLtr(o.x(d.left),d.width),f+=d.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;_x(t,this),this._draw(),Tx(t)}}_draw(){const{options:t,columnSizes:n,lineWidths:a,ctx:r}=this,{align:l,labels:o}=t,h=Ut.color,f=al(t.rtl,this.left,this.width),d=Sn(o.font),{padding:g}=o,p=d.size,y=p/2;let w;this.drawTitle(),r.textAlign=f.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=d.string;const{boxWidth:_,boxHeight:b,itemHeight:T}=Xy(o,p),S=function(K,D,H){if(isNaN(_)||_<=0||isNaN(b)||b<0)return;r.save();const M=et(H.lineWidth,1);if(r.fillStyle=et(H.fillStyle,h),r.lineCap=et(H.lineCap,"butt"),r.lineDashOffset=et(H.lineDashOffset,0),r.lineJoin=et(H.lineJoin,"miter"),r.lineWidth=M,r.strokeStyle=et(H.strokeStyle,h),r.setLineDash(et(H.lineDash,[])),o.usePointStyle){const B={radius:b*Math.SQRT2/2,pointStyle:H.pointStyle,rotation:H.rotation,borderWidth:M},I=f.xPlus(K,_/2),te=D+y;D2(r,B,I,te,o.pointStyleWidth&&_)}else{const B=D+Math.max((p-b)/2,0),I=f.leftForLtr(K,_),te=nl(H.borderRadius);r.beginPath(),Object.values(te).some(q=>q!==0)?Sh(r,{x:I,y:B,w:_,h:b,radius:te}):r.rect(I,B,_,b),r.fill(),M!==0&&r.stroke()}r.restore()},E=function(K,D,H){nc(r,H.text,K,D+T/2,d,{strikethrough:H.hidden,textAlign:f.textAlign(H.textAlign)})},C=this.isHorizontal(),A=this._computeTitleHeight();C?w={x:An(l,this.left+g,this.right-a[0]),y:this.top+g+A,line:0}:w={x:this.left+g,y:An(l,this.top+A+g,this.bottom-n[0].height),line:0},H2(this.ctx,t.textDirection);const F=T+g;this.legendItems.forEach((K,D)=>{r.strokeStyle=K.fontColor,r.fillStyle=K.fontColor;const H=r.measureText(K.text).width,M=f.textAlign(K.textAlign||(K.textAlign=o.textAlign)),B=_+y+H;let I=w.x,te=w.y;f.setWidth(this.width),C?D>0&&I+B+g>this.right&&(te=w.y+=F,w.line++,I=w.x=An(l,this.left+g,this.right-a[w.line])):D>0&&te+F>this.bottom&&(I=w.x=I+n[w.line].width+g,w.line++,te=w.y=An(l,this.top+A+g,this.bottom-n[w.line].height));const q=f.x(I);if(S(q,te,K),I=IN(M,I+_+y,C?I+B:this.right,t.rtl),E(f.x(I),te,K),C)w.x+=B+g;else if(typeof K.text!="string"){const ae=d.lineHeight;w.y+=nb(K,ae)+g}else w.y+=F}),P2(this.ctx,t.textDirection)}drawTitle(){const t=this.options,n=t.title,a=Sn(n.font),r=oa(n.padding);if(!n.display)return;const l=al(t.rtl,this.left,this.width),o=this.ctx,h=n.position,f=a.size/2,d=r.top+f;let g,p=this.left,y=this.width;if(this.isHorizontal())y=Math.max(...this.lineWidths),g=this.top+d,p=An(t.align,p,this.right-y);else{const _=this.columnSizes.reduce((b,T)=>Math.max(b,T.height),0);g=d+An(t.align,this.top,this.bottom-_-t.labels.padding-this._computeTitleHeight())}const w=An(h,p,p+y);o.textAlign=l.textAlign(vx(h)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=a.string,nc(o,n.text,w,g,a)}_computeTitleHeight(){const t=this.options.title,n=Sn(t.font),a=oa(t.padding);return t.display?n.lineHeight+a.height:0}_getLegendItemAt(t,n){let a,r,l;if(us(t,this.left,this.right)&&us(n,this.top,this.bottom)){for(l=this.legendHitBoxes,a=0;a<l.length;++a)if(r=l[a],us(t,r.left,r.left+r.width)&&us(n,r.top,r.top+r.height))return this.legendItems[a]}return null}handleEvent(t){const n=this.options;if(!qC(t.type,n))return;const a=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const r=this._hoveredItem,l=WC(r,a);r&&!l&&At(n.onLeave,[t,r,this],this),this._hoveredItem=a,a&&!l&&At(n.onHover,[t,a,this],this)}else a&&At(n.onClick,[t,a,this],this)}}function GC(e,t,n,a,r){const l=XC(a,e,t,n),o=YC(r,a,t.lineHeight);return{itemWidth:l,itemHeight:o}}function XC(e,t,n,a){let r=e.text;return r&&typeof r!="string"&&(r=r.reduce((l,o)=>l.length>o.length?l:o)),t+n.size/2+a.measureText(r).width}function YC(e,t,n){let a=e;return typeof t.text!="string"&&(a=nb(t,n)),a}function nb(e,t){const n=e.text?e.text.length:0;return t*n}function qC(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var qh={id:"legend",_element:Yy,start(e,t,n){const a=e.legend=new Yy({ctx:e.ctx,options:n,chart:e});Sa.configure(e,a,n),Sa.addBox(e,a)},stop(e){Sa.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const a=e.legend;Sa.configure(e,a,n),a.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const a=t.datasetIndex,r=n.chart;r.isDatasetVisible(a)?(r.hide(a),t.hidden=!0):(r.show(a),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:a,textAlign:r,color:l,useBorderRadius:o,borderRadius:h}}=e.legend.options;return e._getSortedDatasetMetas().map(f=>{const d=f.controller.getStyle(n?0:void 0),g=oa(d.borderWidth);return{text:t[f.index].label,fillStyle:d.backgroundColor,fontColor:l,hidden:!f.visible,lineCap:d.borderCapStyle,lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:(g.width+g.height)/4,strokeStyle:d.borderColor,pointStyle:a||d.pointStyle,rotation:d.rotation,textAlign:r||d.textAlign,borderRadius:o&&(h||d.borderRadius),datasetIndex:f.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class ab extends Pa{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n){const a=this.options;if(this.left=0,this.top=0,!a.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=n;const r=$t(a.text)?a.text.length:1;this._padding=oa(a.padding);const l=r*Sn(a.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=l:this.width=l}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:n,left:a,bottom:r,right:l,options:o}=this,h=o.align;let f=0,d,g,p;return this.isHorizontal()?(g=An(h,a,l),p=n+t,d=l-a):(o.position==="left"?(g=a+t,p=An(h,r,n),f=Vt*-.5):(g=l-t,p=An(h,n,r),f=Vt*.5),d=r-n),{titleX:g,titleY:p,maxWidth:d,rotation:f}}draw(){const t=this.ctx,n=this.options;if(!n.display)return;const a=Sn(n.font),l=a.lineHeight/2+this._padding.top,{titleX:o,titleY:h,maxWidth:f,rotation:d}=this._drawArgs(l);nc(t,n.text,0,0,a,{color:n.color,maxWidth:f,rotation:d,textAlign:vx(n.align),textBaseline:"middle",translation:[o,h]})}}function $C(e,t){const n=new ab({ctx:e.ctx,options:t,chart:e});Sa.configure(e,n,t),Sa.addBox(e,n),e.titleBlock=n}var QC={id:"title",_element:ab,start(e,t,n){$C(e,n)},stop(e){const t=e.titleBlock;Sa.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const a=e.titleBlock;Sa.configure(e,a,n),a.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Fo={average(e){if(!e.length)return!1;let t,n,a=new Set,r=0,l=0;for(t=0,n=e.length;t<n;++t){const h=e[t].element;if(h&&h.hasValue()){const f=h.tooltipPosition();a.add(f.x),r+=f.y,++l}}return l===0||a.size===0?!1:{x:[...a].reduce((h,f)=>h+f)/a.size,y:r/l}},nearest(e,t){if(!e.length)return!1;let n=t.x,a=t.y,r=Number.POSITIVE_INFINITY,l,o,h;for(l=0,o=e.length;l<o;++l){const f=e[l].element;if(f&&f.hasValue()){const d=f.getCenterPoint(),g=Gd(t,d);g<r&&(r=g,h=f)}}if(h){const f=h.tooltipPosition();n=f.x,a=f.y}return{x:n,y:a}}};function qa(e,t){return t&&($t(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function wr(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function ZC(e,t){const{element:n,datasetIndex:a,index:r}=t,l=e.getDatasetMeta(a).controller,{label:o,value:h}=l.getLabelAndValue(r);return{chart:e,label:o,parsed:l.getParsed(r),raw:e.data.datasets[a].data[r],formattedValue:h,dataset:l.getDataset(),dataIndex:r,datasetIndex:a,element:n}}function qy(e,t){const n=e.chart.ctx,{body:a,footer:r,title:l}=e,{boxWidth:o,boxHeight:h}=t,f=Sn(t.bodyFont),d=Sn(t.titleFont),g=Sn(t.footerFont),p=l.length,y=r.length,w=a.length,_=oa(t.padding);let b=_.height,T=0,S=a.reduce((A,F)=>A+F.before.length+F.lines.length+F.after.length,0);if(S+=e.beforeBody.length+e.afterBody.length,p&&(b+=p*d.lineHeight+(p-1)*t.titleSpacing+t.titleMarginBottom),S){const A=t.displayColors?Math.max(h,f.lineHeight):f.lineHeight;b+=w*A+(S-w)*f.lineHeight+(S-1)*t.bodySpacing}y&&(b+=t.footerMarginTop+y*g.lineHeight+(y-1)*t.footerSpacing);let E=0;const C=function(A){T=Math.max(T,n.measureText(A).width+E)};return n.save(),n.font=d.string,dt(e.title,C),n.font=f.string,dt(e.beforeBody.concat(e.afterBody),C),E=t.displayColors?o+2+t.boxPadding:0,dt(a,A=>{dt(A.before,C),dt(A.lines,C),dt(A.after,C)}),E=0,n.font=g.string,dt(e.footer,C),n.restore(),T+=_.width,{width:T,height:b}}function JC(e,t){const{y:n,height:a}=t;return n<a/2?"top":n>e.height-a/2?"bottom":"center"}function ek(e,t,n,a){const{x:r,width:l}=a,o=n.caretSize+n.caretPadding;if(e==="left"&&r+l+o>t.width||e==="right"&&r-l-o<0)return!0}function tk(e,t,n,a){const{x:r,width:l}=n,{width:o,chartArea:{left:h,right:f}}=e;let d="center";return a==="center"?d=r<=(h+f)/2?"left":"right":r<=l/2?d="left":r>=o-l/2&&(d="right"),ek(d,e,t,n)&&(d="center"),d}function $y(e,t,n){const a=n.yAlign||t.yAlign||JC(e,n);return{xAlign:n.xAlign||t.xAlign||tk(e,t,n,a),yAlign:a}}function nk(e,t){let{x:n,width:a}=e;return t==="right"?n-=a:t==="center"&&(n-=a/2),n}function ak(e,t,n){let{y:a,height:r}=e;return t==="top"?a+=n:t==="bottom"?a-=r+n:a-=r/2,a}function Qy(e,t,n,a){const{caretSize:r,caretPadding:l,cornerRadius:o}=e,{xAlign:h,yAlign:f}=n,d=r+l,{topLeft:g,topRight:p,bottomLeft:y,bottomRight:w}=nl(o);let _=nk(t,h);const b=ak(t,f,d);return f==="center"?h==="left"?_+=d:h==="right"&&(_-=d):h==="left"?_-=Math.max(g,y)+r:h==="right"&&(_+=Math.max(p,w)+r),{x:Dn(_,0,a.width-t.width),y:Dn(b,0,a.height-t.height)}}function Zu(e,t,n){const a=oa(n.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-a.right:e.x+a.left}function Zy(e){return qa([],wr(e))}function rk(e,t,n){return si(e,{tooltip:t,tooltipItems:n,type:"tooltip"})}function Jy(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}const rb={beforeTitle:vr,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,a=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(a>0&&t.dataIndex<a)return n[t.dataIndex]}return""},afterTitle:vr,beforeBody:vr,beforeLabel:vr,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return st(n)||(t+=n),t},labelColor(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:vr,afterBody:vr,beforeFooter:vr,footer:vr,afterFooter:vr};function Kn(e,t,n,a){const r=e[t].call(n,a);return typeof r>"u"?rb[t].call(n,a):r}class Jd extends Pa{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const n=this.chart,a=this.options.setContext(this.getContext()),r=a.enabled&&n.options.animation&&a.animations,l=new z2(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(l)),l}getContext(){return this.$context||(this.$context=rk(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,n){const{callbacks:a}=n,r=Kn(a,"beforeTitle",this,t),l=Kn(a,"title",this,t),o=Kn(a,"afterTitle",this,t);let h=[];return h=qa(h,wr(r)),h=qa(h,wr(l)),h=qa(h,wr(o)),h}getBeforeBody(t,n){return Zy(Kn(n.callbacks,"beforeBody",this,t))}getBody(t,n){const{callbacks:a}=n,r=[];return dt(t,l=>{const o={before:[],lines:[],after:[]},h=Jy(a,l);qa(o.before,wr(Kn(h,"beforeLabel",this,l))),qa(o.lines,Kn(h,"label",this,l)),qa(o.after,wr(Kn(h,"afterLabel",this,l))),r.push(o)}),r}getAfterBody(t,n){return Zy(Kn(n.callbacks,"afterBody",this,t))}getFooter(t,n){const{callbacks:a}=n,r=Kn(a,"beforeFooter",this,t),l=Kn(a,"footer",this,t),o=Kn(a,"afterFooter",this,t);let h=[];return h=qa(h,wr(r)),h=qa(h,wr(l)),h=qa(h,wr(o)),h}_createItems(t){const n=this._active,a=this.chart.data,r=[],l=[],o=[];let h=[],f,d;for(f=0,d=n.length;f<d;++f)h.push(ZC(this.chart,n[f]));return t.filter&&(h=h.filter((g,p,y)=>t.filter(g,p,y,a))),t.itemSort&&(h=h.sort((g,p)=>t.itemSort(g,p,a))),dt(h,g=>{const p=Jy(t.callbacks,g);r.push(Kn(p,"labelColor",this,g)),l.push(Kn(p,"labelPointStyle",this,g)),o.push(Kn(p,"labelTextColor",this,g))}),this.labelColors=r,this.labelPointStyles=l,this.labelTextColors=o,this.dataPoints=h,h}update(t,n){const a=this.options.setContext(this.getContext()),r=this._active;let l,o=[];if(!r.length)this.opacity!==0&&(l={opacity:0});else{const h=Fo[a.position].call(this,r,this._eventPosition);o=this._createItems(a),this.title=this.getTitle(o,a),this.beforeBody=this.getBeforeBody(o,a),this.body=this.getBody(o,a),this.afterBody=this.getAfterBody(o,a),this.footer=this.getFooter(o,a);const f=this._size=qy(this,a),d=Object.assign({},h,f),g=$y(this.chart,a,d),p=Qy(a,d,g,this.chart);this.xAlign=g.xAlign,this.yAlign=g.yAlign,l={opacity:1,x:p.x,y:p.y,width:f.width,height:f.height,caretX:h.x,caretY:h.y}}this._tooltipItems=o,this.$context=void 0,l&&this._resolveAnimations().update(this,l),t&&a.external&&a.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(t,n,a,r){const l=this.getCaretPosition(t,a,r);n.lineTo(l.x1,l.y1),n.lineTo(l.x2,l.y2),n.lineTo(l.x3,l.y3)}getCaretPosition(t,n,a){const{xAlign:r,yAlign:l}=this,{caretSize:o,cornerRadius:h}=a,{topLeft:f,topRight:d,bottomLeft:g,bottomRight:p}=nl(h),{x:y,y:w}=t,{width:_,height:b}=n;let T,S,E,C,A,F;return l==="center"?(A=w+b/2,r==="left"?(T=y,S=T-o,C=A+o,F=A-o):(T=y+_,S=T+o,C=A-o,F=A+o),E=T):(r==="left"?S=y+Math.max(f,g)+o:r==="right"?S=y+_-Math.max(d,p)-o:S=this.caretX,l==="top"?(C=w,A=C-o,T=S-o,E=S+o):(C=w+b,A=C+o,T=S+o,E=S-o),F=C),{x1:T,x2:S,x3:E,y1:C,y2:A,y3:F}}drawTitle(t,n,a){const r=this.title,l=r.length;let o,h,f;if(l){const d=al(a.rtl,this.x,this.width);for(t.x=Zu(this,a.titleAlign,a),n.textAlign=d.textAlign(a.titleAlign),n.textBaseline="middle",o=Sn(a.titleFont),h=a.titleSpacing,n.fillStyle=a.titleColor,n.font=o.string,f=0;f<l;++f)n.fillText(r[f],d.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+h,f+1===l&&(t.y+=a.titleMarginBottom-h)}}_drawColorBox(t,n,a,r,l){const o=this.labelColors[a],h=this.labelPointStyles[a],{boxHeight:f,boxWidth:d}=l,g=Sn(l.bodyFont),p=Zu(this,"left",l),y=r.x(p),w=f<g.lineHeight?(g.lineHeight-f)/2:0,_=n.y+w;if(l.usePointStyle){const b={radius:Math.min(d,f)/2,pointStyle:h.pointStyle,rotation:h.rotation,borderWidth:1},T=r.leftForLtr(y,d)+d/2,S=_+f/2;t.strokeStyle=l.multiKeyBackground,t.fillStyle=l.multiKeyBackground,Yd(t,b,T,S),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,Yd(t,b,T,S)}else{t.lineWidth=lt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const b=r.leftForLtr(y,d),T=r.leftForLtr(r.xPlus(y,1),d-2),S=nl(o.borderRadius);Object.values(S).some(E=>E!==0)?(t.beginPath(),t.fillStyle=l.multiKeyBackground,Sh(t,{x:b,y:_,w:d,h:f,radius:S}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),Sh(t,{x:T,y:_+1,w:d-2,h:f-2,radius:S}),t.fill()):(t.fillStyle=l.multiKeyBackground,t.fillRect(b,_,d,f),t.strokeRect(b,_,d,f),t.fillStyle=o.backgroundColor,t.fillRect(T,_+1,d-2,f-2))}t.fillStyle=this.labelTextColors[a]}drawBody(t,n,a){const{body:r}=this,{bodySpacing:l,bodyAlign:o,displayColors:h,boxHeight:f,boxWidth:d,boxPadding:g}=a,p=Sn(a.bodyFont);let y=p.lineHeight,w=0;const _=al(a.rtl,this.x,this.width),b=function(H){n.fillText(H,_.x(t.x+w),t.y+y/2),t.y+=y+l},T=_.textAlign(o);let S,E,C,A,F,K,D;for(n.textAlign=o,n.textBaseline="middle",n.font=p.string,t.x=Zu(this,T,a),n.fillStyle=a.bodyColor,dt(this.beforeBody,b),w=h&&T!=="right"?o==="center"?d/2+g:d+2+g:0,A=0,K=r.length;A<K;++A){for(S=r[A],E=this.labelTextColors[A],n.fillStyle=E,dt(S.before,b),C=S.lines,h&&C.length&&(this._drawColorBox(n,t,A,_,a),y=Math.max(p.lineHeight,f)),F=0,D=C.length;F<D;++F)b(C[F]),y=p.lineHeight;dt(S.after,b)}w=0,y=p.lineHeight,dt(this.afterBody,b),t.y-=l}drawFooter(t,n,a){const r=this.footer,l=r.length;let o,h;if(l){const f=al(a.rtl,this.x,this.width);for(t.x=Zu(this,a.footerAlign,a),t.y+=a.footerMarginTop,n.textAlign=f.textAlign(a.footerAlign),n.textBaseline="middle",o=Sn(a.footerFont),n.fillStyle=a.footerColor,n.font=o.string,h=0;h<l;++h)n.fillText(r[h],f.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+a.footerSpacing}}drawBackground(t,n,a,r){const{xAlign:l,yAlign:o}=this,{x:h,y:f}=t,{width:d,height:g}=a,{topLeft:p,topRight:y,bottomLeft:w,bottomRight:_}=nl(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(h+p,f),o==="top"&&this.drawCaret(t,n,a,r),n.lineTo(h+d-y,f),n.quadraticCurveTo(h+d,f,h+d,f+y),o==="center"&&l==="right"&&this.drawCaret(t,n,a,r),n.lineTo(h+d,f+g-_),n.quadraticCurveTo(h+d,f+g,h+d-_,f+g),o==="bottom"&&this.drawCaret(t,n,a,r),n.lineTo(h+w,f+g),n.quadraticCurveTo(h,f+g,h,f+g-w),o==="center"&&l==="left"&&this.drawCaret(t,n,a,r),n.lineTo(h,f+p),n.quadraticCurveTo(h,f,h+p,f),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(t){const n=this.chart,a=this.$animations,r=a&&a.x,l=a&&a.y;if(r||l){const o=Fo[t.position].call(this,this._active,this._eventPosition);if(!o)return;const h=this._size=qy(this,t),f=Object.assign({},o,this._size),d=$y(n,t,f),g=Qy(t,f,d,n);(r._to!==g.x||l._to!==g.y)&&(this.xAlign=d.xAlign,this.yAlign=d.yAlign,this.width=h.width,this.height=h.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,g))}}_willRender(){return!!this.opacity}draw(t){const n=this.options.setContext(this.getContext());let a=this.opacity;if(!a)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},l={x:this.x,y:this.y};a=Math.abs(a)<.001?0:a;const o=oa(n.padding),h=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&h&&(t.save(),t.globalAlpha=a,this.drawBackground(l,t,r,n),H2(t,n.textDirection),l.y+=o.top,this.drawTitle(l,t,n),this.drawBody(l,t,n),this.drawFooter(l,t,n),P2(t,n.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,n){const a=this._active,r=t.map(({datasetIndex:h,index:f})=>{const d=this.chart.getDatasetMeta(h);if(!d)throw new Error("Cannot find a dataset at index "+h);return{datasetIndex:h,element:d.data[f],index:f}}),l=!wh(a,r),o=this._positionChanged(r,n);(l||o)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,n,a=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,l=this._active||[],o=this._getActiveElements(t,l,n,a),h=this._positionChanged(o,t),f=n||!wh(o,l)||h;return f&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,n))),f}_getActiveElements(t,n,a,r){const l=this.options;if(t.type==="mouseout")return[];if(!r)return n.filter(h=>this.chart.data.datasets[h.datasetIndex]&&this.chart.getDatasetMeta(h.datasetIndex).controller.getParsed(h.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,l.mode,l,a);return l.reverse&&o.reverse(),o}_positionChanged(t,n){const{caretX:a,caretY:r,options:l}=this,o=Fo[l.position].call(this,t,n);return o!==!1&&(a!==o.x||r!==o.y)}}Ie(Jd,"positioners",Fo);var $h={id:"tooltip",_element:Jd,positioners:Fo,afterInit(e,t,n){n&&(e.tooltip=new Jd({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:rb},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const sk=(e,t,n,a)=>(typeof t=="string"?(n=e.push(t)-1,a.unshift({index:n,label:t})):isNaN(t)&&(n=null),n);function ik(e,t,n,a){const r=e.indexOf(t);if(r===-1)return sk(e,t,n,a);const l=e.lastIndexOf(t);return r!==l?n:r}const lk=(e,t)=>e===null?null:Dn(Math.round(e),0,t);function ev(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class rc extends gl{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const n=this._addedLabels;if(n.length){const a=this.getLabels();for(const{index:r,label:l}of n)a[r]===l&&a.splice(r,1);this._addedLabels=[]}super.init(t)}parse(t,n){if(st(t))return null;const a=this.getLabels();return n=isFinite(n)&&a[n]===t?n:ik(a,t,et(n,t),this._addedLabels),lk(n,a.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:a,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(a=0),n||(r=this.getLabels().length-1)),this.min=a,this.max=r}buildTicks(){const t=this.min,n=this.max,a=this.options.offset,r=[];let l=this.getLabels();l=t===0&&n===l.length-1?l:l.slice(t,n+1),this._valueRange=Math.max(l.length-(a?0:1),1),this._startValue=this.min-(a?.5:0);for(let o=t;o<=n;o++)r.push({value:o});return r}getLabelForValue(t){return ev.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}Ie(rc,"id","category"),Ie(rc,"defaults",{ticks:{callback:ev}});function ok(e,t){const n=[],{bounds:r,step:l,min:o,max:h,precision:f,count:d,maxTicks:g,maxDigits:p,includeBounds:y}=e,w=l||1,_=g-1,{min:b,max:T}=t,S=!st(o),E=!st(h),C=!st(d),A=(T-b)/(p+1);let F=ny((T-b)/_/w)*w,K,D,H,M;if(F<1e-14&&!S&&!E)return[{value:b},{value:T}];M=Math.ceil(T/F)-Math.floor(b/F),M>_&&(F=ny(M*F/_/w)*w),st(f)||(K=Math.pow(10,f),F=Math.ceil(F*K)/K),r==="ticks"?(D=Math.floor(b/F)*F,H=Math.ceil(T/F)*F):(D=b,H=T),S&&E&&l&&DN((h-o)/l,F/1e3)?(M=Math.round(Math.min((h-o)/F,g)),F=(h-o)/M,D=o,H=h):C?(D=S?o:D,H=E?h:H,M=d-1,F=(H-D)/M):(M=(H-D)/F,Po(M,Math.round(M),F/1e3)?M=Math.round(M):M=Math.ceil(M));const B=Math.max(ay(F),ay(D));K=Math.pow(10,st(f)?B:f),D=Math.round(D*K)/K,H=Math.round(H*K)/K;let I=0;for(S&&(y&&D!==o?(n.push({value:o}),D<o&&I++,Po(Math.round((D+I*F)*K)/K,o,tv(o,A,e))&&I++):D<o&&I++);I<M;++I){const te=Math.round((D+I*F)*K)/K;if(E&&te>h)break;n.push({value:te})}return E&&y&&H!==h?n.length&&Po(n[n.length-1].value,h,tv(h,A,e))?n[n.length-1].value=h:n.push({value:h}):(!E||H===h)&&n.push({value:H}),n}function tv(e,t,{horizontal:n,minRotation:a}){const r=Tr(a),l=(n?Math.sin(r):Math.cos(r))||.001,o=.75*t*(""+e).length;return Math.min(t/l,o)}class ck extends gl{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,n){return st(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:n,maxDefined:a}=this.getUserBounds();let{min:r,max:l}=this;const o=f=>r=n?r:f,h=f=>l=a?l:f;if(t){const f=Ja(r),d=Ja(l);f<0&&d<0?h(0):f>0&&d>0&&o(0)}if(r===l){let f=l===0?1:Math.abs(l*.05);h(l+f),t||o(r-f)}this.min=r,this.max=l}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:n,stepSize:a}=t,r;return a?(r=Math.ceil(this.max/a)-Math.floor(this.min/a)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${a} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,n=t.ticks;let a=this.getTickLimit();a=Math.max(2,a);const r={maxTicks:a,bounds:t.bounds,min:t.min,max:t.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},l=this._range||this,o=ok(r,l);return t.bounds==="ticks"&&ON(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let n=this.min,a=this.max;if(super.configure(),this.options.offset&&t.length){const r=(a-n)/Math.max(t.length-1,1)/2;n-=r,a+=r}this._startValue=n,this._endValue=a,this._valueRange=a-n}getLabelForValue(t){return wx(t,this.chart.options.locale,this.options.ticks.format)}}class sc extends ck{determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=Ea(t)?t:0,this.max=Ea(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),n=t?this.width:this.height,a=Tr(this.options.ticks.minRotation),r=(t?Math.sin(a):Math.cos(a))||.001,l=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,l.lineHeight/r))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}Ie(sc,"id","linear"),Ie(sc,"defaults",{ticks:{callback:A2.formatters.numeric}});const Qh={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Gn=Object.keys(Qh);function nv(e,t){return e-t}function av(e,t){if(st(t))return null;const n=e._adapter,{parser:a,round:r,isoWeekday:l}=e._parseOpts;let o=t;return typeof a=="function"&&(o=a(o)),Ea(o)||(o=typeof a=="string"?n.parse(o,a):n.parse(o)),o===null?null:(r&&(o=r==="week"&&(Jo(l)||l===!0)?n.startOf(o,"isoWeek",l):n.startOf(o,r)),+o)}function rv(e,t,n,a){const r=Gn.length;for(let l=Gn.indexOf(e);l<r-1;++l){const o=Qh[Gn[l]],h=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-t)/(h*o.size))<=a)return Gn[l]}return Gn[r-1]}function uk(e,t,n,a,r){for(let l=Gn.length-1;l>=Gn.indexOf(n);l--){const o=Gn[l];if(Qh[o].common&&e._adapter.diff(r,a,o)>=t-1)return o}return Gn[n?Gn.indexOf(n):0]}function hk(e){for(let t=Gn.indexOf(e)+1,n=Gn.length;t<n;++t)if(Qh[Gn[t]].common)return Gn[t]}function sv(e,t,n){if(!n)e[t]=!0;else if(n.length){const{lo:a,hi:r}=yx(n,t),l=n[a]>=t?n[a]:n[r];e[l]=!0}}function fk(e,t,n,a){const r=e._adapter,l=+r.startOf(t[0].value,a),o=t[t.length-1].value;let h,f;for(h=l;h<=o;h=+r.add(h,1,a))f=n[h],f>=0&&(t[f].major=!0);return t}function iv(e,t,n){const a=[],r={},l=t.length;let o,h;for(o=0;o<l;++o)h=t[o],r[h]=o,a.push({value:h,major:!1});return l===0||!n?a:fk(e,a,r,n)}class kh extends gl{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,n={}){const a=t.time||(t.time={}),r=this._adapter=new p3._date(t.adapters.date);r.init(n),Ho(a.displayFormats,r.formats()),this._parseOpts={parser:a.parser,round:a.round,isoWeekday:a.isoWeekday},super.init(t),this._normalized=n.normalized}parse(t,n){return t===void 0?null:av(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,n=this._adapter,a=t.time.unit||"day";let{min:r,max:l,minDefined:o,maxDefined:h}=this.getUserBounds();function f(d){!o&&!isNaN(d.min)&&(r=Math.min(r,d.min)),!h&&!isNaN(d.max)&&(l=Math.max(l,d.max))}(!o||!h)&&(f(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&f(this.getMinMax(!1))),r=Ea(r)&&!isNaN(r)?r:+n.startOf(Date.now(),a),l=Ea(l)&&!isNaN(l)?l:+n.endOf(Date.now(),a)+1,this.min=Math.min(r,l-1),this.max=Math.max(r+1,l)}_getLabelBounds(){const t=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;return t.length&&(n=t[0],a=t[t.length-1]),{min:n,max:a}}buildTicks(){const t=this.options,n=t.time,a=t.ticks,r=a.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const l=this.min,o=this.max,h=BN(r,l,o);return this._unit=n.unit||(a.autoSkip?rv(n.minUnit,this.min,this.max,this._getLabelCapacity(l)):uk(this,h.length,n.minUnit,this.min,this.max)),this._majorUnit=!a.major.enabled||this._unit==="year"?void 0:hk(this._unit),this.initOffsets(r),t.reverse&&h.reverse(),iv(this,h,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let n=0,a=0,r,l;this.options.offset&&t.length&&(r=this.getDecimalForValue(t[0]),t.length===1?n=1-r:n=(this.getDecimalForValue(t[1])-r)/2,l=this.getDecimalForValue(t[t.length-1]),t.length===1?a=l:a=(l-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;n=Dn(n,0,o),a=Dn(a,0,o),this._offsets={start:n,end:a,factor:1/(n+1+a)}}_generate(){const t=this._adapter,n=this.min,a=this.max,r=this.options,l=r.time,o=l.unit||rv(l.minUnit,n,a,this._getLabelCapacity(n)),h=et(r.ticks.stepSize,1),f=o==="week"?l.isoWeekday:!1,d=Jo(f)||f===!0,g={};let p=n,y,w;if(d&&(p=+t.startOf(p,"isoWeek",f)),p=+t.startOf(p,d?"day":o),t.diff(a,n,o)>1e5*h)throw new Error(n+" and "+a+" are too far apart with stepSize of "+h+" "+o);const _=r.ticks.source==="data"&&this.getDataTimestamps();for(y=p,w=0;y<a;y=+t.add(y,h,o),w++)sv(g,y,_);return(y===a||r.bounds==="ticks"||w===1)&&sv(g,y,_),Object.keys(g).sort(nv).map(b=>+b)}getLabelForValue(t){const n=this._adapter,a=this.options.time;return a.tooltipFormat?n.format(t,a.tooltipFormat):n.format(t,a.displayFormats.datetime)}format(t,n){const r=this.options.time.displayFormats,l=this._unit,o=n||r[l];return this._adapter.format(t,o)}_tickFormatFunction(t,n,a,r){const l=this.options,o=l.ticks.callback;if(o)return At(o,[t,n,a],this);const h=l.time.displayFormats,f=this._unit,d=this._majorUnit,g=f&&h[f],p=d&&h[d],y=a[n],w=d&&p&&y&&y.major;return this._adapter.format(t,r||(w?p:g))}generateTickLabels(t){let n,a,r;for(n=0,a=t.length;n<a;++n)r=t[n],r.label=this._tickFormatFunction(r.value,n,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const n=this._offsets,a=this.getDecimalForValue(t);return this.getPixelForDecimal((n.start+a)*n.factor)}getValueForPixel(t){const n=this._offsets,a=this.getDecimalForPixel(t)/n.factor-n.end;return this.min+a*(this.max-this.min)}_getLabelSize(t){const n=this.options.ticks,a=this.ctx.measureText(t).width,r=Tr(this.isHorizontal()?n.maxRotation:n.minRotation),l=Math.cos(r),o=Math.sin(r),h=this._resolveTickFontOptions(0).size;return{w:a*l+h*o,h:a*o+h*l}}_getLabelCapacity(t){const n=this.options.time,a=n.displayFormats,r=a[n.unit]||a.millisecond,l=this._tickFormatFunction(t,0,iv(this,[t],this._majorUnit),r),o=this._getLabelSize(l),h=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return h>0?h:1}getDataTimestamps(){let t=this._cache.data||[],n,a;if(t.length)return t;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,a=r.length;n<a;++n)t=t.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let n,a;if(t.length)return t;const r=this.getLabels();for(n=0,a=r.length;n<a;++n)t.push(av(this,r[n]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return C2(t.sort(nv))}}Ie(kh,"id","time"),Ie(kh,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Ju(e,t,n){let a=0,r=e.length-1,l,o,h,f;n?(t>=e[a].pos&&t<=e[r].pos&&({lo:a,hi:r}=Ys(e,"pos",t)),{pos:l,time:h}=e[a],{pos:o,time:f}=e[r]):(t>=e[a].time&&t<=e[r].time&&({lo:a,hi:r}=Ys(e,"time",t)),{time:l,pos:h}=e[a],{time:o,pos:f}=e[r]);const d=o-l;return d?h+(f-h)*(t-l)/d:h}class lv extends kh{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(t);this._minPos=Ju(n,this.min),this._tableRange=Ju(n,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:n,max:a}=this,r=[],l=[];let o,h,f,d,g;for(o=0,h=t.length;o<h;++o)d=t[o],d>=n&&d<=a&&r.push(d);if(r.length<2)return[{time:n,pos:0},{time:a,pos:1}];for(o=0,h=r.length;o<h;++o)g=r[o+1],f=r[o-1],d=r[o],Math.round((g+f)/2)!==d&&l.push({time:d,pos:o/(h-1)});return l}_generate(){const t=this.min,n=this.max;let a=super.getDataTimestamps();return(!a.includes(t)||!a.length)&&a.splice(0,0,t),(!a.includes(n)||a.length===1)&&a.push(n),a.sort((r,l)=>r-l)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const n=this.getDataTimestamps(),a=this.getLabelTimestamps();return n.length&&a.length?t=this.normalize(n.concat(a)):t=n.length?n:a,t=this._cache.all=t,t}getDecimalForValue(t){return(Ju(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const n=this._offsets,a=this.getDecimalForPixel(t)/n.factor-n.end;return Ju(this._table,a*this._tableRange+this._minPos,!0)}}Ie(lv,"id","timeseries"),Ie(lv,"defaults",kh.defaults);const sb="label";function ov(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function dk(e,t){const n=e.options;n&&t&&Object.assign(n,t)}function ib(e,t){e.labels=t}function lb(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:sb;const a=[];e.datasets=t.map(r=>{const l=e.datasets.find(o=>o[n]===r[n]);return!l||!r.data||a.includes(l)?{...r}:(a.push(l),Object.assign(l,r),l)})}function xk(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:sb;const n={labels:[],datasets:[]};return ib(n,e.labels),lb(n,e.datasets,t),n}function gk(e,t){const{height:n=150,width:a=300,redraw:r=!1,datasetIdKey:l,type:o,data:h,options:f,plugins:d=[],fallbackContent:g,updateMode:p,...y}=e,w=j.useRef(null),_=j.useRef(null),b=()=>{w.current&&(_.current=new ii(w.current,{type:o,data:xk(h,l),options:f&&{...f},plugins:d}),ov(t,_.current))},T=()=>{ov(t,null),_.current&&(_.current.destroy(),_.current=null)};return j.useEffect(()=>{!r&&_.current&&f&&dk(_.current,f)},[r,f]),j.useEffect(()=>{!r&&_.current&&ib(_.current.config.data,h.labels)},[r,h.labels]),j.useEffect(()=>{!r&&_.current&&h.datasets&&lb(_.current.config.data,h.datasets,l)},[r,h.datasets]),j.useEffect(()=>{_.current&&(r?(T(),setTimeout(b)):_.current.update(p))},[r,f,h.labels,h.datasets,p]),j.useEffect(()=>{_.current&&(T(),setTimeout(b))},[o]),j.useEffect(()=>(b(),()=>T()),[]),Vh.createElement("canvas",{ref:w,role:"img",height:n,width:a,...y},g)}const mk=j.forwardRef(gk);function Dx(e,t){return ii.register(t),j.forwardRef((n,a)=>Vh.createElement(mk,{...n,ref:a,type:e}))}const pk=Dx("line",ph),Ox=Dx("bar",mh),ic=Dx("pie",qd);/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var cv=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var e=window.screen;if(e)return(e.deviceXDPI||1)/(e.logicalXDPI||1)}return 1}(),Uo={toTextLines:function(e){var t=[],n;for(e=[].concat(e);e.length;)n=e.pop(),typeof n=="string"?t.unshift.apply(t,n.split(`
`)):Array.isArray(n)?e.push.apply(e,n):st(e)||t.unshift(""+n);return t},textSize:function(e,t,n){var a=[].concat(t),r=a.length,l=e.font,o=0,h;for(e.font=n.string,h=0;h<r;++h)o=Math.max(e.measureText(a[h]).width,o);return e.font=l,{height:r*n.lineHeight,width:o}},bound:function(e,t,n){return Math.max(e,Math.min(t,n))},arrayDiff:function(e,t){var n=e.slice(),a=[],r,l,o,h;for(r=0,o=t.length;r<o;++r)h=t[r],l=n.indexOf(h),l===-1?a.push([h,1]):n.splice(l,1);for(r=0,o=n.length;r<o;++r)a.push([n[r],-1]);return a},rasterize:function(e){return Math.round(e*cv)/cv}};function Od(e,t){var n=t.x,a=t.y;if(n===null)return{x:0,y:-1};if(a===null)return{x:1,y:0};var r=e.x-n,l=e.y-a,o=Math.sqrt(r*r+l*l);return{x:o?r/o:0,y:o?l/o:-1}}function yk(e,t,n,a,r){switch(r){case"center":n=a=0;break;case"bottom":n=0,a=1;break;case"right":n=1,a=0;break;case"left":n=-1,a=0;break;case"top":n=0,a=-1;break;case"start":n=-n,a=-a;break;case"end":break;default:r*=Math.PI/180,n=Math.cos(r),a=Math.sin(r);break}return{x:e,y:t,vx:n,vy:a}}var vk=0,ob=1,cb=2,ub=4,hb=8;function eh(e,t,n){var a=vk;return e<n.left?a|=ob:e>n.right&&(a|=cb),t<n.top?a|=hb:t>n.bottom&&(a|=ub),a}function bk(e,t){for(var n=e.x0,a=e.y0,r=e.x1,l=e.y1,o=eh(n,a,t),h=eh(r,l,t),f,d,g;!(!(o|h)||o&h);)f=o||h,f&hb?(d=n+(r-n)*(t.top-a)/(l-a),g=t.top):f&ub?(d=n+(r-n)*(t.bottom-a)/(l-a),g=t.bottom):f&cb?(g=a+(l-a)*(t.right-n)/(r-n),d=t.right):f&ob&&(g=a+(l-a)*(t.left-n)/(r-n),d=t.left),f===o?(n=d,a=g,o=eh(n,a,t)):(r=d,l=g,h=eh(r,l,t));return{x0:n,x1:r,y0:a,y1:l}}function th(e,t){var n=t.anchor,a=e,r,l;return t.clamp&&(a=bk(a,t.area)),n==="start"?(r=a.x0,l=a.y0):n==="end"?(r=a.x1,l=a.y1):(r=(a.x0+a.x1)/2,l=(a.y0+a.y1)/2),yk(r,l,e.vx,e.vy,t.align)}var nh={arc:function(e,t){var n=(e.startAngle+e.endAngle)/2,a=Math.cos(n),r=Math.sin(n),l=e.innerRadius,o=e.outerRadius;return th({x0:e.x+a*l,y0:e.y+r*l,x1:e.x+a*o,y1:e.y+r*o,vx:a,vy:r},t)},point:function(e,t){var n=Od(e,t.origin),a=n.x*e.options.radius,r=n.y*e.options.radius;return th({x0:e.x-a,y0:e.y-r,x1:e.x+a,y1:e.y+r,vx:n.x,vy:n.y},t)},bar:function(e,t){var n=Od(e,t.origin),a=e.x,r=e.y,l=0,o=0;return e.horizontal?(a=Math.min(e.x,e.base),l=Math.abs(e.base-e.x)):(r=Math.min(e.y,e.base),o=Math.abs(e.base-e.y)),th({x0:a,y0:r+o,x1:a+l,y1:r,vx:n.x,vy:n.y},t)},fallback:function(e,t){var n=Od(e,t.origin);return th({x0:e.x,y0:e.y,x1:e.x+(e.width||0),y1:e.y+(e.height||0),vx:n.x,vy:n.y},t)}},Nr=Uo.rasterize;function wk(e){var t=e.borderWidth||0,n=e.padding,a=e.size.height,r=e.size.width,l=-r/2,o=-a/2;return{frame:{x:l-n.left-t,y:o-n.top-t,w:r+n.width+t*2,h:a+n.height+t*2},text:{x:l,y:o,w:r,h:a}}}function _k(e,t){var n=t.chart.getDatasetMeta(t.datasetIndex).vScale;if(!n)return null;if(n.xCenter!==void 0&&n.yCenter!==void 0)return{x:n.xCenter,y:n.yCenter};var a=n.getBasePixel();return e.horizontal?{x:a,y:null}:{x:null,y:a}}function Tk(e){return e instanceof Sr?nh.arc:e instanceof rl?nh.point:e instanceof Zs?nh.bar:nh.fallback}function Sk(e,t,n,a,r,l){var o=Math.PI/2;if(l){var h=Math.min(l,r/2,a/2),f=t+h,d=n+h,g=t+a-h,p=n+r-h;e.moveTo(t,d),f<g&&d<p?(e.arc(f,d,h,-Math.PI,-o),e.arc(g,d,h,-o,0),e.arc(g,p,h,0,o),e.arc(f,p,h,o,Math.PI)):f<g?(e.moveTo(f,n),e.arc(g,d,h,-o,o),e.arc(f,d,h,o,Math.PI+o)):d<p?(e.arc(f,d,h,-Math.PI,0),e.arc(f,p,h,0,Math.PI)):e.arc(f,d,h,-Math.PI,Math.PI),e.closePath(),e.moveTo(t,n)}else e.rect(t,n,a,r)}function Nk(e,t,n){var a=n.backgroundColor,r=n.borderColor,l=n.borderWidth;!a&&(!r||!l)||(e.beginPath(),Sk(e,Nr(t.x)+l/2,Nr(t.y)+l/2,Nr(t.w)-l,Nr(t.h)-l,n.borderRadius),e.closePath(),a&&(e.fillStyle=a,e.fill()),r&&l&&(e.strokeStyle=r,e.lineWidth=l,e.lineJoin="miter",e.stroke()))}function Ek(e,t,n){var a=n.lineHeight,r=e.w,l=e.x,o=e.y+a/2;return t==="center"?l+=r/2:(t==="end"||t==="right")&&(l+=r),{h:a,w:r,x:l,y:o}}function Ck(e,t,n){var a=e.shadowBlur,r=n.stroked,l=Nr(n.x),o=Nr(n.y),h=Nr(n.w);r&&e.strokeText(t,l,o,h),n.filled&&(a&&r&&(e.shadowBlur=0),e.fillText(t,l,o,h),a&&r&&(e.shadowBlur=a))}function kk(e,t,n,a){var r=a.textAlign,l=a.color,o=!!l,h=a.font,f=t.length,d=a.textStrokeColor,g=a.textStrokeWidth,p=d&&g,y;if(!(!f||!o&&!p))for(n=Ek(n,r,h),e.font=h.string,e.textAlign=r,e.textBaseline="middle",e.shadowBlur=a.textShadowBlur,e.shadowColor=a.textShadowColor,o&&(e.fillStyle=l),p&&(e.lineJoin="round",e.lineWidth=g,e.strokeStyle=d),y=0,f=t.length;y<f;++y)Ck(e,t[y],{stroked:p,filled:o,w:n.w,x:n.x,y:n.y+n.h*y})}var fb=function(e,t,n,a){var r=this;r._config=e,r._index=a,r._model=null,r._rects=null,r._ctx=t,r._el=n};er(fb.prototype,{_modelize:function(e,t,n,a){var r=this,l=r._index,o=Sn(Ft([n.font,{}],a,l)),h=Ft([n.color,Ut.color],a,l);return{align:Ft([n.align,"center"],a,l),anchor:Ft([n.anchor,"center"],a,l),area:a.chart.chartArea,backgroundColor:Ft([n.backgroundColor,null],a,l),borderColor:Ft([n.borderColor,null],a,l),borderRadius:Ft([n.borderRadius,0],a,l),borderWidth:Ft([n.borderWidth,0],a,l),clamp:Ft([n.clamp,!1],a,l),clip:Ft([n.clip,!1],a,l),color:h,display:e,font:o,lines:t,offset:Ft([n.offset,4],a,l),opacity:Ft([n.opacity,1],a,l),origin:_k(r._el,a),padding:oa(Ft([n.padding,4],a,l)),positioner:Tk(r._el),rotation:Ft([n.rotation,0],a,l)*(Math.PI/180),size:Uo.textSize(r._ctx,t,o),textAlign:Ft([n.textAlign,"start"],a,l),textShadowBlur:Ft([n.textShadowBlur,0],a,l),textShadowColor:Ft([n.textShadowColor,h],a,l),textStrokeColor:Ft([n.textStrokeColor,h],a,l),textStrokeWidth:Ft([n.textStrokeWidth,0],a,l)}},update:function(e){var t=this,n=null,a=null,r=t._index,l=t._config,o,h,f,d=Ft([l.display,!0],e,r);d&&(o=e.dataset.data[r],h=et(At(l.formatter,[o,e]),o),f=st(h)?[]:Uo.toTextLines(h),f.length&&(n=t._modelize(d,f,l,e),a=wk(n))),t._model=n,t._rects=a},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(e,t){var n=this,a=e.ctx,r=n._model,l=n._rects,o;this.visible()&&(a.save(),r.clip&&(o=r.area,a.beginPath(),a.rect(o.left,o.top,o.right-o.left,o.bottom-o.top),a.clip()),a.globalAlpha=Uo.bound(0,r.opacity,1),a.translate(Nr(t.x),Nr(t.y)),a.rotate(r.rotation),Nk(a,l.frame,r),kk(a,r.lines,l.text,r),a.restore())}});var jk=Number.MIN_SAFE_INTEGER||-9007199254740991,Ak=Number.MAX_SAFE_INTEGER||9007199254740991;function ko(e,t,n){var a=Math.cos(n),r=Math.sin(n),l=t.x,o=t.y;return{x:l+a*(e.x-l)-r*(e.y-o),y:o+r*(e.x-l)+a*(e.y-o)}}function uv(e,t){var n=Ak,a=jk,r=t.origin,l,o,h,f,d;for(l=0;l<e.length;++l)o=e[l],h=o.x-r.x,f=o.y-r.y,d=t.vx*h+t.vy*f,n=Math.min(n,d),a=Math.max(a,d);return{min:n,max:a}}function ah(e,t){var n=t.x-e.x,a=t.y-e.y,r=Math.sqrt(n*n+a*a);return{vx:(t.x-e.x)/r,vy:(t.y-e.y)/r,origin:e,ln:r}}var db=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};er(db.prototype,{center:function(){var e=this._rect;return{x:e.x+e.w/2,y:e.y+e.h/2}},update:function(e,t,n){this._rotation=n,this._rect={x:t.x+e.x,y:t.y+e.y,w:t.w,h:t.h}},contains:function(e){var t=this,n=1,a=t._rect;return e=ko(e,t.center(),-t._rotation),!(e.x<a.x-n||e.y<a.y-n||e.x>a.x+a.w+n*2||e.y>a.y+a.h+n*2)},intersects:function(e){var t=this._points(),n=e._points(),a=[ah(t[0],t[1]),ah(t[0],t[3])],r,l,o;for(this._rotation!==e._rotation&&a.push(ah(n[0],n[1]),ah(n[0],n[3])),r=0;r<a.length;++r)if(l=uv(t,a[r]),o=uv(n,a[r]),l.max<o.min||o.max<l.min)return!1;return!0},_points:function(){var e=this,t=e._rect,n=e._rotation,a=e.center();return[ko({x:t.x,y:t.y},a,n),ko({x:t.x+t.w,y:t.y},a,n),ko({x:t.x+t.w,y:t.y+t.h},a,n),ko({x:t.x,y:t.y+t.h},a,n)]}});function xb(e,t,n){var a=t.positioner(e,t),r=a.vx,l=a.vy;if(!r&&!l)return{x:a.x,y:a.y};var o=n.w,h=n.h,f=t.rotation,d=Math.abs(o/2*Math.cos(f))+Math.abs(h/2*Math.sin(f)),g=Math.abs(o/2*Math.sin(f))+Math.abs(h/2*Math.cos(f)),p=1/Math.max(Math.abs(r),Math.abs(l));return d*=r*p,g*=l*p,d+=t.offset*r,g+=t.offset*l,{x:a.x+d,y:a.y+g}}function Dk(e,t){var n,a,r,l;for(n=e.length-1;n>=0;--n)for(r=e[n].$layout,a=n-1;a>=0&&r._visible;--a)l=e[a].$layout,l._visible&&r._box.intersects(l._box)&&t(r,l);return e}function Ok(e){var t,n,a,r,l,o,h;for(t=0,n=e.length;t<n;++t)a=e[t],r=a.$layout,r._visible&&(h=new Proxy(a._el,{get:(f,d)=>f.getProps([d],!0)[d]}),l=a.geometry(),o=xb(h,a.model(),l),r._box.update(o,l,a.rotation()));return Dk(e,function(f,d){var g=f._hidable,p=d._hidable;g&&p||p?d._visible=!1:g&&(f._visible=!1)})}var Vo={prepare:function(e){var t=[],n,a,r,l,o;for(n=0,r=e.length;n<r;++n)for(a=0,l=e[n].length;a<l;++a)o=e[n][a],t.push(o),o.$layout={_box:new db,_hidable:!1,_visible:!0,_set:n,_idx:o._index};return t.sort(function(h,f){var d=h.$layout,g=f.$layout;return d._idx===g._idx?g._set-d._set:g._idx-d._idx}),this.update(t),t},update:function(e){var t=!1,n,a,r,l,o;for(n=0,a=e.length;n<a;++n)r=e[n],l=r.model(),o=r.$layout,o._hidable=l&&l.display==="auto",o._visible=r.visible(),t|=o._hidable;t&&Ok(e)},lookup:function(e,t){var n,a;for(n=e.length-1;n>=0;--n)if(a=e[n].$layout,a&&a._visible&&a._box.contains(t))return e[n];return null},draw:function(e,t){var n,a,r,l,o,h;for(n=0,a=t.length;n<a;++n)r=t[n],l=r.$layout,l._visible&&(o=r.geometry(),h=xb(r._el,r.model(),o),l._box.update(h,o,r.rotation()),r.draw(e,h))}},Mk=function(e){if(st(e))return null;var t=e,n,a,r;if(lt(e))if(!st(e.label))t=e.label;else if(!st(e.r))t=e.r;else for(t="",n=Object.keys(e),r=0,a=n.length;r<a;++r)t+=(r!==0?", ":"")+n[r]+": "+e[n[r]];return""+t},Rk={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:Mk,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},Wn="$datalabels",gb="$default";function Fk(e,t){var n=e.datalabels,a={},r=[],l,o;return n===!1?null:(n===!0&&(n={}),t=er({},[t,n]),l=t.labels||{},o=Object.keys(l),delete t.labels,o.length?o.forEach(function(h){l[h]&&r.push(er({},[t,l[h],{_key:h}]))}):r.push(t),a=r.reduce(function(h,f){return dt(f.listeners||{},function(d,g){h[g]=h[g]||{},h[g][f._key||gb]=d}),delete f.listeners,h},{}),{labels:r,listeners:a})}function ex(e,t,n,a){if(t){var r=n.$context,l=n.$groups,o;t[l._set]&&(o=t[l._set][l._key],o&&At(o,[r,a])===!0&&(e[Wn]._dirty=!0,n.update(r)))}}function Lk(e,t,n,a,r){var l,o;!n&&!a||(n?a?n!==a&&(o=l=!0):o=!0:l=!0,o&&ex(e,t.leave,n,r),l&&ex(e,t.enter,a,r))}function Bk(e,t){var n=e[Wn],a=n._listeners,r,l;if(!(!a.enter&&!a.leave)){if(t.type==="mousemove")l=Vo.lookup(n._labels,t);else if(t.type!=="mouseout")return;r=n._hovered,n._hovered=l,Lk(e,a,r,l,t)}}function Hk(e,t){var n=e[Wn],a=n._listeners.click,r=a&&Vo.lookup(n._labels,t);r&&ex(e,a,r,t)}var Cr={id:"datalabels",defaults:Rk,beforeInit:function(e){e[Wn]={_actives:[]}},beforeUpdate:function(e){var t=e[Wn];t._listened=!1,t._listeners={},t._datasets=[],t._labels=[]},afterDatasetUpdate:function(e,t,n){var a=t.index,r=e[Wn],l=r._datasets[a]=[],o=e.isDatasetVisible(a),h=e.data.datasets[a],f=Fk(h,n),d=t.meta.data||[],g=e.ctx,p,y,w,_,b,T,S,E;for(g.save(),p=0,w=d.length;p<w;++p)if(S=d[p],S[Wn]=[],o&&S&&e.getDataVisibility(p)&&!S.skip)for(y=0,_=f.labels.length;y<_;++y)b=f.labels[y],T=b._key,E=new fb(b,g,S,p),E.$groups={_set:a,_key:T||gb},E.$context={active:!1,chart:e,dataIndex:p,dataset:h,datasetIndex:a},E.update(E.$context),S[Wn].push(E),l.push(E);g.restore(),er(r._listeners,f.listeners,{merger:function(C,A,F){A[C]=A[C]||{},A[C][t.index]=F[C],r._listened=!0}})},afterUpdate:function(e){e[Wn]._labels=Vo.prepare(e[Wn]._datasets)},afterDatasetsDraw:function(e){Vo.draw(e,e[Wn]._labels)},beforeEvent:function(e,t){if(e[Wn]._listened){var n=t.event;switch(n.type){case"mousemove":case"mouseout":Bk(e,n);break;case"click":Hk(e,n);break}}},afterEvent:function(e){var t=e[Wn],n=t._actives,a=t._actives=e.getActiveElements(),r=Uo.arrayDiff(n,a),l,o,h,f,d,g,p;for(l=0,o=r.length;l<o;++l)if(d=r[l],d[1])for(p=d[0].element[Wn]||[],h=0,f=p.length;h<f;++h)g=p[h],g.$context.active=d[1]===1,g.update(g.$context);(t._dirty||r.length)&&(Vo.update(t._labels),e.render()),delete t._dirty}};ii.register(Sr,$h,qh,Cr);const Pk=()=>{const e={labels:["Số hộ đã nộp","Số hộ chưa nộp"],datasets:[{label:"Tỷ lệ hộ",data:[75,25],backgroundColor:["#2196F3","#E0E0E0"],borderColor:["#ffffff","#ffffff"],borderWidth:2}]},t={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"right",align:"center"},datalabels:{color:"#ffffff",formatter:(n,a)=>{const r=a.chart.data.datasets[0].data.reduce((o,h)=>o+h,0);return(n/r*100).toFixed(1)+"%"},font:{weight:"bold"}}},layout:{padding:{left:0,right:16,top:0,bottom:0}}};return c.jsx(On,{role:"ketoan",children:c.jsxs("div",{className:"flex flex-col gap-8",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"TRANG CHỦ"}),c.jsx("p",{className:"text-base text-gray-600 mt-2",children:"Chào mừng đến với Hệ thống Quản lý Thu phí Chung cư"})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6 flex flex-col gap-4",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Tỷ lệ (%) hộ đã nộp / chưa nộp trong đợt thu tháng 5"}),c.jsx("div",{className:"w-full h-64 flex items-center justify-center",children:c.jsx(ic,{data:e,options:t})})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6 flex flex-col gap-4",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Doanh thu của đợt thu tháng 5"}),c.jsx("div",{className:"w-full overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tên khoản thu"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thời gian"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Đã thu"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tỷ lệ"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trạng thái"})]})}),c.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Phí chung cư tháng 5/2025"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"01/05 - 31/05/2025"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"102,650,234 VND"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"89,6%"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-green-600",children:"Đang thu"})]}),c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Phí chung cư tháng 4/2025"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"01/04 - 30/04/2025"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"123,654,259 VND"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"100%"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-red-600",children:"Đã thu xong"})]}),c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Phí chung cư tháng 3/2025"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"01/03 - 31/03/2025"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"113,276,093 VND"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"100%"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-red-600",children:"Đã thu xong"})]})]})]})})]})]})})};ii.register(rc,sc,Zs,Sr,$h,qh,Cr);const Ik=()=>{const[e,t]=j.useState(!0),[n,a]=j.useState(0),[r,l]=j.useState(0),[o,h]=j.useState({labels:["0-10","10-20","20-30","30-40","40-50","50-60","> 60"],datasets:[{label:"Số lượng",data:[0,0,0,0,0,0,0],backgroundColor:"#77A1EA",borderColor:"#1976D2",borderWidth:1,borderRadius:4}]}),[f,d]=j.useState({labels:["Nam","Nữ"],datasets:[{label:"Tỷ lệ",data:[50,50],backgroundColor:["#2196F3","#ffffff"],borderColor:["#2196F3","#cccccc"],borderWidth:2}]});j.useEffect(()=>{(async()=>{var _;try{t(!0);const[b,T,S,E]=await Promise.all([Do.getGenderStatistics(),Do.getAgeStatistics(),Do.getTotalResidents(),Do.getTemporaryStatusStatistics()]);if(S.success&&a(((_=S.data.pagination)==null?void 0:_.totalItems)||0),E.statistics){const C=E.statistics.temporaryStatus;l(C.total||0)}if(b.statistics){const C=b.statistics.byGender.find(F=>F.gender.toLowerCase().includes("nam")),A=b.statistics.byGender.find(F=>F.gender.toLowerCase().includes("nữ"));d({labels:["Nam","Nữ"],datasets:[{label:"Tỷ lệ",data:[(C==null?void 0:C.percentage)||0,(A==null?void 0:A.percentage)||0],backgroundColor:["#2196F3","#ffffff"],borderColor:["#2196F3","#cccccc"],borderWidth:2}]})}if(T.statistics){const C=T.statistics.byAgeGroup,A=C.map(K=>K.maxAge>=150?`${K.minAge}+`:`${K.minAge}-${K.maxAge}`),F=C.map(K=>K.count);h({labels:A,datasets:[{label:"Số lượng",data:F,backgroundColor:"#77A1EA",borderColor:"#1976D2",borderWidth:1,borderRadius:4}]})}}catch(b){console.error("Error fetching homepage data:",b)}finally{t(!1)}})()},[]);const g=Math.max(...o.datasets[0].data)+100,p={responsive:!0,plugins:{legend:{display:!1},datalabels:{anchor:"end",align:"top",clamp:!0,color:"#222",font:{weight:"bold",size:16},formatter:w=>w},title:{display:!1}},scales:{y:{beginAtZero:!0,max:g,ticks:{stepSize:100},title:{display:!1}},x:{title:{display:!1}}}},y={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},datalabels:{color:"#222",font:{weight:"bold",size:16},formatter:(w,_)=>{const b=_.chart.data.datasets[0].data.reduce((S,E)=>S+E,0);return(w/b*100).toFixed(0)+"%"}}}};return e?c.jsx(On,{role:"totruong",children:c.jsxs("div",{className:"flex flex-col gap-8",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"TRANG CHỦ"}),c.jsx("p",{className:"text-base text-gray-600 mt-2",children:"Đang tải dữ liệu..."})]}),c.jsx("div",{className:"flex justify-center items-center h-64",children:c.jsx("div",{className:"text-gray-500",children:"Đang tải thống kê..."})})]})}):c.jsx(On,{role:"totruong",children:c.jsxs("div",{className:"flex flex-col gap-8",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"TRANG CHỦ"}),c.jsx("p",{className:"text-base text-gray-600 mt-2",children:"Chào mừng đến với Hệ thống Quản lý Thu phí Chung cư"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6 flex flex-col gap-4",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Tổng số Nhân khẩu"}),c.jsxs("div",{className:"flex items-baseline gap-2",children:[c.jsx("span",{className:"text-5xl font-bold text-blue-600",children:n.toLocaleString()}),c.jsx("span",{className:"text-xl text-gray-700",children:"nhân khẩu"})]})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6 flex flex-col gap-4",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Đang tạm trú/tạm vắng"}),c.jsxs("div",{className:"flex items-baseline gap-2",children:[c.jsx("span",{className:"text-5xl font-bold text-blue-600",children:r}),c.jsx("span",{className:"text-xl text-gray-700",children:"nhân khẩu"})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6 flex flex-col gap-10",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Phân phối nhân khẩu theo độ tuổi"}),c.jsx("div",{className:"w-full h-64",children:c.jsx(Ox,{data:o,options:p,plugins:[Cr]})})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6 flex flex-col gap-4",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Tỷ lệ (%) nam/nữ trong toàn khu chung cư"}),c.jsx("div",{className:"w-full h-64 flex items-center justify-center",children:c.jsx(ic,{data:f,options:y,plugins:[Cr]})}),c.jsxs("div",{className:"flex gap-4 justify-center mt-2",children:[c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"w-4 h-4 bg-blue-500 rounded-full inline-block"}),c.jsx("span",{className:"text-sm text-gray-700",children:"Nam"})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"w-4 h-4 bg-white border border-gray-400 rounded-full inline-block"}),c.jsx("span",{className:"text-sm text-gray-700",children:"Nữ"})]})]})]})]})]})})},mb=({isOpen:e,onClose:t,onAdd:n,householdId:a})=>{const[r,l]=j.useState([]),[o,h]=j.useState(!1),[f,d]=j.useState(""),[g,p]=j.useState({selectedResidentId:"",quanHeVoiChuHo:"",ngayThem:""});j.useEffect(()=>{e&&y()},[e]);const y=async()=>{try{h(!0),d("");const b=await Xn.getAvailable();b.success?l(b.data):d("Không thể lấy danh sách nhân khẩu")}catch(b){console.error("Error fetching available residents:",b),d(b.message||"Có lỗi xảy ra khi lấy danh sách nhân khẩu")}finally{h(!1)}},w=b=>{const{name:T,value:S}=b.target;p(E=>({...E,[T]:S}))},_=async b=>{if(b.preventDefault(),d(""),!g.selectedResidentId||!g.quanHeVoiChuHo||!g.ngayThem){d("Vui lòng điền đầy đủ thông tin");return}const T=r.find(S=>S.id.toString()===g.selectedResidentId);if(!T){d("Nhân khẩu không hợp lệ");return}try{h(!0),a&&await Xn.addToHousehold({residentId:T.id,householdId:a,quanHeVoiChuHo:g.quanHeVoiChuHo,ngayThem:g.ngayThem}),n({residentId:T.id,tenNhanKhau:T.name,quanHeVoiChuHo:g.quanHeVoiChuHo,ngayThem:g.ngayThem}),p({selectedResidentId:"",quanHeVoiChuHo:"",ngayThem:""}),t()}catch(S){console.error("Error adding resident to household:",S),d(S.message||"Có lỗi xảy ra khi thêm nhân khẩu vào hộ khẩu")}finally{h(!1)}};return e?c.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md max-h-[90vh] overflow-y-auto relative",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Thêm Nhân khẩu vào Hộ khẩu"}),c.jsx("button",{onClick:t,className:"w-10 h-10 flex items-center justify-center rounded-full bg-gray-100 hover:bg-gray-200 transition",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("form",{onSubmit:_,className:"space-y-6",children:[f&&c.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:c.jsx("p",{className:"text-red-700 text-sm",children:f})}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Nhân khẩu ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsxs("select",{name:"selectedResidentId",value:g.selectedResidentId,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none appearance-none",required:!0,disabled:o,children:[c.jsx("option",{value:"",children:o?"Đang tải...":"Chọn nhân khẩu"}),r.map(b=>c.jsxs("option",{value:b.id.toString(),children:[b.name," - ",b.cccd]},b.id)),r.length===0&&!o&&c.jsx("option",{value:"",disabled:!0,children:"Không có nhân khẩu khả dụng"})]}),r.length===0&&!o&&c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Tất cả nhân khẩu đã được phân bổ vào các hộ khẩu"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Quan hệ với chủ hộ ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsxs("select",{name:"quanHeVoiChuHo",value:g.quanHeVoiChuHo,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none appearance-none",required:!0,children:[c.jsx("option",{value:"",children:"Chọn quan hệ"}),c.jsx("option",{value:"con",children:"Con"}),c.jsx("option",{value:"vợ/chồng",children:"Vợ/Chồng"}),c.jsx("option",{value:"bố/mẹ",children:"Bố/Mẹ"}),c.jsx("option",{value:"khác",children:"Khác"})]})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Ngày thêm ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"date",name:"ngayThem",value:g.ngayThem,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",required:!0})]}),c.jsxs("div",{className:"flex justify-end gap-4 mt-8",children:[c.jsx("button",{type:"button",onClick:t,className:"px-5 py-2 border border-gray-300 rounded-xl text-gray-700 font-semibold bg-white hover:bg-gray-50 shadow-sm",children:"Hủy"}),c.jsx("button",{type:"submit",disabled:o||r.length===0,className:`px-5 py-2 rounded-xl font-semibold shadow transition ${o||r.length===0?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600"}`,children:o?"Đang thêm...":"Thêm"})]})]})]})}):null},zk=({isOpen:e,onClose:t,householdId:n})=>{var S,E,C,A,F;const[a,r]=j.useState(null),[l,o]=j.useState(!1),[h,f]=j.useState(null),[d,g]=j.useState(!1),[p,y]=j.useState({maHoKhau:"",diaChi:"",lyDoTao:""});j.useEffect(()=>{e&&n&&w()},[e,n]);const w=async()=>{if(n){o(!0),f(null);try{const K=await Na.getById(n);if(K.success){const D=K.data;r(D),y({maHoKhau:D.maHoKhau,diaChi:D.diaChi,lyDoTao:D.lyDoTao})}}catch(K){f(K instanceof Error?K.message:"Lỗi khi tải thông tin hộ khẩu")}finally{o(!1)}}},_=K=>{const{name:D,value:H}=K.target;y(M=>({...M,[D]:H}))},b=async K=>{if(K.preventDefault(),!!n){o(!0),f(null);try{(await Na.update(n,p)).success&&t()}catch(D){f(D instanceof Error?D.message:"Lỗi khi cập nhật hộ khẩu")}finally{o(!1)}}},T=K=>new Date(K).toLocaleDateString("vi-VN");return e?c.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-4xl max-h-[90vh] overflow-y-auto relative",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Chỉnh sửa Hộ khẩu"}),c.jsx("button",{onClick:t,className:"w-10 h-10 flex items-center justify-center rounded-full bg-gray-100 hover:bg-gray-200 transition",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l&&c.jsxs("div",{className:"flex items-center justify-center py-12",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"}),c.jsx("span",{className:"ml-3 text-gray-600",children:"Đang tải dữ liệu..."})]}),h&&c.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:c.jsx("p",{className:"text-red-600",children:h})}),!l&&a&&c.jsxs("form",{onSubmit:b,className:"space-y-6",children:[c.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Thông tin cơ bản"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Mã hộ khẩu"}),c.jsx("input",{type:"text",name:"maHoKhau",value:p.maHoKhau,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Ngày lập"}),c.jsx("input",{type:"text",value:T(a.ngayLap),disabled:!0,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] bg-gray-100 text-gray-600"})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Địa chỉ"}),c.jsx("input",{type:"text",name:"diaChi",value:p.diaChi,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none"})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Lý do tạo"}),c.jsx("textarea",{name:"lyDoTao",value:p.lyDoTao,onChange:_,rows:3,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none"})]})]})]}),c.jsxs("div",{className:"bg-blue-50 rounded-xl p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Thông tin chủ hộ"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Họ tên"}),c.jsx("input",{type:"text",value:((S=a.chuHo)==null?void 0:S.hoTen)||"",disabled:!0,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] bg-gray-100 text-gray-600"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Ngày sinh"}),c.jsx("input",{type:"text",value:(E=a.chuHo)!=null&&E.ngaySinh?T(a.chuHo.ngaySinh):"",disabled:!0,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] bg-gray-100 text-gray-600"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Giới tính"}),c.jsx("input",{type:"text",value:((C=a.chuHo)==null?void 0:C.gioiTinh)||"",disabled:!0,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] bg-gray-100 text-gray-600"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Số CCCD"}),c.jsx("input",{type:"text",value:((A=a.chuHo)==null?void 0:A.soCCCD)||"",disabled:!0,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] bg-gray-100 text-gray-600"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Số điện thoại"}),c.jsx("input",{type:"text",value:((F=a.chuHo)==null?void 0:F.soDienThoai)||"",disabled:!0,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] bg-gray-100 text-gray-600"})]})]})]}),c.jsxs("div",{className:"bg-green-50 rounded-xl p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Danh sách thành viên (",a.thanhVien.length,")"]}),c.jsxs("button",{type:"button",onClick:()=>g(!0),className:"flex items-center gap-2 bg-green-500 text-white px-4 py-2 rounded-xl font-semibold shadow hover:bg-green-600 transition",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thêm thành viên"]})]}),a.thanhVien.length===0?c.jsx("p",{className:"text-gray-500 text-center py-8",children:"Chưa có thành viên nào trong hộ khẩu"}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase",children:"Họ tên"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase",children:"Quan hệ với chủ hộ"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase",children:"Ngày sinh"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase",children:"Giới tính"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase",children:"Ngày vào hộ"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase",children:"Trạng thái"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.thanhVien.map(K=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:K.nhanKhau.hoTen}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:K.quanHeVoiChuHo}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:T(K.nhanKhau.ngaySinh)}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:K.nhanKhau.gioiTinh}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:T(K.ngayVaoHo)}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${K.ngayRoiHo?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:K.ngayRoiHo?"Đã rời hộ":"Đang sinh sống"})})]},K.id))})]})})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[c.jsx("button",{type:"button",onClick:t,className:"px-6 py-2 border border-gray-300 rounded-xl text-gray-700 font-semibold hover:bg-gray-50 transition",children:"Hủy"}),c.jsx("button",{type:"submit",disabled:l,className:"px-6 py-2 bg-blue-500 text-white rounded-xl font-semibold hover:bg-blue-600 transition disabled:opacity-50",children:l?"Đang cập nhật...":"Cập nhật"})]})]}),c.jsx(mb,{isOpen:d,onClose:()=>g(!1),onAdd:K=>{console.log("Adding member:",K),g(!1),w()},householdId:n})]})}):null},Uk=({isOpen:e,onClose:t,onSuccess:n})=>{const[a,r]=j.useState({maHoKhau:"",soPhong:"",soNha:"",duong:"",phuong:"Nhân Chính",quan:"Thanh Xuân",thanhPho:"Hà Nội",chuHoId:"",ngayLap:new Date().toISOString().split("T")[0]}),[l,o]=j.useState([]),[h,f]=j.useState(!1),[d,g]=j.useState(!1),[p,y]=j.useState(""),[w,_]=j.useState({maHoKhau:!1,soPhong:!1,soNha:!1,duong:!1,chuHoId:!1});j.useEffect(()=>{e&&(S(),T(),b(),y(""))},[e]);const b=()=>{r({maHoKhau:"",soPhong:"",soNha:"",duong:"",phuong:"Nhân Chính",quan:"Thanh Xuân",thanhPho:"Hà Nội",chuHoId:"",ngayLap:new Date().toISOString().split("T")[0]}),_({maHoKhau:!1,soPhong:!1,soNha:!1,duong:!1,chuHoId:!1})},T=()=>{const F=new Date,K=F.getFullYear().toString().slice(-2),D=(F.getMonth()+1).toString().padStart(2,"0"),H=F.getDate().toString().padStart(2,"0"),M=F.getHours().toString().padStart(2,"0"),B=F.getMinutes().toString().padStart(2,"0"),I=`HK${K}${D}${H}${M}${B}`;r(te=>({...te,maHoKhau:I}))},S=async()=>{f(!0);try{const F=await Xn.getAll();F.success&&F.data&&o(F.data.residents||[])}catch(F){console.error("Lỗi khi tải danh sách nhân khẩu:",F),y("Không thể tải danh sách nhân khẩu")}finally{f(!1)}},E=F=>{const{name:K,value:D}=F.target;r(H=>({...H,[K]:D})),w[K]&&_(H=>({...H,[K]:!1}))},C=()=>{const F={maHoKhau:!a.maHoKhau.trim(),soPhong:!a.soPhong.trim(),soNha:!a.soNha.trim(),duong:!a.duong.trim(),chuHoId:!1};return _(F),!Object.values(F).some(K=>K)},A=async F=>{var K,D;if(F.preventDefault(),!C()){y("Vui lòng điền đầy đủ thông tin bắt buộc");return}g(!0),y("");try{const H=`${a.soNha}, ${a.duong}, ${a.phuong}, ${a.quan}, ${a.thanhPho}`,M={chuHoId:a.chuHoId||null,diaChi:H,ngayLap:a.ngayLap,soPhong:a.soPhong},B=await Na.create(M);B.success?(n&&n(),t()):y(B.message||"Có lỗi xảy ra khi tạo hộ khẩu")}catch(H){console.error("Lỗi khi tạo hộ khẩu:",H),y(((D=(K=H.response)==null?void 0:K.data)==null?void 0:D.message)||"Có lỗi xảy ra khi tạo hộ khẩu")}finally{g(!1)}};return e?c.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-4xl max-h-[90vh] overflow-y-auto relative",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Thêm hộ khẩu mới"}),c.jsx("button",{onClick:t,className:"w-10 h-10 flex items-center justify-center rounded-full bg-gray-100 hover:bg-gray-200 transition",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),p&&c.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:c.jsx("p",{className:"text-red-600",children:p})}),c.jsxs("form",{onSubmit:A,className:"space-y-6",children:[c.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Thông tin cơ bản"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Mã hộ khẩu ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",name:"maHoKhau",value:a.maHoKhau,onChange:E,className:`block w-full rounded-xl border px-4 py-2 text-[15px] shadow-sm focus:ring-2 focus:ring-blue-200 outline-none ${w.maHoKhau?"border-red-500":"border-gray-300 focus:border-blue-500"}`,placeholder:"Ví dụ: HK2501120830"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Số phòng ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",name:"soPhong",value:a.soPhong,onChange:E,className:`block w-full rounded-xl border px-4 py-2 text-[15px] shadow-sm focus:ring-2 focus:ring-blue-200 outline-none ${w.soPhong?"border-red-500":"border-gray-300 focus:border-blue-500"}`,placeholder:"Ví dụ: 101, 202, A301..."})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Ngày lập"}),c.jsx("input",{type:"date",name:"ngayLap",value:a.ngayLap,onChange:E,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none"})]})]})]}),c.jsxs("div",{className:"bg-blue-50 rounded-xl p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Thông tin địa chỉ"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Số nhà ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",name:"soNha",value:a.soNha,onChange:E,className:`block w-full rounded-xl border px-4 py-2 text-[15px] shadow-sm focus:ring-2 focus:ring-blue-200 outline-none ${w.soNha?"border-red-500":"border-gray-300 focus:border-blue-500"}`,placeholder:"Ví dụ: 123, 45A, số 67..."})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Đường ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",name:"duong",value:a.duong,onChange:E,className:`block w-full rounded-xl border px-4 py-2 text-[15px] shadow-sm focus:ring-2 focus:ring-blue-200 outline-none ${w.duong?"border-red-500":"border-gray-300 focus:border-blue-500"}`,placeholder:"Ví dụ: Nguyễn Trãi, Lê Lợi..."})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Phường"}),c.jsx("input",{type:"text",name:"phuong",value:a.phuong,onChange:E,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Quận"}),c.jsx("input",{type:"text",name:"quan",value:a.quan,onChange:E,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Thành phố"}),c.jsx("input",{type:"text",name:"thanhPho",value:a.thanhPho,onChange:E,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none"})]})]})]}),c.jsxs("div",{className:"bg-green-50 rounded-xl p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Chủ hộ (tùy chọn)"}),c.jsx("div",{className:"grid grid-cols-1 gap-4",children:c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Chọn chủ hộ"}),c.jsxs("select",{name:"chuHoId",value:a.chuHoId,onChange:E,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none appearance-none",disabled:h,children:[c.jsx("option",{value:"",children:h?"Đang tải...":"Để trống nếu chưa có chủ hộ"}),l.map(F=>c.jsxs("option",{value:F.id,children:[F.hoTen," - ",F.cccd]},F.id))]}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Lưu ý: Có thể để trống nếu căn hộ chưa có chủ hộ xác định"})]})})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[c.jsx("button",{type:"button",onClick:t,className:"px-6 py-2 border border-gray-300 rounded-xl text-gray-700 font-semibold hover:bg-gray-50 transition",children:"Hủy"}),c.jsx("button",{type:"submit",disabled:d||h,className:"px-6 py-2 bg-blue-500 text-white rounded-xl font-semibold hover:bg-blue-600 transition disabled:opacity-50",children:d?"Đang tạo...":"Tạo hộ khẩu"})]})]})]})}):null},Vk=({isOpen:e,onClose:t,onSuccess:n,currentHousehold:a})=>{var M,B,I,te;const[r,l]=j.useState(null),[o,h]=j.useState(""),[f,d]=j.useState(null),[g,p]=j.useState([]),[y,w]=j.useState(!1),[_,b]=j.useState(!1),[T,S]=j.useState(""),E=a?parseInt(a.soHoKhau.replace("HK","")):null;j.useEffect(()=>{e&&E&&(A(),F()),e||C()},[e,E]);const C=()=>{l(null),h(""),d(null),p([]),S("")},A=async()=>{if(E)try{w(!0),S("");const q=await Na.getById(E);q.success?d(q.data):S("Không thể tải thông tin hộ khẩu")}catch(q){console.error("Error fetching household data:",q),S("Có lỗi xảy ra khi tải thông tin hộ khẩu")}finally{w(!1)}},F=async()=>{try{const q=await Xn.getAvailable();q.success&&p(q.data||[])}catch(q){console.error("Error fetching available residents:",q)}},K=async()=>{var q,ae;if(!(!r||!E))try{b(!0),S("");const re=await Na.assignHead(E,r);re.success?(n&&n(),t()):S(re.message||"Có lỗi xảy ra khi gán chủ hộ")}catch(re){console.error("Error assigning household head:",re),S(((ae=(q=re.response)==null?void 0:q.data)==null?void 0:ae.message)||"Có lỗi xảy ra khi gán chủ hộ")}finally{b(!1)}},H=[...((M=f==null?void 0:f.thanhVien)==null?void 0:M.map(q=>({...q.nhanKhau,quanHeVoiChuHo:q.quanHeVoiChuHo,isCurrentMember:!0})).filter(q=>q.hoTen&&q.cccd))||[],...g.map(q=>({...q,quanHeVoiChuHo:"Ngoài hộ",isCurrentMember:!1})).filter(q=>q.hoTen&&q.cccd)].filter(q=>{var ae,re;return((ae=q.hoTen)==null?void 0:ae.toLowerCase().includes(o.toLowerCase()))||!1||((re=q.cccd)==null?void 0:re.includes(o))||!1});return e?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] overflow-hidden",children:[c.jsxs("div",{className:"bg-blue-600 text-white p-4 flex justify-between items-center",children:[c.jsxs("h2",{className:"text-lg font-semibold",children:["Gán/Sửa Chủ Hộ - ",(a==null?void 0:a.soHoKhau)||"N/A"]}),c.jsx("button",{onClick:t,className:"text-white hover:text-gray-200 transition-colors",disabled:_,children:c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[c.jsx("h3",{className:"text-md font-semibold text-gray-800 mb-2",children:"Thông tin hộ khẩu:"}),c.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[c.jsxs("div",{children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Số hộ khẩu:"})," ",a==null?void 0:a.soHoKhau]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Chủ hộ hiện tại:"})," ",((B=f==null?void 0:f.chuHo)==null?void 0:B.hoTen)||"Chưa có"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"CCCD chủ hộ:"})," ",((I=f==null?void 0:f.chuHo)==null?void 0:I.cccd)||"N/A"]})]}),c.jsxs("div",{children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Địa chỉ:"})," ",(f==null?void 0:f.diaChi)||`${a==null?void 0:a.soNha}, ${a==null?void 0:a.duong}, ${a==null?void 0:a.phuong}`]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Số thành viên:"})," ",((te=f==null?void 0:f.thanhVien)==null?void 0:te.length)||0]})]})]})]}),T&&c.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:c.jsx("p",{className:"text-red-600 text-sm",children:T})}),y&&c.jsx("div",{className:"mb-4 p-4 text-center",children:c.jsx("p",{className:"text-gray-600",children:"Đang tải dữ liệu..."})}),c.jsx("div",{className:"mb-4",children:c.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md shadow-sm overflow-hidden",children:[c.jsx("div",{className:"p-2 text-gray-400",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),c.jsx("input",{type:"text",placeholder:"Tìm kiếm theo tên hoặc CCCD...",className:"flex-1 p-2 border-l border-gray-300 outline-none text-sm",value:o,onChange:q=>h(q.target.value),disabled:y||_})]})}),!y&&c.jsxs("div",{className:"mb-6",children:[c.jsxs("h3",{className:"text-md font-semibold text-gray-800 mb-3",children:["Chọn người làm chủ hộ mới (",H.length," người):"]}),c.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden max-h-96 overflow-y-auto",children:[c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Chọn"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Họ tên"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ngày sinh"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Giới tính"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CCCD"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trạng thái"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:H.map(q=>c.jsxs("tr",{className:`hover:bg-blue-50 cursor-pointer ${r===q.id?"bg-blue-100":""}`,onClick:()=>l(q.id),children:[c.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:c.jsx("input",{type:"radio",name:"selectedMember",value:q.id,checked:r===q.id,onChange:ae=>l(parseInt(ae.target.value)),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300",disabled:_})}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:q.hoTen||"N/A"}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:q.ngaySinh?new Date(q.ngaySinh).toLocaleDateString("vi-VN"):"N/A"}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:q.gioiTinh||"N/A"}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:q.cccd||"N/A"}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:c.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${q.isCurrentMember?q.quanHeVoiChuHo==="chủ hộ"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:q.isCurrentMember?q.quanHeVoiChuHo:"Ngoài hộ"})})]},q.id))})]}),H.length===0&&!y&&c.jsx("div",{className:"p-4 text-center text-gray-500",children:"Không tìm thấy người nào phù hợp"})]})]}),c.jsxs("div",{className:"flex justify-end gap-3",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",disabled:_,children:"Hủy"}),c.jsx("button",{onClick:K,disabled:!r||_||y,className:`px-4 py-2 rounded-md transition-colors ${r&&!_&&!y?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:_?"Đang xử lý...":"Gán làm chủ hộ"})]})]})]})}):null},Kk=()=>{var P,Z;const[e,t]=j.useState(!1),[n,a]=j.useState(!1),[r,l]=j.useState(!1),[o,h]=j.useState(!1),[f,d]=j.useState(null),[g,p]=j.useState(null),[y,w]=j.useState(""),[_,b]=j.useState("soHoKhau"),[T,S]=j.useState(!0),[E,C]=j.useState({isOpen:!1,hoKhau:null}),[A,F]=j.useState([]),[K,D]=j.useState(!1),[H,M]=j.useState(null);j.useEffect(()=>{B()},[]);const B=async()=>{D(!0),M(null);try{const k=await Na.getAll();k.success&&k.data&&k.data.households&&F(k.data.households)}catch(k){M(k instanceof Error?k.message:"Lỗi khi tải danh sách hộ khẩu"),console.error("Error loading households:",k)}finally{D(!1)}},I=(k=void 0)=>{d(k||null),t(!0)},te=()=>{t(!1),d(null),B()},q=()=>{a(!0)},ae=()=>{a(!1),B()},re=k=>{p(k),h(!0)},ee=()=>{h(!1),p(null)},Q=k=>{console.log("Adding member:",k)},pe=()=>{B(),ee()},ye=async()=>{var k,V;if(E.hoKhau){D(!0),M(null);try{const U=await Na.delete(E.hoKhau.soHoKhau);U.success?(await B(),C({isOpen:!1,hoKhau:null})):M(U.message||"Có lỗi xảy ra khi xóa hộ khẩu")}catch(U){console.error("Error deleting household:",U),M(((V=(k=U.response)==null?void 0:k.data)==null?void 0:V.message)||U.message||"Có lỗi xảy ra khi xóa hộ khẩu")}finally{D(!1)}}},de=[...A.filter(k=>{var U;if(!y)return!0;const V=y.toLowerCase();return k.soHoKhau.toString().includes(V)||(((U=k.chuHoInfo)==null?void 0:U.hoTen)||"").toLowerCase().includes(V)||k.soNha.toLowerCase().includes(V)||k.duong.toLowerCase().includes(V)})].sort((k,V)=>{var ie,we;let U,Te;return _==="chuHo"?(U=((ie=k.chuHoInfo)==null?void 0:ie.hoTen)||"",Te=((we=V.chuHoInfo)==null?void 0:we.hoTen)||""):(U=k[_],Te=V[_]),typeof U=="string"&&(U=U.toLowerCase(),Te=Te.toLowerCase()),U<Te?T?-1:1:U>Te?T?1:-1:0});return K?c.jsx(On,{role:"totruong",children:c.jsx("div",{className:"p-6",children:c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsx("div",{className:"text-lg text-gray-600",children:"Đang tải danh sách hộ khẩu..."})})})}):H?c.jsx(On,{role:"totruong",children:c.jsx("div",{className:"p-6",children:c.jsxs("div",{className:"flex items-center justify-center min-h-[400px]",children:[c.jsxs("div",{className:"text-lg text-red-600",children:["Lỗi: ",H]}),c.jsx("button",{onClick:B,className:"ml-4 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600",children:"Thử lại"})]})})}):c.jsxs(c.Fragment,{children:[c.jsx(On,{role:"totruong",children:c.jsxs("div",{className:"p-6",children:[c.jsx("div",{className:"flex items-center justify-between mb-6",children:c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Quản lý hộ khẩu"})}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[c.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md shadow-sm overflow-hidden flex-1",children:[c.jsx("div",{className:"p-2 text-gray-400",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),c.jsx("input",{type:"text",placeholder:"Tìm theo số hộ khẩu, tên chủ hộ",className:"flex-1 p-2 border-l border-gray-300 outline-none text-sm",value:y,onChange:k=>w(k.target.value)})]}),c.jsxs("button",{onClick:q,className:"bg-blue-500 text-white px-4 py-2 rounded-md shadow-sm hover:bg-blue-600 flex items-center gap-2",children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thêm hộ khẩu"]})]}),c.jsxs("div",{className:"mt-6 bg-white rounded-md shadow-md overflow-hidden border border-gray-200",children:[c.jsx("div",{className:"p-4 bg-gray-100 border-b border-gray-200",children:c.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Danh sách hộ khẩu"})}),c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[[{key:"soHoKhau",label:"Sổ hộ khẩu"},{key:"chuHo",label:"Chủ hộ"},{key:"soNha",label:"Số nhà"},{key:"duong",label:"Đường"},{key:"phuong",label:"Phường"},{key:"quan",label:"Quận"},{key:"thanhPho",label:"Thành phố"},{key:"ngayLamHoKhau",label:"Ngày làm hộ khẩu"}].map(k=>c.jsxs("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider cursor-pointer select-none",onClick:()=>{_===k.key?S(!T):(b(k.key),S(!0))},children:[k.label," ",_===k.key?T?"▲":"▼":""]},k.key)),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Thao tác"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:de.map(k=>{var V;return c.jsxs("tr",{className:"hover:bg-blue-50 cursor-pointer",onClick:()=>I(k),children:[c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:["HK",k.soHoKhau.toString().padStart(3,"0")]}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((V=k.chuHoInfo)==null?void 0:V.hoTen)||"N/A"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:k.soNha}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:k.duong}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:k.phuong}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:k.quan}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:k.thanhPho}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:k.ngayLamHoKhau}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-600",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:U=>{U.stopPropagation(),I(k)},className:"p-1 hover:bg-blue-100 rounded transition-colors",title:"Chỉnh sửa hộ khẩu",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),c.jsx("button",{onClick:U=>{U.stopPropagation(),re(k)},className:"p-1 hover:bg-green-100 rounded transition-colors text-green-600",title:"Gán chủ hộ",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),c.jsx("button",{onClick:U=>{U.stopPropagation(),C({isOpen:!0,hoKhau:k})},className:"p-1 hover:bg-red-100 rounded text-red-600",title:"Xoá hộ khẩu",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},k.soHoKhau)})})]})]})]})}),c.jsx(zk,{isOpen:e,onClose:te,householdId:f?f.soHoKhau:void 0}),c.jsx(Uk,{isOpen:n,onClose:ae}),c.jsx(mb,{isOpen:r,onClose:()=>l(!1),onAdd:Q,householdId:f?f.soHoKhau:void 0}),c.jsx(Vk,{isOpen:o,onClose:ee,onSuccess:pe,currentHousehold:g?{soHoKhau:`HK${g.soHoKhau.toString().padStart(3,"0")}`,chuHo:((P=g.chuHoInfo)==null?void 0:P.hoTen)||"",soNha:g.soNha,duong:g.duong,phuong:g.phuong,quan:g.quan,thanhPho:g.thanhPho,ngayLamHoKhau:g.ngayLamHoKhau}:null}),E.isOpen&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md shadow-md",children:[c.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-4",children:"Xác nhận xoá"}),c.jsxs("p",{className:"text-sm text-gray-700",children:["Bạn có chắc chắn muốn xoá hộ khẩu ",c.jsxs("strong",{children:["HK",(Z=E.hoKhau)==null?void 0:Z.soHoKhau.toString().padStart(3,"0")]})," không?"]}),H&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-md",children:c.jsx("p",{className:"text-sm text-red-600",children:H})}),c.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[c.jsx("button",{onClick:()=>{C({isOpen:!1,hoKhau:null}),M(null)},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300",disabled:K,children:"Huỷ"}),c.jsx("button",{onClick:ye,className:"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 disabled:opacity-50 disabled:cursor-not-allowed",disabled:K,children:K?"Đang xóa...":"Xoá"})]})]})})]})},Wk=({isOpen:e,onClose:t,onSuccess:n})=>{const[a,r]=j.useState({hoTen:"",ngaySinh:"",gioiTinh:"",danToc:"",tonGiao:"",cccd:"",ngayCap:"",noiCap:"",ngheNghiep:"",soDienThoai:"",selectedHouseholdId:"",quanHeVoiChuHo:""}),[l,o]=j.useState([]),[h,f]=j.useState(!1),[d,g]=j.useState(""),[p,y]=j.useState(!1);j.useEffect(()=>{e&&(w(),r({hoTen:"",ngaySinh:"",gioiTinh:"",danToc:"",tonGiao:"",cccd:"",ngayCap:"",noiCap:"",ngheNghiep:"",soDienThoai:"",selectedHouseholdId:"",quanHeVoiChuHo:""}),g(""))},[e]);const w=async()=>{try{f(!0);const T=await Na.getAll();T.success&&T.data?o(T.data.households||[]):g("Không thể tải danh sách hộ khẩu")}catch(T){console.error("Error fetching households:",T),g(T.message||"Có lỗi xảy ra khi tải danh sách hộ khẩu")}finally{f(!1)}},_=T=>{const{name:S,value:E}=T.target;r(C=>({...C,[S]:E})),S==="selectedHouseholdId"&&r(C=>({...C,selectedHouseholdId:E,quanHeVoiChuHo:""}))},b=async T=>{if(T.preventDefault(),!a.hoTen.trim()){g("Vui lòng nhập họ tên");return}if(!a.ngaySinh){g("Vui lòng chọn ngày sinh");return}if(!a.gioiTinh){g("Vui lòng chọn giới tính");return}if(!a.cccd.trim()){g("Vui lòng nhập số CCCD");return}if(a.selectedHouseholdId&&!a.quanHeVoiChuHo){g("Vui lòng chọn quan hệ với chủ hộ");return}try{y(!0),g(""),console.log("Creating new resident:",a);const S=await Xn.create(a);if(S.success)console.log("Resident created successfully:",S.data),n&&n(),t();else throw new Error(S.message||"Không thể tạo nhân khẩu")}catch(S){console.error("Error creating resident:",S),g(S.message||"Có lỗi xảy ra khi tạo nhân khẩu")}finally{y(!1)}};return e?c.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-xl max-h-[90vh] overflow-y-auto relative",children:[c.jsx("div",{className:"mb-8 pb-4 border-b border-gray-300",children:c.jsx("h2",{className:"text-2xl font-bold text-gray-900 text-left",children:"Thêm Nhân khẩu "})}),c.jsxs("form",{onSubmit:b,className:"space-y-8",children:[d&&c.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:c.jsx("p",{className:"text-red-600 text-sm",children:d})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Họ tên ",c.jsx("span",{className:"text-red-500",children:"*"})," "]}),c.jsx("input",{type:"text",name:"hoTen",value:a.hoTen,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập họ tên",required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Ngày sinh ",c.jsx("span",{className:"text-red-500",children:"*"})," "]}),c.jsx("input",{type:"date",name:"ngaySinh",value:a.ngaySinh,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Giới tính ",c.jsx("span",{className:"text-red-500",children:"*"})," "]}),c.jsxs("select",{name:"gioiTinh",value:a.gioiTinh,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none appearance-none",required:!0,children:[c.jsx("option",{value:"",children:"Chọn giới tính"}),c.jsx("option",{value:"Nam",children:"Nam"}),c.jsx("option",{value:"Nữ",children:"Nữ"}),c.jsx("option",{value:"Khác",children:"Khác"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Dân tộc "}),c.jsx("input",{type:"text",name:"danToc",value:a.danToc,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập dân tộc"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Tôn giáo"}),c.jsx("input",{type:"text",name:"tonGiao",value:a.tonGiao,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập tôn giáo"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["CCCD ",c.jsx("span",{className:"text-red-500",children:"*"})," "]}),c.jsx("input",{type:"text",name:"cccd",value:a.cccd,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập số CCCD",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Ngày cấp"}),c.jsx("input",{type:"date",name:"ngayCap",value:a.ngayCap,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Nơi cấp"}),c.jsx("input",{type:"text",name:"noiCap",value:a.noiCap,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập nơi cấp"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Nghề nghiệp"}),c.jsx("input",{type:"text",name:"ngheNghiep",value:a.ngheNghiep,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập nghề nghiệp"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Số điện thoại"}),c.jsx("input",{type:"tel",name:"soDienThoai",value:a.soDienThoai,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập số điện thoại"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Hộ khẩu (tùy chọn)"}),c.jsxs("select",{name:"selectedHouseholdId",value:a.selectedHouseholdId,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none appearance-none",disabled:h,children:[c.jsx("option",{value:"",children:h?"Đang tải...":"Chọn hộ khẩu (để trống nếu tạo hộ mới)"}),l.map(T=>c.jsxs("option",{value:T.id,children:["HK",T.soHoKhau.toString().padStart(3,"0")," - ",T.diaChi]},T.id))]})]}),a.selectedHouseholdId&&c.jsxs("div",{className:"md:col-span-2",children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Quan hệ với chủ hộ ",c.jsx("span",{className:"text-red-500",children:"*"})," "]}),c.jsxs("select",{name:"quanHeVoiChuHo",value:a.quanHeVoiChuHo,onChange:_,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none appearance-none",required:!0,children:[c.jsx("option",{value:"",children:"Chọn quan hệ"}),c.jsx("option",{value:"Con",children:"Con"}),c.jsx("option",{value:"Vợ/Chồng",children:"Vợ/Chồng"}),c.jsx("option",{value:"Cha/Mẹ",children:"Cha/Mẹ"}),c.jsx("option",{value:"Anh/Chị/Em",children:"Anh/Chị/Em"}),c.jsx("option",{value:"Khác",children:"Khác"})]}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Nhân khẩu sẽ được thêm vào hộ khẩu đã chọn"})]}),!a.selectedHouseholdId&&c.jsx("div",{className:"md:col-span-2",children:c.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:c.jsxs("p",{className:"text-blue-800 text-sm",children:[c.jsx("strong",{children:"Lưu ý:"})," Nếu không chọn hộ khẩu, nhân khẩu sẽ được tạo riêng lẻ và có thể tạo hộ khẩu mới sau."]})})})]}),c.jsxs("div",{className:"flex justify-between gap-4 mt-8",children:[c.jsx("button",{type:"button",onClick:t,disabled:p,className:"px-8 py-2 border border-gray-300 rounded-xl text-gray-700 font-bold bg-gray-100 hover:bg-gray-200 shadow-sm text-lg disabled:opacity-50",children:"Hủy"}),c.jsx("button",{type:"submit",disabled:p||h,className:"px-8 py-2 bg-blue-500 text-white rounded-xl font-bold shadow hover:bg-blue-600 transition text-lg disabled:opacity-50 disabled:cursor-not-allowed",children:p?c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Đang lưu..."]}):"Lưu"})]})]})]})}):null},Gk=({isOpen:e,onClose:t,onSuccess:n,residentId:a})=>{const[r,l]=j.useState({hoTen:"",ngaySinh:"",gioiTinh:"",danToc:"",tonGiao:"",cccd:"",ngayCap:"",noiCap:"",ngheNghiep:"",soDienThoai:"",ghiChu:""}),[o,h]=j.useState(!1),[f,d]=j.useState(""),[g,p]=j.useState(!1);j.useEffect(()=>{e&&a&&y()},[e,a]);const y=async()=>{try{h(!0);const b=await Xn.getById(a);if(b.success&&b.data){const T=b.data;l({hoTen:T.hoTen||"",ngaySinh:T.ngaySinh?new Date(T.ngaySinh).toISOString().split("T")[0]:"",gioiTinh:T.gioiTinh||"",danToc:T.danToc||"",tonGiao:T.tonGiao||"",cccd:T.cccd||"",ngayCap:T.ngayCap?new Date(T.ngayCap).toISOString().split("T")[0]:"",noiCap:T.noiCap||"",ngheNghiep:T.ngheNghiep||"",soDienThoai:T.soDienThoai||"",ghiChu:T.ghiChu||""})}else d("Không thể tải thông tin nhân khẩu")}catch(b){console.error("Error fetching resident data:",b),d(b.message||"Có lỗi xảy ra khi tải thông tin nhân khẩu")}finally{h(!1)}},w=b=>{const{name:T,value:S}=b.target;l(E=>({...E,[T]:S}))},_=async b=>{var T,S;if(b.preventDefault(),!r.hoTen.trim()){d("Vui lòng nhập họ tên");return}if(!r.ngaySinh){d("Vui lòng chọn ngày sinh");return}if(!r.gioiTinh){d("Vui lòng chọn giới tính");return}if(!r.cccd.trim()){d("Vui lòng nhập số CCCD");return}try{p(!0),d("");const E=await Xn.update(a,r);E.success?(n==null||n(),t()):d(E.message||"Có lỗi xảy ra khi cập nhật nhân khẩu")}catch(E){console.error("Error updating resident:",E),d(((S=(T=E.response)==null?void 0:T.data)==null?void 0:S.message)||E.message||"Có lỗi xảy ra khi cập nhật nhân khẩu")}finally{p(!1)}};return e?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[c.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 rounded-t-2xl",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Chỉnh sửa thông tin nhân khẩu"}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 text-2xl font-bold",disabled:g,children:"×"})]})}),c.jsx("div",{className:"p-6",children:o?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Đang tải thông tin..."})]}):c.jsxs("form",{onSubmit:_,className:"space-y-6",children:[f&&c.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl",children:f}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Họ tên ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",name:"hoTen",value:r.hoTen,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập họ tên",required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Ngày sinh ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"date",name:"ngaySinh",value:r.ngaySinh,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["Giới tính ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsxs("select",{name:"gioiTinh",value:r.gioiTinh,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none appearance-none",required:!0,children:[c.jsx("option",{value:"",children:"Chọn giới tính"}),c.jsx("option",{value:"Nam",children:"Nam"}),c.jsx("option",{value:"Nữ",children:"Nữ"}),c.jsx("option",{value:"Khác",children:"Khác"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Dân tộc"}),c.jsx("input",{type:"text",name:"danToc",value:r.danToc,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập dân tộc"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Tôn giáo"}),c.jsx("input",{type:"text",name:"tonGiao",value:r.tonGiao,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập tôn giáo"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["CCCD ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",name:"cccd",value:r.cccd,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập số CCCD",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Ngày cấp"}),c.jsx("input",{type:"date",name:"ngayCap",value:r.ngayCap,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Nơi cấp"}),c.jsx("input",{type:"text",name:"noiCap",value:r.noiCap,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập nơi cấp"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Nghề nghiệp"}),c.jsx("input",{type:"text",name:"ngheNghiep",value:r.ngheNghiep,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập nghề nghiệp"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Số điện thoại"}),c.jsx("input",{type:"tel",name:"soDienThoai",value:r.soDienThoai,onChange:w,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none",placeholder:"Nhập số điện thoại"})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Ghi chú"}),c.jsx("textarea",{name:"ghiChu",value:r.ghiChu,onChange:w,rows:3,className:"block w-full rounded-xl border border-gray-300 px-4 py-2 text-[15px] shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none resize-none",placeholder:"Nhập ghi chú (nếu có)"})]})]}),c.jsxs("div",{className:"flex gap-3 pt-6 border-t border-gray-200",children:[c.jsx("button",{type:"button",onClick:t,disabled:g,className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-xl font-medium hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-200 disabled:opacity-50",children:"Hủy"}),c.jsx("button",{type:"submit",disabled:g,className:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-xl font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-200 disabled:opacity-50 disabled:cursor-not-allowed",children:g?c.jsxs("span",{className:"flex items-center justify-center",children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Đang cập nhật..."]}):"Cập nhật"})]})]})})]})}):null},Xk=({isOpen:e,onClose:t,selectedResident:n})=>{var te,q;const[a,r]=j.useState(""),[l,o]=j.useState(""),[h,f]=j.useState(!1),[d,g]=j.useState(""),[p,y]=j.useState(""),[w,_]=j.useState([]),[b,T]=j.useState(null),[S,E]=j.useState(!1),[C,A]=j.useState(""),[F,K]=j.useState(!1);j.useEffect(()=>{e&&n&&(D(),H())},[e,n]);const D=async()=>{try{E(!0),A("");const ae=await Na.getAvailable();ae.success&&ae.data?_(ae.data):A("Không thể tải danh sách hộ khẩu")}catch(ae){console.error("Error fetching households:",ae),A(ae.message||"Có lỗi xảy ra khi tải danh sách hộ khẩu")}finally{E(!1)}},H=async()=>{if(n)try{E(!0);const ae=await Xn.getHouseholdInfo(n.id);ae.success&&ae.data?T(ae.data):A("Không thể tải thông tin hộ khẩu hiện tại")}catch(ae){console.error("Error fetching household info:",ae),A(ae.message||"Có lỗi xảy ra khi tải thông tin hộ khẩu")}finally{E(!1)}},M=async ae=>{if(ae.preventDefault(),!!n){if(!h&&!a){A("Vui lòng chọn hộ gia đình đích");return}if(!h&&!p){A("Vui lòng chọn mối quan hệ với chủ hộ mới");return}if(h&&!l.trim()){A("Vui lòng nhập địa chỉ hộ gia đình mới");return}if(!d.trim()){A("Vui lòng nhập lý do tách hộ");return}try{K(!0),A("");let re=l;h&&re&&(re.includes(" - ")||re.includes(",")&&(re=re.split(",").map(ye=>ye.trim()).join(" - ")));const ee={residentId:n.id,targetType:h?"new":"existing",targetHouseholdId:h?void 0:parseInt(a),newHouseholdAddress:h?re:void 0,reason:d,quanHeVoiChuHoMoi:h?void 0:p},Q=await Xn.separateHousehold(ee);Q.success?(B(),t(),alert("Tách hộ thành công!")):A(Q.message||"Không thể tách hộ")}catch(re){console.error("Error separating household:",re);let ee="Có lỗi xảy ra khi tách hộ";re.message&&(re.message.includes("address")?ee="Lỗi định dạng địa chỉ. Vui lòng kiểm tra lại.":re.message.includes("Không tìm thấy")?ee=re.message:ee=`Lỗi: ${re.message}`),A(ee)}finally{K(!1)}}},B=()=>{r(""),o(""),f(!1),g(""),y("")},I=()=>{B(),t()};return e?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Tách hộ - Chuyển nhân khẩu"}),c.jsx("button",{onClick:I,className:"text-gray-400 hover:text-gray-600 transition-colors",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("form",{onSubmit:M,className:"p-6 space-y-6",children:[n&&c.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[c.jsx("h3",{className:"font-semibold text-blue-800 mb-3",children:"Thông tin nhân khẩu được chuyển:"}),c.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-gray-700",children:"Họ tên:"}),c.jsx("span",{className:"ml-2 text-gray-900",children:n.hoTen})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-gray-700",children:"CCCD:"}),c.jsx("span",{className:"ml-2 text-gray-900",children:n.cccd})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-gray-700",children:"Giới tính:"}),c.jsx("span",{className:"ml-2 text-gray-900",children:n.gioiTinh})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-gray-700",children:"Ngày sinh:"}),c.jsx("span",{className:"ml-2 text-gray-900",children:n.ngaySinh})]}),c.jsxs("div",{className:"col-span-2",children:[c.jsx("span",{className:"font-medium text-gray-700",children:"Nghề nghiệp:"}),c.jsx("span",{className:"ml-2 text-gray-900",children:n.ngheNghiep})]})]})]}),b&&b.householdStatus==="in_household"&&b.currentHousehold&&c.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[c.jsx("h3",{className:"font-semibold text-yellow-800 mb-3",children:"Hộ khẩu hiện tại:"}),c.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-gray-700",children:"Mã hộ khẩu:"}),c.jsxs("span",{className:"ml-2 text-gray-900",children:["HK",((te=b.currentHousehold.soHoKhau)==null?void 0:te.toString().padStart(3,"0"))||"N/A"]})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-gray-700",children:"Chủ hộ:"}),c.jsx("span",{className:"ml-2 text-gray-900",children:b.currentHousehold.chuHo||"Chưa xác định"})]}),c.jsxs("div",{className:"col-span-2",children:[c.jsx("span",{className:"font-medium text-gray-700",children:"Địa chỉ:"}),c.jsx("span",{className:"ml-2 text-gray-900",children:b.currentHousehold.diaChi||"Chưa có địa chỉ"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-gray-700",children:"Vai trò:"}),c.jsx("span",{className:"ml-2 text-gray-900",children:b.isHeadOfHousehold?c.jsx("span",{className:"text-blue-600 font-semibold",children:"Chủ hộ"}):c.jsxs("span",{className:"text-green-600",children:["Thành viên (",b.currentHousehold.quanHeVoiChuHo,")"]})})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-gray-700",children:"Số thành viên khác:"}),c.jsxs("span",{className:"ml-2 text-gray-900",children:[((q=b.otherHouseholdMembers)==null?void 0:q.length)||0," người"]})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-gray-700",children:"Ngày gia nhập:"}),c.jsx("span",{className:"ml-2 text-gray-900",children:b.currentHousehold.ngayThemVaoHo?new Date(b.currentHousehold.ngayThemVaoHo).toLocaleDateString("vi-VN"):"Chưa xác định"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-gray-700",children:"Ngày lập hộ:"}),c.jsx("span",{className:"ml-2 text-gray-900",children:b.currentHousehold.ngayLamHoKhau?new Date(b.currentHousehold.ngayLamHoKhau).toLocaleDateString("vi-VN"):"Chưa xác định"})]})]}),b.otherHouseholdMembers&&b.otherHouseholdMembers.length>0&&c.jsxs("div",{className:"mt-4 pt-3 border-t border-yellow-300",children:[c.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"Thành viên khác trong hộ:"}),c.jsxs("div",{className:"space-y-2",children:[b.otherHouseholdMembers.slice(0,3).map(ae=>c.jsxs("div",{className:"flex justify-between items-center text-sm",children:[c.jsx("span",{className:"text-gray-700",children:ae.hoTen}),c.jsxs("span",{className:"text-gray-500",children:["(",ae.quanHeVoiChuHo,")"]})]},ae.id)),b.otherHouseholdMembers.length>3&&c.jsxs("div",{className:"text-sm text-gray-500",children:["... và ",b.otherHouseholdMembers.length-3," thành viên khác"]})]})]}),c.jsxs("div",{className:"mt-3 p-3 bg-orange-100 border border-orange-300 rounded-md",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("svg",{className:"w-5 h-5 text-orange-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),c.jsx("span",{className:"text-orange-800 font-medium",children:"Lưu ý tách hộ:"})]}),c.jsx("p",{className:"text-orange-700 text-sm mt-1",children:b.separationNotes||"Cần kiểm tra điều kiện tách hộ."})]})]}),b&&b.householdStatus==="no_household"&&c.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("svg",{className:"w-5 h-5 text-gray-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),c.jsx("span",{className:"text-gray-700 font-medium",children:"Trạng thái hộ khẩu:"})]}),c.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Nhân khẩu này hiện không thuộc hộ khẩu nào. Bạn có thể tạo hộ khẩu mới với nhân khẩu này làm chủ hộ."})]}),S&&!b&&n&&c.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600 mr-3"}),c.jsx("span",{className:"text-gray-600",children:"Đang tải thông tin hộ khẩu hiện tại..."})]})}),!S&&!b&&n&&c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("svg",{className:"w-5 h-5 text-red-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),c.jsx("span",{className:"text-red-700 font-medium",children:"Cảnh báo:"})]}),c.jsx("p",{className:"text-red-600 text-sm mt-1",children:"Không tìm thấy thông tin hộ khẩu hiện tại của nhân khẩu này. Có thể nhân khẩu chưa được gán vào hộ khẩu nào."})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"font-semibold text-gray-800",children:"Chọn hộ gia đình đích:"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("label",{className:"flex items-center space-x-3",children:[c.jsx("input",{type:"radio",name:"householdType",checked:!h,onChange:()=>f(!1),className:"text-blue-600"}),c.jsx("span",{className:"text-gray-700",children:"Chuyển vào hộ gia đình có sẵn"})]}),c.jsxs("label",{className:"flex items-center space-x-3",children:[c.jsx("input",{type:"radio",name:"householdType",checked:h,onChange:()=>f(!0),className:"text-blue-600"}),c.jsx("span",{className:"text-gray-700",children:"Tạo hộ gia đình mới"})]})]}),!h&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chọn hộ gia đình:"}),c.jsxs("select",{value:a,onChange:ae=>r(ae.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!h,disabled:S,children:[c.jsx("option",{value:"",children:S?"-- Đang tải...":"-- Chọn hộ gia đình --"}),w.map(ae=>{var re;return c.jsxs("option",{value:ae.id,children:["HK",ae.soHoKhau.toString().padStart(3,"0")," - ",ae.diaChi," - Chủ hộ: ",((re=ae.chuHoInfo)==null?void 0:re.hoTen)||"Chưa có"]},ae.id)}),w.length===0&&!S&&c.jsx("option",{value:"",disabled:!0,children:"Không có hộ khẩu khả dụng"})]}),w.length===0&&!S&&c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Hiện tại không có hộ khẩu nào có thể chuyển đến"}),a&&c.jsxs("div",{className:"mt-4",children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Quan hệ với chủ hộ mới: ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsxs("select",{value:p,onChange:ae=>y(ae.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[c.jsx("option",{value:"",children:"-- Chọn quan hệ --"}),c.jsx("option",{value:"vợ/chồng",children:"Vợ/Chồng"}),c.jsx("option",{value:"con",children:"Con"}),c.jsx("option",{value:"bố/mẹ",children:"Bố/Mẹ"}),c.jsx("option",{value:"khác",children:"Khác"})]})]})]}),h&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Địa chỉ hộ gia đình mới:"}),c.jsx("input",{type:"text",value:l,onChange:ae=>o(ae.target.value),placeholder:"Ví dụ: Chung cư C, Tầng 10, Căn 1001, Thanh Xuân, Hà Nội",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:h}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Lưu ý: Nhân khẩu sẽ trở thành chủ hộ của hộ gia đình mới"}),c.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Định dạng địa chỉ: Số nhà/căn hộ, Đường/Tầng, Phường, Quận, Thành phố"})]})]}),C&&c.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:c.jsx("p",{className:"text-red-600 text-sm",children:C})}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lý do tách hộ:"}),c.jsx("textarea",{value:d,onChange:ae=>g(ae.target.value),placeholder:"Nhập lý do tách hộ...",rows:3,className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[c.jsx("button",{type:"button",onClick:I,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",children:"Hủy"}),c.jsx("button",{type:"submit",disabled:F||S,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:F?c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Đang xử lý..."]}):"Xác nhận tách hộ"})]})]})]})}):null},Yk=()=>{const[e,t]=j.useState(!1),[n,a]=j.useState(!1),[r,l]=j.useState(null),[o,h]=j.useState(!1),[f,d]=j.useState(null),[g,p]=j.useState(""),[y,w]=j.useState("id"),[_,b]=j.useState(!0),[T,S]=j.useState([]),[E,C]=j.useState(!0),[A,F]=j.useState(""),[K,D]=j.useState(1),[H,M]=j.useState(1),[B,I]=j.useState(0),te=10,q=()=>t(!0),ae=()=>{t(!1)},re=U=>{l(U),a(!0)},ee=()=>{a(!1),l(null)},Q=()=>{Z()},pe=()=>{Z(),ee()},ye=async(U,Te)=>{if(window.confirm(`Bạn có chắc chắn muốn xóa nhân khẩu "${Te}" không? Thao tác này không thể hoàn tác.`))try{const ie=await Xn.delete(U);ie.success?(alert("Xóa nhân khẩu thành công!"),Z()):alert(ie.message||"Có lỗi xảy ra khi xóa nhân khẩu")}catch(ie){console.error("Error deleting resident:",ie),alert(ie.message||"Có lỗi xảy ra khi xóa nhân khẩu")}},Y=U=>{d(U),h(!0)},de=()=>{h(!1),d(null)},P=U=>{Y(U)},Z=async()=>{try{C(!0),F("");const U=await Xn.getAll({page:K,limit:te,search:g});if(U.success&&U.data){const Te=U.data.residents||[],ie=await Promise.all(Te.map(async we=>{try{const Ne=await Xn.getHouseholdInfo(we.id);if(console.log(`Household info for resident ${we.id}:`,Ne),Ne.success&&Ne.data){const ze=Ne.data;return console.log("Household data:",ze),{...we,householdStatus:ze.householdStatus,currentHousehold:ze.currentHousehold,laChuHo:ze.isHeadOfHousehold}}return{...we,householdStatus:"no_household",currentHousehold:null,laChuHo:!1}}catch(Ne){return console.warn(`Failed to get household info for resident ${we.id}:`,Ne),{...we,householdStatus:"no_household",currentHousehold:null,laChuHo:!1}}}));S(ie),M(U.data.totalPages||1),I(U.data.total||0)}else F("Không thể tải danh sách nhân khẩu")}catch(U){console.error("Error loading residents:",U),F(U.message||"Có lỗi xảy ra khi tải danh sách nhân khẩu")}finally{C(!1)}};j.useEffect(()=>{Z()},[K]),j.useEffect(()=>{const U=setTimeout(()=>{D(1),Z()},500);return()=>clearTimeout(U)},[g]);const V=[...T.filter(U=>U.hoTen.toLowerCase().includes(g.toLowerCase())||U.cccd.toLowerCase().includes(g.toLowerCase()))].sort((U,Te)=>{const ie=U[y],we=Te[y];return ie==null&&we==null?0:ie==null?_?1:-1:we==null||ie<we?_?-1:1:ie>we?_?1:-1:0});return c.jsxs(c.Fragment,{children:[c.jsx(On,{role:"totruong",children:c.jsxs("div",{className:"p-4 flex flex-col gap-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"QUẢN LÝ NHÂN KHẨU"}),c.jsxs("p",{className:"text-gray-600 text-sm mt-1",children:["Chào mừng đến với Hệ thống Quản lý Thu phí Chung cư",B>0&&c.jsxs("span",{className:"ml-2 text-blue-600 font-medium",children:["(Tổng: ",B," nhân khẩu)"]})]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md shadow-sm overflow-hidden flex-1",children:[c.jsx("div",{className:"p-2 text-gray-400",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),c.jsx("input",{type:"text",placeholder:"Tìm theo họ tên, CCCD",className:"flex-1 p-2 border border-gray-300 outline-none text-sm",value:g,onChange:U=>p(U.target.value)})]}),c.jsxs("button",{className:"bg-blue-500 text-white px-4 py-2 rounded-md shadow-sm hover:bg-blue-600 flex items-center gap-2",onClick:q,children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thêm nhân khẩu"]})]}),c.jsxs("div",{className:"mt-6 bg-white rounded-md shadow-md overflow-hidden border border-gray-200",children:[c.jsx("div",{className:"p-4 bg-gray-100 border-b border-gray-200",children:c.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Danh sách nhân khẩu"})}),E&&c.jsxs("div",{className:"flex items-center justify-center py-12",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),c.jsx("span",{className:"ml-3 text-gray-600",children:"Đang tải dữ liệu..."})]}),A&&!E&&c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 m-4",children:[c.jsx("p",{className:"text-red-600",children:A}),c.jsx("button",{onClick:Z,className:"mt-2 bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600",children:"Thử lại"})]}),!E&&!A&&c.jsxs(c.Fragment,{children:[c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[[{key:"id",label:"ID"},{key:"hoTen",label:"Họ tên"},{key:"gioiTinh",label:"Giới tính"},{key:"ngaySinh",label:"Ngày sinh"},{key:"cccd",label:"CCCD"},{key:"soDienThoai",label:"SĐT"},{key:"ngheNghiep",label:"Nghề nghiệp"},{key:"household",label:"Hộ khẩu"}].map(U=>c.jsxs("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider cursor-pointer select-none",onClick:()=>{U.key!=="household"&&(y===U.key?b(!_):(w(U.key),b(!0)))},children:[U.label," ",y===U.key?_?"▲":"▼":""]},U.key)),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Thao tác"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:V.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:9,className:"px-6 py-8 text-center text-gray-500",children:g?"Không tìm thấy nhân khẩu nào phù hợp":"Chưa có nhân khẩu nào"})}):V.map(U=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:U.id}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:c.jsxs("div",{className:"flex items-center",children:[U.hoTen,U.laChuHo&&c.jsx("span",{className:"ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:"Chủ hộ"})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:U.gioiTinh}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(U.ngaySinh).toLocaleDateString("vi-VN")}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:U.cccd}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:U.soDienThoai||"Chưa có"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:U.ngheNghiep}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:U.currentHousehold?c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsxs("span",{className:"font-medium text-blue-600",children:["HK",String(U.currentHousehold.soHoKhau).padStart(3,"0")]}),U.laChuHo&&c.jsx("span",{className:"ml-2 text-xs text-blue-600",children:"(Chủ hộ)"})]}),c.jsxs("div",{className:"text-xs text-gray-500",children:["Chủ hộ: ",U.currentHousehold.chuHo]}),U.currentHousehold.quanHeVoiChuHo&&!U.laChuHo&&c.jsxs("div",{className:"text-xs text-gray-500",children:["Quan hệ: ",U.currentHousehold.quanHeVoiChuHo]})]}):U.householdStatus==="no_household"?c.jsx("span",{className:"inline-flex px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-600",children:"Chưa có hộ khẩu"}):c.jsx("span",{className:"text-gray-400 text-xs",children:"Đang tải..."})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs("button",{onClick:()=>re(U.id),className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",title:"Chỉnh sửa thông tin",children:[c.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Sửa"]}),c.jsxs("button",{onClick:()=>ye(U.id,U.hoTen),className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-red-100 text-red-800 hover:bg-red-200 transition-colors",title:"Xóa nhân khẩu",children:[c.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Xóa"]}),c.jsxs("button",{onClick:()=>P(U),className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-yellow-100 text-yellow-800 hover:bg-yellow-200 transition-colors",title:"Tách hộ",children:[c.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),"Tách hộ"]})]})})]},U.id))})]}),H>1&&c.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[c.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[c.jsx("button",{onClick:()=>D(U=>Math.max(1,U-1)),disabled:K===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Trước"}),c.jsx("button",{onClick:()=>D(U=>Math.min(H,U+1)),disabled:K===H,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Sau"})]}),c.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[c.jsx("div",{children:c.jsxs("p",{className:"text-sm text-gray-700",children:["Hiển thị ",c.jsx("span",{className:"font-medium",children:(K-1)*te+1})," đến"," ",c.jsx("span",{className:"font-medium",children:Math.min(K*te,B)})," ","trong tổng số ",c.jsx("span",{className:"font-medium",children:B})," kết quả"]})}),c.jsx("div",{children:c.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[c.jsx("button",{onClick:()=>D(U=>Math.max(1,U-1)),disabled:K===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Trước"}),Array.from({length:Math.min(5,H)},(U,Te)=>{const ie=Te+1;return c.jsx("button",{onClick:()=>D(ie),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${K===ie?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:ie},ie)}),c.jsx("button",{onClick:()=>D(U=>Math.min(H,U+1)),disabled:K===H,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Sau"})]})})]})]})]})]})]})}),c.jsx(Wk,{isOpen:e,onClose:ae,onSuccess:Q}),c.jsx(Gk,{isOpen:n,onClose:ee,onSuccess:pe,residentId:r}),c.jsx(Xk,{isOpen:o,onClose:de,selectedResident:f})]})},qk=({isOpen:e,onClose:t,onSave:n})=>{const[a,r]=j.useState(!1),[l,o]=j.useState(null),[h,f]=j.useState([]),[d,g]=j.useState([]),[p,y]=j.useState(null),[w,_]=j.useState(null),[b,T]=j.useState([]),[S,E]=j.useState({}),[C,A]=j.useState("");j.useEffect(()=>{e&&(F(),K(),y(null),_(null),T([]),E({}),A(""),o(null))},[e]),j.useEffect(()=>{p&&w&&D(p,w)},[p,w]);const F=async()=>{try{r(!0);const ae=await(await fetch("http://localhost:8000/api/dot-thu?page=0&size=20&sortBy=createdAt&sortDir=desc",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}})).json();ae.success&&ae.dotThus&&f(ae.dotThus)}catch(q){console.error("Error loading dot thu list:",q),o("Không thể tải danh sách đợt thu")}finally{r(!1)}},K=async()=>{var q;try{const re=await(await fetch("http://localhost:8000/api/households",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}})).json();if(re.success&&((q=re.data)!=null&&q.households)){const ee=re.data.households.map(Q=>{var pe;return{id:Q.soHoKhau,soHoKhau:Q.soHoKhau,chuHo:((pe=Q.chuHoInfo)==null?void 0:pe.hoTen)||"Không xác định",diaChi:`${Q.soNha||""} ${Q.duong||""}, ${Q.phuong||""}`.trim()}});g(ee)}}catch(ae){console.error("Error loading household list:",ae),o("Không thể tải danh sách hộ khẩu")}},D=async(q,ae)=>{try{r(!0);const ee=await(await fetch(`http://localhost:8000/api/household-fees/ho-khau/${ae}/dot-thu/${q}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}})).json();if(ee.success&&ee.data){const Q=ee.data.map(ye=>{var Y;return{id:ye.id,tenKhoanThu:((Y=ye.khoanThu)==null?void 0:Y.tenkhoanthu)||"Không xác định",soTien:parseFloat(ye.soTien||"0"),soTienDaNop:parseFloat(ye.soTienDaNop||"0"),trangThai:ye.trangThai,ghiChu:ye.ghiChu||""}});T(Q);const pe={};Q.forEach(ye=>{ye.soTien>ye.soTienDaNop&&(pe[ye.id]=ye.soTien-ye.soTienDaNop)}),E(pe)}else T([]),E({})}catch(re){console.error("Error loading khoan thu info:",re),o("Không thể tải thông tin khoản thu"),T([])}finally{r(!1)}},H=(q,ae)=>{const re=parseFloat(ae)||0;E(ee=>({...ee,[q]:re}))},M=async()=>{try{if(!p||!w){o("Vui lòng chọn đợt thu và hộ khẩu");return}const q=Object.entries(S).filter(([ee,Q])=>Q>0).map(([ee,Q])=>({householdFeeId:parseInt(ee),amount:Q}));if(q.length===0){o("Vui lòng nhập số tiền thanh toán");return}r(!0);for(const ee of q){const pe=await(await fetch(`http://localhost:8000/api/household-fees/${ee.householdFeeId}/payment`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"},body:JSON.stringify({soTienThanhToan:ee.amount,ghiChu:C||"Thanh toán nhanh"})})).json();if(!pe.success)throw new Error(pe.message||"Có lỗi xảy ra khi thanh toán")}const ae=q.reduce((ee,Q)=>ee+Q.amount,0),re=document.createElement("div");re.className="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transition-all duration-300",re.innerHTML=`
        <div class="flex items-center space-x-2">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
          </svg>
          <span>Thanh toán thành công! Tổng số tiền: ${B(ae)}</span>
        </div>
      `,document.body.appendChild(re),setTimeout(()=>{re.style.opacity="0",setTimeout(()=>document.body.removeChild(re),300)},3e3),n&&n({dotThuId:p,hoKhauId:w,payments:q,totalAmount:ae,ghiChu:C}),I()}catch(q){console.error("Error processing payment:",q),o(q.message||"Có lỗi xảy ra khi xử lý thanh toán")}finally{r(!1)}},B=q=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(q),I=()=>{y(null),_(null),T([]),E({}),A(""),o(null),t()},te=q=>new Date(q).toLocaleDateString("vi-VN");return e?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Ghi nhận thanh toán nhanh"}),c.jsx("button",{onClick:I,className:"text-gray-400 hover:text-gray-600 transition-colors",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"p-6 max-h-[calc(90vh-180px)] overflow-y-auto",children:[l&&c.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-4",children:[l,c.jsx("button",{onClick:()=>o(null),className:"float-right text-red-500 hover:text-red-700",children:"×"})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chọn đợt thu phí"}),c.jsxs("select",{value:p||"",onChange:q=>y(parseInt(q.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"-- Chọn đợt thu --"}),h.map(q=>c.jsxs("option",{value:q.id,children:[q.tenDotThu," (",te(q.ngayTao)," - ",te(q.thoiHan),")"]},q.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chọn hộ khẩu"}),c.jsxs("select",{value:w||"",onChange:q=>_(parseInt(q.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!p,children:[c.jsx("option",{value:"",children:"-- Chọn hộ khẩu --"}),d.map(q=>c.jsxs("option",{value:q.id,children:["HK",q.soHoKhau.toString().padStart(3,"0")," - ",q.chuHo]},q.id))]})]}),b.length>0&&c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Danh sách khoản thu"}),c.jsx("div",{className:"space-y-3",children:b.map(q=>c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsxs("div",{className:"flex justify-between items-start mb-3",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-800",children:q.tenKhoanThu}),c.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[c.jsxs("p",{children:["Tổng tiền: ",c.jsx("span",{className:"font-medium",children:B(q.soTien)})]}),c.jsxs("p",{children:["Đã nộp: ",c.jsx("span",{className:"font-medium text-green-600",children:B(q.soTienDaNop)})]}),c.jsxs("p",{children:["Còn lại: ",c.jsx("span",{className:"font-medium text-red-600",children:B(q.soTien-q.soTienDaNop)})]})]})]}),c.jsx("div",{className:"text-right",children:c.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${q.trangThai==="da_nop_du"?"bg-green-100 text-green-600":q.trangThai==="nop_mot_phan"?"bg-yellow-100 text-yellow-600":"bg-red-100 text-red-600"}`,children:q.trangThai==="da_nop_du"?"Đã nộp đủ":q.trangThai==="nop_mot_phan"?"Nộp một phần":"Chưa nộp"})})]}),q.soTien>q.soTienDaNop&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Số tiền thanh toán"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"number",min:"0",max:q.soTien-q.soTienDaNop,step:"1000",value:S[q.id]||"",onChange:ae=>H(q.id,ae.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nhập số tiền"}),c.jsx("button",{type:"button",onClick:()=>H(q.id,(q.soTien-q.soTienDaNop).toString()),className:"px-3 py-2 text-sm bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200",children:"Toàn bộ"})]})]})]},q.id))}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi chú"}),c.jsx("textarea",{value:C,onChange:q=>A(q.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ghi chú về thanh toán (tùy chọn)"})]}),c.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"font-medium text-gray-800",children:"Tổng tiền thanh toán:"}),c.jsx("span",{className:"text-xl font-bold text-blue-600",children:B(Object.values(S).reduce((q,ae)=>q+ae,0))})]})})]}),a&&c.jsxs("div",{className:"flex items-center justify-center py-4",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),c.jsx("span",{className:"ml-2 text-gray-600",children:"Đang xử lý..."})]})]})]}),c.jsxs("div",{className:"flex justify-end gap-3 p-6 border-t border-gray-200",children:[c.jsx("button",{onClick:I,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",disabled:a,children:"Hủy"}),c.jsx("button",{onClick:M,disabled:a||!p||!w||b.length===0||Object.values(S).every(q=>q===0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:a?"Đang xử lý...":"Xác nhận thanh toán"})]})]})}):null},$k=({isOpen:e,onClose:t,onSave:n})=>{const[a,r]=j.useState(!1),[l,o]=j.useState(null),[h,f]=j.useState([]),[d,g]=j.useState(null),[p,y]=j.useState([]),[w,_]=j.useState(new Set),[b,T]=j.useState(""),[S,E]=j.useState("");j.useEffect(()=>{e&&(C(),g(null),y([]),_(new Set),T(""),E(""),o(null))},[e]),j.useEffect(()=>{d&&A(d)},[d]);const C=async()=>{try{r(!0);const re=await(await fetch("http://localhost:8000/api/dot-thu?page=0&size=20&sortBy=createdAt&sortDir=desc",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}})).json();re.success&&re.dotThus&&f(re.dotThus)}catch(ae){console.error("Error loading dot thu list:",ae),o("Không thể tải danh sách đợt thu")}finally{r(!1)}},A=async ae=>{var re,ee,Q;try{r(!0);const ye=await(await fetch("http://localhost:8000/api/households",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}})).json();if(!ye.success||!((re=ye.data)!=null&&re.households))throw new Error("Không thể lấy danh sách hộ khẩu");const Y=ye.data.households,de=[];for(const P of Y)try{const k=await(await fetch(`http://localhost:8000/api/household-fees/ho-khau/${P.soHoKhau}/dot-thu/${ae}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}})).json();if(k.success&&((ee=k.data)==null?void 0:ee.length)>0){const V=k.data;let U=0,Te=0;const ie=V.map(Ne=>{var rt;const ze=parseFloat(Ne.soTien||"0"),Ue=parseFloat(Ne.soTienDaNop||"0");return U+=ze,Te+=Ue,{id:Ne.id,tenKhoanThu:((rt=Ne.khoanThu)==null?void 0:rt.tenkhoanthu)||"Không xác định",soTien:ze,soTienDaNop:Ue,remaining:ze-Ue}}),we=U-Te;we>0&&de.push({hoKhauId:P.soHoKhau,hoKhau:{id:P.soHoKhau,soHoKhau:P.soHoKhau,chuHo:((Q=P.chuHoInfo)==null?void 0:Q.hoTen)||"Không xác định",diaChi:`${P.soNha||""} ${P.duong||""}, ${P.phuong||""}`.trim()},totalAmount:U,paidAmount:Te,remainingAmount:we,feeDetails:ie.filter(Ne=>Ne.remaining>0)})}}catch(Z){console.error(`Error loading fees for household ${P.soHoKhau}:`,Z)}y(de)}catch(pe){console.error("Error loading household fees:",pe),o("Không thể tải thông tin khoản thu: "+pe.message)}finally{r(!1)}},F=ae=>{const re=new Set(w);re.has(ae)?re.delete(ae):re.add(ae),_(re)},K=()=>{const ae=D();w.size===ae.length?_(new Set):_(new Set(ae.map(re=>re.hoKhauId)))},D=()=>p.filter(ae=>ae.hoKhau.chuHo.toLowerCase().includes(b.toLowerCase())||ae.hoKhau.soHoKhau.toString().includes(b)),H=async()=>{try{if(!d||w.size===0){o("Vui lòng chọn đợt thu và ít nhất một hộ khẩu");return}r(!0);let ae=0,re=0;for(const Q of w){const pe=p.find(ye=>ye.hoKhauId===Q);if(pe){for(const ye of pe.feeDetails)if(ye.remaining>0){const de=await(await fetch(`http://localhost:8000/api/household-fees/${ye.id}/payment`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"},body:JSON.stringify({soTienThanhToan:ye.remaining,ghiChu:S||`Thanh toán nhanh cho ${pe.hoKhau.chuHo}`})})).json();de.success?(re+=ye.remaining,ae++):console.error(`Failed to pay fee ${ye.id}:`,de.message)}}}const ee=document.createElement("div");ee.className="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transition-all duration-300",ee.innerHTML=`
        <div class="flex items-center space-x-2">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
          </svg>
          <div>
            <div class="font-medium">Thanh toán thành công!</div>
            <div class="text-sm">Đã thanh toán cho ${w.size} hộ khẩu</div>
            <div class="text-sm">Tổng số tiền: ${M(re)}</div>
          </div>
        </div>
      `,document.body.appendChild(ee),setTimeout(()=>{ee.style.opacity="0",setTimeout(()=>document.body.removeChild(ee),300)},5e3),n&&n({dotThuId:d,householdIds:Array.from(w),totalHouseholds:w.size,totalAmount:re,totalProcessed:ae,ghiChu:S}),I()}catch(ae){console.error("Error processing payments:",ae),o(ae.message||"Có lỗi xảy ra khi xử lý thanh toán")}finally{r(!1)}},M=ae=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(ae),B=ae=>new Date(ae).toLocaleDateString("vi-VN"),I=()=>{g(null),y([]),_(new Set),T(""),E(""),o(null),t()};if(!e)return null;const te=D(),q=Array.from(w).reduce((ae,re)=>{const ee=p.find(Q=>Q.hoKhauId===re);return ae+((ee==null?void 0:ee.remainingAmount)||0)},0);return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Thanh toán nhanh - Chọn nhiều hộ"}),c.jsx("button",{onClick:I,className:"text-gray-400 hover:text-gray-600 transition-colors",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"p-6 space-y-6",children:[l&&c.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:[l,c.jsx("button",{onClick:()=>o(null),className:"float-right text-red-500 hover:text-red-700",children:"×"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chọn đợt thu phí"}),c.jsxs("select",{value:d||"",onChange:ae=>g(parseInt(ae.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"-- Chọn đợt thu --"}),h.map(ae=>c.jsxs("option",{value:ae.id,children:[ae.tenDotThu," (",B(ae.ngayTao)," - ",B(ae.thoiHan),")"]},ae.id))]})]}),d&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("div",{className:"flex-1 max-w-md",children:c.jsx("input",{type:"text",placeholder:"Tìm kiếm hộ khẩu theo tên chủ hộ hoặc số hộ khẩu...",value:b,onChange:ae=>T(ae.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})}),c.jsxs("div",{className:"text-sm text-gray-600",children:["Đã chọn: ",w.size,"/",te.length," hộ",w.size>0&&c.jsxs("span",{className:"ml-2 font-medium text-green-600",children:["(",M(q),")"]})]})]}),a?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),c.jsx("p",{className:"mt-2 text-gray-600",children:"Đang tải dữ liệu hộ khẩu..."})]}):te.length>0?c.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[c.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",checked:w.size===te.length&&te.length>0,onChange:K,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),c.jsxs("label",{className:"ml-2 text-sm font-medium text-gray-700",children:["Chọn tất cả (",te.length," hộ có khoản phí chưa thanh toán)"]})]})}),c.jsx("div",{className:"max-h-96 overflow-y-auto",children:te.map(ae=>c.jsx("div",{className:`border-b border-gray-100 hover:bg-gray-50 transition-colors ${w.has(ae.hoKhauId)?"bg-blue-50":""}`,children:c.jsx("div",{className:"px-4 py-3",children:c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx("input",{type:"checkbox",checked:w.has(ae.hoKhauId),onChange:()=>F(ae.hoKhauId),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded mt-1"}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsxs("h4",{className:"text-sm font-medium text-gray-900",children:["HK",ae.hoKhau.soHoKhau.toString().padStart(3,"0")," - ",ae.hoKhau.chuHo]}),c.jsx("p",{className:"text-xs text-gray-500",children:ae.hoKhau.diaChi})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm font-medium text-red-600",children:M(ae.remainingAmount)}),c.jsxs("p",{className:"text-xs text-gray-500",children:[ae.feeDetails.length," khoản chưa nộp"]})]})]}),c.jsx("div",{className:"mt-2 space-y-1",children:ae.feeDetails.map(re=>c.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[c.jsxs("span",{children:["• ",re.tenKhoanThu]}),c.jsx("span",{children:M(re.remaining)})]},re.id))})]})]})})},ae.hoKhauId))})]}):c.jsx("div",{className:"text-center py-8 text-gray-500",children:p.length===0?"Không có hộ khẩu nào có khoản phí chưa thanh toán trong đợt thu này":"Không tìm thấy hộ khẩu nào phù hợp với từ khóa tìm kiếm"}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ghi chú chung"}),c.jsx("textarea",{value:S,onChange:ae=>E(ae.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ghi chú cho tất cả các thanh toán (tùy chọn)"})]}),c.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[c.jsx("div",{className:"text-sm text-gray-600",children:w.size>0&&c.jsxs(c.Fragment,{children:["Sẽ thanh toán cho ",c.jsx("strong",{children:w.size})," hộ khẩu",c.jsx("br",{}),"Tổng số tiền: ",c.jsx("strong",{className:"text-green-600",children:M(q)})]})}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:I,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",disabled:a,children:"Hủy"}),c.jsx("button",{onClick:H,disabled:w.size===0||a,className:`px-4 py-2 rounded-md transition-colors ${w.size>0&&!a?"bg-green-600 text-white hover:bg-green-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:a?"Đang xử lý...":`Thanh toán ${w.size} hộ`})]})]})]})]})]})})},Qk=()=>{var ee;const[e,t]=j.useState([]),[n,a]=j.useState(null),[r,l]=j.useState(null),[o,h]=j.useState(null),[f,d]=j.useState([]),[g,p]=j.useState(null),[y,w]=j.useState(!0),[_,b]=j.useState(null),[T,S]=j.useState(!1),[E,C]=j.useState(!1),[A,F]=j.useState({show:!1,type:"info",message:""}),K=(Q,pe)=>{F({show:!0,type:Q,message:pe}),setTimeout(()=>{F(ye=>({...ye,show:!1}))},4e3)};j.useEffect(()=>{D()},[]),j.useEffect(()=>{n&&H(n)},[n]),j.useEffect(()=>{n&&o&&B(n,o)},[n,o]);const D=async()=>{try{w(!0);const Q=await bn.dotThu.getAll({page:0,size:20,sortBy:"createdAt",sortDir:"desc"});Q.success&&Q.dotThus&&(t(Q.dotThus),Q.dotThus.length>0&&a(Q.dotThus[0].id))}catch(Q){console.error("Error loading dot thu list:",Q),b("Không thể tải danh sách đợt thu phí")}finally{w(!1)}},H=async Q=>{try{w(!0);const ye=await(await fetch(`http://localhost:8000/api/household-fees/dashboard/${Q}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}})).json();if(ye.success)l(ye.data),h(null),d([]);else throw new Error(ye.message||"Không thể tải dashboard")}catch(pe){console.error("Error loading dashboard:",pe),b("Không thể tải dashboard khoản thu")}finally{w(!1)}},M=async Q=>{try{const ye=await(await fetch(`http://localhost:8000/api/household-fees/dashboard/${Q}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}})).json();if(ye.success)l(ye.data);else throw new Error(ye.message||"Không thể tải dashboard")}catch(pe){console.error("Error reloading dashboard:",pe),K("error","Không thể cập nhật dữ liệu dashboard")}},B=async(Q,pe)=>{try{w(!0);const Y=await(await fetch(`http://localhost:8000/api/household-fees/dot-thu/${Q}/khoan-thu/${pe}/households`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"}})).json();if(Y.success)d(Y.data.households);else throw new Error(Y.message||"Không thể tải danh sách hộ gia đình")}catch(ye){console.error("Error loading household fees:",ye),b("Không thể tải danh sách hộ gia đình")}finally{w(!1)}},I=Q=>{h(Q)},te=async(Q,pe,ye)=>{try{if(isNaN(pe)||pe<0){K("error","Số tiền thanh toán không hợp lệ. Vui lòng nhập số tiền >= 0");return}const de=await(await fetch(`http://localhost:8000/api/household-fees/${Q}/payment`,{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"Content-Type":"application/json"},body:JSON.stringify({soTienThanhToan:pe,ghiChu:ye})})).json();if(de.success)p(null),K("success",`Cập nhật thanh toán thành công! Đã nộp ${q(pe)}`),n&&await M(n),n&&o&&await B(n,o);else throw new Error(de.message||"Không thể cập nhật thanh toán")}catch(Y){console.error("Error updating payment:",Y);const de=Y instanceof Error?Y.message:"Có lỗi xảy ra khi cập nhật thanh toán";K("error",de)}},q=Q=>{const pe=typeof Q=="string"?parseFloat(Q):Q;return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(pe)},ae=Q=>new Date(Q).toLocaleDateString("vi-VN"),re=Q=>{switch(Q){case"da_nop_du":return"text-green-600 bg-green-100";case"nop_mot_phan":return"text-yellow-600 bg-yellow-100";case"chua_nop":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}};return y&&!r?c.jsx(On,{role:"ketoan",children:c.jsx("div",{className:"p-6 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Đang tải dữ liệu..."})]})})}):c.jsx(On,{role:"ketoan",children:c.jsxs("div",{className:"p-6",children:[c.jsx("div",{className:"mb-6",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Quản lý khoản thu"}),c.jsx("p",{className:"text-gray-600 mt-1",children:"Theo dõi tình hình thu phí từng khoản"})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsxs("button",{onClick:()=>S(!0),className:"bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 flex items-center gap-2",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Nộp nhanh (1 hộ)"]}),c.jsxs("button",{onClick:()=>C(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 flex items-center gap-2",children:[c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),"Thanh toán nhiều hộ"]})]})]})}),_&&c.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:[_,c.jsx("button",{onClick:()=>b(null),className:"float-right text-red-500 hover:text-red-700",children:"×"})]}),A.show&&c.jsx("div",{className:`fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg border-l-4 ${A.type==="success"?"bg-green-50 border-green-400 text-green-700":A.type==="error"?"bg-red-50 border-red-400 text-red-700":"bg-blue-50 border-blue-400 text-blue-700"} transform transition-all duration-300 ${A.show?"translate-x-0 opacity-100":"translate-x-full opacity-0"}`,children:c.jsxs("div",{className:"flex items-center",children:[c.jsxs("div",{className:"flex-shrink-0",children:[A.type==="success"&&c.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),A.type==="error"&&c.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),A.type==="info"&&c.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})]}),c.jsx("div",{className:"ml-3 flex-1",children:c.jsx("p",{className:"text-sm font-medium",children:A.message})}),c.jsx("div",{className:"ml-4 flex-shrink-0",children:c.jsx("button",{onClick:()=>F(Q=>({...Q,show:!1})),className:"inline-flex text-gray-400 hover:text-gray-600",children:c.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]})}),c.jsxs("div",{className:"mb-6",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chọn đợt thu phí:"}),c.jsxs("select",{value:n||"",onChange:Q=>a(parseInt(Q.target.value)),className:"w-full max-w-md px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"-- Chọn đợt thu --"}),e.map(Q=>c.jsxs("option",{value:Q.id,children:[Q.tenDotThu," (",ae(Q.ngayTao)," - ",ae(Q.thoiHan),")"]},Q.id))]})]}),r&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[c.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:["Tổng quan: ",r.dotThu.tenDotThu]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[c.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Tổng hộ khẩu"}),c.jsx("p",{className:"text-2xl font-bold text-blue-800",children:r.tongKet.tongHoKhau})]}),c.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[c.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Đã thu"}),c.jsx("p",{className:"text-2xl font-bold text-green-800",children:q(r.tongKet.tongTienDaThu)})]}),c.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[c.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"Dự kiến"}),c.jsx("p",{className:"text-2xl font-bold text-orange-800",children:q(r.tongKet.tongTienDuKien)})]}),c.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[c.jsx("p",{className:"text-sm text-purple-600 font-medium",children:"Tỷ lệ thu"}),c.jsxs("p",{className:"text-2xl font-bold text-purple-800",children:[r.tongKet.tyLeThuTienTongQuat,"%"]})]})]})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Danh sách khoản thu"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.khoanThuList.map(Q=>c.jsxs("div",{onClick:()=>I(Q.khoanThuId),className:`p-4 border rounded-lg cursor-pointer transition-colors ${o===Q.khoanThuId?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsx("h4",{className:"font-medium text-gray-800",children:Q.tenKhoanThu}),Q.batBuoc&&c.jsx("span",{className:"text-xs bg-red-100 text-red-600 px-2 py-1 rounded",children:"Bắt buộc"})]}),c.jsxs("div",{className:"space-y-2 text-sm",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-600",children:"Tỷ lệ hoàn thành:"}),c.jsxs("span",{className:"font-medium",children:[Q.thongKe.tyLeHoanThanh,"%"]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-600",children:"Đã thu:"}),c.jsx("span",{className:"font-medium text-green-600",children:q(Q.taiChinh.tongTienDaThu)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-600",children:"Dự kiến:"}),c.jsx("span",{className:"font-medium",children:q(Q.taiChinh.tongTienDuKien)})]}),c.jsxs("div",{className:"text-xs text-gray-500",children:[Q.thongKe.hoDaNop,"/",Q.thongKe.tongHoKhau," hộ đã nộp"]})]})]},Q.khoanThuId))})]}),o&&f.length>0&&c.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Chi tiết hộ gia đình - ",(ee=r.khoanThuList.find(Q=>Q.khoanThuId===o))==null?void 0:ee.tenKhoanThu]}),c.jsx("button",{onClick:()=>h(null),className:"text-gray-500 hover:text-gray-700",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hộ khẩu"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Chủ hộ"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Số tiền"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Đã nộp"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trạng thái"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thao tác"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.map(Q=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["HK",Q.hoKhau.soHoKhau.toString().padStart(3,"0")]}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Q.hoKhau.chuHo}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:q(Q.soTien)}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600",children:q(Q.soTienDaNop)}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${re(Q.trangThai)}`,children:Q.trangThaiText})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:c.jsx("button",{onClick:()=>p(Q),className:"text-blue-600 hover:text-blue-800 font-medium",children:"Cập nhật"})})]},Q.id))})]})})]})]}),g&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Cập nhật thanh toán"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"bg-gray-50 p-3 rounded-md",children:[c.jsxs("p",{className:"text-sm text-gray-600",children:["Hộ khẩu: ",c.jsxs("span",{className:"font-medium",children:["HK",g.hoKhau.soHoKhau.toString().padStart(3,"0")]})]}),c.jsxs("p",{className:"text-sm text-gray-600",children:["Chủ hộ: ",c.jsx("span",{className:"font-medium",children:g.hoKhau.chuHo})]}),c.jsxs("p",{className:"text-sm text-gray-600",children:["Số tiền phải nộp: ",c.jsx("span",{className:"font-medium text-blue-600",children:q(parseFloat(g.soTien))})]}),c.jsxs("p",{className:"text-sm text-gray-600",children:["Đã nộp: ",c.jsx("span",{className:"font-medium text-green-600",children:q(parseFloat(g.soTienDaNop))})]}),c.jsxs("p",{className:"text-sm text-gray-600",children:["Còn lại: ",c.jsx("span",{className:"font-medium text-red-600",children:q(parseFloat(g.soTien)-parseFloat(g.soTienDaNop))})]}),g.chiTietTinhPhi&&g.chiTietTinhPhi.vehicle&&c.jsxs("div",{className:"mt-3 p-2 bg-blue-50 rounded",children:[c.jsx("p",{className:"text-xs font-semibold text-blue-700 mb-1",children:"Chi tiết phí phương tiện:"}),Array.isArray(g.chiTietTinhPhi.vehicle)?c.jsx("ul",{className:"text-xs text-blue-800 list-disc ml-4",children:g.chiTietTinhPhi.vehicle.map((Q,pe)=>c.jsxs("li",{children:[Q.loaiXe?`${Q.loaiXe}: `:"",q(Q.phiThue),Q.bienSo?` (Biển số: ${Q.bienSo})`:""]},pe))}):c.jsx("span",{className:"text-xs text-blue-800",children:q(g.chiTietTinhPhi.vehicle)})]})]}),c.jsxs("form",{onSubmit:Q=>{Q.preventDefault();const pe=new FormData(Q.target),ye=pe.get("soTienNop"),Y=parseFloat(ye),de=pe.get("ghiChu");if(!ye||isNaN(Y)||Y<0){alert("Vui lòng nhập số tiền hợp lệ (>= 0)");return}te(g.id,Y,de)},children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Số tiền nộp"}),c.jsx("input",{type:"number",name:"soTienNop",min:"0",step:"1000",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nhập số tiền nộp",required:!0}),c.jsxs("div",{className:"flex gap-2 mt-2",children:[c.jsxs("button",{type:"button",onClick:Q=>{var ye;const pe=(ye=Q.target.closest("form"))==null?void 0:ye.querySelector('input[name="soTienNop"]');pe&&(pe.value=(parseFloat(g.soTien)-parseFloat(g.soTienDaNop)).toString())},className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:["Số tiền còn lại (",q(parseFloat(g.soTien)-parseFloat(g.soTienDaNop)),")"]}),c.jsxs("button",{type:"button",onClick:Q=>{var ye;const pe=(ye=Q.target.closest("form"))==null?void 0:ye.querySelector('input[name="soTienNop"]');pe&&(pe.value=g.soTien.toString())},className:"px-2 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200",children:["Toàn bộ (",q(parseFloat(g.soTien)),")"]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi chú"}),c.jsx("textarea",{name:"ghiChu",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ghi chú về thanh toán (tùy chọn)"})]}),c.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[c.jsx("button",{type:"button",onClick:()=>p(null),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Hủy"}),c.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Cập nhật thanh toán"})]})]})]})]})}),T&&c.jsx(qk,{isOpen:T,onClose:()=>S(!1),onSave:Q=>{console.log("Payment data:",Q),S(!1),K("success","Thanh toán nhanh thành công!"),n&&M(n),n&&o&&B(n,o)}}),E&&c.jsx($k,{isOpen:E,onClose:()=>C(!1),onSave:Q=>{console.log("Multiple payment data:",Q),C(!1),K("success",`Thanh toán thành công cho ${Q.totalHouseholds} hộ khẩu! Tổng số tiền: ${q(Q.totalAmount)}`),n&&M(n),n&&o&&B(n,o)}})]})})},Zk=({isOpen:e,onClose:t,onSave:n})=>{const a=new Date().toISOString().slice(0,10),[r,l]=j.useState(""),[o,h]=j.useState(""),[f,d]=j.useState(a),[g,p]=j.useState(""),[y,w]=j.useState({}),[_,b]=j.useState(!1),[T,S]=j.useState(!1),[E,C]=j.useState(null);if(!e)return null;const A=r||o||f!==a||g,F=()=>{const I={};return r.trim()||(I.maDot="Vui lòng nhập mã đợt"),o.trim()||(I.tenDot="Vui lòng nhập tên đợt thu"),f||(I.ngayTao="Vui lòng chọn ngày tạo"),g||(I.hanThu="Vui lòng chọn hạn thu"),f&&g&&g<f&&(I.hanThu="Hạn thu phải lớn hơn hoặc bằng ngày tạo"),w(I),Object.keys(I).length===0},K=()=>{A?(b(!0),C("close")):D()},D=()=>{w({}),l(""),h(""),d(a),p(""),b(!1),S(!1),C(null),t()},H=()=>{F()&&(S(!0),C("save"))},M=()=>{n&&n({maDot:r,tenDot:o,ngayTao:f,hanThu:g}),D()},B=I=>{I.target===I.currentTarget&&K()};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",onClick:B,children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md max-h-[90vh] overflow-y-auto relative",children:[c.jsx("button",{className:"absolute top-3 right-3 text-gray-400 hover:text-gray-700 text-2xl font-bold focus:outline-none",onClick:K,"aria-label":"Đóng",children:"×"}),c.jsx("h3",{className:"text-2xl font-bold text-center mb-6",children:"Thêm Đợt thu phí"}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Mã đợt ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",className:`mt-1 block w-full px-3 py-2 border ${y.maDot?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,placeholder:"Ví dụ: D004",value:r,onChange:I=>l(I.target.value)}),y.maDot&&c.jsx("p",{className:"text-xs text-red-500 mt-1",children:y.maDot})]}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tên đợt thu ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",className:`mt-1 block w-full px-3 py-2 border ${y.tenDot?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,placeholder:"Ví dụ: Tháng 6/2025",value:o,onChange:I=>h(I.target.value)}),y.tenDot&&c.jsx("p",{className:"text-xs text-red-500 mt-1",children:y.tenDot})]}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Ngày tạo ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"date",className:`mt-1 block w-full px-3 py-2 border ${y.ngayTao?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,value:f,onChange:I=>d(I.target.value)}),y.ngayTao&&c.jsx("p",{className:"text-xs text-red-500 mt-1",children:y.ngayTao})]}),c.jsxs("div",{className:"mb-8",children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Hạn thu ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"date",className:`mt-1 block w-full px-3 py-2 border ${y.hanThu?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,value:g,onChange:I=>p(I.target.value)}),y.hanThu&&c.jsx("p",{className:"text-xs text-red-500 mt-1",children:y.hanThu})]}),c.jsxs("div",{className:"flex gap-4",children:[c.jsx("button",{className:"flex-1 px-4 py-3 bg-gray-500 text-white text-base font-semibold rounded-md shadow-sm hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all",onClick:K,children:"Hủy"}),c.jsx("button",{className:"flex-1 px-4 py-3 bg-blue-500 text-white text-base font-semibold rounded-md shadow-sm hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all",onClick:H,children:"Lưu"})]})]})}),(_||T)&&c.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60]",onClick:()=>{b(!1),S(!1),C(null)},children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl px-8 py-7 max-w-sm w-full relative",onClick:I=>I.stopPropagation(),children:[c.jsxs("p",{className:"text-base text-gray-800 mb-6 text-center font-medium",children:[_&&"Những thay đổi hiện tại sẽ không được lưu lại. Bạn vẫn muốn thoát?",T&&"Bạn xác nhận tạo đợt thu phí mới này?"]}),c.jsxs("div",{className:"flex gap-4 w-full",children:[c.jsx("button",{className:"flex-1 px-4 py-2.5 bg-gray-400 text-white rounded hover:bg-gray-500 font-medium transition-colors",onClick:()=>{b(!1),S(!1),C(null)},children:_?"Chỉnh sửa tiếp":"Hủy"}),c.jsx("button",{className:"flex-1 px-4 py-2.5 bg-blue-500 text-white rounded hover:bg-blue-600 font-medium transition-colors",onClick:()=>{E==="close"&&D(),E==="save"&&M()},children:_?"Thoát":"Xác nhận"})]})]})})]})},Jk=({isOpen:e,onClose:t,onSave:n,batch:a})=>{var P,Z;const r=new Date().toISOString().slice(0,10),[l,o]=j.useState(""),[h,f]=j.useState(""),[d,g]=j.useState(r),[p,y]=j.useState(""),[w,_]=j.useState([]),[b,T]=j.useState([]),[S,E]=j.useState({}),[C,A]=j.useState(!1),[F,K]=j.useState(!1),[D,H]=j.useState(null),[M,B]=j.useState(!1),I=k=>{if(!k)return"";if(/^\d{4}-\d{2}-\d{2}$/.test(k))return k;const V=k.split("/");return V.length!==3?"":`${V[2]}-${V[1]}-${V[0]}`},te=k=>{if(!k)return"";const V=k.split("-");return V.length!==3?k:`${V[2]}/${V[1]}/${V[0]}`};j.useEffect(()=>{var k;if(a&&(o(a.maDot||""),f(a.tenDot||""),g(I(a.ngayTao)||r),y(I(a.hanCuoi)||""),(k=a.details)!=null&&k.khoanThu)){const V=a.details.khoanThu.map(U=>({khoanThuId:U.id,soTien:U.soTienMacDinh||0}));T(V)}},[a,r]),j.useEffect(()=>{(async()=>{if(e)try{B(!0);const V=await y2.getAll();V.success&&_(V.data)}catch(V){console.error("Error loading KhoanThu:",V)}finally{B(!1)}})()},[e]);const q=(k,V)=>{T(V?U=>[...U,{khoanThuId:k,soTien:0}]:U=>U.filter(Te=>Te.khoanThuId!==k))},ae=(k,V)=>{T(U=>U.map(Te=>Te.khoanThuId===k?{...Te,soTien:V}:Te))};if(!e)return null;const re=a&&(l!==a.maDot||h!==a.tenDot||te(d)!==a.ngayTao||te(p)!==a.hanCuoi||JSON.stringify(b)!==JSON.stringify(((Z=(P=a.details)==null?void 0:P.khoanThu)==null?void 0:Z.map(k=>({khoanThuId:k.id,soTien:k.soTienMacDinh||0})))||[])),ee=()=>{const k={};return l.trim()||(k.maDot="Vui lòng nhập mã đợt"),h.trim()||(k.tenDot="Vui lòng nhập tên đợt thu"),d||(k.ngayTao="Vui lòng chọn ngày tạo"),p||(k.hanThu="Vui lòng chọn hạn thu"),d&&p&&p<d&&(k.hanThu="Hạn thu phải lớn hơn hoặc bằng ngày tạo"),E(k),Object.keys(k).length===0},Q=()=>{re?(A(!0),H("close")):pe()},pe=()=>{E({}),o(""),f(""),g(r),y(""),T([]),A(!1),K(!1),H(null),t()},ye=()=>{ee()&&(K(!0),H("save"))},Y=()=>{const k=b.reduce((V,U)=>V+(U.soTien||0),0);n&&n({maDot:l,tenDot:h,ngayTao:te(d),hanThu:te(p),khoanThu:b,soTien:k}),pe()},de=k=>{k.target===k.currentTarget&&Q()};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",onClick:de,children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md max-h-[90vh] overflow-y-auto relative",onClick:k=>k.stopPropagation(),children:[c.jsx("button",{className:"absolute top-3 right-3 text-gray-400 hover:text-gray-700 text-2xl font-bold focus:outline-none",onClick:Q,"aria-label":"Đóng",children:"×"}),c.jsx("h3",{className:"text-2xl font-bold text-center mb-6",children:"Chỉnh sửa đợt thu phí"}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Mã đợt ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",className:`mt-1 block w-full px-3 py-2 border ${S.maDot?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,placeholder:"Ví dụ: D004",value:l,onChange:k=>o(k.target.value)}),S.maDot&&c.jsx("p",{className:"text-xs text-red-500 mt-1",children:S.maDot})]}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tên đợt thu ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",className:`mt-1 block w-full px-3 py-2 border ${S.tenDot?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,placeholder:"Ví dụ: Tháng 6/2025",value:h,onChange:k=>f(k.target.value)}),S.tenDot&&c.jsx("p",{className:"text-xs text-red-500 mt-1",children:S.tenDot})]}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Ngày tạo ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"date",className:`mt-1 block w-full px-3 py-2 border ${S.ngayTao?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,value:d,onChange:k=>g(k.target.value)}),S.ngayTao&&c.jsx("p",{className:"text-xs text-red-500 mt-1",children:S.ngayTao})]}),c.jsxs("div",{className:"mb-8",children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Hạn thu ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"date",className:`mt-1 block w-full px-3 py-2 border ${S.hanThu?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,value:p,onChange:k=>y(k.target.value)}),S.hanThu&&c.jsx("p",{className:"text-xs text-red-500 mt-1",children:S.hanThu})]}),c.jsxs("div",{className:"mb-8",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Chọn khoản thu cho đợt này"}),M?c.jsx("div",{className:"text-center py-4 text-gray-500",children:"Đang tải khoản thu..."}):c.jsx("div",{className:"space-y-3 max-h-48 overflow-y-auto border border-gray-200 rounded-md p-3",children:w.length===0?c.jsx("div",{className:"text-center py-4 text-gray-500",children:"Không có khoản thu nào"}):w.map(k=>{const V=b.some(Te=>Te.khoanThuId===k.id),U=b.find(Te=>Te.khoanThuId===k.id);return c.jsxs("div",{className:"flex items-center space-x-3 p-2 border border-gray-100 rounded",children:[c.jsx("input",{type:"checkbox",checked:V,onChange:Te=>q(k.id,Te.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("span",{className:"text-sm font-medium text-gray-900",children:k.tenKhoan}),k.batBuoc&&c.jsx("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Bắt buộc"}),k.ghiChu&&c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:k.ghiChu})]}),V&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"text-xs text-gray-500",children:"Số tiền:"}),c.jsx("input",{type:"number",value:(U==null?void 0:U.soTien)||0,onChange:Te=>ae(k.id,parseInt(Te.target.value)||0),className:"w-24 px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"0",min:"0"}),c.jsx("span",{className:"text-xs text-gray-500",children:"VND"})]})]},k.id)})})]}),c.jsxs("div",{className:"flex gap-4",children:[c.jsx("button",{className:"flex-1 px-4 py-3 bg-gray-500 text-white text-base font-semibold rounded-md shadow-sm hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all",onClick:Q,children:"Hủy"}),c.jsx("button",{className:"flex-1 px-4 py-3 bg-blue-500 text-white text-base font-semibold rounded-md shadow-sm hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all",onClick:ye,children:"Lưu"})]})]})}),(C||F)&&c.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60]",onClick:()=>{A(!1),K(!1),H(null)},children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl px-8 py-7 max-w-sm w-full relative",onClick:k=>k.stopPropagation(),children:[c.jsxs("p",{className:"text-base text-gray-800 mb-6 text-center font-medium",children:[C&&"Những thay đổi hiện tại sẽ không được lưu lại. Bạn vẫn muốn thoát?",F&&"Bạn xác nhận lưu các thay đổi cho đợt thu phí này?"]}),c.jsxs("div",{className:"flex gap-4 w-full",children:[c.jsx("button",{className:"flex-1 px-4 py-2.5 bg-gray-400 text-white rounded hover:bg-gray-500 font-medium transition-colors",onClick:()=>{A(!1),K(!1),H(null)},children:C?"Chỉnh sửa tiếp":"Hủy"}),c.jsx("button",{className:"flex-1 px-4 py-2.5 bg-blue-500 text-white rounded hover:bg-blue-600 font-medium transition-colors",onClick:()=>{D==="close"&&pe(),D==="save"&&Y()},children:C?"Thoát":"Xác nhận"})]})]})})]})},Lo={PHI_DICH_VU:{id:"PHI_DICH_VU",name:"Phí dịch vụ chung cư",rate:1e4,mandatory:!0,calculateByArea:!0},PHI_QUAN_LY:{id:"PHI_QUAN_LY",name:"Phí quản lý chung cư",rate:7e3,mandatory:!0,calculateByArea:!0},PHI_GUI_XE:{id:"PHI_GUI_XE",name:"Phí gửi xe",rateMotorbike:7e4,rateCar:12e5,mandatory:!0,calculateByVehicle:!0},PHI_DIEN:{id:"PHI_DIEN",name:"Phí điện",mandatory:!0,importable:!0},PHI_NUOC:{id:"PHI_NUOC",name:"Phí nước",mandatory:!0,importable:!0},PHI_INTERNET:{id:"PHI_INTERNET",name:"Phí internet",mandatory:!0,importable:!0},KHOAN_DONG_GOP:{id:"KHOAN_DONG_GOP",name:"Khoản đóng góp",mandatory:!1,voluntary:!0}},jo=[{id:"HK001",owner:"Nguyễn Văn A",area:75.5,vehicles:{motorbikes:2,cars:0}},{id:"HK002",owner:"Trần Thị B",area:100.2,vehicles:{motorbikes:1,cars:1}},{id:"HK003",owner:"Lê Văn C",area:60,vehicles:{motorbikes:3,cars:0}},{id:"HK004",owner:"Phạm Thị D",area:120.5,vehicles:{motorbikes:1,cars:1}},{id:"HK005",owner:"Hoàng Văn E",area:85,vehicles:{motorbikes:2,cars:1}}],hv=({isOpen:e,onClose:t,onSave:n,initialData:a,title:r="Thêm khoản thu"})=>{const[l,o]=j.useState(""),[h,f]=j.useState(""),[d,g]=j.useState({}),[p,y]=j.useState(null),[w,_]=j.useState(""),[b,T]=j.useState({}),[S,E]=j.useState(!1),[C,A]=j.useState(!1),[F,K]=j.useState(null),[D,H]=j.useState(null),M=!!a,B=Lo[l],I=B&&(B.calculateByArea||B.calculateByVehicle),te=B==null?void 0:B.importable,q=ie=>ie?new Intl.NumberFormat("vi-VN").format(ie):"",ae=ie=>{const we=Lo[ie];if(!we)return{};const Ne={};return jo.forEach(ze=>{let Ue=0;"calculateByArea"in we&&we.calculateByArea?Ue=Math.round(ze.area*we.rate):"calculateByVehicle"in we&&we.calculateByVehicle?Ue=ze.vehicles.motorbikes*we.rateMotorbike+ze.vehicles.cars*we.rateCar:"voluntary"in we&&we.voluntary&&(Ue=0),Ne[ze.id]={amount:Ue,auto:!0}}),Ne},re=ie=>{o(ie),ie==="PHI_DIEN"||ie==="PHI_NUOC"||ie==="PHI_INTERNET"?(g({}),y(null),H(null)):ie?(g(ae(ie)),y(null),H(null)):(g({}),y(null),H(null))},ee=(ie,we)=>{const Ne=we.replace(/[^\d]/g,"");g(ze=>({...ze,[ie]:{amount:parseInt(Ne)||0,auto:!1}}))},Q=async ie=>{const we=ie.target.files;if(!we||we.length===0){y(null);return}const Ne=we[0];if(!Ne.name.endsWith(".xlsx")&&!Ne.name.endsWith(".xls")&&!Ne.name.endsWith(".csv")){_("Vui lòng chọn file Excel (.xlsx, .xls) hoặc CSV (.csv)"),y(null);return}_(""),y(Ne),H(Ne.name);try{let ze="";Ne.name.endsWith(".csv")?ze=await Ne.text():ze=await Ne.text();const Ue=ze.split(/\r?\n/).filter(ft=>ft.trim()!=="");if(Ue.length<2)throw new Error("File phải có ít nhất 1 dòng dữ liệu");const rt=Ue[0].split(",").map(ft=>ft.trim().toLowerCase()),Ye=rt.findIndex(ft=>ft.includes("mã hộ")),rn=rt.findIndex(ft=>ft.includes("chủ hộ")),xt=rt.findIndex(ft=>ft.includes("số tiền"));if(Ye===-1||rn===-1||xt===-1)throw new Error("File phải có đủ 3 cột: Mã hộ, Chủ hộ, Số tiền");const Fe={};for(let ft=1;ft<Ue.length;++ft){const Jt=Ue[ft].split(",");if(Jt.length<3)continue;const Fn=Jt[Ye].trim(),Cn=Jt[rn].trim(),me=parseInt(Jt[xt].replace(/[^\d]/g,""))||0;!Fn||!Cn||(Fe[Fn]={amount:me,auto:!1,owner:Cn})}if(Object.keys(Fe).length===0)throw new Error("Không có dữ liệu hợp lệ trong file");g(Fe),_("")}catch(ze){_("Lỗi đọc file: "+(ze.message||"Định dạng không hợp lệ"))}};j.useEffect(()=>{a?(o(a.type||""),f(a.chiTiet||""),a.householdFees?g(a.householdFees):a.type&&g(ae(a.type)),a.importedFileName&&H(a.importedFileName)):(o(""),f(""),g({}),y(null),_(""),H(null))},[a,e]);const pe=l!==""||h!==""||Object.keys(d).length>0||p!==null,ye=()=>{const ie={};return l||(ie.feeType="Vui lòng chọn loại phí"),B&&"voluntary"in B&&B.voluntary&&!h.trim()&&(ie.chiTiet="Vui lòng nhập mô tả cho khoản đóng góp"),(I||te)&&Object.keys(d).length===0&&(ie.householdFees="Vui lòng nhập số tiền cho các hộ"),T(ie),Object.keys(ie).length===0},Y=()=>{pe?(E(!0),K("close")):de()},de=()=>{T({}),o(""),f(""),g({}),y(null),_(""),E(!1),A(!1),K(null),H(null),t()},P=()=>{ye()&&(A(!0),K("save"))},Z=()=>{if(n){const ie=Lo[l],we={type:l,tenKhoan:(ie==null?void 0:ie.name)||"",chiTiet:h,batBuoc:ie!=null&&ie.mandatory?"Bắt buộc":"Không bắt buộc",householdFees:d,importedFileName:D||void 0};n(we)}de()},k=ie=>{ie.target===ie.currentTarget&&Y()},V=j.useMemo(()=>Object.values(d).reduce((ie,{amount:we})=>ie+we,0),[d]),U=l==="PHI_DIEN"||l==="PHI_NUOC"||l==="PHI_INTERNET",Te=!U;return c.jsxs(c.Fragment,{children:[e&&c.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",onClick:k,children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-3xl max-h-[90vh] overflow-y-auto relative",onClick:ie=>ie.stopPropagation(),children:[c.jsx("button",{className:"absolute top-3 right-3 text-gray-400 hover:text-gray-700 text-2xl font-bold focus:outline-none",onClick:Y,"aria-label":"Đóng",children:"×"}),c.jsx("h3",{className:"text-2xl font-bold text-center mb-6",children:r}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Loại khoản thu ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsxs("select",{className:`mt-1 block w-full px-3 py-2 border ${b.feeType?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,value:l,onChange:ie=>re(ie.target.value),disabled:M,children:[c.jsx("option",{value:"",children:"-- Chọn loại khoản thu --"}),Object.values(Lo).map(ie=>c.jsx("option",{value:ie.id,children:ie.name},ie.id))]}),b.feeType&&c.jsx("p",{className:"text-xs text-red-500 mt-1",children:b.feeType})]}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[B&&"voluntary"in B&&B.voluntary?"Mô tả khoản đóng góp":"Chi tiết"," ",B&&"voluntary"in B&&B.voluntary&&c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("textarea",{className:`mt-1 block w-full px-3 py-2 border ${b.chiTiet?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm`,placeholder:B&&"voluntary"in B&&B.voluntary?"Nhập mô tả chi tiết về mục đích đóng góp...":"Mô tả chi tiết về khoản thu...",rows:3,value:h,onChange:ie=>f(ie.target.value)}),b.chiTiet&&c.jsx("p",{className:"text-xs text-red-500 mt-1",children:b.chiTiet})]}),U&&!Object.keys(d).length&&c.jsxs("div",{className:"mb-6 p-4 border border-dashed border-gray-300 rounded-lg",children:[c.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Import dữ liệu từ Excel/CSV"}),c.jsxs("p",{className:"text-sm text-gray-500 mb-3",children:["Định dạng file mẫu:",c.jsx("br",{}),c.jsx("b",{children:"Cột 1"}),": Mã hộ (ví dụ: HK001, HK002, ...)",c.jsx("br",{}),c.jsx("b",{children:"Cột 2"}),": Chủ hộ (ví dụ: Nguyễn Văn A, ...)",c.jsx("br",{}),c.jsx("b",{children:"Cột 3"}),": Số tiền (chỉ số, không có chữ VND, ví dụ: 150000)",c.jsx("br",{})]}),c.jsxs("label",{className:"flex items-center justify-center w-full",children:[c.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",className:"hidden",onChange:Q}),c.jsx("div",{className:"px-4 py-2 bg-blue-500 text-white text-sm font-medium rounded hover:bg-blue-600 cursor-pointer",children:"Chọn file"})]}),w&&c.jsx("p",{className:"mt-2 text-sm text-red-500",children:w})]}),U&&Object.keys(d).length>0&&c.jsxs("div",{className:"mb-6",children:[c.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[c.jsxs("span",{className:"text-sm text-gray-700",children:["File đã chọn: ",c.jsx("b",{children:D})]}),c.jsxs("label",{children:[c.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",className:"hidden",onChange:Q}),c.jsx("span",{className:"ml-2 px-3 py-1 bg-blue-100 text-blue-700 rounded cursor-pointer hover:bg-blue-200 transition",children:"Đổi file"})]})]}),c.jsx("div",{className:"border border-gray-200 rounded-lg max-h-60 overflow-y-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50 sticky top-0",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Mã hộ"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Chủ hộ"}),B&&"calculateByArea"in B&&B.calculateByArea&&c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Diện tích (m²)"}),B&&"calculateByVehicle"in B&&B.calculateByVehicle&&c.jsxs(c.Fragment,{children:[c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Xe máy"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Ô tô"})]}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Số tiền (VND)"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Object.entries(d).map(([ie,we])=>{var Ne,ze,Ue;return c.jsxs("tr",{children:[c.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:ie}),c.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:we.owner||""}),B&&"calculateByArea"in B&&B.calculateByArea&&c.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:((Ne=jo.find(rt=>rt.id===ie))==null?void 0:Ne.area)||""}),B&&"calculateByVehicle"in B&&B.calculateByVehicle&&c.jsxs(c.Fragment,{children:[c.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:((ze=jo.find(rt=>rt.id===ie))==null?void 0:ze.vehicles.motorbikes)||""}),c.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:((Ue=jo.find(rt=>rt.id===ie))==null?void 0:Ue.vehicles.cars)||""})]}),c.jsx("td",{className:"px-4 py-2 text-sm",children:c.jsx("input",{type:"text",className:"block w-28 px-2 py-1 border border-gray-300 rounded-md shadow-sm text-sm focus:ring-blue-500 focus:border-blue-500 text-right transition-all hover:border-blue-400 focus:bg-blue-50",placeholder:"0",value:we.amount?q(we.amount):"",onChange:rt=>g(Ye=>({...Ye,[ie]:{...Ye[ie],amount:parseInt(rt.target.value.replace(/[^\d]/g,""))||0,auto:!1}})),inputMode:"numeric"})})]},ie)})})]})}),w&&c.jsx("p",{className:"text-xs text-red-500 mt-2",children:w})]}),Te&&I&&c.jsxs("div",{className:"mb-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("h4",{className:"font-medium text-gray-700",children:"Số tiền theo hộ"}),c.jsxs("p",{className:"text-sm text-gray-500",children:["Tổng thu: ",c.jsxs("span",{className:"font-semibold text-gray-700",children:[q(V)," VND"]})]})]}),c.jsx("div",{className:"border border-gray-200 rounded-lg max-h-60 overflow-y-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50 sticky top-0",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Mã hộ"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Chủ hộ"}),B&&"calculateByArea"in B&&B.calculateByArea&&c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Diện tích (m²)"}),B&&"calculateByVehicle"in B&&B.calculateByVehicle&&c.jsxs(c.Fragment,{children:[c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Xe máy"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Ô tô"})]}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Số tiền (VND)"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:jo.map(ie=>{var we;return c.jsxs("tr",{children:[c.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:ie.id}),c.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:ie.owner}),B&&"calculateByArea"in B&&B.calculateByArea&&c.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:ie.area}),B&&"calculateByVehicle"in B&&B.calculateByVehicle&&c.jsxs(c.Fragment,{children:[c.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:ie.vehicles.motorbikes}),c.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:ie.vehicles.cars})]}),c.jsx("td",{className:"px-4 py-2 text-sm",children:c.jsx("input",{type:"text",className:"block w-28 px-2 py-1 border border-gray-300 rounded-md shadow-sm text-sm focus:ring-blue-500 focus:border-blue-500 text-right transition-all hover:border-blue-400 focus:bg-blue-50",placeholder:"0",value:(we=d[ie.id])!=null&&we.amount?q(d[ie.id].amount):"",onChange:Ne=>ee(ie.id,Ne.target.value),inputMode:"numeric"})})]},ie.id)})})]})}),b.householdFees&&c.jsx("p",{className:"text-xs text-red-500 mt-1",children:b.householdFees})]}),c.jsxs("div",{className:"flex gap-4 mt-4",children:[c.jsx("button",{className:"flex-1 px-4 py-3 bg-gray-500 text-white text-base font-semibold rounded-md shadow-sm hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all",onClick:Y,children:"Hủy"}),c.jsx("button",{className:"flex-1 px-4 py-3 bg-blue-500 text-white text-base font-semibold rounded-md shadow-sm hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all",onClick:P,children:"Lưu"})]})]})}),(S||C)&&c.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60]",onClick:()=>{E(!1),A(!1),K(null)},children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl px-8 py-7 max-w-sm w-full relative",onClick:ie=>ie.stopPropagation(),children:[c.jsxs("p",{className:"text-base text-gray-800 mb-6 text-center font-medium",children:[S&&"Những thay đổi hiện tại sẽ không được lưu lại. Bạn vẫn muốn thoát?",C&&M&&"Bạn xác nhận lưu thay đổi cho khoản thu này?",C&&!M&&"Bạn xác nhận tạo khoản thu mới này?"]}),c.jsxs("div",{className:"flex gap-4 w-full",children:[c.jsx("button",{className:"flex-1 px-4 py-2.5 bg-gray-400 text-white rounded hover:bg-gray-500 font-medium transition-colors",onClick:()=>{E(!1),A(!1),K(null)},children:S?"Chỉnh sửa tiếp":"Hủy"}),c.jsx("button",{className:"flex-1 px-4 py-2.5 bg-blue-500 text-white rounded hover:bg-blue-600 font-medium transition-colors",onClick:()=>{F==="close"&&de(),F==="save"&&Z()},children:S?"Thoát":"Xác nhận"})]})]})})]})},ej=e=>{const t=e.toLowerCase();return t.includes("dịch vụ")||t.includes("dich vu")?"PHI_DICH_VU":t.includes("quản lý")||t.includes("quan ly")?"PHI_QUAN_LY":t.includes("gửi xe")||t.includes("gui xe")||t.includes("xe")?"PHI_GUI_XE":t.includes("điện")||t.includes("dien")?"PHI_DIEN":t.includes("nước")||t.includes("nuoc")?"PHI_NUOC":t.includes("internet")||t.includes("mạng")?"PHI_INTERNET":t.includes("vệ sinh")||t.includes("ve sinh")?"PHI_VE_SINH":"PHI_DICH_VU"},rh=[{maDot:"D001",tenDot:"Tháng 05/2025",ngayTao:"01/05/2025",hanCuoi:"31/05/2025",trangThai:"Đang mở",details:{maDot:"D001",tenDot:"Tháng 05/2025",ngayTao:"01/05/2025",hanCuoi:"31/05/2025",khoanThu:[{id:"K001",type:"PHI_DICH_VU",tenKhoan:"Phí dịch vụ chung cư",chiTiet:"Phí dịch vụ tháng 5",batBuoc:"Bắt buộc",householdFees:{HK001:{amount:755e3,auto:!0},HK002:{amount:1002e3,auto:!0},HK003:{amount:6e5,auto:!0},HK004:{amount:1205e3,auto:!0},HK005:{amount:85e4,auto:!0}}},{id:"K002",type:"PHI_GUI_XE",tenKhoan:"Phí gửi xe",chiTiet:"Phí gửi xe tháng 5",batBuoc:"Bắt buộc",householdFees:{HK001:{amount:14e4,auto:!0},HK002:{amount:127e4,auto:!0},HK003:{amount:21e4,auto:!0},HK004:{amount:127e4,auto:!0},HK005:{amount:134e4,auto:!0}}}]},isExpanded:!1},{maDot:"D002",tenDot:"Tháng 04/2025",ngayTao:"01/04/2025",hanCuoi:"30/04/2025",trangThai:"Đã đóng",details:{maDot:"D002",tenDot:"Tháng 04/2025",ngayTao:"01/04/2025",hanCuoi:"30/04/2025",khoanThu:[{id:"K004",type:"PHI_DICH_VU",tenKhoan:"Phí dịch vụ chung cư",chiTiet:"Phí dịch vụ tháng 4",batBuoc:"Bắt buộc",householdFees:{HK001:{amount:7e5,auto:!0},HK002:{amount:95e4,auto:!0},HK003:{amount:6e5,auto:!0},HK004:{amount:12e5,auto:!0},HK005:{amount:8e5,auto:!0}}},{id:"K005",type:"PHI_GUI_XE",tenKhoan:"Phí gửi xe",chiTiet:"Phí gửi xe tháng 4",batBuoc:"Bắt buộc",householdFees:{HK001:{amount:7e4,auto:!0},HK002:{amount:127e4,auto:!0},HK003:{amount:21e4,auto:!0},HK004:{amount:127e4,auto:!0},HK005:{amount:134e4,auto:!0}}}]},isExpanded:!1},{maDot:"D003",tenDot:"Quý I /2025",ngayTao:"01/01/2025",hanCuoi:"31/03/2025",trangThai:"Đã đóng",details:{maDot:"D003",tenDot:"Quý I /2025",ngayTao:"01/01/2025",hanCuoi:"31/03/2025",khoanThu:[{id:"K006",type:"PHI_QUAN_LY",tenKhoan:"Phí quản lý",chiTiet:"Phí quản lý quý",batBuoc:"Bắt buộc",householdFees:{HK001:{amount:4e5,auto:!0},HK002:{amount:7e5,auto:!0},HK003:{amount:3e5,auto:!0},HK004:{amount:9e5,auto:!0},HK005:{amount:5e5,auto:!0}}},{id:"K007",type:"KHOAN_DONG_GOP",tenKhoan:"Phí sửa chữa chung",chiTiet:"Sửa chữa cơ sở vật chất",batBuoc:"Không bắt buộc",householdFees:{HK001:{amount:1e5,auto:!0},HK002:{amount:2e5,auto:!0},HK003:{amount:0,auto:!0},HK004:{amount:0,auto:!0},HK005:{amount:0,auto:!0}}}]},isExpanded:!1}],tj=()=>{const[e,t]=j.useState(!1),[n,a]=j.useState(!1),[r,l]=j.useState(null),[o,h]=j.useState(""),[f,d]=j.useState("Tất cả"),[g,p]=j.useState([]),[y,w]=j.useState(!0),[_,b]=j.useState(null),[T,S]=j.useState(!1),[E,C]=j.useState(!1),[A,F]=j.useState(!1),[K,D]=j.useState(!1),[H,M]=j.useState(null),[B,I]=j.useState(null),[te,q]=j.useState(null);j.useEffect(()=>{console.log("🚀 QuanLyDotThuPhi component mounted"),ae()},[]);const ae=async()=>{try{w(!0),b(null),console.log("🔄 Loading fee collection data from API..."),console.log("📊 Current batches state:",g),console.log("📊 Sample batches available:",rh),console.log("🔑 Checking authentication token...");const me=localStorage.getItem("authToken");if(console.log("🔑 Auth token:",me?"Present":"Missing"),!me){console.warn("⚠️  No auth token found, using sample data"),b("Vui lòng đăng nhập để tải dữ liệu từ server."),p(rh);return}try{const ke=await bn.dotThu.getAll({page:0,size:100,sortBy:"createdAt",sortDir:"desc"});if(console.log("📊 API Response:",ke),ke&&ke.success&&ke.dotThus){const Le=ke.dotThus.map(Ze=>{const wt=(Ze.khoanThu||[]).map(tt=>({id:tt.id,type:ej(tt.tenkhoanthu),tenKhoan:tt.tenkhoanthu,chiTiet:tt.ghichu||tt.tenkhoanthu,batBuoc:tt.batbuoc?"Bắt buộc":"Không bắt buộc",soTien:tt.DotThu_KhoanThu&&tt.DotThu_KhoanThu.soTien!==void 0&&tt.DotThu_KhoanThu.soTien!==null?Number(tt.DotThu_KhoanThu.soTien):void 0,householdFees:{}}));console.log("🔄 Transformed khoanThu for dotThu",Ze.id,":",wt);const _t=tt=>{switch(tt){case"DANG_MO":return"Đang mở";case"DA_DONG":return"Đã đóng";case"HOAN_THANH":return"Hoàn thành";default:return ee(Ze.thoiHan)?"Đã đóng":"Đang mở"}};return{maDot:Ze.id,tenDot:Ze.tenDotThu,ngayTao:re(Ze.ngayTao),hanCuoi:re(Ze.thoiHan),trangThai:_t(Ze.trangThai),details:{maDot:Ze.id,tenDot:Ze.tenDotThu,ngayTao:re(Ze.ngayTao),hanCuoi:re(Ze.thoiHan),khoanThu:wt},isExpanded:!1}});console.log("✅ Transformed batches:",Le),p(Le)}else console.log("⚠️  No data returned from API or invalid response structure:",ke),p([])}catch(ke){console.warn("⚠️  API call failed, using sample data as fallback:",ke),b("Không thể tải dữ liệu từ server. Đang hiển thị dữ liệu mẫu."),p(rh)}}catch(me){console.error("❌ Error loading fee collection data:",me),b("Không thể tải dữ liệu đợt thu phí. Đang sử dụng dữ liệu mẫu."),p(rh)}finally{w(!1)}},re=me=>new Date(me).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}),ee=me=>{const ke=new Date;return new Date(me)<ke},Q=me=>{if(!me)return;let ke;if(typeof me=="string")if(me.includes("/")){const Le=me.split("/");Le.length===3?ke=new Date(parseInt(Le[2],10),parseInt(Le[1],10)-1,parseInt(Le[0],10)):ke=new Date(me)}else ke=new Date(me);else ke=me;if(ke&&!isNaN(ke.getTime()))return ke.toISOString().split("T")[0];console.warn("Invalid date input for formatDateForAPI:",me)},pe=me=>{const ke=new Date().toISOString().slice(0,10),Le=me.hanCuoi;return ke>Le&&me.trangThai==="Đang mở"?{...me,trangThai:"Đã đóng"}:me},ye=g.map(pe).filter(me=>{const ke=me.tenDot.toLowerCase().includes(o.toLowerCase()),Le=f==="Tất cả"?!0:me.trangThai===f;return ke&&Le});console.log("🔍 Debug render state:"),console.log("- Batches:",g),console.log("- Filtered batches:",ye),console.log("- Loading:",y),console.log("- Error:",_),console.log("- Search:",o),console.log("- Filter:",f);const Y=me=>{p(ke=>ke.map(Le=>Le.maDot===me?{...Le,isExpanded:!Le.isExpanded}:Le))},de=()=>t(!0),P=()=>t(!1),Z=(me,ke)=>{ke.stopPropagation(),l(me),a(!0)},k=()=>{a(!1),l(null)},V=(me,ke)=>{ke.stopPropagation(),l(me),S(!0)},U=()=>{S(!1),l(null)},Te=async()=>{if(r)try{console.log("🔄 Deleting batch:",r.maDot);const me=await bn.dotThu.delete(r.maDot);if(me.success)console.log("✅ Batch deleted successfully"),await ae(),U(),alert("Đã xóa đợt thu thành công!");else throw new Error(me.message||"Không thể xóa đợt thu")}catch(me){console.error("❌ Error deleting batch:",me),alert("Có lỗi xảy ra khi xóa đợt thu: "+(me.message||"Lỗi không xác định")),p(ke=>ke.filter(Le=>Le.maDot!==r.maDot)),U()}},ie=(me,ke)=>{if(ke.stopPropagation(),me.trangThai==="Đã đóng"||me.trangThai==="Hoàn thành"){q("Không thể thêm khoản thu vào đợt thu đã đóng hoặc hoàn thành.");return}l(me),I(me),M(null),C(!0)},we=()=>{C(!1)},Ne=async me=>{if(B)try{const ke=await bn.khoanThu.create({tenKhoan:me.tenKhoan,batBuoc:me.batBuoc==="Bắt buộc",ghiChu:me.chiTiet||""});if(ke.success){const Le=ke.data.id,Ze=me.householdFees?Object.values(me.householdFees).reduce((tt,gn)=>tt+(gn.amount||0),0):0,wt=[...B.details.khoanThu.map(tt=>({khoanThuId:String(tt.id),soTien:tt.soTien!==void 0?parseFloat(tt.soTien):0})),{khoanThuId:String(Le),soTien:Ze}],_t=await bn.dotThu.update(B.maDot,{khoanThu:wt});_t.success?(await ae(),we(),alert("Đã tạo khoản thu thành công!")):alert("Có lỗi xảy ra khi gắn khoản thu vào đợt thu: "+(_t.message||"Lỗi không xác định"))}else alert("Có lỗi xảy ra khi tạo khoản thu: "+(ke.message||"Lỗi không xác định"))}catch(ke){console.error("Error creating fee type:",ke),alert("Có lỗi xảy ra khi tạo khoản thu: "+(ke.message||"Lỗi không xác định"))}},ze=(me,ke,Le)=>{Le.stopPropagation(),M(me),I(ke),F(!0)},Ue=()=>{F(!1),M(null)},rt=async me=>{if(B&&H)try{if(H.id&&(H.tenKhoan!==me.tenKhoan||H.batBuoc!==(me.batBuoc==="Bắt buộc")||H.chiTiet!==me.chiTiet)){const Ze=await bn.khoanThu.update(H.id,{tenKhoan:me.tenKhoan,batBuoc:me.batBuoc==="Bắt buộc",ghiChu:me.chiTiet||""});if(!Ze.success){alert("Có lỗi xảy ra khi cập nhật chi tiết khoản thu: "+(Ze.message||"Lỗi không xác định"));return}}const ke=B.details.khoanThu.map(Ze=>{if(Ze.id===H.id){const wt=me.householdFees?Object.values(me.householdFees).reduce((_t,tt)=>_t+(tt.amount||0),0):me.soTien?parseFloat(me.soTien):0;return{khoanThuId:String(Ze.id),soTien:wt}}return{khoanThuId:String(Ze.id),soTien:Ze.soTien!==void 0&&Ze.soTien!==null?parseFloat(Ze.soTien):0}}),Le=await bn.dotThu.update(B.maDot,{khoanThu:ke});Le.success?(await ae(),Ue(),alert("Đã cập nhật khoản thu thành công!")):alert("Có lỗi xảy ra khi cập nhật số tiền khoản thu trong đợt thu: "+(Le.message||"Lỗi không xác định"))}catch(ke){console.error("Error updating fee type:",ke),alert("Có lỗi xảy ra khi cập nhật khoản thu: "+(ke.message||"Lỗi không xác định"))}},Ye=(me,ke,Le)=>{Le.stopPropagation(),M(me),I(ke),D(!0)},rn=()=>{D(!1),M(null)},xt=async()=>{if(B&&H)try{const me=B.details.khoanThu.filter(Le=>Le.id!==H.id).map(Le=>({khoanThuId:String(Le.id),soTien:Le.soTien!==void 0&&Le.soTien!==null?parseFloat(Le.soTien):0})),ke=await bn.dotThu.update(B.maDot,{khoanThu:me});ke.success?(console.log("✅ Fee association removed successfully from DotThu"),await ae(),rn(),alert("Đã xóa khoản thu khỏi đợt thu thành công!")):alert("Có lỗi xảy ra khi xóa khoản thu khỏi đợt thu: "+(ke.message||"Lỗi không xác định"))}catch(me){console.error("Error deleting fee from DotThu:",me),alert("Có lỗi xảy ra khi xóa khoản thu: "+(me.message||"Lỗi không xác định"))}},Fe=async me=>{try{console.log("🔄 Creating new batch:",me);const ke=await bn.dotThu.create({tenDotThu:me.tenDot,ngayTao:Q(me.ngayTao)||me.ngayTao,thoiHan:Q(me.hanThu)||me.hanThu});if(ke.success)console.log("✅ Batch created successfully:",ke.data),await ae(),alert("Đã tạo đợt thu mới thành công!");else throw new Error(ke.message||"Không thể tạo đợt thu")}catch(ke){console.error("❌ Error creating batch:",ke),alert("Có lỗi xảy ra khi tạo đợt thu: "+(ke.message||"Lỗi không xác định"));const Le=new Date().toISOString().slice(0,10),Ze=me.hanThu>=Le?"Đang mở":"Đã đóng";p(wt=>[{maDot:me.maDot,tenDot:me.tenDot,ngayTao:me.ngayTao,hanCuoi:me.hanThu,trangThai:Ze,details:{maDot:me.maDot,tenDot:me.tenDot,ngayTao:me.ngayTao,hanCuoi:me.hanThu,khoanThu:[]},isExpanded:!1},...wt])}},ft=async me=>{if(r&&r.maDot)try{const ke={tenDotThu:me.tenDot,ngayTao:Q(me.ngayTao),thoiHan:Q(me.hanThu),khoanThu:Array.isArray(me.khoanThu)?me.khoanThu.map(wt=>({khoanThuId:String(wt.khoanThuId),soTien:wt.soTien})):[]},Le=Object.fromEntries(Object.entries(ke).filter(([wt,_t])=>_t!==void 0)),Ze=await bn.dotThu.update(r.maDot,Le);Ze.success?(await ae(),k(),alert("Đã cập nhật đợt thu thành công!")):alert("Có lỗi xảy ra khi cập nhật đợt thu: "+(Ze.message||"Lỗi không xác định"))}catch(ke){console.error("Error updating batch:",ke),alert("Có lỗi xảy ra khi cập nhật đợt thu: "+(ke.message||"Lỗi không xác định"))}},Jt=async(me,ke)=>{if(ke.stopPropagation(),window.confirm(`Bạn có chắc chắn muốn đóng đợt thu "${me.tenDot}" không? Sau khi đóng, sẽ không thể thêm hoặc chỉnh sửa khoản thu nữa.`))try{const Le=await bn.dotThu.close(me.maDot);Le.success?(await ae(),alert("Đã đóng đợt thu thành công!")):alert("Có lỗi xảy ra khi đóng đợt thu: "+(Le.message||"Lỗi không xác định"))}catch(Le){console.error("Error closing batch:",Le),alert("Có lỗi xảy ra khi đóng đợt thu: "+(Le.message||"Lỗi không xác định"))}},Fn=async(me,ke)=>{if(ke.stopPropagation(),window.confirm(`Bạn có chắc chắn muốn mở lại đợt thu "${me.tenDot}" không?`))try{const Le=await bn.dotThu.reopen(me.maDot);Le.success?(await ae(),alert("Đã mở lại đợt thu thành công!")):alert("Có lỗi xảy ra khi mở lại đợt thu: "+(Le.message||"Lỗi không xác định"))}catch(Le){console.error("Error reopening batch:",Le),alert("Có lỗi xảy ra khi mở lại đợt thu: "+(Le.message||"Lỗi không xác định"))}},Cn=async(me,ke)=>{if(ke.stopPropagation(),window.confirm(`Bạn có chắc chắn muốn đánh dấu đợt thu "${me.tenDot}" là hoàn thành không?`))try{const Le=await bn.dotThu.markCompleted(me.maDot);Le.success?(await ae(),alert("Đã đánh dấu đợt thu hoàn thành!")):alert("Có lỗi xảy ra khi đánh dấu hoàn thành: "+(Le.message||"Lỗi không xác định"))}catch(Le){console.error("Error marking completed:",Le),alert("Có lỗi xảy ra khi đánh dấu hoàn thành: "+(Le.message||"Lỗi không xác định"))}};return c.jsxs(c.Fragment,{children:[c.jsx(On,{role:"ketoan",children:c.jsxs("div",{className:"p-4 flex flex-col gap-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"QUẢN LÝ ĐỢT THU PHÍ"}),c.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Chào mừng đến với Hệ thống Quản lý Thu phí Chung cư"})]}),_&&c.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),_,c.jsx("button",{onClick:()=>{b(null),ae()},className:"ml-auto text-sm underline hover:no-underline",children:"Thử lại"})]})}),y?c.jsx("div",{className:"flex items-center justify-center py-12",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),c.jsx("span",{className:"text-gray-600",children:"Đang tải dữ liệu..."})]})}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md shadow-sm overflow-hidden flex-1",children:[c.jsx("div",{className:"p-2 text-gray-400",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),c.jsx("input",{type:"text",placeholder:"Tìm đợt thu...",className:"flex-1 p-2 border-l border-gray-300 outline-none text-sm",autoFocus:!0,value:o,onChange:me=>h(me.target.value)})]}),c.jsx("div",{className:"border border-gray-300 rounded-md shadow-sm overflow-hidden bg-white",children:c.jsxs("select",{className:"p-2 text-sm bg-white outline-none",value:f,onChange:me=>d(me.target.value),children:[c.jsx("option",{value:"Tất cả",children:"Tất cả"}),c.jsx("option",{value:"Đang mở",children:"Đang mở"}),c.jsx("option",{value:"Đã đóng",children:"Đã đóng"}),c.jsx("option",{value:"Hoàn thành",children:"Hoàn thành"})]})}),c.jsxs("button",{className:"bg-blue-500 text-white px-4 py-2 rounded-md shadow-sm hover:bg-blue-600 flex items-center gap-2",onClick:de,children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Tạo đợt thu mới"]})]}),c.jsxs("div",{className:"bg-white rounded-md shadow-md overflow-hidden border border-gray-200",children:[c.jsx("div",{className:"p-4 bg-gray-100 border-b border-gray-200",children:c.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Danh sách đợt thu"})}),c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Mã đợt"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Tên đợt"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Ngày tạo"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Hạn cuối"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Trạng thái"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Thao tác"})]})}),c.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[(console.log("🎯 Rendering table with filteredBatches:",ye),console.log("🎯 filteredBatches.length:",ye.length),null),ye.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500",children:"Không có đợt thu phí nào"})}):ye.map(me=>c.jsxs(Vh.Fragment,{children:[c.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer transition-all",onClick:()=>Y(me.maDot),children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:me.maDot}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"mr-2",children:me.tenDot}),me.isExpanded?c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:me.ngayTao}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:me.hanCuoi}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:c.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${me.trangThai==="Đang mở"?"bg-green-100 text-green-800":me.trangThai==="Hoàn thành"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:me.trangThai})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("button",{onClick:ke=>Z(me,ke),className:"text-indigo-600 hover:text-indigo-900",title:"Chỉnh sửa",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),me.trangThai==="Đang mở"?c.jsx("button",{onClick:ke=>Jt(me,ke),className:"text-orange-600 hover:text-orange-800",title:"Đóng đợt thu",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}):c.jsx("button",{onClick:ke=>Fn(me,ke),className:"text-green-600 hover:text-green-800",title:"Mở lại đợt thu",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z"})})}),(me.trangThai==="Đang mở"||me.trangThai==="Đã đóng")&&c.jsx("button",{onClick:ke=>Cn(me,ke),className:"text-blue-600 hover:text-blue-800",title:"Đánh dấu hoàn thành",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),c.jsx("button",{onClick:ke=>V(me,ke),className:"text-red-600 hover:text-red-800",title:"Xóa",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]}),me.isExpanded&&c.jsx("tr",{children:c.jsx("td",{colSpan:6,className:"px-0 py-0 bg-gray-50",children:c.jsxs("div",{className:"p-4",children:[c.jsxs("div",{className:"flex justify-between items-center mb-3",children:[c.jsx("h3",{className:"text-md font-semibold text-gray-800",children:"Danh sách khoản thu"}),c.jsxs("button",{className:"bg-blue-500 text-white px-3 py-1 rounded-md text-sm hover:bg-blue-600 flex items-center gap-1",onClick:ke=>ie(me,ke),children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thêm khoản thu"]})]}),me.details.khoanThu.length>0?c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Loại khoản thu"}),c.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Mô tả"}),c.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Tổng tiền"}),c.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Bắt buộc"}),c.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Thao tác"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:me.details.khoanThu.map(ke=>{const Le=Lo[ke.type],Ze=ke.soTien!==void 0&&ke.soTien!==null?parseFloat(ke.soTien):ke.householdFees?Object.values(ke.householdFees).reduce((wt,_t)=>wt+(_t.amount||0),0):0;return c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:(Le==null?void 0:Le.name)||ke.tenKhoan||"Không xác định"}),c.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:ke.chiTiet}),c.jsxs("td",{className:"px-4 py-3 text-sm text-blue-700 font-semibold",children:[Ze.toLocaleString("vi-VN")," VND"]}),c.jsx("td",{className:"px-4 py-3 text-sm",children:c.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ke.batBuoc==="Bắt buộc"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:ke.batBuoc})}),c.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:c.jsxs("div",{className:"flex space-x-3",children:[c.jsx("button",{onClick:wt=>ze(ke,me,wt),className:"text-indigo-600 hover:text-indigo-900",title:"Chỉnh sửa",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),c.jsx("button",{onClick:wt=>Ye(ke,me,wt),className:"text-red-600 hover:text-red-800",title:"Xóa",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},ke.id)})})]})}):c.jsx("div",{className:"text-center text-gray-500 text-sm py-6",children:"Chưa có khoản thu nào"})]})})})]},me.maDot))]})]})]})]})]})}),c.jsx(Zk,{isOpen:e,onClose:P,onSave:Fe}),c.jsx(Jk,{isOpen:n,onClose:k,onSave:ft,batch:r}),c.jsx(hv,{isOpen:E,onClose:we,onSave:Ne,title:"Thêm khoản thu"}),c.jsx(hv,{isOpen:A,onClose:Ue,onSave:rt,initialData:H,title:"Chỉnh sửa khoản thu"}),T&&r&&c.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",onClick:U,children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-sm w-full relative",onClick:me=>me.stopPropagation(),children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Xác nhận xóa"}),c.jsxs("p",{className:"text-gray-700 mb-6",children:["Bạn có chắc chắn muốn xóa đợt thu ",c.jsxs("span",{className:"font-bold text-red-600",children:['"',r.tenDot,'"']})," không? ",c.jsx("br",{}),c.jsx("span",{className:"text-sm text-gray-500",children:"Thao tác này không thể hoàn tác."})]}),c.jsxs("div",{className:"flex justify-end gap-3",children:[c.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100 font-medium",onClick:U,children:"Hủy"}),c.jsx("button",{className:"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 font-medium",onClick:Te,children:"Xóa"})]})]})}),K&&H&&c.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",onClick:rn,children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-sm w-full relative",onClick:me=>me.stopPropagation(),children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Xác nhận xóa"}),c.jsxs("p",{className:"text-gray-700 mb-6",children:["Bạn có chắc chắn muốn xóa khoản thu ",c.jsxs("span",{className:"font-bold text-red-600",children:['"',H.tenKhoan,'"']})," không? ",c.jsx("br",{}),c.jsx("span",{className:"text-sm text-gray-500",children:"Thao tác này không thể hoàn tác."})]}),c.jsxs("div",{className:"flex justify-end gap-3",children:[c.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100 font-medium",onClick:rn,children:"Hủy"}),c.jsx("button",{className:"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 font-medium",onClick:xt,children:"Xóa"})]})]})}),te&&c.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",onClick:()=>q(null),children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full relative flex flex-col items-center",onClick:me=>me.stopPropagation(),children:[c.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Không thể thêm khoản thu"}),c.jsx("p",{className:"text-gray-700 mb-6 text-center",children:te}),c.jsx("div",{className:"flex justify-center w-full",children:c.jsx("button",{className:"px-6 py-2 bg-blue-500 text-white rounded-lg font-semibold shadow hover:bg-blue-600 transition-all focus:outline-none focus:ring-2 focus:ring-blue-400",onClick:()=>q(null),children:"Đóng"})})]})})]})},nj=({isOpen:e,onClose:t,editData:n,onSave:a})=>{const[r,l]=j.useState(""),[o,h]=j.useState(""),[f,d]=j.useState(""),[g,p]=j.useState(""),[y,w]=j.useState(""),[_,b]=j.useState(""),T=["Nguyễn Văn An","Trần Thị Bình","Lê Minh Công","Phạm Thị Dung","Hoàng Văn Em"],S=["Tạm trú","Tạm vắng"];j.useEffect(()=>{n?(l(n.hoTen),h(n.trangThai),d(n.diaChi),p(n.tuNgay),w(n.denNgay),b(n.noiDungDeNghi)):E()},[n]);const E=()=>{l(""),h(""),d(""),p(""),w(""),b("")},C=()=>{if(!r||!o||!f||!g||!y){alert("Vui lòng nhập đầy đủ thông tin bắt buộc!");return}a({hoTen:r,trangThai:o,diaChi:f,tuNgay:g,denNgay:y,noiDungDeNghi:_}),t()};return e?c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto backdrop-blur-md bg-white/30",children:c.jsx("div",{className:"flex min-h-screen items-center justify-center p-4",children:c.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-lg shadow-xl",children:[c.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-gray-200",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:n?"Cập nhật tạm trú/tạm vắng":"Thêm mới tạm trú/tạm vắng"}),c.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),c.jsxs("div",{className:"p-6 space-y-5",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Nhân khẩu ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsxs("select",{value:r,onChange:A=>l(A.target.value),className:"w-full p-2 border border-gray-300 rounded-md",children:[c.jsx("option",{value:"",children:"-- Chọn nhân khẩu --"}),T.map(A=>c.jsx("option",{value:A,children:A},A))]})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Trạng thái ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsxs("select",{value:o,onChange:A=>h(A.target.value),className:"w-full p-2 border border-gray-300 rounded-md",children:[c.jsx("option",{value:"",children:"-- Chọn trạng thái --"}),S.map(A=>c.jsx("option",{value:A,children:A},A))]})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Địa chỉ ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{value:f,onChange:A=>d(A.target.value),type:"text",className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"Nhập địa chỉ tạm trú/tạm vắng"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Từ ngày ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{value:g,onChange:A=>p(A.target.value),type:"date",className:"w-full p-2 border border-gray-300 rounded-md"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Đến ngày ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{value:y,onChange:A=>w(A.target.value),type:"date",className:"w-full p-2 border border-gray-300 rounded-md"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nội dung đề nghị"}),c.jsx("textarea",{value:_,onChange:A=>b(A.target.value),rows:4,className:"w-full p-2 border border-gray-300 rounded-md resize-none",placeholder:"Nhập nội dung đề nghị..."})]})]}),c.jsxs("div",{className:"flex justify-end gap-3 px-6 py-4 border-t border-gray-200",children:[c.jsx("button",{onClick:()=>{E(),t()},className:"px-4 py-2 rounded-md bg-gray-100 hover:bg-gray-200 text-gray-800",children:"Hủy"}),c.jsx("button",{onClick:C,className:"px-4 py-2 rounded-md bg-blue-600 hover:bg-blue-700 text-white",children:n?"Cập nhật":"Lưu"})]})]})})}):null},aj=()=>{const[e,t]=j.useState(!1),[n,a]=j.useState("Tất cả"),[r,l]=j.useState(!1),[o,h]=j.useState(null),[f,d]=j.useState(""),g=j.useRef(null),[p,y]=j.useState({top:0,left:0,width:0}),[w,_]=j.useState([{id:"1",hoTen:"Nguyễn Văn An",trangThai:"Tạm trú",diaChi:"123 Lê Lợi, Q.1, TP.HCM",tuNgay:"2025-05-01",denNgay:"2025-08-01",noiDungDeNghi:"Đăng ký tạm trú để thực tập tại công ty"},{id:"2",hoTen:"Trần Thị Bình",trangThai:"Tạm vắng",diaChi:"45 Nguyễn Du, Q.3, TP.HCM",tuNgay:"2025-06-10",denNgay:"2025-07-05",noiDungDeNghi:"Xin tạm vắng để về quê chăm người thân"},{id:"3",hoTen:"Lê Minh Công",trangThai:"Tạm trú",diaChi:"98 Phạm Văn Đồng, Q. Gò Vấp",tuNgay:"2025-05-15",denNgay:"2025-06-30",noiDungDeNghi:"Gia hạn tạm trú do chưa hoàn thành khóa học"}]),b=()=>{h(null),t(!0)},T=M=>{h(M),t(!0)},S=()=>{t(!1),h(null)},E=M=>{if(o)_(B=>B.map(I=>I.id===o.id?{...o,...M}:I));else{const B=Date.now().toString();_(I=>[...I,{id:B,...M}])}S()},C=M=>{const B=w.find(I=>I.id===M);B&&T(B)},A=M=>{window.confirm("Bạn có chắc chắn muốn xóa không?")&&_(B=>B.filter(I=>I.id!==M))},F=M=>{a(M),l(!1)},K=()=>{if(!r&&g.current){const M=g.current.getBoundingClientRect();y({top:M.bottom+window.scrollY,left:M.left+window.scrollX,width:M.width})}l(!r)};j.useEffect(()=>{const M=()=>{l(!1)};if(r)return document.addEventListener("click",M),()=>document.removeEventListener("click",M)},[r]);const D=M=>{d(M.target.value)},H=w.filter(M=>{const B=n==="Tất cả"||M.trangThai===n,I=f===""||M.hoTen.toLowerCase().includes(f.toLowerCase())||M.diaChi.toLowerCase().includes(f.toLowerCase())||M.noiDungDeNghi.toLowerCase().includes(f.toLowerCase());return B&&I});return c.jsxs(c.Fragment,{children:[c.jsx(On,{role:"totruong",children:c.jsx("div",{className:"min-h-screen bg-gray-50",children:c.jsxs("div",{className:"p-4 flex flex-col gap-6",style:{fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, sans-serif'},children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-medium text-gray-900",style:{fontWeight:"500"},children:"QUẢN LÝ TẠM TRÚ/TẠM VẮNG"}),c.jsx("p",{className:"text-gray-500 text-sm mt-1",style:{fontWeight:"400"},children:"Chào mừng đến với Hệ thống Quản lý Thu phí Chung cư"})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{children:c.jsxs("div",{ref:g,className:"flex items-center border border-gray-300 rounded-md shadow-sm overflow-hidden cursor-pointer",onClick:M=>{M.stopPropagation(),K()},children:[c.jsx("input",{type:"text",value:n,readOnly:!0,className:"flex-1 p-2 outline-none text-sm cursor-pointer bg-white",style:{fontWeight:"400",minWidth:"120px"}}),c.jsx("button",{className:"p-2 border-l border-gray-300 bg-gray-50 text-gray-600 hover:bg-gray-100",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})}),c.jsx("input",{type:"text",placeholder:"Tìm kiếm theo tên, địa chỉ hoặc nội dung",className:"flex-1 p-2 border rounded-md shadow-sm text-sm",style:{fontWeight:"400"},value:f,onChange:D}),c.jsxs("button",{className:"bg-blue-500 text-white px-4 py-2 rounded-md shadow-sm hover:bg-blue-600 flex items-center gap-2",style:{fontWeight:"500"},onClick:b,children:[c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Thêm TT/TV"]})]}),c.jsxs("div",{className:"mt-6 bg-white rounded-md shadow-md overflow-hidden border border-gray-200",children:[c.jsx("div",{className:"p-4 bg-gray-100 border-b border-gray-200",children:c.jsxs("h2",{className:"text-lg font-medium text-gray-900",style:{fontWeight:"500"},children:["Danh sách tạm trú/tạm vắng",f&&c.jsxs("span",{className:"text-sm font-normal text-gray-600",children:["(",H.length,' kết quả cho "',f,'")']})]})}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",style:{fontWeight:"500"},children:"Họ tên"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",style:{fontWeight:"500"},children:"Trạng thái"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",style:{fontWeight:"500"},children:"Địa chỉ"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",style:{fontWeight:"500"},children:"Thời gian"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",style:{fontWeight:"500"},children:"Nội dung đề nghị"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",style:{fontWeight:"500"},children:"Thao tác"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:H.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-500 text-sm",children:f?`Không tìm thấy kết quả nào cho "${f}"`:"Không có dữ liệu"})}):H.map(M=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",style:{fontWeight:"500"},children:M.hoTen}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",style:{fontWeight:"400"},children:c.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${M.trangThai==="Tạm trú"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:M.trangThai})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",style:{fontWeight:"400"},children:M.diaChi}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",style:{fontWeight:"400"},children:[M.tuNgay," → ",M.denNgay]}),c.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 max-w-xs truncate",style:{fontWeight:"400"},title:M.noiDungDeNghi,children:M.noiDungDeNghi}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:()=>C(M.id),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-50 transition-colors",title:"Sửa",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),c.jsx("button",{onClick:()=>A(M.id),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-50 transition-colors",title:"Xóa",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},M.id))})]})})]})]})})}),r&&I4.createPortal(c.jsx("div",{className:"bg-white border border-gray-300 rounded-md shadow-lg",style:{position:"fixed",top:p.top,left:p.left,width:p.width,zIndex:9999,maxHeight:"200px",overflowY:"auto"},onClick:M=>M.stopPropagation(),children:["Tất cả","Tạm trú","Tạm vắng"].map(M=>c.jsx("div",{className:"p-2 hover:bg-gray-100 cursor-pointer text-sm",style:{fontWeight:"400"},onClick:()=>F(M),children:M},M))}),document.body),c.jsx(nj,{isOpen:e,onClose:S,editData:o,onSave:E})]})},rj=[{label:"Tất cả",value:""},{label:"Thêm vào hộ khẩu",value:"1"},{label:"Tách/rời khỏi hộ khẩu",value:"2"},{label:"Cập nhật thông tin",value:"3"},{label:"Tạm vắng",value:"4"},{label:"Tạm trú",value:"5"}],sj=e=>{const{loaiThayDoiCode:t,tenNhanKhau:n,soHoKhau:a}=e;switch(t){case 1:return`${n} đã được thêm vào hộ khẩu ${a}. Nguyên nhân: Thành viên mới tham gia hộ khẩu (kết hôn, nhận nuôi, hoặc chuyển đến).`;case 2:return`${n} đã tách khỏi hộ khẩu ${a}. Nguyên nhân: Tách hộ để thành lập hộ khẩu riêng hoặc chuyển sang hộ khẩu khác.`;case 3:return`Thông tin của ${n} trong hộ khẩu ${a} đã được cập nhật. Nguyên nhân: Thay đổi thông tin cá nhân như nghề nghiệp, số điện thoại.`;case 4:return`${n} tạm vắng khỏi hộ khẩu ${a}. Nguyên nhân: Đi công tác, học tập hoặc làm việc xa nhà trong thời gian dài.`;case 5:return`${n} tạm trú tại hộ khẩu ${a}. Nguyên nhân: Lưu trú tạm thời do công tác, học tập.`;default:return`${n} có thay đổi trong hộ khẩu ${a}.`}},ij=()=>{const[e,t]=j.useState("2025-06-11"),[n,a]=j.useState("2025-06-11"),[r,l]=j.useState(""),[o,h]=j.useState("thoiGian"),[f,d]=j.useState(!1),[g,p]=j.useState(null),[y,w]=j.useState(!1),[_,b]=j.useState([]),T=async()=>{try{w(!0);const C=await Xn.getHouseholdChangeHistory({fromDate:e,toDate:n,changeType:r?parseInt(r):void 0,limit:100});C.success?b(C.data.history):(console.error("API returned error:",C),b([]))}catch(C){console.error("Error fetching history data:",C),b([])}finally{w(!1)}};j.useEffect(()=>{T()},[e,n,r]);const E=[..._.filter(C=>!r||C.loaiThayDoiCode.toString()===r)].sort((C,A)=>{const F=C[o],K=A[o];return F<K?f?-1:1:F>K?f?1:-1:0});return c.jsx(On,{role:"totruong",children:c.jsxs("div",{className:"p-4 flex flex-col gap-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"LỊCH SỬ THAY ĐỔI HỘ KHẨU"}),c.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Chào mừng đến với Hệ thống Quản lý Thu phí Chung cư"})]}),c.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[c.jsx("label",{className:"font-semibold text-gray-700",children:"Khoảng thời gian:"}),c.jsx("input",{type:"date",className:"border border-gray-300 rounded-md px-2 py-1 text-sm",value:e,onChange:C=>t(C.target.value)}),c.jsx("span",{children:"-"}),c.jsx("input",{type:"date",className:"border border-gray-300 rounded-md px-2 py-1 text-sm",value:n,onChange:C=>a(C.target.value)}),c.jsx("label",{className:"font-semibold text-gray-700 ml-4",children:"Loại thay đổi:"}),c.jsx("select",{className:"border border-gray-300 rounded-md px-3 py-2 text-sm",value:r,onChange:C=>l(C.target.value),children:rj.map(C=>c.jsx("option",{value:C.value,children:C.label},C.value))}),c.jsx("button",{onClick:T,className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors text-sm",disabled:y,children:y?"Đang tải...":"Làm mới"})]}),c.jsxs("div",{className:"mt-6 bg-white rounded-md shadow-md overflow-hidden border border-gray-200",children:[c.jsx("div",{className:"p-4 bg-gray-100 border-b border-gray-200",children:c.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Danh sách lịch sử thay đổi hộ khẩu"})}),c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider cursor-pointer",onClick:()=>{h("tenNhanKhau"),d(C=>!C)},children:"Tên nhân khẩu"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider cursor-pointer",onClick:()=>{h("soHoKhau"),d(C=>!C)},children:"Số hộ khẩu"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider cursor-pointer",onClick:()=>{h("loaiThayDoi"),d(C=>!C)},children:"Loại thay đổi"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider cursor-pointer",onClick:()=>{h("thoiGian"),d(C=>!C)},children:"Thời gian"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y?c.jsx("tr",{children:c.jsx("td",{colSpan:4,className:"px-6 py-4 text-center text-gray-500",children:"Đang tải dữ liệu..."})}):E.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:4,className:"px-6 py-4 text-center text-gray-500",children:"Không có dữ liệu lịch sử thay đổi"})}):E.map((C,A)=>c.jsxs("tr",{className:"hover:bg-blue-50 cursor-pointer",onClick:()=>p(C),children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:C.tenNhanKhau}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:C.soHoKhau}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:C.loaiThayDoi}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:C.thoiGian})]},A))})]})]}),g&&c.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 min-w-[500px] max-w-[90vw] max-h-[80vh] overflow-y-auto",children:[c.jsx("h3",{className:"text-lg font-bold mb-4 text-blue-600",children:"Chi tiết thay đổi hộ khẩu"}),c.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[c.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[c.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Tên nhân khẩu"}),c.jsx("div",{className:"text-base font-semibold",children:g.tenNhanKhau})]}),c.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[c.jsx("div",{className:"text-sm font-medium text-gray-600",children:"CCCD"}),c.jsx("div",{className:"text-base",children:g.cccd})]}),c.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[c.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Số hộ khẩu"}),c.jsx("div",{className:"text-base font-semibold",children:g.soHoKhau})]}),c.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[c.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Thời gian"}),c.jsx("div",{className:"text-base",children:g.thoiGian})]})]}),c.jsxs("div",{className:"bg-gray-50 p-3 rounded mb-4",children:[c.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Địa chỉ hộ khẩu"}),c.jsx("div",{className:"text-base",children:g.diaChi})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("div",{className:"text-sm font-medium text-gray-600 mb-2",children:"Loại thay đổi"}),c.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${g.loaiThayDoiCode===1?"bg-green-100 text-green-800":g.loaiThayDoiCode===2?"bg-red-100 text-red-800":g.loaiThayDoiCode===3?"bg-blue-100 text-blue-800":g.loaiThayDoiCode===4?"bg-yellow-100 text-yellow-800":g.loaiThayDoiCode===5?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:g.loaiThayDoi})]}),c.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-4",children:[c.jsx("div",{className:"text-sm font-medium text-blue-800 mb-2",children:"Mô tả chi tiết"}),c.jsx("div",{className:"text-sm text-blue-700",children:sj(g)})]}),g.chiTiet&&c.jsxs("div",{className:"bg-gray-50 p-3 rounded mb-4",children:[c.jsx("div",{className:"text-sm font-medium text-gray-600 mb-2",children:"Thông tin gốc từ hệ thống"}),c.jsx("div",{className:"text-sm text-gray-700",children:g.chiTiet})]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors",onClick:()=>p(null),children:"Đóng"}),c.jsx("button",{className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",onClick:()=>{console.log("View related details for:",g)},children:"Xem chi tiết hộ khẩu"})]})]})})]})})};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lj=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),oj=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,a)=>a?a.toUpperCase():n.toLowerCase()),fv=e=>{const t=oj(e);return t.charAt(0).toUpperCase()+t.slice(1)},pb=(...e)=>e.filter((t,n,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===n).join(" ").trim(),cj=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var uj={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hj=j.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:a,className:r="",children:l,iconNode:o,...h},f)=>j.createElement("svg",{ref:f,...uj,width:t,height:t,stroke:e,strokeWidth:a?Number(n)*24/Number(t):n,className:pb("lucide",r),...!l&&!cj(h)&&{"aria-hidden":"true"},...h},[...o.map(([d,g])=>j.createElement(d,g)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=(e,t)=>{const n=j.forwardRef(({className:a,...r},l)=>j.createElement(hj,{ref:l,iconNode:t,className:pb(`lucide-${lj(fv(e))}`,`lucide-${e}`,a),...r}));return n.displayName=fv(e),n};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fj=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],dv=ar("car",fj);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dj=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],Md=ar("house",dj);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xj=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],gj=ar("loader-circle",xj);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mj=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],yb=ar("plus",mj);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pj=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],yj=ar("search",pj);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vj=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],bj=ar("square-pen",vj);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wj=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],_j=ar("trash-2",wj);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tj=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Sj=ar("triangle-alert",Tj);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nj=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],xv=ar("users",Nj);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ej=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],lc=ar("x",Ej),Cj=({isOpen:e,onClose:t,onSubmit:n,vehicleTypes:a,editingVehicle:r})=>{const[l,o]=j.useState([]),[h,f]=j.useState(!1),[d,g]=j.useState({hoKhauId:"",loaiXeId:"",bienSo:"",ngayBatDau:new Date().toISOString().split("T")[0],ngayKetThuc:"",trangThai:"ACTIVE",ghiChu:""});j.useEffect(()=>{e&&(p(),r?g({hoKhauId:r.hoKhauId.toString(),loaiXeId:r.loaiXeId.toString(),bienSo:r.bienSo,ngayBatDau:r.ngayBatDau.split("T")[0],ngayKetThuc:r.ngayKetThuc?r.ngayKetThuc.split("T")[0]:"",trangThai:r.trangThai,ghiChu:r.ghiChu||""}):y())},[e,r]);const p=async()=>{var b;try{f(!0);const T=await Na.getAll({limit:1e3});o(((b=T.data)==null?void 0:b.households)||[])}catch(T){console.error("Error loading households:",T)}finally{f(!1)}},y=()=>{g({hoKhauId:"",loaiXeId:"",bienSo:"",ngayBatDau:new Date().toISOString().split("T")[0],ngayKetThuc:"",trangThai:"ACTIVE",ghiChu:""})},w=b=>{b.preventDefault();const T={hoKhauId:parseInt(d.hoKhauId),loaiXeId:parseInt(d.loaiXeId),bienSo:d.bienSo.toUpperCase(),ngayBatDau:d.ngayBatDau,ngayKetThuc:d.ngayKetThuc||void 0,trangThai:d.trangThai,ghiChu:d.ghiChu};n(T)},_=(b,T)=>{g(S=>({...S,[b]:T}))};return e?c.jsxs("div",{className:"fixed inset-0 z-50",children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25",onClick:t}),c.jsxs("div",{className:"fixed left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg shadow-lg w-full max-w-md max-h-[90vh] overflow-auto",children:[c.jsxs("div",{className:"sticky top-0 bg-white flex items-center justify-between p-5 border-b border-gray-200",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r?"Chỉnh sửa xe":"Thêm xe mới"}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors rounded-full p-1 hover:bg-gray-100",children:c.jsx(lc,{className:"w-5 h-5"})})]}),c.jsxs("form",{onSubmit:w,className:"p-6 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hộ khẩu *"}),c.jsxs("select",{value:d.hoKhauId,onChange:b=>_("hoKhauId",b.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:h,children:[c.jsx("option",{value:"",children:h?"Đang tải...":"Chọn hộ khẩu"}),l.map(b=>{var T;return c.jsxs("option",{value:b.soHoKhau,children:["HK",b.soHoKhau.toString().padStart(3,"0")," - ",(T=b.chuHoInfo)==null?void 0:T.hoTen," - ",b.soNha," ",b.duong]},b.soHoKhau)})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Loại xe *"}),c.jsxs("select",{value:d.loaiXeId,onChange:b=>_("loaiXeId",b.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[c.jsx("option",{value:"",children:"Chọn loại xe"}),a.map(b=>{let T="";return b.ten==="Xe đạp"||b.ten==="Xe máy"?T="70.000 VNĐ/tháng":b.ten==="Ô tô"&&(T="1.200.000 VNĐ/tháng"),c.jsxs("option",{value:b.id,children:[b.ten," - ",T]},b.id)})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Biển số xe *"}),c.jsx("input",{type:"text",value:d.bienSo,onChange:b=>_("bienSo",b.target.value.toUpperCase()),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"VD: 30A-12345",required:!0}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Định dạng: 30A-12345 hoặc HN-1234"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ngày bắt đầu *"}),c.jsx("input",{type:"date",value:d.ngayBatDau,onChange:b=>_("ngayBatDau",b.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ngày kết thúc"}),c.jsx("input",{type:"date",value:d.ngayKetThuc,onChange:b=>_("ngayKetThuc",b.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:d.ngayBatDau}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Để trống nếu không có ngày kết thúc"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trạng thái"}),c.jsxs("select",{value:d.trangThai,onChange:b=>_("trangThai",b.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[c.jsx("option",{value:"ACTIVE",children:"Đang hoạt động"}),c.jsx("option",{value:"INACTIVE",children:"Tạm ngưng"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ghi chú"}),c.jsx("textarea",{value:d.ghiChu,onChange:b=>_("ghiChu",b.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"Ghi chú về xe..."})]}),c.jsx("div",{className:"border-t border-gray-200 py-4 mt-6",children:c.jsxs("div",{className:"flex gap-3 justify-end",children:[c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-offset-1 transition-colors",children:"Hủy"}),c.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-1 focus:ring-offset-1 transition-colors",children:r?"Cập nhật":"Lưu"})]})})]})]})]}):null},sh={async getVehicleTypes(){const e=await De("/vehicles/types");return e.data||e},async createVehicleType(e){return(await De("/vehicles/types",{method:"POST",body:JSON.stringify(e)})).data},async updateVehicleType(e,t){return(await De(`/vehicles/types/${e}`,{method:"PUT",body:JSON.stringify(t)})).data},async deleteVehicleType(e){await De(`/vehicles/types/${e}`,{method:"DELETE"})},async getVehicles(e){const t=e?"?"+new URLSearchParams(Object.entries(e).reduce((a,[r,l])=>(l!==void 0&&l!==""&&(a[r]=String(l)),a),{})).toString():"";return(await De(`/vehicles${t}`)).data},async createVehicle(e){return(await De("/vehicles",{method:"POST",body:JSON.stringify(e)})).data},async updateVehicle(e,t){return(await De(`/vehicles/${e}`,{method:"PUT",body:JSON.stringify(t)})).data},async deleteVehicle(e){await De(`/vehicles/${e}`,{method:"DELETE"})},async getVehiclesByHousehold(e){const t=await De(`/vehicles/household/${e}`);return t.data||t},async getVehicleStatistics(){const e=await De("/vehicles/statistics");return e.data||e}},kj=()=>{const[e,t]=j.useState([]),[n,a]=j.useState([]),[r,l]=j.useState(!1),[o,h]=j.useState(""),[f,d]=j.useState(""),[g,p]=j.useState(""),[y,w]=j.useState(""),[_,b]=j.useState(!1),[T,S]=j.useState(null),[E,C]=j.useState(null);j.useEffect(()=>{A()},[]);const A=async()=>{try{l(!0),h("");const I=await sh.getVehicles();t(I.vehicles||[]),a([{id:1,ten:"Xe máy",phiThue:7e4,moTa:"Xe máy các loại"},{id:2,ten:"Ô tô",phiThue:12e5,moTa:"Xe ô tô các loại"},{id:3,ten:"Xe đạp",phiThue:7e4,moTa:"Xe đạp các loại"}])}catch(I){h(I.message||"Không thể tải dữ liệu"),console.error("Error loading data:",I)}finally{l(!1)}},F=e.filter(I=>{var re,ee,Q;const te=I.bienSo.toLowerCase().includes(f.toLowerCase())||((Q=(ee=(re=I.hoKhau)==null?void 0:re.chuHoInfo)==null?void 0:ee.hoTen)==null?void 0:Q.toLowerCase().includes(f.toLowerCase()))||"",q=!g||I.trangThai===g||g==="ACTIVE"&&I.trangThai==="Hoạt động"||g==="INACTIVE"&&I.trangThai==="Ngừng sử dụng",ae=!y||I.loaiXeId.toString()===y;return te&&q&&ae}),K=()=>{S(null),b(!0)},D=I=>{S(I),b(!0)},H=async I=>{try{l(!0);const te=parseInt(I.loaiXeId),q={...I,loaiXeId:te};T?await sh.updateVehicle(T.id,q):await sh.createVehicle(q),b(!1),S(null),await A()}catch(te){h(te.message||"Có lỗi xảy ra khi lưu thông tin xe")}finally{l(!1)}},M=async I=>{try{l(!0),await sh.deleteVehicle(I.id),C(null),await A()}catch(te){h(te.message||"Không thể xóa xe")}finally{l(!1)}},B=I=>I==="ACTIVE"||I==="Hoạt động"?c.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:"Đang sử dụng"}):c.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:"Ngừng sử dụng"});return c.jsx(On,{role:"totruong",children:c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"mb-6",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[c.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:c.jsx(dv,{className:"h-6 w-6 text-blue-600"})}),c.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Quản lý xe"})]}),c.jsx("p",{className:"text-gray-600 text-sm",children:"Quản lý thông tin xe và phí gửi xe trong chung cư"})]}),o&&c.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),c.jsx("div",{className:"ml-3",children:c.jsx("p",{className:"text-sm",children:o})})]})}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 mb-6",children:c.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-end",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tìm kiếm"}),c.jsxs("div",{className:"relative",children:[c.jsx(yj,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),c.jsx("input",{type:"text",placeholder:"Tìm kiếm theo biển số hoặc tên chủ xe...",className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:f,onChange:I=>d(I.target.value)})]})]}),c.jsxs("div",{className:"w-full lg:w-48",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trạng thái"}),c.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:g,onChange:I=>p(I.target.value),children:[c.jsx("option",{value:"",children:"Tất cả trạng thái"}),c.jsx("option",{value:"ACTIVE",children:"Đang sử dụng"}),c.jsx("option",{value:"INACTIVE",children:"Ngừng sử dụng"})]})]}),c.jsxs("div",{className:"w-full lg:w-48",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Loại xe"}),c.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:y,onChange:I=>w(I.target.value),children:[c.jsx("option",{value:"",children:"Tất cả loại xe"}),n.map(I=>c.jsx("option",{value:I.id.toString(),children:I.ten},I.id))]})]}),c.jsx("div",{className:"w-full lg:w-auto",children:c.jsxs("button",{onClick:K,className:"w-full lg:w-auto flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",disabled:r,children:[c.jsx(yb,{className:"h-5 w-5 mr-2"}),"Thêm xe mới"]})})]})}),c.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[c.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:c.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Danh sách xe (",F.length,")"]})}),r?c.jsxs("div",{className:"p-8 text-center",children:[c.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),c.jsx("p",{className:"mt-2 text-gray-500",children:"Đang tải dữ liệu..."})]}):F.length===0?c.jsxs("div",{className:"p-8 text-center text-gray-500",children:[c.jsx(dv,{className:"h-12 w-12 mx-auto text-gray-300 mb-4"}),c.jsx("p",{children:"Không tìm thấy xe nào"})]}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Biển số"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Loại xe"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Chủ xe"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phí thuê/tháng"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trạng thái"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ngày bắt đầu"}),c.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thao tác"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:F.map(I=>{var te,q,ae,re,ee,Q,pe,ye,Y,de;return c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:"text-sm font-medium text-gray-900",children:I.bienSo})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:"text-sm text-gray-900",children:((te=I.loaiXe)==null?void 0:te.ten)||"-"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"text-sm text-gray-900",children:[c.jsx("div",{className:"font-medium",children:((ae=(q=I.hoKhau)==null?void 0:q.chuHoInfo)==null?void 0:ae.hoTen)||"-"}),c.jsxs("div",{className:"text-xs text-gray-500",children:["HK",(ee=(re=I.hoKhau)==null?void 0:re.soHoKhau)==null?void 0:ee.toString().padStart(3,"0")," - ",(Q=I.hoKhau)==null?void 0:Q.soNha," ",(pe=I.hoKhau)==null?void 0:pe.duong]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:"text-sm text-gray-900",children:((ye=I.loaiXe)==null?void 0:ye.ten)==="Ô tô"?"1.200.000 VNĐ":((Y=I.loaiXe)==null?void 0:Y.ten)==="Xe máy"||((de=I.loaiXe)==null?void 0:de.ten)==="Xe đạp"?"70.000 VNĐ":"-"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:B(I.trangThai)}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:"text-sm text-gray-900",children:I.ngayBatDau?new Date(I.ngayBatDau).toLocaleDateString("vi-VN"):"-"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx("button",{onClick:()=>D(I),className:"text-blue-600 hover:text-blue-900 p-1 rounded",title:"Chỉnh sửa",children:c.jsx(bj,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>C(I),className:"text-red-600 hover:text-red-900 p-1 rounded",title:"Xóa",children:c.jsx(_j,{className:"h-4 w-4"})})]})})]},I.id)})})]})})]}),c.jsx(Cj,{isOpen:_,onClose:()=>{b(!1),S(null)},onSubmit:H,editingVehicle:T,vehicleTypes:n}),E&&c.jsxs("div",{className:"fixed inset-0 z-50",children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25",onClick:()=>C(null)}),c.jsxs("div",{className:"fixed left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg shadow-lg max-w-md w-full",children:[c.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-gray-200",children:[c.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center gap-2",children:[c.jsx("svg",{className:"h-5 w-5 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 15.5c-.77.833.192 2.5 1.732 2.5z"})}),"Xác nhận xóa xe"]}),c.jsx("button",{onClick:()=>C(null),className:"text-gray-400 hover:text-gray-600 transition-colors rounded-full p-1 hover:bg-gray-100",children:c.jsx(lc,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>C(null),className:"text-gray-400 hover:text-gray-600 transition-colors rounded-full p-1 hover:bg-gray-100",children:c.jsx(lc,{className:"w-5 h-5"})})]}),c.jsxs("div",{className:"p-6",children:[c.jsx("div",{className:"mb-4",children:c.jsxs("p",{className:"text-sm text-gray-700",children:["Bạn có chắc chắn muốn xóa xe ",c.jsx("strong",{children:E.bienSo})," không? Hành động này không thể hoàn tác."]})}),c.jsx("div",{className:"border-t border-gray-200 py-4 mt-6",children:c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{onClick:()=>C(null),className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50",children:"Hủy"}),c.jsx("button",{onClick:()=>M(E),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700",disabled:r,children:r?"Đang xóa...":"Xóa"})]})})]})]})]})]})})},jj=({isOpen:e,onClose:t,onSave:n,editData:a})=>{const[r,l]=j.useState({soPhong:"",tang:"",dienTich:0,trangThai:"trong",hoThue:"",ngayBatDau:"",ghiChu:""});j.useEffect(()=>{l(a?{...a}:{soPhong:"",tang:"",dienTich:0,trangThai:"trong",hoThue:"",ngayBatDau:"",ghiChu:""})},[a,e]);const o=f=>{const{name:d,value:g}=f.target;l(d==="dienTich"?{...r,[d]:parseFloat(g)||0}:{...r,[d]:g})},h=f=>{f.preventDefault(),n(r)};return e?c.jsxs("div",{className:"fixed inset-0 z-50",children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25",onClick:t}),c.jsxs("div",{className:"fixed left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg shadow-lg w-full max-w-md max-h-[90vh] overflow-auto",children:[c.jsxs("div",{className:"sticky top-0 bg-white flex items-center justify-between p-5 border-b border-gray-200",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:a?"Chỉnh sửa phòng":"Thêm phòng mới"}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors rounded-full p-1 hover:bg-gray-100",children:c.jsx(lc,{className:"w-5 h-5"})})]}),c.jsxs("form",{onSubmit:h,className:"p-6 space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Số phòng ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",name:"soPhong",value:r.soPhong,onChange:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"VD: 101",required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tầng ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",name:"tang",value:r.tang,onChange:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"VD: 1",required:!0})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Diện tích (m²) ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"number",name:"dienTich",value:r.dienTich,onChange:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"VD: 30",required:!0,min:"0",step:"0.01"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trạng thái"}),c.jsxs("select",{name:"trangThai",value:r.trangThai,onChange:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[c.jsx("option",{value:"trong",children:"Trống"}),c.jsx("option",{value:"da_thue",children:"Đã thuê"}),c.jsx("option",{value:"bao_tri",children:"Bảo trì"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi chú"}),c.jsx("textarea",{name:"ghiChu",value:r.ghiChu||"",onChange:o,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nhập ghi chú về phòng...",rows:3})]}),c.jsx("div",{className:"border-t border-gray-200 py-4 mt-6",children:c.jsxs("div",{className:"flex gap-3 justify-end",children:[c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-offset-1 transition-colors",children:"Hủy"}),c.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-1 focus:ring-offset-1 transition-colors",children:a?"Cập nhật":"Thêm mới"})]})})]})]})]}):null},Aj=({isOpen:e,onClose:t,onSave:n,availableRooms:a,households:r=[]})=>{const[l,o]=j.useState({id:"",tenChuHo:"",nguoiThue:"",soHoKhau:"",soPhong:"",ngayBatDau:new Date().toISOString().split("T")[0],sdt:""});j.useEffect(()=>{e&&o({id:"",tenChuHo:"",nguoiThue:"",soHoKhau:"",soPhong:"",ngayBatDau:new Date().toISOString().split("T")[0],sdt:""})},[e]);const h=g=>{var w;const{name:p,value:y}=g.target;if(p==="soHoKhau"){const _=r.find(b=>b.soHoKhau.toString()===y);_!=null&&_.chuHoInfo?o({...l,[p]:y,tenChuHo:_.chuHoInfo.hoTen||"",sdt:((w=_.chuHoInfo)==null?void 0:w.sdt)||""}):o({...l,[p]:y})}else o({...l,[p]:y})},f=g=>{g.preventDefault(),n(l),t(),d()},d=()=>{o({id:"",tenChuHo:"",nguoiThue:"",soHoKhau:"",soPhong:"",ngayBatDau:new Date().toISOString().split("T")[0],sdt:""})};return e?c.jsxs("div",{className:"fixed inset-0 z-50",children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25",onClick:t}),c.jsxs("div",{className:"fixed left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg shadow-lg w-full max-w-md max-h-[90vh] overflow-auto",children:[c.jsxs("div",{className:"sticky top-0 bg-white flex items-center justify-between p-5 border-b border-gray-200",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Thêm hộ thuê mới"}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors rounded-full p-1 hover:bg-gray-100",children:c.jsx(lc,{className:"w-5 h-5"})})]}),c.jsxs("form",{onSubmit:f,className:"p-6 space-y-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tên chủ hộ ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",name:"tenChuHo",value:l.tenChuHo,onChange:h,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"VD: Nguyễn Văn A",readOnly:!!l.soHoKhau,required:!0}),!!l.soHoKhau&&c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Tự động điền theo hộ khẩu đã chọn"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Người thuê thực tế ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",name:"nguoiThue",value:l.nguoiThue,onChange:h,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"VD: Nguyễn Thị B (có thể khác chủ hộ)",required:!0}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Người thực tế sống trong phòng (có thể khác chủ hộ)"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Hộ khẩu ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsxs("select",{name:"soHoKhau",value:l.soHoKhau,onChange:h,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[c.jsx("option",{value:"",children:"Chọn hộ khẩu"}),r.map(g=>{var p;return c.jsxs("option",{value:g.soHoKhau.toString(),children:[g.soHoKhau," - ",((p=g.chuHoInfo)==null?void 0:p.hoTen)||"Không có chủ hộ"]},g.soHoKhau)})]}),r.length===0&&c.jsx("p",{className:"text-sm text-red-500 mt-1",children:"Không có hộ khẩu nào"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Số điện thoại ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"tel",name:"sdt",value:l.sdt,onChange:h,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"VD: 0912345678",readOnly:!!l.soHoKhau,required:!0,pattern:"[0-9]{10}",title:"Vui lòng nhập số điện thoại 10 số"}),!!l.soHoKhau&&c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Tự động điền theo hộ khẩu đã chọn"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Chọn phòng ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsxs("select",{name:"soPhong",value:l.soPhong,onChange:h,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[c.jsx("option",{value:"",children:"Chọn phòng"}),a.map(g=>c.jsxs("option",{value:g.soPhong,children:["Phòng ",g.soPhong," - Tầng ",g.tang," (",g.dienTich,"m²)"]},g.id))]}),a.length===0&&c.jsx("p",{className:"text-sm text-red-500 mt-1",children:"Không có phòng trống"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Ngày bắt đầu ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"date",name:"ngayBatDau",value:l.ngayBatDau,onChange:h,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsx("div",{className:"border-t border-gray-200 py-4 mt-6",children:c.jsxs("div",{className:"flex gap-3 justify-end",children:[c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-offset-1 transition-colors",children:"Hủy"}),c.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-1 focus:ring-offset-1 transition-colors",disabled:a.length===0,children:"Thêm mới"})]})})]})]})]}):null},Ks={async getRooms(e){const t=e?"?"+new URLSearchParams(Object.entries(e).reduce((a,[r,l])=>(l!==void 0&&l!==""&&(a[r]=String(l)),a),{})).toString():"";return await De(`/rooms${t}`)},async getRoom(e){return await De(`/rooms/${e}`)},async createRoom(e){return(await De("/rooms",{method:"POST",body:JSON.stringify(e)})).room},async updateRoom(e,t){return(await De(`/rooms/${e}`,{method:"PUT",body:JSON.stringify(t)})).room},async deleteRoom(e){await De(`/rooms/${e}`,{method:"DELETE"})},async assignRoom(e,t,n){return(await De(`/rooms/${e}/assign`,{method:"POST",body:JSON.stringify({hoKhauId:t,ngayBatDau:n})})).room},async releaseRoom(e,t){return(await De(`/rooms/${e}/release`,{method:"POST",body:JSON.stringify({ngayKetThuc:t})})).room},async updateTenant(e,t){return(await De(`/rooms/${e}/tenant`,{method:"PUT",body:JSON.stringify({nguoiThue:t})})).room},async getRoomStatistics(){return await De("/rooms/statistics")}},Dj=()=>{const[e,t]=j.useState([]),[n,a]=j.useState([]),[r,l]=j.useState(!1),[o,h]=j.useState(!1),[f,d]=j.useState(null),[g,p]=j.useState(null),[y,w]=j.useState(""),[_,b]=j.useState(""),[T,S]=j.useState(!0),[E,C]=j.useState(null),[A,F]=j.useState(null),[K,D]=j.useState([]),H=async()=>{try{S(!0);const V=(await Ks.getRooms()).rooms.map(Te=>{var ie,we;return{...Te,hoThue:((we=(ie=Te.hoKhau)==null?void 0:ie.chuHoInfo)==null?void 0:we.hoTen)||void 0,nguoiThue:Te.nguoiThue||void 0}});t(V);const U=await Ks.getRoomStatistics();F(U),C(null)}catch(k){console.error("Error fetching room data:",k),C("Có lỗi xảy ra khi tải dữ liệu phòng. Vui lòng thử lại sau.")}finally{S(!1)}},M=async()=>{try{const k=await Na.getAll();if(k.data){D(k.data.households||[]);const V=[];k.data.households.forEach(U=>{var Te,ie,we;U.roomInfo&&V.push({id:U.soHoKhau.toString(),tenChuHo:((Te=U.chuHoInfo)==null?void 0:Te.hoTen)||"Unknown",nguoiThue:((ie=U.chuHoInfo)==null?void 0:ie.hoTen)||"Unknown",soHoKhau:U.soHoKhau.toString(),soPhong:U.roomInfo.soPhong,ngayBatDau:U.roomInfo.ngayBatDau||"",sdt:((we=U.chuHoInfo)==null?void 0:we.soDienThoai)||""})}),a(V)}}catch(k){console.error("Error fetching households:",k)}};j.useEffect(()=>{H(),M()},[]);const B=(k=null)=>{d(k),l(!0)},I=()=>{d(null),l(!1)},te=async k=>{try{S(!0),f&&f.id?await Ks.updateRoom(f.id,k):await Ks.createRoom(k),await H(),I()}catch(V){console.error("Error saving room:",V),C("Có lỗi xảy ra khi lưu thông tin phòng. Vui lòng thử lại sau.")}finally{S(!1)}},q=()=>{h(!0)},ae=()=>{h(!1)},re=async k=>{try{S(!0);const V=e.find(U=>U.soPhong===k.soPhong);if(!V)throw new Error("Không tìm thấy phòng");await Ks.assignRoom(V.id,Number(k.soHoKhau),k.ngayBatDau),k.nguoiThue&&await Ks.updateTenant(V.id,k.nguoiThue),await H(),await M(),ae()}catch(V){console.error("Error assigning room to tenant:",V),C("Có lỗi xảy ra khi cập nhật thông tin người thuê. Vui lòng thử lại sau.")}finally{S(!1)}},ee=async()=>{if(g)try{S(!0),await Ks.deleteRoom(g.id),await H(),p(null)}catch(k){console.error("Error deleting room:",k),C("Có lỗi xảy ra khi xóa phòng. Vui lòng thử lại sau.")}finally{S(!1)}},Q=()=>{p(null)},pe=(A==null?void 0:A.rentedRooms)||e.filter(k=>k.hoKhauId).length,ye=(A==null?void 0:A.availableRooms)||e.filter(k=>k.trangThai==="trong").length,Y=(A==null?void 0:A.maintenanceRooms)||e.filter(k=>k.trangThai==="bao_tri").length,de=(A==null?void 0:A.totalRooms)||e.length,P=[...new Set(e.map(k=>k.tang))].sort(),Z=e.filter(k=>{const V=k.soPhong.toLowerCase().includes(y.toLowerCase())||(k.hoThue||"").toLowerCase().includes(y.toLowerCase()),U=!_||k.tang===_;return V&&U});return c.jsxs(On,{role:"totruong",children:[c.jsxs("div",{className:"p-4 flex flex-col gap-6",children:[c.jsxs("div",{className:"mb-4",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[c.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:c.jsx(Md,{className:"h-6 w-6 text-blue-600"})}),c.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"QUẢN LÝ PHÒNG"})]}),c.jsx("p",{className:"text-gray-600 text-sm",children:"Quản lý thông tin phòng và người thuê trong chung cư"})]}),T&&c.jsxs("div",{className:"flex justify-center items-center py-8",children:[c.jsx(gj,{className:"h-8 w-8 animate-spin text-blue-600"}),c.jsx("span",{className:"ml-2 text-gray-600",children:"Đang tải dữ liệu..."})]}),E&&c.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg",children:c.jsx("p",{children:E})}),!T&&!E&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 mb-2",children:c.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-end",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tìm kiếm"}),c.jsx("input",{type:"text",placeholder:"Tìm theo số phòng hoặc tên người thuê...",value:y,onChange:k=>w(k.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{className:"w-full lg:w-48",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tầng"}),c.jsxs("select",{value:_,onChange:k=>b(k.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Tất cả các tầng"}),P.map(k=>c.jsxs("option",{value:k,children:["Tầng ",k]},k))]})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsxs("button",{onClick:()=>B(),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:[c.jsx(yb,{className:"h-5 w-5"}),"Thêm phòng mới"]}),c.jsxs("button",{onClick:()=>q(),className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors",disabled:ye===0,children:[c.jsx(xv,{className:"h-5 w-5"}),"Thêm hộ thuê"]})]})]})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-gray-500 text-sm",children:"Tổng số phòng"}),c.jsx("div",{className:"text-2xl font-semibold",children:de})]}),c.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:c.jsx(Md,{className:"h-6 w-6 text-blue-600"})})]})}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-gray-500 text-sm",children:"Phòng đã thuê"}),c.jsx("div",{className:"text-2xl font-semibold",children:pe})]}),c.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:c.jsx(xv,{className:"h-6 w-6 text-green-600"})})]})}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-gray-500 text-sm",children:"Phòng trống"}),c.jsx("div",{className:"text-2xl font-semibold",children:ye})]}),c.jsx("div",{className:"p-3 bg-orange-100 rounded-full",children:c.jsx(Md,{className:"h-6 w-6 text-orange-600"})})]})}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-gray-500 text-sm",children:"Phòng bảo trì"}),c.jsx("div",{className:"text-2xl font-semibold",children:Y})]}),c.jsx("div",{className:"p-3 bg-red-100 rounded-full",children:c.jsx(Sj,{className:"h-6 w-6 text-red-600"})})]})})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[c.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:c.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Danh sách phòng (",Z.length,")"]})}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Số phòng"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tầng"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Diện tích (m²)"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trạng thái"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ghi chú"}),c.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thao tác"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Z.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:7,className:"px-4 py-4 text-center text-gray-500",children:"Không tìm thấy phòng nào"})}):Z.map(k=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:k.soPhong}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:k.tang}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:k.dienTich}),c.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:[k.trangThai==="da_thue"&&c.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Đã thuê"}),k.trangThai==="trong"&&c.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Trống"}),k.trangThai==="bao_tri"&&c.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Bảo trì"})]}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:k.ghiChu||"-"}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:c.jsxs("div",{className:"flex justify-center gap-3",children:[c.jsx("button",{onClick:()=>B(k),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-50 transition-colors",title:"Sửa",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),c.jsx("button",{onClick:()=>p(k),className:"text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-50 transition-colors",disabled:!!k.hoKhauId,title:"Xóa",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},k.id))})]})})]})]})]}),c.jsx(jj,{isOpen:r,onClose:I,onSave:te,editData:f,tenants:n}),c.jsx(Aj,{isOpen:o,onClose:ae,onSave:re,availableRooms:e.filter(k=>!k.hoKhauId),households:K}),g&&c.jsxs("div",{className:"fixed inset-0 z-50",children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25",onClick:Q}),c.jsx("div",{className:"fixed left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg shadow-lg max-w-md w-full",children:c.jsxs("div",{className:"p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Xác nhận xóa phòng"}),c.jsxs("p",{className:"text-sm text-gray-600 mb-6",children:["Bạn có chắc chắn muốn xóa phòng ",c.jsx("strong",{children:g.soPhong}),"?",c.jsx("br",{}),g.hoKhauId&&"Hộ thuê sẽ bị gỡ liên kết khỏi phòng này."]}),c.jsxs("div",{className:"flex justify-end gap-3",children:[c.jsx("button",{onClick:Q,className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50",children:"Hủy"}),c.jsx("button",{onClick:ee,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700",children:"Xóa"})]})]})})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var jh={};jh.version="0.18.5";var vb=1252,Oj=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],bb=function(e){Oj.indexOf(e)!=-1&&(vb=e)};function Mj(){bb(1252)}var oc=function(e){bb(e)};function Rj(){oc(1200),Mj()}var ih=function(t){return String.fromCharCode(t)},gv=function(t){return String.fromCharCode(t)},mv,fs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function cc(e){for(var t="",n=0,a=0,r=0,l=0,o=0,h=0,f=0,d=0;d<e.length;)n=e.charCodeAt(d++),l=n>>2,a=e.charCodeAt(d++),o=(n&3)<<4|a>>4,r=e.charCodeAt(d++),h=(a&15)<<2|r>>6,f=r&63,isNaN(a)?h=f=64:isNaN(r)&&(f=64),t+=fs.charAt(l)+fs.charAt(o)+fs.charAt(h)+fs.charAt(f);return t}function Or(e){var t="",n=0,a=0,r=0,l=0,o=0,h=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)l=fs.indexOf(e.charAt(d++)),o=fs.indexOf(e.charAt(d++)),n=l<<2|o>>4,t+=String.fromCharCode(n),h=fs.indexOf(e.charAt(d++)),a=(o&15)<<4|h>>2,h!==64&&(t+=String.fromCharCode(a)),f=fs.indexOf(e.charAt(d++)),r=(h&3)<<6|f,f!==64&&(t+=String.fromCharCode(r));return t}var ht=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Fr=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,n){return n?new Buffer(t,n):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ni(e){return ht?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function pv(e){return ht?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Fa=function(t){return ht?Fr(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)&255})};function Zh(e){if(typeof ArrayBuffer>"u")return Fa(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),a=0;a!=e.length;++a)n[a]=e.charCodeAt(a)&255;return t}function vc(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function Fj(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var _n=ht?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Fr(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var a=new Uint8Array(n),r=0;for(t=0,n=0;t<e.length;n+=r,++t)if(r=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],n);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),n)}return a}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function Lj(e){for(var t=[],n=0,a=e.length+250,r=ni(e.length+255),l=0;l<e.length;++l){var o=e.charCodeAt(l);if(o<128)r[n++]=o;else if(o<2048)r[n++]=192|o>>6&31,r[n++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var h=e.charCodeAt(++l)&1023;r[n++]=240|o>>8&7,r[n++]=128|o>>2&63,r[n++]=128|h>>6&15|(o&3)<<4,r[n++]=128|h&63}else r[n++]=224|o>>12&15,r[n++]=128|o>>6&63,r[n++]=128|o&63;n>a&&(t.push(r.slice(0,n)),n=0,r=ni(65535),a=65530)}return t.push(r.slice(0,n)),_n(t)}var Ko=/\u0000/g,lh=/[\u0001-\u0006]/g;function sl(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function La(e,t){var n=""+e;return n.length>=t?n:It("0",t-n.length)+n}function Mx(e,t){var n=""+e;return n.length>=t?n:It(" ",t-n.length)+n}function Ah(e,t){var n=""+e;return n.length>=t?n:n+It(" ",t-n.length)}function Bj(e,t){var n=""+Math.round(e);return n.length>=t?n:It("0",t-n.length)+n}function Hj(e,t){var n=""+e;return n.length>=t?n:It("0",t-n.length)+n}var yv=Math.pow(2,32);function qi(e,t){if(e>yv||e<-yv)return Bj(e,t);var n=Math.round(e);return Hj(n,t)}function Dh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var vv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Rd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Pj(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Kt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},bv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Ij={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Oh(e,t,n){for(var a=e<0?-1:1,r=e*a,l=0,o=1,h=0,f=1,d=0,g=0,p=Math.floor(r);d<t&&(p=Math.floor(r),h=p*o+l,g=p*d+f,!(r-p<5e-8));)r=1/(r-p),l=o,o=h,f=d,d=g;if(g>t&&(d>t?(g=f,h=l):(g=d,h=o)),!n)return[0,a*h,g];var y=Math.floor(a*h/g);return[y,a*h-y*g,g]}function oh(e,t,n){if(e>2958465||e<0)return null;var a=e|0,r=Math.floor(86400*(e-a)),l=0,o=[],h={D:a,T:r,u:86400*(e-a)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(h.u)<1e-6&&(h.u=0),t&&t.date1904&&(a+=1462),h.u>.9999&&(h.u=0,++r==86400&&(h.T=r=0,++a,++h.D)),a===60)o=n?[1317,10,29]:[1900,2,29],l=3;else if(a===0)o=n?[1317,8,29]:[1900,1,0],l=6;else{a>60&&--a;var f=new Date(1900,0,1);f.setDate(f.getDate()+a-1),o=[f.getFullYear(),f.getMonth()+1,f.getDate()],l=f.getDay(),a<60&&(l=(l+6)%7),n&&(l=Xj(f,o))}return h.y=o[0],h.m=o[1],h.d=o[2],h.S=r%60,r=Math.floor(r/60),h.M=r%60,r=Math.floor(r/60),h.H=r,h.q=l,h}var wb=new Date(1899,11,31,0,0,0),zj=wb.getTime(),Uj=new Date(1900,2,1,0,0,0);function _b(e,t){var n=e.getTime();return t?n-=1461*24*60*60*1e3:e>=Uj&&(n+=24*60*60*1e3),(n-(zj+(e.getTimezoneOffset()-wb.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Rx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Vj(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Kj(e){var t=e<0?12:11,n=Rx(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10),n.length<=t)?n:e.toExponential(5)}function Wj(e){var t=Rx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Gj(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n;return t>=-4&&t<=-1?n=e.toPrecision(10+t):Math.abs(t)<=9?n=Kj(e):t===10?n=e.toFixed(10).substr(0,12):n=Wj(e),Rx(Vj(n.toUpperCase()))}function tx(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Gj(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ms(14,_b(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Xj(e,t){t[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}function Yj(e,t,n,a){var r="",l=0,o=0,h=n.y,f,d=0;switch(e){case 98:h=n.y+543;case 121:switch(t.length){case 1:case 2:f=h%100,d=2;break;default:f=h%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:f=n.m,d=t.length;break;case 3:return Rd[n.m-1][1];case 5:return Rd[n.m-1][0];default:return Rd[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:f=n.d,d=t.length;break;case 3:return vv[n.q][0];default:return vv[n.q][1]}break;case 104:switch(t.length){case 1:case 2:f=1+(n.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:f=n.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:f=n.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return n.u===0&&(t=="s"||t=="ss")?La(n.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,l=Math.round(o*(n.S+n.u)),l>=60*o&&(l=0),t==="s"?l===0?"0":""+l/o:(r=La(l,2+a),t==="ss"?r.substr(0,2):"."+r.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":f=n.D*24+n.H;break;case"[m]":case"[mm]":f=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":f=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:f=h,d=1;break}var g=d>0?La(f,d):"";return g}function ds(e){var t=3;if(e.length<=t)return e;for(var n=e.length%t,a=e.substr(0,n);n!=e.length;n+=t)a+=(a.length>0?",":"")+e.substr(n,t);return a}var Tb=/%/g;function qj(e,t,n){var a=t.replace(Tb,""),r=t.length-a.length;return kr(e,a,n*Math.pow(10,2*r))+It("%",r)}function $j(e,t,n){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return kr(e,t.substr(0,a),n/Math.pow(10,3*(t.length-a)))}function Sb(e,t){var n,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Sb(e,-t);var r=e.indexOf(".");r===-1&&(r=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%r;if(l<0&&(l+=r),n=(t/Math.pow(10,l)).toPrecision(a+1+(r+l)%r),n.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+l):n+="E+"+(o-l);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,r)+"."+n.substr(2+r),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,f,d,g){return f+d+g.substr(0,(r+l)%r)+"."+g.substr(l)+"E"})}else n=t.toExponential(a);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var Nb=/# (\?+)( ?)\/( ?)(\d+)/;function Qj(e,t,n){var a=parseInt(e[4],10),r=Math.round(t*a),l=Math.floor(r/a),o=r-l*a,h=a;return n+(l===0?"":""+l)+" "+(o===0?It(" ",e[1].length+1+e[4].length):Mx(o,e[1].length)+e[2]+"/"+e[3]+La(h,e[4].length))}function Zj(e,t,n){return n+(t===0?"":""+t)+It(" ",e[1].length+2+e[4].length)}var Eb=/^#*0*\.([0#]+)/,Cb=/\).*[0#]/,kb=/\(###\) ###\\?-####/;function Bn(e){for(var t="",n,a=0;a!=e.length;++a)switch(n=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(n)}return t}function wv(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function _v(e,t){var n=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(n*a)).length?0:Math.round(n*a)}function Jj(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function eA(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function _a(e,t,n){if(e.charCodeAt(0)===40&&!t.match(Cb)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?_a("n",a,n):"("+_a("n",a,-n)+")"}if(t.charCodeAt(t.length-1)===44)return $j(e,t,n);if(t.indexOf("%")!==-1)return qj(e,t,n);if(t.indexOf("E")!==-1)return Sb(t,n);if(t.charCodeAt(0)===36)return"$"+_a(e,t.substr(t.charAt(1)==" "?2:1),n);var r,l,o,h,f=Math.abs(n),d=n<0?"-":"";if(t.match(/^00+$/))return d+qi(f,t.length);if(t.match(/^[#?]+$/))return r=qi(n,0),r==="0"&&(r=""),r.length>t.length?r:Bn(t.substr(0,t.length-r.length))+r;if(l=t.match(Nb))return Qj(l,f,d);if(t.match(/^#+0+$/))return d+qi(f,t.length-t.indexOf("0"));if(l=t.match(Eb))return r=wv(n,l[1].length).replace(/^([^\.]+)$/,"$1."+Bn(l[1])).replace(/\.$/,"."+Bn(l[1])).replace(/\.(\d*)$/,function(_,b){return"."+b+It("0",Bn(l[1]).length-b.length)}),t.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return d+wv(f,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return d+ds(qi(f,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+_a(e,t,-n):ds(""+(Math.floor(n)+Jj(n,l[1].length)))+"."+La(_v(n,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return _a(e,t.replace(/^#,#*,/,""),n);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=sl(_a(e,t.replace(/[\\-]/g,""),n)),o=0,sl(sl(t.replace(/\\/g,"")).replace(/[0#]/g,function(_){return o<r.length?r.charAt(o++):_==="0"?"0":""}));if(t.match(kb))return r=_a(e,"##########",n),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var g="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),h=Oh(f,Math.pow(10,o)-1,!1),r=""+d,g=kr("n",l[1],h[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),r+=g+l[2]+"/"+l[3],g=Ah(h[2],o),g.length<l[4].length&&(g=Bn(l[4].substr(l[4].length-g.length))+g),r+=g,r;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),h=Oh(f,Math.pow(10,o)-1,!0),d+(h[0]||(h[1]?"":"0"))+" "+(h[1]?Mx(h[1],o)+l[2]+"/"+l[3]+Ah(h[2],o):It(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return r=qi(n,0),t.length<=r.length?r:Bn(t.substr(0,t.length-r.length))+r;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){r=""+n.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=r.indexOf(".");var p=t.indexOf(".")-o,y=t.length-r.length-p;return Bn(t.substr(0,p)+r+t.substr(t.length-y))}if(l=t.match(/^00,000\.([#0]*0)$/))return o=_v(n,l[1].length),n<0?"-"+_a(e,t,-n):ds(eA(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?La(0,3-_.length):"")+_})+"."+La(o,l[1].length);switch(t){case"###,##0.00":return _a(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var w=ds(qi(f,0));return w!=="0"?d+w:"";case"###,###.00":return _a(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return _a(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function tA(e,t,n){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return kr(e,t.substr(0,a),n/Math.pow(10,3*(t.length-a)))}function nA(e,t,n){var a=t.replace(Tb,""),r=t.length-a.length;return kr(e,a,n*Math.pow(10,2*r))+It("%",r)}function jb(e,t){var n,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+jb(e,-t);var r=e.indexOf(".");r===-1&&(r=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%r;if(l<0&&(l+=r),n=(t/Math.pow(10,l)).toPrecision(a+1+(r+l)%r),!n.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+l):n+="E+"+(o-l),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,f,d,g){return f+d+g.substr(0,(r+l)%r)+"."+g.substr(l)+"E"})}else n=t.toExponential(a);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function $a(e,t,n){if(e.charCodeAt(0)===40&&!t.match(Cb)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?$a("n",a,n):"("+$a("n",a,-n)+")"}if(t.charCodeAt(t.length-1)===44)return tA(e,t,n);if(t.indexOf("%")!==-1)return nA(e,t,n);if(t.indexOf("E")!==-1)return jb(t,n);if(t.charCodeAt(0)===36)return"$"+$a(e,t.substr(t.charAt(1)==" "?2:1),n);var r,l,o,h,f=Math.abs(n),d=n<0?"-":"";if(t.match(/^00+$/))return d+La(f,t.length);if(t.match(/^[#?]+$/))return r=""+n,n===0&&(r=""),r.length>t.length?r:Bn(t.substr(0,t.length-r.length))+r;if(l=t.match(Nb))return Zj(l,f,d);if(t.match(/^#+0+$/))return d+La(f,t.length-t.indexOf("0"));if(l=t.match(Eb))return r=(""+n).replace(/^([^\.]+)$/,"$1."+Bn(l[1])).replace(/\.$/,"."+Bn(l[1])),r=r.replace(/\.(\d*)$/,function(_,b){return"."+b+It("0",Bn(l[1]).length-b.length)}),t.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return d+ds(""+f);if(l=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+$a(e,t,-n):ds(""+n)+"."+It("0",l[1].length);if(l=t.match(/^#,#*,#0/))return $a(e,t.replace(/^#,#*,/,""),n);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=sl($a(e,t.replace(/[\\-]/g,""),n)),o=0,sl(sl(t.replace(/\\/g,"")).replace(/[0#]/g,function(_){return o<r.length?r.charAt(o++):_==="0"?"0":""}));if(t.match(kb))return r=$a(e,"##########",n),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var g="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),h=Oh(f,Math.pow(10,o)-1,!1),r=""+d,g=kr("n",l[1],h[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),r+=g+l[2]+"/"+l[3],g=Ah(h[2],o),g.length<l[4].length&&(g=Bn(l[4].substr(l[4].length-g.length))+g),r+=g,r;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),h=Oh(f,Math.pow(10,o)-1,!0),d+(h[0]||(h[1]?"":"0"))+" "+(h[1]?Mx(h[1],o)+l[2]+"/"+l[3]+Ah(h[2],o):It(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return r=""+n,t.length<=r.length?r:Bn(t.substr(0,t.length-r.length))+r;if(l=t.match(/^([#0]+)\.([#0]+)$/)){r=""+n.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=r.indexOf(".");var p=t.indexOf(".")-o,y=t.length-r.length-p;return Bn(t.substr(0,p)+r+t.substr(t.length-y))}if(l=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+$a(e,t,-n):ds(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?La(0,3-_.length):"")+_})+"."+La(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var w=ds(""+f);return w!=="0"?d+w:"";default:if(t.match(/\.[0#?]*$/))return $a(e,t.slice(0,t.lastIndexOf(".")),n)+Bn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function kr(e,t,n){return(n|0)===n?$a(e,t,n):_a(e,t,n)}function aA(e){for(var t=[],n=!1,a=0,r=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:n=!n;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(r,a-r),r=a+1}if(t[t.length]=e.substr(r),n===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Ab=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Db(e){for(var t=0,n="",a="";t<e.length;)switch(n=e.charAt(t)){case"G":Dh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(a=n;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(Ab))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||n=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function rA(e,t,n,a){for(var r=[],l="",o=0,h="",f="t",d,g,p,y="H";o<e.length;)switch(h=e.charAt(o)){case"G":if(!Dh(e,o))throw new Error("unrecognized character "+h+" in "+e);r[r.length]={t:"G",v:"General"},o+=7;break;case'"':for(l="";(p=e.charCodeAt(++o))!==34&&o<e.length;)l+=String.fromCharCode(p);r[r.length]={t:"t",v:l},++o;break;case"\\":var w=e.charAt(++o),_=w==="("||w===")"?w:"t";r[r.length]={t:_,v:w},++o;break;case"_":r[r.length]={t:"t",v:" "},o+=2;break;case"@":r[r.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=oh(t,n,e.charAt(o+1)==="2"),d==null))return"";r[r.length]={t:"X",v:e.substr(o,2)},f=h,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":h=h.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=oh(t,n),d==null))return"";for(l=h;++o<e.length&&e.charAt(o).toLowerCase()===h;)l+=h;h==="m"&&f.toLowerCase()==="h"&&(h="M"),h==="h"&&(h=y),r[r.length]={t:h,v:l},f=h;break;case"A":case"a":case"上":var b={t:h,v:h};if(d==null&&(d=oh(t,n)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(b.v=d.H>=12?"P":"A"),b.t="T",y="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(b.v=d.H>=12?"PM":"AM"),b.t="T",o+=5,y="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(d!=null&&(b.v=d.H>=12?"下午":"上午"),b.t="T",o+=5,y="h"):(b.t="t",++o),d==null&&b.t==="T")return"";r[r.length]=b,f=h;break;case"[":for(l=h;e.charAt(o++)!=="]"&&o<e.length;)l+=e.charAt(o);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(Ab)){if(d==null&&(d=oh(t,n),d==null))return"";r[r.length]={t:"Z",v:l.toLowerCase()},f=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Db(e)||(r[r.length]={t:"t",v:l}));break;case".":if(d!=null){for(l=h;++o<e.length&&(h=e.charAt(o))==="0";)l+=h;r[r.length]={t:"s",v:l};break}case"0":case"#":for(l=h;++o<e.length&&"0#?.,E+-%".indexOf(h=e.charAt(o))>-1;)l+=h;r[r.length]={t:"n",v:l};break;case"?":for(l=h;e.charAt(++o)===h;)l+=h;r[r.length]={t:h,v:l},f=h;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":r[r.length]={t:a===1?"t":h,v:h},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=h;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)l+=e.charAt(o);r[r.length]={t:"D",v:l};break;case" ":r[r.length]={t:h,v:h},++o;break;case"$":r[r.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(h)===-1)throw new Error("unrecognized character "+h+" in "+e);r[r.length]={t:"t",v:h},++o;break}var T=0,S=0,E;for(o=r.length-1,f="t";o>=0;--o)switch(r[o].t){case"h":case"H":r[o].t=y,f="h",T<1&&(T=1);break;case"s":(E=r[o].v.match(/\.0+$/))&&(S=Math.max(S,E[0].length-1)),T<3&&(T=3);case"d":case"y":case"M":case"e":f=r[o].t;break;case"m":f==="s"&&(r[o].t="M",T<2&&(T=2));break;case"X":break;case"Z":T<1&&r[o].v.match(/[Hh]/)&&(T=1),T<2&&r[o].v.match(/[Mm]/)&&(T=2),T<3&&r[o].v.match(/[Ss]/)&&(T=3)}switch(T){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var C="",A;for(o=0;o<r.length;++o)switch(r[o].t){case"t":case"T":case" ":case"D":break;case"X":r[o].v="",r[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":r[o].v=Yj(r[o].t.charCodeAt(0),r[o].v,d,S),r[o].t="t";break;case"n":case"?":for(A=o+1;r[A]!=null&&((h=r[A].t)==="?"||h==="D"||(h===" "||h==="t")&&r[A+1]!=null&&(r[A+1].t==="?"||r[A+1].t==="t"&&r[A+1].v==="/")||r[o].t==="("&&(h===" "||h==="n"||h===")")||h==="t"&&(r[A].v==="/"||r[A].v===" "&&r[A+1]!=null&&r[A+1].t=="?"));)r[o].v+=r[A].v,r[A]={v:"",t:";"},++A;C+=r[o].v,o=A-1;break;case"G":r[o].t="t",r[o].v=tx(t,n);break}var F="",K,D;if(C.length>0){C.charCodeAt(0)==40?(K=t<0&&C.charCodeAt(0)===45?-t:t,D=kr("n",C,K)):(K=t<0&&a>1?-t:t,D=kr("n",C,K),K<0&&r[0]&&r[0].t=="t"&&(D=D.substr(1),r[0].v="-"+r[0].v)),A=D.length-1;var H=r.length;for(o=0;o<r.length;++o)if(r[o]!=null&&r[o].t!="t"&&r[o].v.indexOf(".")>-1){H=o;break}var M=r.length;if(H===r.length&&D.indexOf("E")===-1){for(o=r.length-1;o>=0;--o)r[o]==null||"n?".indexOf(r[o].t)===-1||(A>=r[o].v.length-1?(A-=r[o].v.length,r[o].v=D.substr(A+1,r[o].v.length)):A<0?r[o].v="":(r[o].v=D.substr(0,A+1),A=-1),r[o].t="t",M=o);A>=0&&M<r.length&&(r[M].v=D.substr(0,A+1)+r[M].v)}else if(H!==r.length&&D.indexOf("E")===-1){for(A=D.indexOf(".")-1,o=H;o>=0;--o)if(!(r[o]==null||"n?".indexOf(r[o].t)===-1)){for(g=r[o].v.indexOf(".")>-1&&o===H?r[o].v.indexOf(".")-1:r[o].v.length-1,F=r[o].v.substr(g+1);g>=0;--g)A>=0&&(r[o].v.charAt(g)==="0"||r[o].v.charAt(g)==="#")&&(F=D.charAt(A--)+F);r[o].v=F,r[o].t="t",M=o}for(A>=0&&M<r.length&&(r[M].v=D.substr(0,A+1)+r[M].v),A=D.indexOf(".")+1,o=H;o<r.length;++o)if(!(r[o]==null||"n?(".indexOf(r[o].t)===-1&&o!==H)){for(g=r[o].v.indexOf(".")>-1&&o===H?r[o].v.indexOf(".")+1:0,F=r[o].v.substr(0,g);g<r[o].v.length;++g)A<D.length&&(F+=D.charAt(A++));r[o].v=F,r[o].t="t",M=o}}}for(o=0;o<r.length;++o)r[o]!=null&&"n?".indexOf(r[o].t)>-1&&(K=a>1&&t<0&&o>0&&r[o-1].v==="-"?-t:t,r[o].v=kr(r[o].t,r[o].v,K),r[o].t="t");var B="";for(o=0;o!==r.length;++o)r[o]!=null&&(B+=r[o].v);return B}var Tv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Sv(e,t){if(t==null)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function sA(e,t){var n=aA(e),a=n.length,r=n[a-1].indexOf("@");if(a<4&&r>-1&&--a,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||r>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=r>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=r>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=r>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var l=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[a,l];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var o=n[0].match(Tv),h=n[1].match(Tv);return Sv(t,o)?[a,n[0]]:Sv(t,h)?[a,n[1]]:[a,n[o!=null&&h!=null?2:1]]}return[a,l]}function ms(e,t,n){n==null&&(n={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&n.dateNF?a=n.dateNF:a=e;break;case"number":e==14&&n.dateNF?a=n.dateNF:a=(n.table!=null?n.table:Kt)[e],a==null&&(a=n.table&&n.table[bv[e]]||Kt[bv[e]]),a==null&&(a=Ij[e]||"General");break}if(Dh(a,0))return tx(t,n);t instanceof Date&&(t=_b(t,n.date1904));var r=sA(a,t);if(Dh(r[1]))return tx(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return rA(r[1],t,n,r[0])}function Ob(e,t){if(typeof t!="number"){t=+t||-1;for(var n=0;n<392;++n){if(Kt[n]==null){t<0&&(t=n);continue}if(Kt[n]==e){t=n;break}}t<0&&(t=391)}return Kt[t]=e,t}function Jh(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Ob(e[t],t)}function ef(){Kt=Pj()}var Mb=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function iA(e){var t=typeof e=="number"?Kt[e]:e;return t=t.replace(Mb,"(\\d+)"),new RegExp("^"+t+"$")}function lA(e,t,n){var a=-1,r=-1,l=-1,o=-1,h=-1,f=-1;(t.match(Mb)||[]).forEach(function(p,y){var w=parseInt(n[y+1],10);switch(p.toLowerCase().charAt(0)){case"y":a=w;break;case"d":l=w;break;case"h":o=w;break;case"s":f=w;break;case"m":o>=0?h=w:r=w;break}}),f>=0&&h==-1&&r>=0&&(h=r,r=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var g=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return o==-1&&h==-1&&f==-1?d:a==-1&&r==-1&&l==-1?g:d+"T"+g}var oA=function(){var e={};e.version="1.2.0";function t(){for(var D=0,H=new Array(256),M=0;M!=256;++M)D=M,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,H[M]=D;return typeof Int32Array<"u"?new Int32Array(H):H}var n=t();function a(D){var H=0,M=0,B=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)I[B]=D[B];for(B=0;B!=256;++B)for(M=D[B],H=256+B;H<4096;H+=256)M=I[H]=M>>>8^D[M&255];var te=[];for(B=1;B!=16;++B)te[B-1]=typeof Int32Array<"u"?I.subarray(B*256,B*256+256):I.slice(B*256,B*256+256);return te}var r=a(n),l=r[0],o=r[1],h=r[2],f=r[3],d=r[4],g=r[5],p=r[6],y=r[7],w=r[8],_=r[9],b=r[10],T=r[11],S=r[12],E=r[13],C=r[14];function A(D,H){for(var M=H^-1,B=0,I=D.length;B<I;)M=M>>>8^n[(M^D.charCodeAt(B++))&255];return~M}function F(D,H){for(var M=H^-1,B=D.length-15,I=0;I<B;)M=C[D[I++]^M&255]^E[D[I++]^M>>8&255]^S[D[I++]^M>>16&255]^T[D[I++]^M>>>24]^b[D[I++]]^_[D[I++]]^w[D[I++]]^y[D[I++]]^p[D[I++]]^g[D[I++]]^d[D[I++]]^f[D[I++]]^h[D[I++]]^o[D[I++]]^l[D[I++]]^n[D[I++]];for(B+=15;I<B;)M=M>>>8^n[(M^D[I++])&255];return~M}function K(D,H){for(var M=H^-1,B=0,I=D.length,te=0,q=0;B<I;)te=D.charCodeAt(B++),te<128?M=M>>>8^n[(M^te)&255]:te<2048?(M=M>>>8^n[(M^(192|te>>6&31))&255],M=M>>>8^n[(M^(128|te&63))&255]):te>=55296&&te<57344?(te=(te&1023)+64,q=D.charCodeAt(B++)&1023,M=M>>>8^n[(M^(240|te>>8&7))&255],M=M>>>8^n[(M^(128|te>>2&63))&255],M=M>>>8^n[(M^(128|q>>6&15|(te&3)<<4))&255],M=M>>>8^n[(M^(128|q&63))&255]):(M=M>>>8^n[(M^(224|te>>12&15))&255],M=M>>>8^n[(M^(128|te>>6&63))&255],M=M>>>8^n[(M^(128|te&63))&255]);return~M}return e.table=n,e.bstr=A,e.buf=F,e.str=K,e}(),kt=function(){var t={};t.version="1.2.1";function n(O,G){for(var L=O.split("/"),z=G.split("/"),W=0,X=0,ue=Math.min(L.length,z.length);W<ue;++W){if(X=L[W].length-z[W].length)return X;if(L[W]!=z[W])return L[W]<z[W]?-1:1}return L.length-z.length}function a(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:a(O.slice(0,-1));var G=O.lastIndexOf("/");return G===-1?O:O.slice(0,G+1)}function r(O){if(O.charAt(O.length-1)=="/")return r(O.slice(0,-1));var G=O.lastIndexOf("/");return G===-1?O:O.slice(G+1)}function l(O,G){typeof G=="string"&&(G=new Date(G));var L=G.getHours();L=L<<6|G.getMinutes(),L=L<<5|G.getSeconds()>>>1,O.write_shift(2,L);var z=G.getFullYear()-1980;z=z<<4|G.getMonth()+1,z=z<<5|G.getDate(),O.write_shift(2,z)}function o(O){var G=O.read_shift(2)&65535,L=O.read_shift(2)&65535,z=new Date,W=L&31;L>>>=5;var X=L&15;L>>>=4,z.setMilliseconds(0),z.setFullYear(L+1980),z.setMonth(X-1),z.setDate(W);var ue=G&31;G>>>=5;var ve=G&63;return G>>>=6,z.setHours(G),z.setMinutes(ve),z.setSeconds(ue<<1),z}function h(O){sa(O,0);for(var G={},L=0;O.l<=O.length-4;){var z=O.read_shift(2),W=O.read_shift(2),X=O.l+W,ue={};switch(z){case 21589:L=O.read_shift(1),L&1&&(ue.mtime=O.read_shift(4)),W>5&&(L&2&&(ue.atime=O.read_shift(4)),L&4&&(ue.ctime=O.read_shift(4))),ue.mtime&&(ue.mt=new Date(ue.mtime*1e3));break}O.l=X,G[z]=ue}return G}var f;function d(){return f||(f={})}function g(O,G){if(O[0]==80&&O[1]==75)return wl(O,G);if((O[0]|32)==109&&(O[1]|32)==105)return lf(O,G);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var L=3,z=512,W=0,X=0,ue=0,ve=0,le=0,he=[],xe=O.slice(0,512);sa(xe,0);var je=p(xe);switch(L=je[0],L){case 3:z=512;break;case 4:z=4096;break;case 0:if(je[1]==0)return wl(O,G);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}z!==512&&(xe=O.slice(0,z),sa(xe,28));var Oe=O.slice(0,z);y(xe,L);var He=xe.read_shift(4,"i");if(L===3&&He!==0)throw new Error("# Directory Sectors: Expected 0 saw "+He);xe.l+=4,ue=xe.read_shift(4,"i"),xe.l+=4,xe.chk("00100000","Mini Stream Cutoff Size: "),ve=xe.read_shift(4,"i"),W=xe.read_shift(4,"i"),le=xe.read_shift(4,"i"),X=xe.read_shift(4,"i");for(var Ae=-1,Be=0;Be<109&&(Ae=xe.read_shift(4,"i"),!(Ae<0));++Be)he[Be]=Ae;var Xe=w(O,z);T(le,X,Xe,z,he);var Tt=E(Xe,ue,he,z);Tt[ue].name="!Directory",W>0&&ve!==q&&(Tt[ve].name="!MiniFAT"),Tt[he[0]].name="!FAT",Tt.fat_addrs=he,Tt.ssz=z;var St={},Dt=[],rr=[],Br=[];C(ue,Tt,Xe,Dt,W,St,rr,ve),_(rr,Br,Dt),Dt.shift();var ua={FileIndex:rr,FullPaths:Br};return G&&G.raw&&(ua.raw={header:Oe,sectors:Xe}),ua}function p(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(ae,"Header Signature: "),O.l+=16;var G=O.read_shift(2,"u");return[O.read_shift(2,"u"),G]}function y(O,G){var L=9;switch(O.l+=2,L=O.read_shift(2)){case 9:if(G!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(G!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function w(O,G){for(var L=Math.ceil(O.length/G)-1,z=[],W=1;W<L;++W)z[W-1]=O.slice(W*G,(W+1)*G);return z[L-1]=O.slice(L*G),z}function _(O,G,L){for(var z=0,W=0,X=0,ue=0,ve=0,le=L.length,he=[],xe=[];z<le;++z)he[z]=xe[z]=z,G[z]=L[z];for(;ve<xe.length;++ve)z=xe[ve],W=O[z].L,X=O[z].R,ue=O[z].C,he[z]===z&&(W!==-1&&he[W]!==W&&(he[z]=he[W]),X!==-1&&he[X]!==X&&(he[z]=he[X])),ue!==-1&&(he[ue]=z),W!==-1&&z!=he[z]&&(he[W]=he[z],xe.lastIndexOf(W)<ve&&xe.push(W)),X!==-1&&z!=he[z]&&(he[X]=he[z],xe.lastIndexOf(X)<ve&&xe.push(X));for(z=1;z<le;++z)he[z]===z&&(X!==-1&&he[X]!==X?he[z]=he[X]:W!==-1&&he[W]!==W&&(he[z]=he[W]));for(z=1;z<le;++z)if(O[z].type!==0){if(ve=z,ve!=he[ve])do ve=he[ve],G[z]=G[ve]+"/"+G[z];while(ve!==0&&he[ve]!==-1&&ve!=he[ve]);he[z]=-1}for(G[0]+="/",z=1;z<le;++z)O[z].type!==2&&(G[z]+="/")}function b(O,G,L){for(var z=O.start,W=O.size,X=[],ue=z;L&&W>0&&ue>=0;)X.push(G.slice(ue*te,ue*te+te)),W-=te,ue=Xs(L,ue*4);return X.length===0?be(0):_n(X).slice(0,O.size)}function T(O,G,L,z,W){var X=q;if(O===q){if(G!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var ue=L[O],ve=(z>>>2)-1;if(!ue)return;for(var le=0;le<ve&&(X=Xs(ue,le*4))!==q;++le)W.push(X);T(Xs(ue,z-4),G-1,L,z,W)}}function S(O,G,L,z,W){var X=[],ue=[];W||(W=[]);var ve=z-1,le=0,he=0;for(le=G;le>=0;){W[le]=!0,X[X.length]=le,ue.push(O[le]);var xe=L[Math.floor(le*4/z)];if(he=le*4&ve,z<4+he)throw new Error("FAT boundary crossed: "+le+" 4 "+z);if(!O[xe])break;le=Xs(O[xe],he)}return{nodes:X,data:Ov([ue])}}function E(O,G,L,z){var W=O.length,X=[],ue=[],ve=[],le=[],he=z-1,xe=0,je=0,Oe=0,He=0;for(xe=0;xe<W;++xe)if(ve=[],Oe=xe+G,Oe>=W&&(Oe-=W),!ue[Oe]){le=[];var Ae=[];for(je=Oe;je>=0;){Ae[je]=!0,ue[je]=!0,ve[ve.length]=je,le.push(O[je]);var Be=L[Math.floor(je*4/z)];if(He=je*4&he,z<4+He)throw new Error("FAT boundary crossed: "+je+" 4 "+z);if(!O[Be]||(je=Xs(O[Be],He),Ae[je]))break}X[Oe]={nodes:ve,data:Ov([le])}}return X}function C(O,G,L,z,W,X,ue,ve){for(var le=0,he=z.length?2:0,xe=G[O].data,je=0,Oe=0,He;je<xe.length;je+=128){var Ae=xe.slice(je,je+128);sa(Ae,64),Oe=Ae.read_shift(2),He=Px(Ae,0,Oe-he),z.push(He);var Be={name:He,type:Ae.read_shift(1),color:Ae.read_shift(1),L:Ae.read_shift(4,"i"),R:Ae.read_shift(4,"i"),C:Ae.read_shift(4,"i"),clsid:Ae.read_shift(16),state:Ae.read_shift(4,"i"),start:0,size:0},Xe=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);Xe!==0&&(Be.ct=A(Ae,Ae.l-8));var Tt=Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2)+Ae.read_shift(2);Tt!==0&&(Be.mt=A(Ae,Ae.l-8)),Be.start=Ae.read_shift(4,"i"),Be.size=Ae.read_shift(4,"i"),Be.size<0&&Be.start<0&&(Be.size=Be.type=0,Be.start=q,Be.name=""),Be.type===5?(le=Be.start,W>0&&le!==q&&(G[le].name="!StreamData")):Be.size>=4096?(Be.storage="fat",G[Be.start]===void 0&&(G[Be.start]=S(L,Be.start,G.fat_addrs,G.ssz)),G[Be.start].name=Be.name,Be.content=G[Be.start].data.slice(0,Be.size)):(Be.storage="minifat",Be.size<0?Be.size=0:le!==q&&Be.start!==q&&G[le]&&(Be.content=b(Be,G[le].data,(G[ve]||{}).data))),Be.content&&sa(Be.content,0),X[He]=Be,ue.push(Be)}}function A(O,G){return new Date((la(O,G+4)/1e7*Math.pow(2,32)+la(O,G)/1e7-11644473600)*1e3)}function F(O,G){return d(),g(f.readFileSync(O),G)}function K(O,G){var L=G&&G.type;switch(L||ht&&Buffer.isBuffer(O)&&(L="buffer"),L||"base64"){case"file":return F(O,G);case"base64":return g(Fa(Or(O)),G);case"binary":return g(Fa(O),G)}return g(O,G)}function D(O,G){var L=G||{},z=L.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=z+"/",O.FileIndex[0]={name:z,type:5}),L.CLSID&&(O.FileIndex[0].clsid=L.CLSID),H(O)}function H(O){var G="Sh33tJ5";if(!kt.find(O,"/"+G)){var L=be(4);L[0]=55,L[1]=L[3]=50,L[2]=54,O.FileIndex.push({name:G,type:2,content:L,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+G),M(O)}}function M(O,G){D(O);for(var L=!1,z=!1,W=O.FullPaths.length-1;W>=0;--W){var X=O.FileIndex[W];switch(X.type){case 0:z?L=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:z=!0,isNaN(X.R*X.L*X.C)&&(L=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!G)){var ue=new Date(1987,1,19),ve=0,le=Object.create?Object.create(null):{},he=[];for(W=0;W<O.FullPaths.length;++W)le[O.FullPaths[W]]=!0,O.FileIndex[W].type!==0&&he.push([O.FullPaths[W],O.FileIndex[W]]);for(W=0;W<he.length;++W){var xe=a(he[W][0]);z=le[xe],z||(he.push([xe,{name:r(xe).replace("/",""),type:1,clsid:ee,ct:ue,mt:ue,content:null}]),le[xe]=!0)}for(he.sort(function(He,Ae){return n(He[0],Ae[0])}),O.FullPaths=[],O.FileIndex=[],W=0;W<he.length;++W)O.FullPaths[W]=he[W][0],O.FileIndex[W]=he[W][1];for(W=0;W<he.length;++W){var je=O.FileIndex[W],Oe=O.FullPaths[W];if(je.name=r(Oe).replace("/",""),je.L=je.R=je.C=-(je.color=1),je.size=je.content?je.content.length:0,je.start=0,je.clsid=je.clsid||ee,W===0)je.C=he.length>1?1:-1,je.size=0,je.type=5;else if(Oe.slice(-1)=="/"){for(ve=W+1;ve<he.length&&a(O.FullPaths[ve])!=Oe;++ve);for(je.C=ve>=he.length?-1:ve,ve=W+1;ve<he.length&&a(O.FullPaths[ve])!=a(Oe);++ve);je.R=ve>=he.length?-1:ve,je.type=1}else a(O.FullPaths[W+1]||"")==a(Oe)&&(je.R=W+1),je.type=2}}}function B(O,G){var L=G||{};if(L.fileType=="mad")return Ua(O,L);switch(M(O),L.fileType){case"zip":return Ts(O,L)}var z=function(He){for(var Ae=0,Be=0,Xe=0;Xe<He.FileIndex.length;++Xe){var Tt=He.FileIndex[Xe];if(Tt.content){var St=Tt.content.length;St>0&&(St<4096?Ae+=St+63>>6:Be+=St+511>>9)}}for(var Dt=He.FullPaths.length+3>>2,rr=Ae+7>>3,Br=Ae+127>>7,ua=rr+Be+Dt+Br,ka=ua+127>>7,Ss=ka<=109?0:Math.ceil((ka-109)/127);ua+ka+Ss+127>>7>ka;)Ss=++ka<=109?0:Math.ceil((ka-109)/127);var ja=[1,Ss,ka,Br,Dt,Be,Ae,0];return He.FileIndex[0].size=Ae<<6,ja[7]=(He.FileIndex[0].start=ja[0]+ja[1]+ja[2]+ja[3]+ja[4]+ja[5])+(ja[6]+7>>3),ja}(O),W=be(z[7]<<9),X=0,ue=0;{for(X=0;X<8;++X)W.write_shift(1,re[X]);for(X=0;X<8;++X)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),X=0;X<3;++X)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,z[2]),W.write_shift(4,z[0]+z[1]+z[2]+z[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,z[3]?z[0]+z[1]+z[2]-1:q),W.write_shift(4,z[3]),W.write_shift(-4,z[1]?z[0]-1:q),W.write_shift(4,z[1]),X=0;X<109;++X)W.write_shift(-4,X<z[2]?z[1]+X:-1)}if(z[1])for(ue=0;ue<z[1];++ue){for(;X<236+ue*127;++X)W.write_shift(-4,X<z[2]?z[1]+X:-1);W.write_shift(-4,ue===z[1]-1?q:ue+1)}var ve=function(He){for(ue+=He;X<ue-1;++X)W.write_shift(-4,X+1);He&&(++X,W.write_shift(-4,q))};for(ue=X=0,ue+=z[1];X<ue;++X)W.write_shift(-4,Q.DIFSECT);for(ue+=z[2];X<ue;++X)W.write_shift(-4,Q.FATSECT);ve(z[3]),ve(z[4]);for(var le=0,he=0,xe=O.FileIndex[0];le<O.FileIndex.length;++le)xe=O.FileIndex[le],xe.content&&(he=xe.content.length,!(he<4096)&&(xe.start=ue,ve(he+511>>9)));for(ve(z[6]+7>>3);W.l&511;)W.write_shift(-4,Q.ENDOFCHAIN);for(ue=X=0,le=0;le<O.FileIndex.length;++le)xe=O.FileIndex[le],xe.content&&(he=xe.content.length,!(!he||he>=4096)&&(xe.start=ue,ve(he+63>>6)));for(;W.l&511;)W.write_shift(-4,Q.ENDOFCHAIN);for(X=0;X<z[4]<<2;++X){var je=O.FullPaths[X];if(!je||je.length===0){for(le=0;le<17;++le)W.write_shift(4,0);for(le=0;le<3;++le)W.write_shift(4,-1);for(le=0;le<12;++le)W.write_shift(4,0);continue}xe=O.FileIndex[X],X===0&&(xe.start=xe.size?xe.start-1:q);var Oe=X===0&&L.root||xe.name;if(he=2*(Oe.length+1),W.write_shift(64,Oe,"utf16le"),W.write_shift(2,he),W.write_shift(1,xe.type),W.write_shift(1,xe.color),W.write_shift(-4,xe.L),W.write_shift(-4,xe.R),W.write_shift(-4,xe.C),xe.clsid)W.write_shift(16,xe.clsid,"hex");else for(le=0;le<4;++le)W.write_shift(4,0);W.write_shift(4,xe.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,xe.start),W.write_shift(4,xe.size),W.write_shift(4,0)}for(X=1;X<O.FileIndex.length;++X)if(xe=O.FileIndex[X],xe.size>=4096)if(W.l=xe.start+1<<9,ht&&Buffer.isBuffer(xe.content))xe.content.copy(W,W.l,0,xe.size),W.l+=xe.size+511&-512;else{for(le=0;le<xe.size;++le)W.write_shift(1,xe.content[le]);for(;le&511;++le)W.write_shift(1,0)}for(X=1;X<O.FileIndex.length;++X)if(xe=O.FileIndex[X],xe.size>0&&xe.size<4096)if(ht&&Buffer.isBuffer(xe.content))xe.content.copy(W,W.l,0,xe.size),W.l+=xe.size+63&-64;else{for(le=0;le<xe.size;++le)W.write_shift(1,xe.content[le]);for(;le&63;++le)W.write_shift(1,0)}if(ht)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}function I(O,G){var L=O.FullPaths.map(function(le){return le.toUpperCase()}),z=L.map(function(le){var he=le.split("/");return he[he.length-(le.slice(-1)=="/"?2:1)]}),W=!1;G.charCodeAt(0)===47?(W=!0,G=L[0].slice(0,-1)+G):W=G.indexOf("/")!==-1;var X=G.toUpperCase(),ue=W===!0?L.indexOf(X):z.indexOf(X);if(ue!==-1)return O.FileIndex[ue];var ve=!X.match(lh);for(X=X.replace(Ko,""),ve&&(X=X.replace(lh,"!")),ue=0;ue<L.length;++ue)if((ve?L[ue].replace(lh,"!"):L[ue]).replace(Ko,"")==X||(ve?z[ue].replace(lh,"!"):z[ue]).replace(Ko,"")==X)return O.FileIndex[ue];return null}var te=64,q=-2,ae="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",Q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:ae,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function pe(O,G,L){d();var z=B(O,L);f.writeFileSync(G,z)}function ye(O){for(var G=new Array(O.length),L=0;L<O.length;++L)G[L]=String.fromCharCode(O[L]);return G.join("")}function Y(O,G){var L=B(O,G);switch(G&&G.type||"buffer"){case"file":return d(),f.writeFileSync(G.filename,L),L;case"binary":return typeof L=="string"?L:ye(L);case"base64":return cc(typeof L=="string"?L:ye(L));case"buffer":if(ht)return Buffer.isBuffer(L)?L:Fr(L);case"array":return typeof L=="string"?Fa(L):L}return L}var de;function P(O){try{var G=O.InflateRaw,L=new G;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)de=O;else throw new Error("zlib does not expose bytesRead")}catch(z){console.error("cannot use native zlib: "+(z.message||z))}}function Z(O,G){if(!de)return kc(O,G);var L=de.InflateRaw,z=new L,W=z._processChunk(O.slice(O.l),z._finishFlushFlag);return O.l+=z.bytesRead,W}function k(O){return de?de.deflateRawSync(O):Nc(O)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ie(O){var G=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(G>>16|G>>8|G)&255}for(var we=typeof Uint8Array<"u",Ne=we?new Uint8Array(256):[],ze=0;ze<256;++ze)Ne[ze]=ie(ze);function Ue(O,G){var L=Ne[O&255];return G<=8?L>>>8-G:(L=L<<8|Ne[O>>8&255],G<=16?L>>>16-G:(L=L<<8|Ne[O>>16&255],L>>>24-G))}function rt(O,G){var L=G&7,z=G>>>3;return(O[z]|(L<=6?0:O[z+1]<<8))>>>L&3}function Ye(O,G){var L=G&7,z=G>>>3;return(O[z]|(L<=5?0:O[z+1]<<8))>>>L&7}function rn(O,G){var L=G&7,z=G>>>3;return(O[z]|(L<=4?0:O[z+1]<<8))>>>L&15}function xt(O,G){var L=G&7,z=G>>>3;return(O[z]|(L<=3?0:O[z+1]<<8))>>>L&31}function Fe(O,G){var L=G&7,z=G>>>3;return(O[z]|(L<=1?0:O[z+1]<<8))>>>L&127}function ft(O,G,L){var z=G&7,W=G>>>3,X=(1<<L)-1,ue=O[W]>>>z;return L<8-z||(ue|=O[W+1]<<8-z,L<16-z)||(ue|=O[W+2]<<16-z,L<24-z)||(ue|=O[W+3]<<24-z),ue&X}function Jt(O,G,L){var z=G&7,W=G>>>3;return z<=5?O[W]|=(L&7)<<z:(O[W]|=L<<z&255,O[W+1]=(L&7)>>8-z),G+3}function Fn(O,G,L){var z=G&7,W=G>>>3;return L=(L&1)<<z,O[W]|=L,G+1}function Cn(O,G,L){var z=G&7,W=G>>>3;return L<<=z,O[W]|=L&255,L>>>=8,O[W+1]=L,G+8}function me(O,G,L){var z=G&7,W=G>>>3;return L<<=z,O[W]|=L&255,L>>>=8,O[W+1]=L&255,O[W+2]=L>>>8,G+16}function ke(O,G){var L=O.length,z=2*L>G?2*L:G+5,W=0;if(L>=G)return O;if(ht){var X=pv(z);if(O.copy)O.copy(X);else for(;W<O.length;++W)X[W]=O[W];return X}else if(we){var ue=new Uint8Array(z);if(ue.set)ue.set(O);else for(;W<L;++W)ue[W]=O[W];return ue}return O.length=z,O}function Le(O){for(var G=new Array(O),L=0;L<O;++L)G[L]=0;return G}function Ze(O,G,L){var z=1,W=0,X=0,ue=0,ve=0,le=O.length,he=we?new Uint16Array(32):Le(32);for(X=0;X<32;++X)he[X]=0;for(X=le;X<L;++X)O[X]=0;le=O.length;var xe=we?new Uint16Array(le):Le(le);for(X=0;X<le;++X)he[W=O[X]]++,z<W&&(z=W),xe[X]=0;for(he[0]=0,X=1;X<=z;++X)he[X+16]=ve=ve+he[X-1]<<1;for(X=0;X<le;++X)ve=O[X],ve!=0&&(xe[X]=he[ve+16]++);var je=0;for(X=0;X<le;++X)if(je=O[X],je!=0)for(ve=Ue(xe[X],z)>>z-je,ue=(1<<z+4-je)-1;ue>=0;--ue)G[ve|ue<<je]=je&15|X<<4;return z}var wt=we?new Uint16Array(512):Le(512),_t=we?new Uint16Array(32):Le(32);if(!we){for(var tt=0;tt<512;++tt)wt[tt]=0;for(tt=0;tt<32;++tt)_t[tt]=0}(function(){for(var O=[],G=0;G<32;G++)O.push(5);Ze(O,_t,32);var L=[];for(G=0;G<=143;G++)L.push(8);for(;G<=255;G++)L.push(9);for(;G<=279;G++)L.push(7);for(;G<=287;G++)L.push(8);Ze(L,wt,288)})();var gn=function(){for(var G=we?new Uint8Array(32768):[],L=0,z=0;L<Te.length-1;++L)for(;z<Te[L+1];++z)G[z]=L;for(;z<32768;++z)G[z]=29;var W=we?new Uint8Array(259):[];for(L=0,z=0;L<U.length-1;++L)for(;z<U[L+1];++z)W[z]=L;function X(ve,le){for(var he=0;he<ve.length;){var xe=Math.min(65535,ve.length-he),je=he+xe==ve.length;for(le.write_shift(1,+je),le.write_shift(2,xe),le.write_shift(2,~xe&65535);xe-- >0;)le[le.l++]=ve[he++]}return le.l}function ue(ve,le){for(var he=0,xe=0,je=we?new Uint16Array(32768):[];xe<ve.length;){var Oe=Math.min(65535,ve.length-xe);if(Oe<10){for(he=Jt(le,he,+(xe+Oe==ve.length)),he&7&&(he+=8-(he&7)),le.l=he/8|0,le.write_shift(2,Oe),le.write_shift(2,~Oe&65535);Oe-- >0;)le[le.l++]=ve[xe++];he=le.l*8;continue}he=Jt(le,he,+(xe+Oe==ve.length)+2);for(var He=0;Oe-- >0;){var Ae=ve[xe];He=(He<<5^Ae)&32767;var Be=-1,Xe=0;if((Be=je[He])&&(Be|=xe&-32768,Be>xe&&(Be-=32768),Be<xe))for(;ve[Be+Xe]==ve[xe+Xe]&&Xe<250;)++Xe;if(Xe>2){Ae=W[Xe],Ae<=22?he=Cn(le,he,Ne[Ae+1]>>1)-1:(Cn(le,he,3),he+=5,Cn(le,he,Ne[Ae-23]>>5),he+=3);var Tt=Ae<8?0:Ae-4>>2;Tt>0&&(me(le,he,Xe-U[Ae]),he+=Tt),Ae=G[xe-Be],he=Cn(le,he,Ne[Ae]>>3),he-=3;var St=Ae<4?0:Ae-2>>1;St>0&&(me(le,he,xe-Be-Te[Ae]),he+=St);for(var Dt=0;Dt<Xe;++Dt)je[He]=xe&32767,He=(He<<5^ve[xe])&32767,++xe;Oe-=Xe-1}else Ae<=143?Ae=Ae+48:he=Fn(le,he,1),he=Cn(le,he,Ne[Ae]),je[He]=xe&32767,++xe}he=Cn(le,he,0)-1}return le.l=(he+7)/8|0,le.l}return function(le,he){return le.length<8?X(le,he):ue(le,he)}}();function Nc(O){var G=be(50+Math.floor(O.length*1.1)),L=gn(O,G);return G.slice(0,L)}var Ec=we?new Uint16Array(32768):Le(32768),Cc=we?new Uint16Array(32768):Le(32768),bs=we?new Uint16Array(128):Le(128),ws=1,za=1;function fi(O,G){var L=xt(O,G)+257;G+=5;var z=xt(O,G)+1;G+=5;var W=rn(O,G)+4;G+=4;for(var X=0,ue=we?new Uint8Array(19):Le(19),ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,he=we?new Uint8Array(8):Le(8),xe=we?new Uint8Array(8):Le(8),je=ue.length,Oe=0;Oe<W;++Oe)ue[V[Oe]]=X=Ye(O,G),le<X&&(le=X),he[X]++,G+=3;var He=0;for(he[0]=0,Oe=1;Oe<=le;++Oe)xe[Oe]=He=He+he[Oe-1]<<1;for(Oe=0;Oe<je;++Oe)(He=ue[Oe])!=0&&(ve[Oe]=xe[He]++);var Ae=0;for(Oe=0;Oe<je;++Oe)if(Ae=ue[Oe],Ae!=0){He=Ne[ve[Oe]]>>8-Ae;for(var Be=(1<<7-Ae)-1;Be>=0;--Be)bs[He|Be<<Ae]=Ae&7|Oe<<3}var Xe=[];for(le=1;Xe.length<L+z;)switch(He=bs[Fe(O,G)],G+=He&7,He>>>=3){case 16:for(X=3+rt(O,G),G+=2,He=Xe[Xe.length-1];X-- >0;)Xe.push(He);break;case 17:for(X=3+Ye(O,G),G+=3;X-- >0;)Xe.push(0);break;case 18:for(X=11+Fe(O,G),G+=7;X-- >0;)Xe.push(0);break;default:Xe.push(He),le<He&&(le=He);break}var Tt=Xe.slice(0,L),St=Xe.slice(L);for(Oe=L;Oe<286;++Oe)Tt[Oe]=0;for(Oe=z;Oe<30;++Oe)St[Oe]=0;return ws=Ze(Tt,Ec,286),za=Ze(St,Cc,30),G}function _s(O,G){if(O[0]==3&&!(O[1]&3))return[ni(G),2];for(var L=0,z=0,W=pv(G||1<<18),X=0,ue=W.length>>>0,ve=0,le=0;(z&1)==0;){if(z=Ye(O,L),L+=3,z>>>1)z>>1==1?(ve=9,le=5):(L=fi(O,L),ve=ws,le=za);else{L&7&&(L+=8-(L&7));var he=O[L>>>3]|O[(L>>>3)+1]<<8;if(L+=32,he>0)for(!G&&ue<X+he&&(W=ke(W,X+he),ue=W.length);he-- >0;)W[X++]=O[L>>>3],L+=8;continue}for(;;){!G&&ue<X+32767&&(W=ke(W,X+32767),ue=W.length);var xe=ft(O,L,ve),je=z>>>1==1?wt[xe]:Ec[xe];if(L+=je&15,je>>>=4,(je>>>8&255)===0)W[X++]=je;else{if(je==256)break;je-=257;var Oe=je<8?0:je-4>>2;Oe>5&&(Oe=0);var He=X+U[je];Oe>0&&(He+=ft(O,L,Oe),L+=Oe),xe=ft(O,L,le),je=z>>>1==1?_t[xe]:Cc[xe],L+=je&15,je>>>=4;var Ae=je<4?0:je-2>>1,Be=Te[je];for(Ae>0&&(Be+=ft(O,L,Ae),L+=Ae),!G&&ue<He&&(W=ke(W,He+100),ue=W.length);X<He;)W[X]=W[X-Be],++X}}}return G?[W,L+7>>>3]:[W.slice(0,X),L+7>>>3]}function kc(O,G){var L=O.slice(O.l||0),z=_s(L,G);return O.l+=z[1],z[0]}function bl(O,G){if(O)typeof console<"u"&&console.error(G);else throw new Error(G)}function wl(O,G){var L=O;sa(L,0);var z=[],W=[],X={FileIndex:z,FullPaths:W};D(X,{root:G.root});for(var ue=L.length-4;(L[ue]!=80||L[ue+1]!=75||L[ue+2]!=5||L[ue+3]!=6)&&ue>=0;)--ue;L.l=ue+4,L.l+=4;var ve=L.read_shift(2);L.l+=6;var le=L.read_shift(4);for(L.l=le,ue=0;ue<ve;++ue){L.l+=20;var he=L.read_shift(4),xe=L.read_shift(4),je=L.read_shift(2),Oe=L.read_shift(2),He=L.read_shift(2);L.l+=8;var Ae=L.read_shift(4),Be=h(L.slice(L.l+je,L.l+je+Oe));L.l+=je+Oe+He;var Xe=L.l;L.l=Ae+4,_l(L,he,xe,X,Be),L.l=Xe}return X}function _l(O,G,L,z,W){O.l+=2;var X=O.read_shift(2),ue=O.read_shift(2),ve=o(O);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var le=O.read_shift(4),he=O.read_shift(4),xe=O.read_shift(4),je=O.read_shift(2),Oe=O.read_shift(2),He="",Ae=0;Ae<je;++Ae)He+=String.fromCharCode(O[O.l++]);if(Oe){var Be=h(O.slice(O.l,O.l+Oe));(Be[21589]||{}).mt&&(ve=Be[21589].mt),((W||{})[21589]||{}).mt&&(ve=W[21589].mt)}O.l+=Oe;var Xe=O.slice(O.l,O.l+he);switch(ue){case 8:Xe=Z(O,xe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ue)}var Tt=!1;X&8&&(le=O.read_shift(4),le==134695760&&(le=O.read_shift(4),Tt=!0),he=O.read_shift(4),xe=O.read_shift(4)),he!=G&&bl(Tt,"Bad compressed size: "+G+" != "+he),xe!=L&&bl(Tt,"Bad uncompressed size: "+L+" != "+xe),ln(z,He,Xe,{unsafe:!0,mt:ve})}function Ts(O,G){var L=G||{},z=[],W=[],X=be(1),ue=L.compression?8:0,ve=0,le=0,he=0,xe=0,je=0,Oe=O.FullPaths[0],He=Oe,Ae=O.FileIndex[0],Be=[],Xe=0;for(le=1;le<O.FullPaths.length;++le)if(He=O.FullPaths[le].slice(Oe.length),Ae=O.FileIndex[le],!(!Ae.size||!Ae.content||He=="Sh33tJ5")){var Tt=xe,St=be(He.length);for(he=0;he<He.length;++he)St.write_shift(1,He.charCodeAt(he)&127);St=St.slice(0,St.l),Be[je]=oA.buf(Ae.content,0);var Dt=Ae.content;ue==8&&(Dt=k(Dt)),X=be(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,ve),X.write_shift(2,ue),Ae.mt?l(X,Ae.mt):X.write_shift(4,0),X.write_shift(-4,Be[je]),X.write_shift(4,Dt.length),X.write_shift(4,Ae.content.length),X.write_shift(2,St.length),X.write_shift(2,0),xe+=X.length,z.push(X),xe+=St.length,z.push(St),xe+=Dt.length,z.push(Dt),X=be(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,ve),X.write_shift(2,ue),X.write_shift(4,0),X.write_shift(-4,Be[je]),X.write_shift(4,Dt.length),X.write_shift(4,Ae.content.length),X.write_shift(2,St.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,Tt),Xe+=X.l,W.push(X),Xe+=St.length,W.push(St),++je}return X=be(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,je),X.write_shift(2,je),X.write_shift(4,Xe),X.write_shift(4,xe),X.write_shift(2,0),_n([_n(z),_n(W),X])}var di={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function jc(O,G){if(O.ctype)return O.ctype;var L=O.name||"",z=L.match(/\.([^\.]+)$/);return z&&di[z[1]]||G&&(z=(L=G).match(/[\.\\]([^\.\\])+$/),z&&di[z[1]])?di[z[1]]:"application/octet-stream"}function Ac(O){for(var G=cc(O),L=[],z=0;z<G.length;z+=76)L.push(G.slice(z,z+76));return L.join(`\r
`)+`\r
`}function Tl(O){var G=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(he){var xe=he.charCodeAt(0).toString(16).toUpperCase();return"="+(xe.length==1?"0"+xe:xe)});G=G.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),G.charAt(0)==`
`&&(G="=0D"+G.slice(1)),G=G.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],z=G.split(`\r
`),W=0;W<z.length;++W){var X=z[W];if(X.length==0){L.push("");continue}for(var ue=0;ue<X.length;){var ve=76,le=X.slice(ue,ue+ve);le.charAt(ve-1)=="="?ve--:le.charAt(ve-2)=="="?ve-=2:le.charAt(ve-3)=="="&&(ve-=3),le=X.slice(ue,ue+ve),ue+=ve,ue<X.length&&(le+="="),L.push(le)}}return L.join(`\r
`)}function Sl(O){for(var G=[],L=0;L<O.length;++L){for(var z=O[L];L<=O.length&&z.charAt(z.length-1)=="=";)z=z.slice(0,z.length-1)+O[++L];G.push(z)}for(var W=0;W<G.length;++W)G[W]=G[W].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return Fa(G.join(`\r
`))}function Dc(O,G,L){for(var z="",W="",X="",ue,ve=0;ve<10;++ve){var le=G[ve];if(!le||le.match(/^\s*$/))break;var he=le.match(/^(.*?):\s*([^\s].*)$/);if(he)switch(he[1].toLowerCase()){case"content-location":z=he[2].trim();break;case"content-type":X=he[2].trim();break;case"content-transfer-encoding":W=he[2].trim();break}}switch(++ve,W.toLowerCase()){case"base64":ue=Fa(Or(G.slice(ve).join("")));break;case"quoted-printable":ue=Sl(G.slice(ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var xe=ln(O,z.slice(L.length),ue,{unsafe:!0});X&&(xe.ctype=X)}function lf(O,G){if(ye(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=G&&G.root||"",z=(ht&&Buffer.isBuffer(O)?O.toString("binary"):ye(O)).split(`\r
`),W=0,X="";for(W=0;W<z.length;++W)if(X=z[W],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),L||(L=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),X.slice(0,L.length)!=L););var ue=(z[1]||"").match(/boundary="(.*?)"/);if(!ue)throw new Error("MAD cannot find boundary");var ve="--"+(ue[1]||""),le=[],he=[],xe={FileIndex:le,FullPaths:he};D(xe);var je,Oe=0;for(W=0;W<z.length;++W){var He=z[W];He!==ve&&He!==ve+"--"||(Oe++&&Dc(xe,z.slice(je,W),L),je=W)}return xe}function Ua(O,G){var L=G||{},z=L.boundary||"SheetJS";z="------="+z;for(var W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+z.slice(2)+'"',"","",""],X=O.FullPaths[0],ue=X,ve=O.FileIndex[0],le=1;le<O.FullPaths.length;++le)if(ue=O.FullPaths[le].slice(X.length),ve=O.FileIndex[le],!(!ve.size||!ve.content||ue=="Sh33tJ5")){ue=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Xe){return"_x"+Xe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Xe){return"_u"+Xe.charCodeAt(0).toString(16)+"_"});for(var he=ve.content,xe=ht&&Buffer.isBuffer(he)?he.toString("binary"):ye(he),je=0,Oe=Math.min(1024,xe.length),He=0,Ae=0;Ae<=Oe;++Ae)(He=xe.charCodeAt(Ae))>=32&&He<128&&++je;var Be=je>=Oe*4/5;W.push(z),W.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+ue),W.push("Content-Transfer-Encoding: "+(Be?"quoted-printable":"base64")),W.push("Content-Type: "+jc(ve,ue)),W.push(""),W.push(Be?Tl(xe):Ac(xe))}return W.push(z+`--\r
`),W.join(`\r
`)}function sn(O){var G={};return D(G,O),G}function ln(O,G,L,z){var W=z&&z.unsafe;W||D(O);var X=!W&&kt.find(O,G);if(!X){var ue=O.FullPaths[0];G.slice(0,ue.length)==ue?ue=G:(ue.slice(-1)!="/"&&(ue+="/"),ue=(ue+G).replace("//","/")),X={name:r(G),type:2},O.FileIndex.push(X),O.FullPaths.push(ue),W||kt.utils.cfb_gc(O)}return X.content=L,X.size=L?L.length:0,z&&(z.CLSID&&(X.clsid=z.CLSID),z.mt&&(X.mt=z.mt),z.ct&&(X.ct=z.ct)),X}function Lr(O,G){D(O);var L=kt.find(O,G);if(L){for(var z=0;z<O.FileIndex.length;++z)if(O.FileIndex[z]==L)return O.FileIndex.splice(z,1),O.FullPaths.splice(z,1),!0}return!1}function Nl(O,G,L){D(O);var z=kt.find(O,G);if(z){for(var W=0;W<O.FileIndex.length;++W)if(O.FileIndex[W]==z)return O.FileIndex[W].name=r(L),O.FullPaths[W]=L,!0}return!1}function of(O){M(O,!0)}return t.find=I,t.read=K,t.parse=g,t.write=Y,t.writeFile=pe,t.utils={cfb_new:sn,cfb_add:ln,cfb_del:Lr,cfb_mov:Nl,cfb_gc:of,ReadShift:Go,CheckField:Qb,prep_blob:sa,bconcat:_n,use_zlib:P,_deflateRaw:Nc,_inflateRaw:kc,consts:Q},t}();function cA(e){return typeof e=="string"?Zh(e):Array.isArray(e)?Fj(e):e}function bc(e,t,n){if(typeof Deno<"u"){if(n&&typeof t=="string")switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=Zh(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var a=n=="utf8"?hc(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var r=new Blob([cA(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(r,e);if(typeof saveAs<"u")return saveAs(r,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(r);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=l,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var h=File(e);return h.open("w"),h.encoding="binary",Array.isArray(t)&&(t=vc(t)),h.write(t),h.close(),t}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+e)}function En(e){for(var t=Object.keys(e),n=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&n.push(t[a]);return n}function Nv(e,t){for(var n=[],a=En(e),r=0;r!==a.length;++r)n[e[a[r]][t]]==null&&(n[e[a[r]][t]]=a[r]);return n}function Fx(e){for(var t=[],n=En(e),a=0;a!==n.length;++a)t[e[n[a]]]=n[a];return t}function tf(e){for(var t=[],n=En(e),a=0;a!==n.length;++a)t[e[n[a]]]=parseInt(n[a],10);return t}function uA(e){for(var t=[],n=En(e),a=0;a!==n.length;++a)t[e[n[a]]]==null&&(t[e[n[a]]]=[]),t[e[n[a]]].push(n[a]);return t}var Mh=new Date(1899,11,30,0,0,0);function qn(e,t){var n=e.getTime(),a=Mh.getTime()+(e.getTimezoneOffset()-Mh.getTimezoneOffset())*6e4;return(n-a)/(24*60*60*1e3)}var Rb=new Date,hA=Mh.getTime()+(Rb.getTimezoneOffset()-Mh.getTimezoneOffset())*6e4,Ev=Rb.getTimezoneOffset();function Fb(e){var t=new Date;return t.setTime(e*24*60*60*1e3+hA),t.getTimezoneOffset()!==Ev&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Ev)*6e4),t}var Cv=new Date("2017-02-19T19:06:09.000Z"),Lb=isNaN(Cv.getFullYear())?new Date("2/19/17"):Cv,fA=Lb.getFullYear()==2017;function Pn(e,t){var n=new Date(e);if(fA)return t>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):t<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(e instanceof Date)return e;if(Lb.getFullYear()==1917&&!isNaN(n.getFullYear())){var a=n.getFullYear();return e.indexOf(""+a)>-1||n.setFullYear(n.getFullYear()+100),n}var r=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function nf(e,t){if(ht&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var n={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(l){return n[l]||l})}catch{}for(var a=[],r=0;r!=e.length;++r)a.push(String.fromCharCode(e[r]));return a.join("")}function $n(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=$n(e[n]));return t}function It(e,t){for(var n="";n.length<t;)n+=e;return n}function jr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(r,l){return n=-n,l}),!isNaN(t=Number(a)))?t/n:t}var dA=["january","february","march","april","may","june","july","august","september","october","november","december"];function uc(e){var t=new Date(e),n=new Date(NaN),a=t.getYear(),r=t.getMonth(),l=t.getDate();if(isNaN(l))return n;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&dA.indexOf(o)==-1)return n}else if(o.match(/[a-z]/))return n;return a<0||a>8099?n:(r>0||l>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?n:t}function $e(e,t,n){if(e.FullPaths){if(typeof n=="string"){var a;return ht?a=Fr(n):a=Lj(n),kt.utils.cfb_add(e,t,a)}kt.utils.cfb_add(e,t,n)}else e.file(t,n)}function Lx(){return kt.utils.cfb_new()}var Zt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,xA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Bx=Fx(xA),Hx=/[&<>'"]/g,gA=/[\u0000-\u0008\u000b-\u001f]/g;function vt(e){var t=e+"";return t.replace(Hx,function(n){return Bx[n]}).replace(gA,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function kv(e){return vt(e).replace(/ /g,"_x0020_")}var Bb=/[\u0000-\u001f]/g;function mA(e){var t=e+"";return t.replace(Hx,function(n){return Bx[n]}).replace(/\n/g,"<br/>").replace(Bb,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function pA(e){var t=e+"";return t.replace(Hx,function(n){return Bx[n]}).replace(Bb,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}function yA(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function vA(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Fd(e){for(var t="",n=0,a=0,r=0,l=0,o=0,h=0;n<e.length;){if(a=e.charCodeAt(n++),a<128){t+=String.fromCharCode(a);continue}if(r=e.charCodeAt(n++),a>191&&a<224){o=(a&31)<<6,o|=r&63,t+=String.fromCharCode(o);continue}if(l=e.charCodeAt(n++),a<240){t+=String.fromCharCode((a&15)<<12|(r&63)<<6|l&63);continue}o=e.charCodeAt(n++),h=((a&7)<<18|(r&63)<<12|(l&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(h>>>10&1023)),t+=String.fromCharCode(56320+(h&1023))}return t}function jv(e){var t=ni(2*e.length),n,a,r=1,l=0,o=0,h;for(a=0;a<e.length;a+=r)r=1,(h=e.charCodeAt(a))<128?n=h:h<224?(n=(h&31)*64+(e.charCodeAt(a+1)&63),r=2):h<240?(n=(h&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),r=3):(r=4,n=(h&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),n-=65536,o=55296+(n>>>10&1023),n=56320+(n&1023)),o!==0&&(t[l++]=o&255,t[l++]=o>>>8,o=0),t[l++]=n%256,t[l++]=n>>>8;return t.slice(0,l).toString("ucs2")}function Av(e){return Fr(e,"binary").toString("utf8")}var ch="foo bar bazâð£",Wo=ht&&(Av(ch)==Fd(ch)&&Av||jv(ch)==Fd(ch)&&jv)||Fd,hc=ht?function(e){return Fr(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,a=0,r=0;n<e.length;)switch(a=e.charCodeAt(n++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,r=e.charCodeAt(n++)-56320+(a<<10),t.push(String.fromCharCode(240+(r>>18&7))),t.push(String.fromCharCode(144+(r>>12&63))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},bA=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(n){for(var a=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),r=0;r<e.length;++r)a=a.replace(e[r][0],e[r][1]);return a}}(),Hb=/(^\s|\s$|\n)/;function Tn(e,t){return"<"+e+(t.match(Hb)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function fc(e){return En(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Me(e,t,n){return"<"+e+(n!=null?fc(n):"")+(t!=null?(t.match(Hb)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function nx(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}function wA(e,t){switch(typeof e){case"string":var n=Me("vt:lpwstr",vt(e));return n=n.replace(/&quot;/g,"_x0022_"),n;case"number":return Me((e|0)==e?"vt:i4":"vt:r8",vt(String(e)));case"boolean":return Me("vt:bool",e?"true":"false")}if(e instanceof Date)return Me("vt:filetime",nx(e));throw new Error("Unable to serialize "+e)}var fn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ml=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ia={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function _A(e,t){for(var n=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),r=e[t+6]&15,l=5;l>=0;--l)r=r*256+e[t+l];return a==2047?r==0?n*(1/0):NaN:(a==0?a=-1022:(a-=1023,r+=Math.pow(2,52)),n*Math.pow(2,a-52)*r)}function TA(e,t,n){var a=(t<0||1/t==-1/0?1:0)<<7,r=0,l=0,o=a?-t:t;isFinite(o)?o==0?r=l=0:(r=Math.floor(Math.log(o)/Math.LN2),l=o*Math.pow(2,52-r),r<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?r=-1022:(l-=Math.pow(2,52),r+=1023)):(r=2047,l=isNaN(t)?26985:0);for(var h=0;h<=5;++h,l/=256)e[n+h]=l&255;e[n+6]=(r&15)<<4|l&15,e[n+7]=r>>4|a}var Dv=function(e){for(var t=[],n=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var r=0,l=e[0][a].length;r<l;r+=n)t.push.apply(t,e[0][a].slice(r,r+n));return t},Ov=ht?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Fr(t)})):Dv(e)}:Dv,Mv=function(e,t,n){for(var a=[],r=t;r<n;r+=2)a.push(String.fromCharCode(Bo(e,r)));return a.join("").replace(Ko,"")},Px=ht?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(Ko,""):Mv(e,t,n)}:Mv,Rv=function(e,t,n){for(var a=[],r=t;r<t+n;++r)a.push(("0"+e[r].toString(16)).slice(-2));return a.join("")},Pb=ht?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):Rv(e,t,n)}:Rv,Fv=function(e,t,n){for(var a=[],r=t;r<n;r++)a.push(String.fromCharCode(Zi(e,r)));return a.join("")},wc=ht?function(t,n,a){return Buffer.isBuffer(t)?t.toString("utf8",n,a):Fv(t,n,a)}:Fv,Ib=function(e,t){var n=la(e,t);return n>0?wc(e,t+4,t+4+n-1):""},zb=Ib,Ub=function(e,t){var n=la(e,t);return n>0?wc(e,t+4,t+4+n-1):""},Vb=Ub,Kb=function(e,t){var n=2*la(e,t);return n>0?wc(e,t+4,t+4+n-1):""},Wb=Kb,Gb=function(t,n){var a=la(t,n);return a>0?Px(t,n+4,n+4+a):""},Xb=Gb,Yb=function(e,t){var n=la(e,t);return n>0?wc(e,t+4,t+4+n):""},qb=Yb,$b=function(e,t){return _A(e,t)},Rh=$b,Ix=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ht&&(zb=function(t,n){if(!Buffer.isBuffer(t))return Ib(t,n);var a=t.readUInt32LE(n);return a>0?t.toString("utf8",n+4,n+4+a-1):""},Vb=function(t,n){if(!Buffer.isBuffer(t))return Ub(t,n);var a=t.readUInt32LE(n);return a>0?t.toString("utf8",n+4,n+4+a-1):""},Wb=function(t,n){if(!Buffer.isBuffer(t))return Kb(t,n);var a=2*t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+a-1)},Xb=function(t,n){if(!Buffer.isBuffer(t))return Gb(t,n);var a=t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+a)},qb=function(t,n){if(!Buffer.isBuffer(t))return Yb(t,n);var a=t.readUInt32LE(n);return t.toString("utf8",n+4,n+4+a)},Rh=function(t,n){return Buffer.isBuffer(t)?t.readDoubleLE(n):$b(t,n)},Ix=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Zi=function(e,t){return e[t]},Bo=function(e,t){return e[t+1]*256+e[t]},SA=function(e,t){var n=e[t+1]*256+e[t];return n<32768?n:(65535-n+1)*-1},la=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Xs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},NA=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Go(e,t){var n="",a,r,l=[],o,h,f,d;switch(t){case"dbcs":if(d=this.l,ht&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)n+=String.fromCharCode(Bo(this,d)),d+=2;e*=2;break;case"utf8":n=wc(this,this.l,this.l+e);break;case"utf16le":e*=2,n=Px(this,this.l,this.l+e);break;case"wstr":return Go.call(this,e,"dbcs");case"lpstr-ansi":n=zb(this,this.l),e=4+la(this,this.l);break;case"lpstr-cp":n=Vb(this,this.l),e=4+la(this,this.l);break;case"lpwstr":n=Wb(this,this.l),e=4+2*la(this,this.l);break;case"lpp4":e=4+la(this,this.l),n=Xb(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+la(this,this.l),n=qb(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,n="";(o=Zi(this,this.l+e++))!==0;)l.push(ih(o));n=l.join("");break;case"_wstr":for(e=0,n="";(o=Bo(this,this.l+e))!==0;)l.push(ih(o)),e+=2;e+=2,n=l.join("");break;case"dbcs-cont":for(n="",d=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Zi(this,d),this.l=d+1,h=Go.call(this,e-f,o?"dbcs-cont":"sbcs-cont"),l.join("")+h;l.push(ih(Bo(this,d))),d+=2}n=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(n="",d=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Zi(this,d),this.l=d+1,h=Go.call(this,e-f,o?"dbcs-cont":"sbcs-cont"),l.join("")+h;l.push(ih(Zi(this,d))),d+=1}n=l.join("");break;default:switch(e){case 1:return a=Zi(this,this.l),this.l++,a;case 2:return a=(t==="i"?SA:Bo)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?Xs:NA)(this,this.l),this.l+=4,a):(r=la(this,this.l),this.l+=4,r);case 8:case-8:if(t==="f")return e==8?r=Rh(this,this.l):r=Rh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:n=Pb(this,this.l,e);break}}return this.l+=e,n}var EA=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},CA=function(e,t,n){e[n]=t&255,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},kA=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255};function jA(e,t,n){var a=0,r=0;if(n==="dbcs"){for(r=0;r!=t.length;++r)kA(this,t.charCodeAt(r),this.l+2*r);a=2*t.length}else if(n==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=t.length;++r)this[this.l+r]=t.charCodeAt(r)&255;a=t.length}else if(n==="hex"){for(;r<e;++r)this[this.l++]=parseInt(t.slice(2*r,2*r+2),16)||0;return this}else if(n==="utf16le"){var l=Math.min(this.l+e,this.length);for(r=0;r<Math.min(t.length,e);++r){var o=t.charCodeAt(r);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,EA(this,t,this.l);break;case 8:if(a=8,n==="f"){TA(this,t,this.l);break}case 16:break;case-4:a=4,CA(this,t,this.l);break}return this.l+=a,this}function Qb(e,t){var n=Pb(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function sa(e,t){e.l=t,e.read_shift=Go,e.chk=Qb,e.write_shift=jA}function tr(e,t){e.l+=t}function be(e){var t=ni(e);return sa(t,0),t}function Yn(){var e=[],t=ht?256:2048,n=function(d){var g=be(d);return sa(g,0),g},a=n(t),r=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},l=function(d){return a&&d<a.length-a.l?a:(r(),a=n(Math.max(d+1,t)))},o=function(){return r(),_n(e)},h=function(d){r(),a=d,a.l==null&&(a.l=a.length),l(t)};return{next:l,push:h,end:o,_bufs:e}}function Ce(e,t,n,a){var r=+t,l;if(!isNaN(r)){a||(a=_M[r].p||(n||[]).length||0),l=1+(r>=128?1:0)+1,a>=128&&++l,a>=16384&&++l,a>=2097152&&++l;var o=e.next(l);r<=127?o.write_shift(1,r):(o.write_shift(1,(r&127)+128),o.write_shift(1,r>>7));for(var h=0;h!=4;++h)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&Ix(n)&&e.push(n)}}function Xo(e,t,n){var a=$n(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!n||n.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Lv(e,t,n){var a=$n(e);return a.s=Xo(a.s,t.s,n),a.e=Xo(a.e,t.s,n),a}function Yo(e,t){if(e.cRel&&e.c<0)for(e=$n(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=$n(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=bt(e);return!e.cRel&&e.cRel!=null&&(n=OA(n)),!e.rRel&&e.rRel!=null&&(n=AA(n)),n}function Ld(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Mn(e.s.c)+":"+(e.e.cRel?"":"$")+Mn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Nn(e.s.r)+":"+(e.e.rRel?"":"$")+Nn(e.e.r):Yo(e.s,t.biff)+":"+Yo(e.e,t.biff)}function zx(e){return parseInt(DA(e),10)-1}function Nn(e){return""+(e+1)}function AA(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function DA(e){return e.replace(/\$(\d+)$/,"$1")}function Ux(e){for(var t=MA(e),n=0,a=0;a!==t.length;++a)n=26*n+t.charCodeAt(a)-64;return n-1}function Mn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function OA(e){return e.replace(/^([A-Z])/,"$$$1")}function MA(e){return e.replace(/^\$([A-Z])/,"$1")}function RA(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function dn(e){for(var t=0,n=0,a=0;a<e.length;++a){var r=e.charCodeAt(a);r>=48&&r<=57?t=10*t+(r-48):r>=65&&r<=90&&(n=26*n+(r-64))}return{c:n-1,r:t-1}}function bt(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function ca(e){var t=e.indexOf(":");return t==-1?{s:dn(e),e:dn(e)}:{s:dn(e.slice(0,t)),e:dn(e.slice(t+1))}}function Qt(e,t){return typeof t>"u"||typeof t=="number"?Qt(e.s,e.e):(typeof e!="string"&&(e=bt(e)),typeof t!="string"&&(t=bt(t)),e==t?e:e+":"+t)}function Mt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,a=0,r=0,l=e.length;for(n=0;a<l&&!((r=e.charCodeAt(a)-64)<1||r>26);++a)n=26*n+r;for(t.s.c=--n,n=0;a<l&&!((r=e.charCodeAt(a)-48)<0||r>9);++a)n=10*n+r;if(t.s.r=--n,a===l||r!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,n=0;a!=l&&!((r=e.charCodeAt(a)-64)<1||r>26);++a)n=26*n+r;for(t.e.c=--n,n=0;a!=l&&!((r=e.charCodeAt(a)-48)<0||r>9);++a)n=10*n+r;return t.e.r=--n,t}function Bv(e,t){var n=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ms(e.z,n?qn(t):t)}catch{}try{return e.w=ms((e.XF||{}).numFmtId||(n?14:0),n?qn(t):t)}catch{return""+t}}function Mr(e,t,n){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),e.t=="e"?_c[e.v]||e.v:t==null?Bv(e,e.v):Bv(e,t))}function li(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",a={};return a[n]=e,{SheetNames:[n],Sheets:a}}function Zb(e,t,n){var a=n||{},r=e?Array.isArray(e):a.dense,l=e||(r?[]:{}),o=0,h=0;if(l&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var f=typeof a.origin=="string"?dn(a.origin):a.origin;o=f.r,h=f.c}l["!ref"]||(l["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var g=Mt(l["!ref"]);d.s.c=g.s.c,d.s.r=g.s.r,d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),o==-1&&(d.e.r=o=g.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=t[p].length;++y)if(!(typeof t[p][y]>"u")){var w={v:t[p][y]},_=o+p,b=h+y;if(d.s.r>_&&(d.s.r=_),d.s.c>b&&(d.s.c=b),d.e.r<_&&(d.e.r=_),d.e.c<b&&(d.e.c=b),t[p][y]&&typeof t[p][y]=="object"&&!Array.isArray(t[p][y])&&!(t[p][y]instanceof Date))w=t[p][y];else if(Array.isArray(w.v)&&(w.f=t[p][y][1],w.v=w.v[0]),w.v===null)if(w.f)w.t="n";else if(a.nullError)w.t="e",w.v=0;else if(a.sheetStubs)w.t="z";else continue;else typeof w.v=="number"?w.t="n":typeof w.v=="boolean"?w.t="b":w.v instanceof Date?(w.z=a.dateNF||Kt[14],a.cellDates?(w.t="d",w.w=ms(w.z,qn(w.v))):(w.t="n",w.v=qn(w.v),w.w=ms(w.z,w.v))):w.t="s";if(r)l[_]||(l[_]=[]),l[_][b]&&l[_][b].z&&(w.z=l[_][b].z),l[_][b]=w;else{var T=bt({c:b,r:_});l[T]&&l[T].z&&(w.z=l[T].z),l[T]=w}}}return d.s.c<1e7&&(l["!ref"]=Qt(d)),l}function pl(e,t){return Zb(null,e,t)}function FA(e){return e.read_shift(4,"i")}function Ba(e,t){return t||(t=be(4)),t.write_shift(4,e),t}function Rn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function xn(e,t){var n=!1;return t==null&&(n=!0,t=be(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function LA(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function BA(e,t){return t||(t=be(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Vx(e,t){var n=e.l,a=e.read_shift(1),r=Rn(e),l=[],o={t:r,h:r};if((a&1)!==0){for(var h=e.read_shift(4),f=0;f!=h;++f)l.push(LA(e));o.r=l}else o.r=[{ich:0,ifnt:0}];return e.l=n+t,o}function HA(e,t){var n=!1;return t==null&&(n=!0,t=be(15+4*e.t.length)),t.write_shift(1,0),xn(e.t,t),n?t.slice(0,t.l):t}var PA=Vx;function IA(e,t){var n=!1;return t==null&&(n=!0,t=be(23+4*e.t.length)),t.write_shift(1,1),xn(e.t,t),t.write_shift(4,1),BA({},t),n?t.slice(0,t.l):t}function Ca(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function oi(e,t){return t==null&&(t=be(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ci(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ui(e,t){return t==null&&(t=be(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var zA=Rn,Jb=xn;function Kx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Fh(e,t){var n=!1;return t==null&&(n=!0,t=be(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var UA=Rn,ax=Kx,Wx=Fh;function ew(e){var t=e.slice(e.l,e.l+4),n=t[0]&1,a=t[0]&2;e.l+=4;var r=a===0?Rh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Xs(t,0)>>2;return n?r/100:r}function tw(e,t){t==null&&(t=be(4));var n=0,a=0,r=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:r==(r|0)&&r>=-536870912&&r<1<<29&&(a=1,n=1),a)t.write_shift(-4,((n?r:e)<<2)+(n+2));else throw new Error("unsupported RkNumber "+e)}function nw(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function VA(e,t){return t||(t=be(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var hi=nw,yl=VA;function vl(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ai(e,t){return(t||be(8)).write_shift(8,e,"f")}function KA(e){var t={},n=e.read_shift(1),a=n>>>1,r=e.read_shift(1),l=e.read_shift(2,"i"),o=e.read_shift(1),h=e.read_shift(1),f=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=r;var d=JA[r];d&&(t.rgb=Yv(d));break;case 2:t.rgb=Yv([o,h,f]);break;case 3:t.theme=r;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function Lh(e,t){if(t||(t=be(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function WA(e){var t=e.read_shift(1);e.l++;var n={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return n}function GA(e,t){t||(t=be(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,n),t.write_shift(1,0),t}var aw=2,ra=3,uh=11,Bh=19,hh=64,XA=65,YA=71,qA=4108,$A=4126,wn=80,Hv={1:{n:"CodePage",t:aw},2:{n:"Category",t:wn},3:{n:"PresentationFormat",t:wn},4:{n:"ByteCount",t:ra},5:{n:"LineCount",t:ra},6:{n:"ParagraphCount",t:ra},7:{n:"SlideCount",t:ra},8:{n:"NoteCount",t:ra},9:{n:"HiddenCount",t:ra},10:{n:"MultimediaClipCount",t:ra},11:{n:"ScaleCrop",t:uh},12:{n:"HeadingPairs",t:qA},13:{n:"TitlesOfParts",t:$A},14:{n:"Manager",t:wn},15:{n:"Company",t:wn},16:{n:"LinksUpToDate",t:uh},17:{n:"CharacterCount",t:ra},19:{n:"SharedDoc",t:uh},22:{n:"HyperlinksChanged",t:uh},23:{n:"AppVersion",t:ra,p:"version"},24:{n:"DigSig",t:XA},26:{n:"ContentType",t:wn},27:{n:"ContentStatus",t:wn},28:{n:"Language",t:wn},29:{n:"Version",t:wn},255:{},2147483648:{n:"Locale",t:Bh},2147483651:{n:"Behavior",t:Bh},1919054434:{}},Pv={1:{n:"CodePage",t:aw},2:{n:"Title",t:wn},3:{n:"Subject",t:wn},4:{n:"Author",t:wn},5:{n:"Keywords",t:wn},6:{n:"Comments",t:wn},7:{n:"Template",t:wn},8:{n:"LastAuthor",t:wn},9:{n:"RevNumber",t:wn},10:{n:"EditTime",t:hh},11:{n:"LastPrinted",t:hh},12:{n:"CreatedDate",t:hh},13:{n:"ModifiedDate",t:hh},14:{n:"PageCount",t:ra},15:{n:"WordCount",t:ra},16:{n:"CharCount",t:ra},17:{n:"Thumbnail",t:YA},18:{n:"Application",t:wn},19:{n:"DocSecurity",t:ra},255:{},2147483648:{n:"Locale",t:Bh},2147483651:{n:"Behavior",t:Bh},1919054434:{}};function QA(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var ZA=QA([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),JA=$n(ZA),_c={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},e6={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},fh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function rw(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function sw(e,t){var n=uA(e6),a=[],r;a[a.length]=Zt,a[a.length]=Me("Types",null,{xmlns:fn.CT,"xmlns:xsd":fn.xsd,"xmlns:xsi":fn.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Me("Default",null,{Extension:f[0],ContentType:f[1]})}));var l=function(f){e[f]&&e[f].length>0&&(r=e[f][0],a[a.length]=Me("Override",null,{PartName:(r[0]=="/"?"":"/")+r,ContentType:fh[f][t.bookType]||fh[f].xlsx}))},o=function(f){(e[f]||[]).forEach(function(d){a[a.length]=Me("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:fh[f][t.bookType]||fh[f].xlsx})})},h=function(f){(e[f]||[]).forEach(function(d){a[a.length]=Me("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:n[f][0]})})};return l("workbooks"),o("sheets"),o("charts"),h("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(h),h("vba"),h("comments"),h("threadedcomments"),h("drawings"),o("metadata"),h("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var ct={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function iw(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function il(e){var t=[Zt,Me("Relationships",null,{xmlns:fn.RELS})];return En(e["!id"]).forEach(function(n){t[t.length]=Me("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function yt(e,t,n,a,r,l){if(r||(r={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,r.Id="rId"+t,r.Type=a,r.Target=n,[ct.HLINK,ct.XPATH,ct.XMISS].indexOf(r.Type)>-1&&(r.TargetMode="External"),e["!id"][r.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][r.Id]=r,e[("/"+r.Target).replace("//","/")]=r,t}function t6(e){var t=[Zt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Iv(e,t,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function n6(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function a6(e){var t=[Zt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=e.length;++n)t.push(Iv(e[n][0],e[n][1])),t.push(n6("",e[n][0]));return t.push(Iv("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function lw(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+jh.version+"</meta:generator></office:meta></office:document-meta>"}var Js=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Bd(e,t,n,a,r){r[e]!=null||t==null||t===""||(r[e]=t,t=vt(t),a[a.length]=n?Me(e,t,n):Tn(e,t))}function ow(e,t){var n=t||{},a=[Zt,Me("cp:coreProperties",null,{"xmlns:cp":fn.CORE_PROPS,"xmlns:dc":fn.dc,"xmlns:dcterms":fn.dcterms,"xmlns:dcmitype":fn.dcmitype,"xmlns:xsi":fn.xsi})],r={};if(!e&&!n.Props)return a.join("");e&&(e.CreatedDate!=null&&Bd("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:nx(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},a,r),e.ModifiedDate!=null&&Bd("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:nx(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},a,r));for(var l=0;l!=Js.length;++l){var o=Js[l],h=n.Props&&n.Props[o[1]]!=null?n.Props[o[1]]:e?e[o[1]]:null;h===!0?h="1":h===!1?h="0":typeof h=="number"&&(h=String(h)),h!=null&&Bd(o[0],h,null,a,r)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var ll=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],cw=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function uw(e){var t=[],n=Me;return e||(e={}),e.Application="SheetJS",t[t.length]=Zt,t[t.length]=Me("Properties",null,{xmlns:fn.EXT_PROPS,"xmlns:vt":fn.vt}),ll.forEach(function(a){if(e[a[1]]!==void 0){var r;switch(a[2]){case"string":r=vt(String(e[a[1]]));break;case"bool":r=e[a[1]]?"true":"false";break}r!==void 0&&(t[t.length]=n(a[0],r))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+vt(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function hw(e){var t=[Zt,Me("Properties",null,{xmlns:fn.CUST_PROPS,"xmlns:vt":fn.vt})];if(!e)return t.join("");var n=1;return En(e).forEach(function(r){++n,t[t.length]=Me("property",wA(e[r]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:vt(r)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var zv={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function r6(e,t){var n=[];return En(zv).map(function(a){for(var r=0;r<Js.length;++r)if(Js[r][1]==a)return Js[r];for(r=0;r<ll.length;++r)if(ll[r][1]==a)return ll[r];throw a}).forEach(function(a){if(e[a[1]]!=null){var r=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":r=new Date(r).toISOString().replace(/\.\d*Z/,"Z");break}typeof r=="number"?r=String(r):r===!0||r===!1?r=r?"1":"0":r instanceof Date&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"")),n.push(Tn(zv[a[1]]||a[1],r))}}),Me("DocumentProperties",n.join(""),{xmlns:ia.o})}function s6(e,t){var n=["Worksheets","SheetNames"],a="CustomDocumentProperties",r=[];return e&&En(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)){for(var o=0;o<Js.length;++o)if(l==Js[o][1])return;for(o=0;o<ll.length;++o)if(l==ll[o][1])return;for(o=0;o<n.length;++o)if(l==n[o])return;var h=e[l],f="string";typeof h=="number"?(f="float",h=String(h)):h===!0||h===!1?(f="boolean",h=h?"1":"0"):h=String(h),r.push(Me(kv(l),h,{"dt:dt":f}))}}),t&&En(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)&&!(e&&Object.prototype.hasOwnProperty.call(e,l))){var o=t[l],h="string";typeof o=="number"?(h="float",o=String(o)):o===!0||o===!1?(h="boolean",o=o?"1":"0"):o instanceof Date?(h="dateTime.tz",o=o.toISOString()):o=String(o),r.push(Me(kv(l),o,{"dt:dt":h}))}}),"<"+a+' xmlns="'+ia.o+'">'+r.join("")+"</"+a+">"}function i6(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,n=t.getTime()/1e3+11644473600,a=n%Math.pow(2,32),r=(n-a)/Math.pow(2,32);a*=1e7,r*=1e7;var l=a/Math.pow(2,32)|0;l>0&&(a=a%Math.pow(2,32),r+=l);var o=be(8);return o.write_shift(4,a),o.write_shift(4,r),o}function Uv(e,t){var n=be(4),a=be(4);switch(n.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=be(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=i6(t);break;case 31:case 80:for(a=be(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return _n([n,a])}var fw=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function l6(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Vv(e,t,n){var a=be(8),r=[],l=[],o=8,h=0,f=be(8),d=be(8);if(f.write_shift(4,2),f.write_shift(4,1200),d.write_shift(4,1),l.push(f),r.push(d),o+=8+f.length,!t){d=be(8),d.write_shift(4,0),r.unshift(d);var g=[be(4)];for(g[0].write_shift(4,e.length),h=0;h<e.length;++h){var p=e[h][0];for(f=be(8+2*(p.length+1)+(p.length%2?0:2)),f.write_shift(4,h+2),f.write_shift(4,p.length+1),f.write_shift(0,p,"dbcs");f.l!=f.length;)f.write_shift(1,0);g.push(f)}f=_n(g),l.unshift(f),o+=8+f.length}for(h=0;h<e.length;++h)if(!(t&&!t[e[h][0]])&&!(fw.indexOf(e[h][0])>-1||cw.indexOf(e[h][0])>-1)&&e[h][1]!=null){var y=e[h][1],w=0;if(t){w=+t[e[h][0]];var _=n[w];if(_.p=="version"&&typeof y=="string"){var b=y.split(".");y=(+b[0]<<16)+(+b[1]||0)}f=Uv(_.t,y)}else{var T=l6(y);T==-1&&(T=31,y=String(y)),f=Uv(T,y)}l.push(f),d=be(8),d.write_shift(4,t?w:2+h),r.push(d),o+=8+f.length}var S=8*(l.length+1);for(h=0;h<l.length;++h)r[h].write_shift(4,S),S+=l[h].length;return a.write_shift(4,o),a.write_shift(4,l.length),_n([a].concat(r).concat(l))}function Kv(e,t,n,a,r,l){var o=be(r?68:48),h=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,kt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,r?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,r?68:48);var f=Vv(e,n,a);if(h.push(f),r){var d=Vv(r,null,null);o.write_shift(16,l,"hex"),o.write_shift(4,68+f.length),h.push(d)}return _n(h)}function o6(e,t){t||(t=be(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}function c6(e,t){return e.read_shift(t)===1}function Hn(e,t){return t||(t=be(2)),t.write_shift(2,+!!e),t}function dw(e){return e.read_shift(2,"u")}function Ta(e,t){return t||(t=be(2)),t.write_shift(2,e),t}function xw(e,t,n){return n||(n=be(2)),n.write_shift(1,t=="e"?+e:+!!e),n.write_shift(1,t=="e"?1:0),n}function gw(e,t,n){var a=e.read_shift(n&&n.biff>=12?2:1),r="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var l=e.read_shift(1);l&&(r="dbcs-cont")}else n.biff==12&&(r="wstr");n.biff>=2&&n.biff<=5&&(r="cpstr");var o=a?e.read_shift(a,r):"";return o}function u6(e){var t=e.t||"",n=be(3);n.write_shift(2,t.length),n.write_shift(1,1);var a=be(2*t.length);a.write_shift(2*t.length,t,"utf16le");var r=[n,a];return _n(r)}function h6(e,t,n){var a;if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}var r=e.read_shift(1);return r===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function f6(e,t,n){var a=e.read_shift(n&&n.biff==2?1:2);return a===0?(e.l++,""):h6(e,a,n)}function d6(e,t,n){if(n.biff>5)return f6(e,t,n);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function mw(e,t,n){return n||(n=be(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function Wv(e,t){t||(t=be(6+e.length*2)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function x6(e){var t=be(512),n=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var r=a.indexOf("#"),l=r>-1?31:23;switch(a.charAt(0)){case"#":l=28;break;case".":l&=-3;break}t.write_shift(4,2),t.write_shift(4,l);var o=[8,6815827,6619237,4849780,83];for(n=0;n<o.length;++n)t.write_shift(4,o[n]);if(l==28)a=a.slice(1),Wv(a,t);else if(l&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<o.length;++n)t.write_shift(1,parseInt(o[n],16));var h=r>-1?a.slice(0,r):a;for(t.write_shift(4,2*(h.length+1)),n=0;n<h.length;++n)t.write_shift(2,h.charCodeAt(n));t.write_shift(2,0),l&8&&Wv(r>-1?a.slice(r+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<o.length;++n)t.write_shift(1,parseInt(o[n],16));for(var f=0;a.slice(f*3,f*3+3)=="../"||a.slice(f*3,f*3+3)=="..\\";)++f;for(t.write_shift(2,f),t.write_shift(4,a.length-3*f+1),n=0;n<a.length-3*f;++n)t.write_shift(1,a.charCodeAt(n+3*f)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function ri(e,t,n,a){return a||(a=be(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,n||0),a}function g6(e,t,n){var a=n.biff>8?4:2,r=e.read_shift(a),l=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[r,l,o]}function m6(e){var t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2);return{s:{c:a,r:t},e:{c:r,r:n}}}function pw(e,t){return t||(t=be(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Gx(e,t,n){var a=1536,r=16;switch(n.bookType){case"biff8":break;case"biff5":a=1280,r=8;break;case"biff4":a=4,r=6;break;case"biff3":a=3,r=6;break;case"biff2":a=2,r=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=be(r);return l.write_shift(2,a),l.write_shift(2,t),r>4&&l.write_shift(2,29282),r>6&&l.write_shift(2,1997),r>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function p6(e,t){var n=!t||t.biff==8,a=be(n?112:54);for(a.write_shift(t.biff==8?2:1,7),n&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(n?0:536870912));a.l<a.length;)a.write_shift(1,n?0:32);return a}function y6(e,t){var n=!t||t.biff>=8?2:1,a=be(8+n*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var r=a.slice(0,a.l);return r.l=a.l,r}function v6(e,t){var n=be(8);n.write_shift(4,e.Count),n.write_shift(4,e.Unique);for(var a=[],r=0;r<e.length;++r)a[r]=u6(e[r]);var l=_n([n].concat(a));return l.parts=[n.length].concat(a.map(function(o){return o.length})),l}function b6(){var e=be(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function w6(e){var t=be(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function _6(e,t){var n=e.name||"Arial",a=t&&t.biff==5,r=a?15+n.length:16+2*n.length,l=be(r);return l.write_shift(2,e.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,n.length),a||l.write_shift(1,1),l.write_shift((a?1:2)*n.length,n,a?"sbcs":"utf16le"),l}function T6(e,t,n,a){var r=be(10);return ri(e,t,a,r),r.write_shift(4,n),r}function S6(e,t,n,a,r){var l=!r||r.biff==8,o=be(8+ +l+(1+l)*n.length);return ri(e,t,a,o),o.write_shift(2,n.length),l&&o.write_shift(1,1),o.write_shift((1+l)*n.length,n,l?"utf16le":"sbcs"),o}function N6(e,t,n,a){var r=n&&n.biff==5;a||(a=be(r?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(r?1:2,t.length),r||a.write_shift(1,1),a.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le");var l=a.length>a.l?a.slice(0,a.l):a;return l.l==null&&(l.l=l.length),l}function E6(e,t){var n=t.biff==8||!t.biff?4:2,a=be(2*n+6);return a.write_shift(n,e.s.r),a.write_shift(n,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function Gv(e,t,n,a){var r=n&&n.biff==5;a||(a=be(r?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var l=0;return e.numFmtId>0&&r&&(l|=1024),a.write_shift(4,l),a.write_shift(4,0),r||a.write_shift(4,0),a.write_shift(2,0),a}function C6(e){var t=be(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function k6(e,t,n,a,r,l){var o=be(8);return ri(e,t,a,o),xw(n,l,o),o}function j6(e,t,n,a){var r=be(14);return ri(e,t,a,r),ai(n,r),r}function A6(e,t,n){if(n.biff<8)return D6(e,t,n);for(var a=[],r=e.l+t,l=e.read_shift(n.biff>8?4:2);l--!==0;)a.push(g6(e,n.biff>8?12:6,n));if(e.l!=r)throw new Error("Bad ExternSheet: "+e.l+" != "+r);return a}function D6(e,t,n){e[e.l+1]==3&&e[e.l]++;var a=gw(e,t,n);return a.charCodeAt(0)==3?a.slice(1):a}function O6(e){var t=be(2+e.length*8);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)pw(e[n],t);return t}function M6(e){var t=be(24),n=dn(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<16;++r)t.write_shift(1,parseInt(a[r],16));return _n([t,x6(e[1])])}function R6(e){var t=e[1].Tooltip,n=be(10+2*(t.length+1));n.write_shift(2,2048);var a=dn(e[0]);n.write_shift(2,a.r),n.write_shift(2,a.r),n.write_shift(2,a.c),n.write_shift(2,a.c);for(var r=0;r<t.length;++r)n.write_shift(2,t.charCodeAt(r));return n.write_shift(2,0),n}function F6(e){return e||(e=be(4)),e.write_shift(2,1),e.write_shift(2,1),e}function L6(e,t,n){if(!n.cellStyles)return tr(e,t);var a=n&&n.biff>=12?4:2,r=e.read_shift(a),l=e.read_shift(a),o=e.read_shift(a),h=e.read_shift(a),f=e.read_shift(2);a==2&&(e.l+=2);var d={s:r,e:l,w:o,ixfe:h,flags:f};return(n.biff>=5||!n.biff)&&(d.level=f>>8&7),d}function B6(e,t){var n=be(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,e.width*256),n.write_shift(2,0);var a=0;return e.hidden&&(a|=1),n.write_shift(1,a),a=e.level||0,n.write_shift(1,a),n.write_shift(2,0),n}function H6(e){for(var t=be(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}function P6(e,t,n){var a=be(15);return Sc(a,e,t),a.write_shift(8,n,"f"),a}function I6(e,t,n){var a=be(9);return Sc(a,e,t),a.write_shift(2,n),a}var z6=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Fx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(h,f){var d=[],g=ni(1);switch(f.type){case"base64":g=Fa(Or(h));break;case"binary":g=Fa(h);break;case"buffer":case"array":g=h;break}sa(g,0);var p=g.read_shift(1),y=!!(p&136),w=!1,_=!1;switch(p){case 2:break;case 3:break;case 48:w=!0,y=!0;break;case 49:w=!0,y=!0;break;case 131:break;case 139:break;case 140:_=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var b=0,T=521;p==2&&(b=g.read_shift(2)),g.l+=3,p!=2&&(b=g.read_shift(4)),b>1048576&&(b=1e6),p!=2&&(T=g.read_shift(2));var S=g.read_shift(2),E=f.codepage||1252;p!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(E=e[g[g.l]]),g.l+=1,g.l+=2),_&&(g.l+=36);for(var C=[],A={},F=Math.min(g.length,p==2?521:T-10-(w?264:0)),K=_?32:11;g.l<F&&g[g.l]!=13;)switch(A={},A.name=mv.utils.decode(E,g.slice(g.l,g.l+K)).replace(/[\u0000\r\n].*$/g,""),g.l+=K,A.type=String.fromCharCode(g.read_shift(1)),p!=2&&!_&&(A.offset=g.read_shift(4)),A.len=g.read_shift(1),p==2&&(A.offset=g.read_shift(2)),A.dec=g.read_shift(1),A.name.length&&C.push(A),p!=2&&(g.l+=_?13:14),A.type){case"B":(!w||A.len!=8)&&f.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+A.type)}if(g[g.l]!==13&&(g.l=T-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=T;var D=0,H=0;for(d[0]=[],H=0;H!=C.length;++H)d[0][H]=C[H].name;for(;b-- >0;){if(g[g.l]===42){g.l+=S;continue}for(++g.l,d[++D]=[],H=0,H=0;H!=C.length;++H){var M=g.slice(g.l,g.l+C[H].len);g.l+=C[H].len,sa(M,0);var B=mv.utils.decode(E,M);switch(C[H].type){case"C":B.trim().length&&(d[D][H]=B.replace(/\s+$/,""));break;case"D":B.length===8?d[D][H]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):d[D][H]=B;break;case"F":d[D][H]=parseFloat(B.trim());break;case"+":case"I":d[D][H]=_?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":d[D][H]=!0;break;case"N":case"F":d[D][H]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));d[D][H]="##MEMO##"+(_?parseInt(B.trim(),10):M.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(d[D][H]=+B||0);break;case"@":d[D][H]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":d[D][H]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":d[D][H]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[D][H]=-M.read_shift(-8,"f");break;case"B":if(w&&C[H].len==8){d[D][H]=M.read_shift(8,"f");break}case"G":case"P":M.l+=C[H].len;break;case"0":if(C[H].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[H].type)}}}if(p!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=C,d}function a(h,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var g=pl(n(h,d),d);return g["!cols"]=d.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete d.DBF,g}function r(h,f){try{return li(a(h,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function o(h,f){var d=f||{};if(+d.codepage>=0&&oc(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var g=Yn(),p=Uh(h,{header:1,raw:!0,cellDates:!0}),y=p[0],w=p.slice(1),_=h["!cols"]||[],b=0,T=0,S=0,E=1;for(b=0;b<y.length;++b){if(((_[b]||{}).DBF||{}).name){y[b]=_[b].DBF.name,++S;continue}if(y[b]!=null){if(++S,typeof y[b]=="number"&&(y[b]=y[b].toString(10)),typeof y[b]!="string")throw new Error("DBF Invalid column name "+y[b]+" |"+typeof y[b]+"|");if(y.indexOf(y[b])!==b){for(T=0;T<1024;++T)if(y.indexOf(y[b]+"_"+T)==-1){y[b]+="_"+T;break}}}}var C=Mt(h["!ref"]),A=[],F=[],K=[];for(b=0;b<=C.e.c-C.s.c;++b){var D="",H="",M=0,B=[];for(T=0;T<w.length;++T)w[T][b]!=null&&B.push(w[T][b]);if(B.length==0||y[b]==null){A[b]="?";continue}for(T=0;T<B.length;++T){switch(typeof B[T]){case"number":H="B";break;case"string":H="C";break;case"boolean":H="L";break;case"object":H=B[T]instanceof Date?"D":"C";break;default:H="C"}M=Math.max(M,String(B[T]).length),D=D&&D!=H?"C":H}M>250&&(M=250),H=((_[b]||{}).DBF||{}).type,H=="C"&&_[b].DBF.len>M&&(M=_[b].DBF.len),D=="B"&&H=="N"&&(D="N",K[b]=_[b].DBF.dec,M=_[b].DBF.len),F[b]=D=="C"||H=="N"?M:l[D]||0,E+=F[b],A[b]=D}var I=g.next(32);for(I.write_shift(4,318902576),I.write_shift(4,w.length),I.write_shift(2,296+32*S),I.write_shift(2,E),b=0;b<4;++b)I.write_shift(4,0);for(I.write_shift(4,0|(+t[vb]||3)<<8),b=0,T=0;b<y.length;++b)if(y[b]!=null){var te=g.next(32),q=(y[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);te.write_shift(1,q,"sbcs"),te.write_shift(1,A[b]=="?"?"C":A[b],"sbcs"),te.write_shift(4,T),te.write_shift(1,F[b]||l[A[b]]||0),te.write_shift(1,K[b]||0),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(1,0),te.write_shift(4,0),te.write_shift(4,0),T+=F[b]||l[A[b]]||0}var ae=g.next(264);for(ae.write_shift(4,13),b=0;b<65;++b)ae.write_shift(4,0);for(b=0;b<w.length;++b){var re=g.next(E);for(re.write_shift(1,0),T=0;T<y.length;++T)if(y[T]!=null)switch(A[T]){case"L":re.write_shift(1,w[b][T]==null?63:w[b][T]?84:70);break;case"B":re.write_shift(8,w[b][T]||0,"f");break;case"N":var ee="0";for(typeof w[b][T]=="number"&&(ee=w[b][T].toFixed(K[T]||0)),S=0;S<F[T]-ee.length;++S)re.write_shift(1,32);re.write_shift(1,ee,"sbcs");break;case"D":w[b][T]?(re.write_shift(4,("0000"+w[b][T].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(w[b][T].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+w[b][T].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var Q=String(w[b][T]!=null?w[b][T]:"").slice(0,F[T]);for(re.write_shift(1,Q,"sbcs"),S=0;S<F[T]-Q.length;++S)re.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:r,to_sheet:a,from_sheet:o}}(),U6=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+En(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(y,w){var _=e[w];return typeof _=="number"?gv(_):_},a=function(y,w,_){var b=w.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return b==59?y:gv(b)};e["|"]=254;function r(y,w){switch(w.type){case"base64":return l(Or(y),w);case"binary":return l(y,w);case"buffer":return l(ht&&Buffer.isBuffer(y)?y.toString("binary"):vc(y),w);case"array":return l(nf(y),w)}throw new Error("Unrecognized type "+w.type)}function l(y,w){var _=y.split(/[\n\r]+/),b=-1,T=-1,S=0,E=0,C=[],A=[],F=null,K={},D=[],H=[],M=[],B=0,I;for(+w.codepage>=0&&oc(+w.codepage);S!==_.length;++S){B=0;var te=_[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,n),q=te.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),ae=q[0],re;if(te.length>0)switch(ae){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&A.push(te.slice(3).replace(/;;/g,";"));break;case"C":var ee=!1,Q=!1,pe=!1,ye=!1,Y=-1,de=-1;for(E=1;E<q.length;++E)switch(q[E].charAt(0)){case"A":break;case"X":T=parseInt(q[E].slice(1))-1,Q=!0;break;case"Y":for(b=parseInt(q[E].slice(1))-1,Q||(T=0),I=C.length;I<=b;++I)C[I]=[];break;case"K":re=q[E].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(jr(re))?isNaN(uc(re).getDate())||(re=Pn(re)):(re=jr(re),F!==null&&Db(F)&&(re=Fb(re))),ee=!0;break;case"E":ye=!0;var P=I5(q[E].slice(1),{r:b,c:T});C[b][T]=[C[b][T],P];break;case"S":pe=!0,C[b][T]=[C[b][T],"S5S"];break;case"G":break;case"R":Y=parseInt(q[E].slice(1))-1;break;case"C":de=parseInt(q[E].slice(1))-1;break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+te)}if(ee&&(C[b][T]&&C[b][T].length==2?C[b][T][0]=re:C[b][T]=re,F=null),pe){if(ye)throw new Error("SYLK shared formula cannot have own formula");var Z=Y>-1&&C[Y][de];if(!Z||!Z[1])throw new Error("SYLK shared formula cannot find base");C[b][T][1]=z5(Z[1],{r:b-Y,c:T-de})}break;case"F":var k=0;for(E=1;E<q.length;++E)switch(q[E].charAt(0)){case"X":T=parseInt(q[E].slice(1))-1,++k;break;case"Y":for(b=parseInt(q[E].slice(1))-1,I=C.length;I<=b;++I)C[I]=[];break;case"M":B=parseInt(q[E].slice(1))/20;break;case"F":break;case"G":break;case"P":F=A[parseInt(q[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=q[E].slice(1).split(" "),I=parseInt(M[0],10);I<=parseInt(M[1],10);++I)B=parseInt(M[2],10),H[I-1]=B===0?{hidden:!0}:{wch:B},Xx(H[I-1]);break;case"C":T=parseInt(q[E].slice(1))-1,H[T]||(H[T]={});break;case"R":b=parseInt(q[E].slice(1))-1,D[b]||(D[b]={}),B>0?(D[b].hpt=B,D[b].hpx=_w(B)):B===0&&(D[b].hidden=!0);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+te)}k<1&&(F=null);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+te)}}return D.length>0&&(K["!rows"]=D),H.length>0&&(K["!cols"]=H),w&&w.sheetRows&&(C=C.slice(0,w.sheetRows)),[C,K]}function o(y,w){var _=r(y,w),b=_[0],T=_[1],S=pl(b,w);return En(T).forEach(function(E){S[E]=T[E]}),S}function h(y,w){return li(o(y,w),w)}function f(y,w,_,b){var T="C;Y"+(_+1)+";X"+(b+1)+";K";switch(y.t){case"n":T+=y.v||0,y.f&&!y.F&&(T+=";E"+qx(y.f,{r:_,c:b}));break;case"b":T+=y.v?"TRUE":"FALSE";break;case"e":T+=y.w||y.v;break;case"d":T+='"'+(y.w||y.v)+'"';break;case"s":T+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function d(y,w){w.forEach(function(_,b){var T="F;W"+(b+1)+" "+(b+1)+" ";_.hidden?T+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=Hh(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=Ph(_.wpx)),typeof _.wch=="number"&&(T+=Math.round(_.wch))),T.charAt(T.length-1)!=" "&&y.push(T)})}function g(y,w){w.forEach(function(_,b){var T="F;";_.hidden?T+="M0;":_.hpt?T+="M"+20*_.hpt+";":_.hpx&&(T+="M"+20*Ih(_.hpx)+";"),T.length>2&&y.push(T+"R"+(b+1))})}function p(y,w){var _=["ID;PWXL;N;E"],b=[],T=Mt(y["!ref"]),S,E=Array.isArray(y),C=`\r
`;_.push("P;PGeneral"),_.push("F;P0;DG0G8;M255"),y["!cols"]&&d(_,y["!cols"]),y["!rows"]&&g(_,y["!rows"]),_.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" "));for(var A=T.s.r;A<=T.e.r;++A)for(var F=T.s.c;F<=T.e.c;++F){var K=bt({r:A,c:F});S=E?(y[A]||[])[F]:y[K],!(!S||S.v==null&&(!S.f||S.F))&&b.push(f(S,y,A,F))}return _.join(C)+C+b.join(C)+C+"E"+C}return{to_workbook:h,to_sheet:o,from_sheet:p}}(),V6=function(){function e(l,o){switch(o.type){case"base64":return t(Or(l),o);case"binary":return t(l,o);case"buffer":return t(ht&&Buffer.isBuffer(l)?l.toString("binary"):vc(l),o);case"array":return t(nf(l),o)}throw new Error("Unrecognized type "+o.type)}function t(l,o){for(var h=l.split(`
`),f=-1,d=-1,g=0,p=[];g!==h.length;++g){if(h[g].trim()==="BOT"){p[++f]=[],d=0;continue}if(!(f<0)){var y=h[g].trim().split(","),w=y[0],_=y[1];++g;for(var b=h[g]||"";(b.match(/["]/g)||[]).length&1&&g<h.length-1;)b+=`
`+h[++g];switch(b=b.trim(),+w){case-1:if(b==="BOT"){p[++f]=[],d=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?p[f][d]=!0:b==="FALSE"?p[f][d]=!1:isNaN(jr(_))?isNaN(uc(_).getDate())?p[f][d]=_:p[f][d]=Pn(_):p[f][d]=jr(_),++d;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),p[f][d++]=b!==""?b:null;break}if(b==="EOD")break}}return o&&o.sheetRows&&(p=p.slice(0,o.sheetRows)),p}function n(l,o){return pl(e(l,o),o)}function a(l,o){return li(n(l,o),o)}var r=function(){var l=function(f,d,g,p,y){f.push(d),f.push(g+","+p),f.push('"'+y.replace(/"/g,'""')+'"')},o=function(f,d,g,p){f.push(d+","+g),f.push(d==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(f){var d=[],g=Mt(f["!ref"]),p,y=Array.isArray(f);l(d,"TABLE",0,1,"sheetjs"),l(d,"VECTORS",0,g.e.r-g.s.r+1,""),l(d,"TUPLES",0,g.e.c-g.s.c+1,""),l(d,"DATA",0,0,"");for(var w=g.s.r;w<=g.e.r;++w){o(d,-1,0,"BOT");for(var _=g.s.c;_<=g.e.c;++_){var b=bt({r:w,c:_});if(p=y?(f[w]||[])[_]:f[b],!p){o(d,1,0,"");continue}switch(p.t){case"n":var T=p.w;!T&&p.v!=null&&(T=p.v),T==null?p.f&&!p.F?o(d,1,0,"="+p.f):o(d,1,0,""):o(d,0,T,"V");break;case"b":o(d,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=ms(p.z||Kt[14],qn(Pn(p.v)))),o(d,0,p.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var S=`\r
`,E=d.join(S);return E}}();return{to_workbook:a,to_sheet:n,from_sheet:r}}(),yw=function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(p,y){for(var w=p.split(`
`),_=-1,b=-1,T=0,S=[];T!==w.length;++T){var E=w[T].trim().split(":");if(E[0]==="cell"){var C=dn(E[1]);if(S.length<=C.r)for(_=S.length;_<=C.r;++_)S[_]||(S[_]=[]);switch(_=C.r,b=C.c,E[2]){case"t":S[_][b]=e(E[3]);break;case"v":S[_][b]=+E[3];break;case"vtf":var A=E[E.length-1];case"vtc":switch(E[3]){case"nl":S[_][b]=!!+E[4];break;default:S[_][b]=+E[4];break}E[2]=="vtf"&&(S[_][b]=[S[_][b],A])}}}return y&&y.sheetRows&&(S=S.slice(0,y.sheetRows)),S}function a(p,y){return pl(n(p,y),y)}function r(p,y){return li(a(p,y),y)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,h=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(p){if(!p||!p["!ref"])return"";for(var y=[],w=[],_,b="",T=ca(p["!ref"]),S=Array.isArray(p),E=T.s.r;E<=T.e.r;++E)for(var C=T.s.c;C<=T.e.c;++C)if(b=bt({r:E,c:C}),_=S?(p[E]||[])[C]:p[b],!(!_||_.v==null||_.t==="z")){switch(w=["cell",b,"t"],_.t){case"s":case"str":w.push(t(_.v));break;case"n":_.f?(w[2]="vtf",w[3]="n",w[4]=_.v,w[5]=t(_.f)):(w[2]="v",w[3]=_.v);break;case"b":w[2]="vt"+(_.f?"f":"c"),w[3]="nl",w[4]=_.v?"1":"0",w[5]=t(_.f||(_.v?"TRUE":"FALSE"));break;case"d":var A=qn(Pn(_.v));w[2]="vtc",w[3]="nd",w[4]=""+A,w[5]=_.w||ms(_.z||Kt[14],A);break;case"e":continue}y.push(w.join(":"))}return y.push("sheet:c:"+(T.e.c-T.s.c+1)+":r:"+(T.e.r-T.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function g(p){return[l,o,h,o,d(p),f].join(`
`)}return{to_workbook:r,to_sheet:a,from_sheet:g}}(),K6=function(){function e(g,p,y,w,_){_.raw?p[y][w]=g:g===""||(g==="TRUE"?p[y][w]=!0:g==="FALSE"?p[y][w]=!1:isNaN(jr(g))?isNaN(uc(g).getDate())?p[y][w]=g:p[y][w]=Pn(g):p[y][w]=jr(g))}function t(g,p){var y=p||{},w=[];if(!g||g.length===0)return w;for(var _=g.split(/[\r\n]/),b=_.length-1;b>=0&&_[b].length===0;)--b;for(var T=10,S=0,E=0;E<=b;++E)S=_[E].indexOf(" "),S==-1?S=_[E].length:S++,T=Math.max(T,S);for(E=0;E<=b;++E){w[E]=[];var C=0;for(e(_[E].slice(0,T).trim(),w,E,C,y),C=1;C<=(_[E].length-T)/10+1;++C)e(_[E].slice(T+(C-1)*10,T+C*10).trim(),w,E,C,y)}return y.sheetRows&&(w=w.slice(0,y.sheetRows)),w}var n={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function r(g){for(var p={},y=!1,w=0,_=0;w<g.length;++w)(_=g.charCodeAt(w))==34?y=!y:!y&&_ in n&&(p[_]=(p[_]||0)+1);_=[];for(w in p)Object.prototype.hasOwnProperty.call(p,w)&&_.push([p[w],w]);if(!_.length){p=a;for(w in p)Object.prototype.hasOwnProperty.call(p,w)&&_.push([p[w],w])}return _.sort(function(b,T){return b[0]-T[0]||a[b[1]]-a[T[1]]}),n[_.pop()[1]]||44}function l(g,p){var y=p||{},w="",_=y.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(w=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(w=g.charAt(4),g=g.slice(6)):w=r(g.slice(0,1024)):y&&y.FS?w=y.FS:w=r(g.slice(0,1024));var T=0,S=0,E=0,C=0,A=0,F=w.charCodeAt(0),K=!1,D=0,H=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var M=y.dateNF!=null?iA(y.dateNF):null;function B(){var I=g.slice(C,A),te={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)te.t="z";else if(y.raw)te.t="s",te.v=I;else if(I.trim().length===0)te.t="s",te.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(te.t="s",te.v=I.slice(2,-1).replace(/""/g,'"')):U5(I)?(te.t="n",te.f=I.slice(1)):(te.t="s",te.v=I);else if(I=="TRUE")te.t="b",te.v=!0;else if(I=="FALSE")te.t="b",te.v=!1;else if(!isNaN(E=jr(I)))te.t="n",y.cellText!==!1&&(te.w=I),te.v=E;else if(!isNaN(uc(I).getDate())||M&&I.match(M)){te.z=y.dateNF||Kt[14];var q=0;M&&I.match(M)&&(I=lA(I,y.dateNF,I.match(M)||[]),q=1),y.cellDates?(te.t="d",te.v=Pn(I,q)):(te.t="n",te.v=qn(Pn(I,q))),y.cellText!==!1&&(te.w=ms(te.z,te.v instanceof Date?qn(te.v):te.v)),y.cellNF||delete te.z}else te.t="s",te.v=I;if(te.t=="z"||(y.dense?(_[T]||(_[T]=[]),_[T][S]=te):_[bt({c:S,r:T})]=te),C=A+1,H=g.charCodeAt(C),b.e.c<S&&(b.e.c=S),b.e.r<T&&(b.e.r=T),D==F)++S;else if(S=0,++T,y.sheetRows&&y.sheetRows<=T)return!0}e:for(;A<g.length;++A)switch(D=g.charCodeAt(A)){case 34:H===34&&(K=!K);break;case F:case 10:case 13:if(!K&&B())break e;break}return A-C>0&&B(),_["!ref"]=Qt(b),_}function o(g,p){return!(p&&p.PRN)||p.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?l(g,p):pl(t(g,p),p)}function h(g,p){var y="",w=p.type=="string"?[0,0,0,0]:nR(g,p);switch(p.type){case"base64":y=Or(g);break;case"binary":y=g;break;case"buffer":p.codepage==65001?y=g.toString("utf8"):(p.codepage,y=ht&&Buffer.isBuffer(g)?g.toString("binary"):vc(g));break;case"array":y=nf(g);break;case"string":y=g;break;default:throw new Error("Unrecognized type "+p.type)}return w[0]==239&&w[1]==187&&w[2]==191?y=Wo(y.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?y=Wo(y):p.type=="binary",y.slice(0,19)=="socialcalc:version:"?yw.to_sheet(p.type=="string"?y:Wo(y),p):o(y,p)}function f(g,p){return li(h(g,p),p)}function d(g){for(var p=[],y=Mt(g["!ref"]),w,_=Array.isArray(g),b=y.s.r;b<=y.e.r;++b){for(var T=[],S=y.s.c;S<=y.e.c;++S){var E=bt({r:b,c:S});if(w=_?(g[b]||[])[S]:g[E],!w||w.v==null){T.push("          ");continue}for(var C=(w.w||(Mr(w),w.w)||"").slice(0,10);C.length<10;)C+=" ";T.push(C+(S===0?" ":""))}p.push(T.join(""))}return p.join(`
`)}return{to_workbook:f,to_sheet:h,from_sheet:d}}(),Xv=function(){function e(P,Z,k){if(P){sa(P,P.l||0);for(var V=k.Enum||Y;P.l<P.length;){var U=P.read_shift(2),Te=V[U]||V[65535],ie=P.read_shift(2),we=P.l+ie,Ne=Te.f&&Te.f(P,ie,k);if(P.l=we,Z(Ne,Te,U))return}}}function t(P,Z){switch(Z.type){case"base64":return n(Fa(Or(P)),Z);case"binary":return n(Fa(P),Z);case"buffer":case"array":return n(P,Z)}throw"Unsupported type "+Z.type}function n(P,Z){if(!P)return P;var k=Z||{},V=k.dense?[]:{},U="Sheet1",Te="",ie=0,we={},Ne=[],ze=[],Ue={s:{r:0,c:0},e:{r:0,c:0}},rt=k.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)k.Enum=Y,e(P,function(Fe,ft,Jt){switch(Jt){case 0:k.vers=Fe,Fe>=4096&&(k.qpro=!0);break;case 6:Ue=Fe;break;case 204:Fe&&(Te=Fe);break;case 222:Te=Fe;break;case 15:case 51:k.qpro||(Fe[1].v=Fe[1].v.slice(1));case 13:case 14:case 16:Jt==14&&(Fe[2]&112)==112&&(Fe[2]&15)>1&&(Fe[2]&15)<15&&(Fe[1].z=k.dateNF||Kt[14],k.cellDates&&(Fe[1].t="d",Fe[1].v=Fb(Fe[1].v))),k.qpro&&Fe[3]>ie&&(V["!ref"]=Qt(Ue),we[U]=V,Ne.push(U),V=k.dense?[]:{},Ue={s:{r:0,c:0},e:{r:0,c:0}},ie=Fe[3],U=Te||"Sheet"+(ie+1),Te="");var Fn=k.dense?(V[Fe[0].r]||[])[Fe[0].c]:V[bt(Fe[0])];if(Fn){Fn.t=Fe[1].t,Fn.v=Fe[1].v,Fe[1].z!=null&&(Fn.z=Fe[1].z),Fe[1].f!=null&&(Fn.f=Fe[1].f);break}k.dense?(V[Fe[0].r]||(V[Fe[0].r]=[]),V[Fe[0].r][Fe[0].c]=Fe[1]):V[bt(Fe[0])]=Fe[1];break}},k);else if(P[2]==26||P[2]==14)k.Enum=de,P[2]==14&&(k.qpro=!0,P.l=0),e(P,function(Fe,ft,Jt){switch(Jt){case 204:U=Fe;break;case 22:Fe[1].v=Fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Fe[3]>ie&&(V["!ref"]=Qt(Ue),we[U]=V,Ne.push(U),V=k.dense?[]:{},Ue={s:{r:0,c:0},e:{r:0,c:0}},ie=Fe[3],U="Sheet"+(ie+1)),rt>0&&Fe[0].r>=rt)break;k.dense?(V[Fe[0].r]||(V[Fe[0].r]=[]),V[Fe[0].r][Fe[0].c]=Fe[1]):V[bt(Fe[0])]=Fe[1],Ue.e.c<Fe[0].c&&(Ue.e.c=Fe[0].c),Ue.e.r<Fe[0].r&&(Ue.e.r=Fe[0].r);break;case 27:Fe[14e3]&&(ze[Fe[14e3][0]]=Fe[14e3][1]);break;case 1537:ze[Fe[0]]=Fe[1],Fe[0]==ie&&(U=Fe[1]);break}},k);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(V["!ref"]=Qt(Ue),we[Te||U]=V,Ne.push(Te||U),!ze.length)return{SheetNames:Ne,Sheets:we};for(var Ye={},rn=[],xt=0;xt<ze.length;++xt)we[Ne[xt]]?(rn.push(ze[xt]||Ne[xt]),Ye[ze[xt]]=we[ze[xt]]||we[Ne[xt]]):(rn.push(ze[xt]),Ye[ze[xt]]={"!ref":"A1"});return{SheetNames:rn,Sheets:Ye}}function a(P,Z){var k=Z||{};if(+k.codepage>=0&&oc(+k.codepage),k.type=="string")throw new Error("Cannot write WK1 to JS string");var V=Yn(),U=Mt(P["!ref"]),Te=Array.isArray(P),ie=[];Re(V,0,l(1030)),Re(V,6,f(U));for(var we=Math.min(U.e.r,8191),Ne=U.s.r;Ne<=we;++Ne)for(var ze=Nn(Ne),Ue=U.s.c;Ue<=U.e.c;++Ue){Ne===U.s.r&&(ie[Ue]=Mn(Ue));var rt=ie[Ue]+ze,Ye=Te?(P[Ne]||[])[Ue]:P[rt];if(!(!Ye||Ye.t=="z"))if(Ye.t=="n")(Ye.v|0)==Ye.v&&Ye.v>=-32768&&Ye.v<=32767?Re(V,13,w(Ne,Ue,Ye.v)):Re(V,14,b(Ne,Ue,Ye.v));else{var rn=Mr(Ye);Re(V,15,p(Ne,Ue,rn.slice(0,239)))}}return Re(V,1),V.end()}function r(P,Z){var k=Z||{};if(+k.codepage>=0&&oc(+k.codepage),k.type=="string")throw new Error("Cannot write WK3 to JS string");var V=Yn();Re(V,0,o(P));for(var U=0,Te=0;U<P.SheetNames.length;++U)(P.Sheets[P.SheetNames[U]]||{})["!ref"]&&Re(V,27,ye(P.SheetNames[U],Te++));var ie=0;for(U=0;U<P.SheetNames.length;++U){var we=P.Sheets[P.SheetNames[U]];if(!(!we||!we["!ref"])){for(var Ne=Mt(we["!ref"]),ze=Array.isArray(we),Ue=[],rt=Math.min(Ne.e.r,8191),Ye=Ne.s.r;Ye<=rt;++Ye)for(var rn=Nn(Ye),xt=Ne.s.c;xt<=Ne.e.c;++xt){Ye===Ne.s.r&&(Ue[xt]=Mn(xt));var Fe=Ue[xt]+rn,ft=ze?(we[Ye]||[])[xt]:we[Fe];if(!(!ft||ft.t=="z"))if(ft.t=="n")Re(V,23,B(Ye,xt,ie,ft.v));else{var Jt=Mr(ft);Re(V,22,D(Ye,xt,ie,Jt.slice(0,239)))}}++ie}}return Re(V,1),V.end()}function l(P){var Z=be(2);return Z.write_shift(2,P),Z}function o(P){var Z=be(26);Z.write_shift(2,4096),Z.write_shift(2,4),Z.write_shift(4,0);for(var k=0,V=0,U=0,Te=0;Te<P.SheetNames.length;++Te){var ie=P.SheetNames[Te],we=P.Sheets[ie];if(!(!we||!we["!ref"])){++U;var Ne=ca(we["!ref"]);k<Ne.e.r&&(k=Ne.e.r),V<Ne.e.c&&(V=Ne.e.c)}}return k>8191&&(k=8191),Z.write_shift(2,k),Z.write_shift(1,U),Z.write_shift(1,V),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(1,1),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(4,0),Z}function h(P,Z,k){var V={s:{c:0,r:0},e:{c:0,r:0}};return Z==8&&k.qpro?(V.s.c=P.read_shift(1),P.l++,V.s.r=P.read_shift(2),V.e.c=P.read_shift(1),P.l++,V.e.r=P.read_shift(2),V):(V.s.c=P.read_shift(2),V.s.r=P.read_shift(2),Z==12&&k.qpro&&(P.l+=2),V.e.c=P.read_shift(2),V.e.r=P.read_shift(2),Z==12&&k.qpro&&(P.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function f(P){var Z=be(8);return Z.write_shift(2,P.s.c),Z.write_shift(2,P.s.r),Z.write_shift(2,P.e.c),Z.write_shift(2,P.e.r),Z}function d(P,Z,k){var V=[{c:0,r:0},{t:"n",v:0},0,0];return k.qpro&&k.vers!=20768?(V[0].c=P.read_shift(1),V[3]=P.read_shift(1),V[0].r=P.read_shift(2),P.l+=2):(V[2]=P.read_shift(1),V[0].c=P.read_shift(2),V[0].r=P.read_shift(2)),V}function g(P,Z,k){var V=P.l+Z,U=d(P,Z,k);if(U[1].t="s",k.vers==20768){P.l++;var Te=P.read_shift(1);return U[1].v=P.read_shift(Te,"utf8"),U}return k.qpro&&P.l++,U[1].v=P.read_shift(V-P.l,"cstr"),U}function p(P,Z,k){var V=be(7+k.length);V.write_shift(1,255),V.write_shift(2,Z),V.write_shift(2,P),V.write_shift(1,39);for(var U=0;U<V.length;++U){var Te=k.charCodeAt(U);V.write_shift(1,Te>=128?95:Te)}return V.write_shift(1,0),V}function y(P,Z,k){var V=d(P,Z,k);return V[1].v=P.read_shift(2,"i"),V}function w(P,Z,k){var V=be(7);return V.write_shift(1,255),V.write_shift(2,Z),V.write_shift(2,P),V.write_shift(2,k,"i"),V}function _(P,Z,k){var V=d(P,Z,k);return V[1].v=P.read_shift(8,"f"),V}function b(P,Z,k){var V=be(13);return V.write_shift(1,255),V.write_shift(2,Z),V.write_shift(2,P),V.write_shift(8,k,"f"),V}function T(P,Z,k){var V=P.l+Z,U=d(P,Z,k);if(U[1].v=P.read_shift(8,"f"),k.qpro)P.l=V;else{var Te=P.read_shift(2);A(P.slice(P.l,P.l+Te),U),P.l+=Te}return U}function S(P,Z,k){var V=Z&32768;return Z&=-32769,Z=(V?P:0)+(Z>=8192?Z-16384:Z),(V?"":"$")+(k?Mn(Z):Nn(Z))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function A(P,Z){sa(P,0);for(var k=[],V=0,U="",Te="",ie="",we="";P.l<P.length;){var Ne=P[P.l++];switch(Ne){case 0:k.push(P.read_shift(8,"f"));break;case 1:Te=S(Z[0].c,P.read_shift(2),!0),U=S(Z[0].r,P.read_shift(2),!1),k.push(Te+U);break;case 2:{var ze=S(Z[0].c,P.read_shift(2),!0),Ue=S(Z[0].r,P.read_shift(2),!1);Te=S(Z[0].c,P.read_shift(2),!0),U=S(Z[0].r,P.read_shift(2),!1),k.push(ze+Ue+":"+Te+U)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:k.push("("+k.pop()+")");break;case 5:k.push(P.read_shift(2));break;case 6:{for(var rt="";Ne=P[P.l++];)rt+=String.fromCharCode(Ne);k.push('"'+rt.replace(/"/g,'""')+'"')}break;case 8:k.push("-"+k.pop());break;case 23:k.push("+"+k.pop());break;case 22:k.push("NOT("+k.pop()+")");break;case 20:case 21:we=k.pop(),ie=k.pop(),k.push(["AND","OR"][Ne-20]+"("+ie+","+we+")");break;default:if(Ne<32&&C[Ne])we=k.pop(),ie=k.pop(),k.push(ie+C[Ne]+we);else if(E[Ne]){if(V=E[Ne][1],V==69&&(V=P[P.l++]),V>k.length){console.error("WK1 bad formula parse 0x"+Ne.toString(16)+":|"+k.join("|")+"|");return}var Ye=k.slice(-V);k.length-=V,k.push(E[Ne][0]+"("+Ye.join(",")+")")}else return Ne<=7?console.error("WK1 invalid opcode "+Ne.toString(16)):Ne<=24?console.error("WK1 unsupported op "+Ne.toString(16)):Ne<=30?console.error("WK1 invalid opcode "+Ne.toString(16)):Ne<=115?console.error("WK1 unsupported function opcode "+Ne.toString(16)):console.error("WK1 unrecognized opcode "+Ne.toString(16))}}k.length==1?Z[1].f=""+k[0]:console.error("WK1 bad formula parse |"+k.join("|")+"|")}function F(P){var Z=[{c:0,r:0},{t:"n",v:0},0];return Z[0].r=P.read_shift(2),Z[3]=P[P.l++],Z[0].c=P[P.l++],Z}function K(P,Z){var k=F(P);return k[1].t="s",k[1].v=P.read_shift(Z-4,"cstr"),k}function D(P,Z,k,V){var U=be(6+V.length);U.write_shift(2,P),U.write_shift(1,k),U.write_shift(1,Z),U.write_shift(1,39);for(var Te=0;Te<V.length;++Te){var ie=V.charCodeAt(Te);U.write_shift(1,ie>=128?95:ie)}return U.write_shift(1,0),U}function H(P,Z){var k=F(P);k[1].v=P.read_shift(2);var V=k[1].v>>1;if(k[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return k[1].v=V,k}function M(P,Z){var k=F(P),V=P.read_shift(4),U=P.read_shift(4),Te=P.read_shift(2);if(Te==65535)return V===0&&U===3221225472?(k[1].t="e",k[1].v=15):V===0&&U===3489660928?(k[1].t="e",k[1].v=42):k[1].v=0,k;var ie=Te&32768;return Te=(Te&32767)-16446,k[1].v=(1-ie*2)*(U*Math.pow(2,Te+32)+V*Math.pow(2,Te)),k}function B(P,Z,k,V){var U=be(14);if(U.write_shift(2,P),U.write_shift(1,k),U.write_shift(1,Z),V==0)return U.write_shift(4,0),U.write_shift(4,0),U.write_shift(2,65535),U;var Te=0,ie=0,we=0,Ne=0;return V<0&&(Te=1,V=-V),ie=Math.log2(V)|0,V/=Math.pow(2,ie-31),Ne=V>>>0,(Ne&2147483648)==0&&(V/=2,++ie,Ne=V>>>0),V-=Ne,Ne|=2147483648,Ne>>>=0,V*=Math.pow(2,32),we=V>>>0,U.write_shift(4,we),U.write_shift(4,Ne),ie+=16383+(Te?32768:0),U.write_shift(2,ie),U}function I(P,Z){var k=M(P);return P.l+=Z-14,k}function te(P,Z){var k=F(P),V=P.read_shift(4);return k[1].v=V>>6,k}function q(P,Z){var k=F(P),V=P.read_shift(8,"f");return k[1].v=V,k}function ae(P,Z){var k=q(P);return P.l+=Z-10,k}function re(P,Z){return P[P.l+Z-1]==0?P.read_shift(Z,"cstr"):""}function ee(P,Z){var k=P[P.l++];k>Z-1&&(k=Z-1);for(var V="";V.length<k;)V+=String.fromCharCode(P[P.l++]);return V}function Q(P,Z,k){if(!(!k.qpro||Z<21)){var V=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var U=P.read_shift(Z-21,"cstr");return[V,U]}}function pe(P,Z){for(var k={},V=P.l+Z;P.l<V;){var U=P.read_shift(2);if(U==14e3){for(k[U]=[0,""],k[U][0]=P.read_shift(2);P[P.l];)k[U][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return k}function ye(P,Z){var k=be(5+P.length);k.write_shift(2,14e3),k.write_shift(2,Z);for(var V=0;V<P.length;++V){var U=P.charCodeAt(V);k[k.l++]=U>127?95:U}return k[k.l++]=0,k}var Y={0:{n:"BOF",f:dw},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:h},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:_},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:ee},65535:{n:""}},de={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:K},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:H},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:pe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:te},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:ae},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:r,to_workbook:t}}(),W6=/^\s|\s$|[\t\n\r]/;function vw(e,t){if(!t.bookSST)return"";var n=[Zt];n[n.length]=Me("sst",null,{xmlns:ml[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var r=e[a],l="<si>";r.r?l+=r.r:(l+="<t",r.t||(r.t=""),r.t.match(W6)&&(l+=' xml:space="preserve"'),l+=">"+vt(r.t)+"</t>"),l+="</si>",n[n.length]=l}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function G6(e){return[e.read_shift(4),e.read_shift(4)]}function X6(e,t){return t||(t=be(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Y6=HA;function q6(e){var t=Yn();Ce(t,159,X6(e));for(var n=0;n<e.length;++n)Ce(t,19,Y6(e[n]));return Ce(t,160),t.end()}function $6(e){for(var t=[],n=e.split(""),a=0;a<n.length;++a)t[a]=n[a].charCodeAt(0);return t}function bw(e){var t=0,n,a=$6(e),r=a.length+1,l,o,h,f,d;for(n=ni(r),n[0]=a.length,l=1;l!=r;++l)n[l]=a[l-1];for(l=r-1;l>=0;--l)o=n[l],h=(t&16384)===0?0:1,f=t<<1&32767,d=h|f,t=d^o;return t^52811}var Q6=function(){function e(r,l){switch(l.type){case"base64":return t(Or(r),l);case"binary":return t(r,l);case"buffer":return t(ht&&Buffer.isBuffer(r)?r.toString("binary"):vc(r),l);case"array":return t(nf(r),l)}throw new Error("Unrecognized type "+l.type)}function t(r,l){var o=l||{},h=o.dense?[]:{},f=r.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(g,p){Array.isArray(h)&&(h[p]=[]);for(var y=/\\\w+\b/g,w=0,_,b=-1;_=y.exec(g);){switch(_[0]){case"\\cell":var T=g.slice(w,y.lastIndex-_[0].length);if(T[0]==" "&&(T=T.slice(1)),++b,T.length){var S={v:T,t:"s"};Array.isArray(h)?h[p][b]=S:h[bt({r:p,c:b})]=S}break}w=y.lastIndex}b>d.e.c&&(d.e.c=b)}),h["!ref"]=Qt(d),h}function n(r,l){return li(e(r,l),l)}function a(r){for(var l=["{\\rtf1\\ansi"],o=Mt(r["!ref"]),h,f=Array.isArray(r),d=o.s.r;d<=o.e.r;++d){l.push("\\trowd\\trautofit1");for(var g=o.s.c;g<=o.e.c;++g)l.push("\\cellx"+(g+1));for(l.push("\\pard\\intbl"),g=o.s.c;g<=o.e.c;++g){var p=bt({r:d,c:g});h=f?(r[d]||[])[g]:r[p],!(!h||h.v==null&&(!h.f||h.F))&&(l.push(" "+(h.w||(Mr(h),h.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:n,to_sheet:e,from_sheet:a}}();function Yv(e){for(var t=0,n=1;t!=3;++t)n=n*256+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}var Z6=6,Ar=Z6;function Hh(e){return Math.floor((e+Math.round(128/Ar)/256)*Ar)}function Ph(e){return Math.floor((e-5)/Ar*100+.5)/100}function rx(e){return Math.round((e*Ar+5)/Ar*256)/256}function Xx(e){e.width?(e.wpx=Hh(e.width),e.wch=Ph(e.wpx),e.MDW=Ar):e.wpx?(e.wch=Ph(e.wpx),e.width=rx(e.wch),e.MDW=Ar):typeof e.wch=="number"&&(e.width=rx(e.wch),e.wpx=Hh(e.width),e.MDW=Ar),e.customWidth&&delete e.customWidth}var J6=96,ww=J6;function Ih(e){return e*96/ww}function _w(e){return e*ww/96}function e5(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&(t[t.length]=Me("numFmt",null,{numFmtId:a,formatCode:vt(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Me("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function t5(e){var t=[];return t[t.length]=Me("cellXfs",null),e.forEach(function(n){t[t.length]=Me("xf",null,n)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Me("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Tw(e,t){var n=[Zt,Me("styleSheet",null,{xmlns:ml[0],"xmlns:vt":fn.vt})],a;return e.SSF&&(a=e5(e.SSF))!=null&&(n[n.length]=a),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=t5(t.cellXfs))&&(n[n.length]=a),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function n5(e,t){var n=e.read_shift(2),a=Rn(e);return[n,a]}function a5(e,t,n){n||(n=be(6+4*t.length)),n.write_shift(2,e),xn(t,n);var a=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),a}function r5(e,t,n){var a={};a.sz=e.read_shift(2)/20;var r=WA(e);r.fItalic&&(a.italic=1),r.fCondense&&(a.condense=1),r.fExtend&&(a.extend=1),r.fShadow&&(a.shadow=1),r.fOutline&&(a.outline=1),r.fStrikeout&&(a.strike=1);var l=e.read_shift(2);switch(l===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var h=e.read_shift(1);h>0&&(a.family=h);var f=e.read_shift(1);switch(f>0&&(a.charset=f),e.l++,a.color=KA(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Rn(e),a}function s5(e,t){t||(t=be(25+4*32)),t.write_shift(2,e.sz*20),GA(e,t),t.write_shift(2,e.bold?700:400);var n=0;e.vertAlign=="superscript"?n=1:e.vertAlign=="subscript"&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Lh(e.color,t);var a=0;return a=2,t.write_shift(1,a),xn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var i5=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Hd,l5=tr;function qv(e,t){t||(t=be(4*3+8*7+16*1)),Hd||(Hd=Fx(i5));var n=Hd[e.patternType];n==null&&(n=40),t.write_shift(4,n);var a=0;if(n!=40)for(Lh({auto:1},t),Lh({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function o5(e,t){var n=e.l+t,a=e.read_shift(2),r=e.read_shift(2);return e.l=n,{ixfe:a,numFmtId:r}}function Sw(e,t,n){n||(n=be(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var a=0;return n.write_shift(1,a),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function Ao(e,t){return t||(t=be(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var c5=tr;function u5(e,t){return t||(t=be(51)),t.write_shift(1,0),Ao(null,t),Ao(null,t),Ao(null,t),Ao(null,t),Ao(null,t),t.length>t.l?t.slice(0,t.l):t}function h5(e,t){return t||(t=be(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Fh(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function f5(e,t,n){var a=be(2052);return a.write_shift(4,e),Fh(t,a),Fh(n,a),a.length>a.l?a.slice(0,a.l):a}function d5(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var r=a[0];r<=a[1];++r)t[r]!=null&&++n}),n!=0&&(Ce(e,615,Ba(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var r=a[0];r<=a[1];++r)t[r]!=null&&Ce(e,44,a5(r,t[r]))}),Ce(e,616))}}function x5(e){var t=1;Ce(e,611,Ba(t)),Ce(e,43,s5({sz:12,color:{theme:1},name:"Calibri",family:2})),Ce(e,612)}function g5(e){var t=2;Ce(e,603,Ba(t)),Ce(e,45,qv({patternType:"none"})),Ce(e,45,qv({patternType:"gray125"})),Ce(e,604)}function m5(e){var t=1;Ce(e,613,Ba(t)),Ce(e,46,u5()),Ce(e,614)}function p5(e){var t=1;Ce(e,626,Ba(t)),Ce(e,47,Sw({numFmtId:0},65535)),Ce(e,627)}function y5(e,t){Ce(e,617,Ba(t.length)),t.forEach(function(n){Ce(e,47,Sw(n,0))}),Ce(e,618)}function v5(e){var t=1;Ce(e,619,Ba(t)),Ce(e,48,h5({xfId:0,name:"Normal"})),Ce(e,620)}function b5(e){var t=0;Ce(e,505,Ba(t)),Ce(e,506)}function w5(e){var t=0;Ce(e,508,f5(t,"TableStyleMedium9","PivotStyleMedium4")),Ce(e,509)}function _5(e,t){var n=Yn();return Ce(n,278),d5(n,e.SSF),x5(n),g5(n),m5(n),p5(n),y5(n,t.cellXfs),v5(n),b5(n),w5(n),Ce(n,279),n.end()}function Nw(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var n=[Zt];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function T5(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Rn(e)}}function S5(e){var t=be(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),xn(e.name,t),t.slice(0,t.l)}function N5(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function E5(e){var t=be(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}function C5(e,t){var n=be(8+2*t.length);return n.write_shift(4,e),xn(t,n),n.slice(0,n.l)}function k5(e){return e.l+=4,e.read_shift(4)!=0}function j5(e,t){var n=be(8);return n.write_shift(4,e),n.write_shift(4,1),n}function A5(){var e=Yn();return Ce(e,332),Ce(e,334,Ba(1)),Ce(e,335,S5({name:"XLDAPR",version:12e4,flags:3496657072})),Ce(e,336),Ce(e,339,C5(1,"XLDAPR")),Ce(e,52),Ce(e,35,Ba(514)),Ce(e,4096,Ba(0)),Ce(e,4097,Ta(1)),Ce(e,36),Ce(e,53),Ce(e,340),Ce(e,337,j5(1)),Ce(e,51,E5([[1,0]])),Ce(e,338),Ce(e,333),e.end()}function Ew(){var e=[Zt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function D5(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=bt(n);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}var tl=1024;function Cw(e,t){for(var n=[21600,21600],a=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),r=[Me("xml",null,{"xmlns:v":ia.v,"xmlns:o":ia.o,"xmlns:x":ia.x,"xmlns:mv":ia.mv}).replace(/\/>/,">"),Me("o:shapelayout",Me("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Me("v:shapetype",[Me("v:stroke",null,{joinstyle:"miter"}),Me("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:a})];tl<e*1e3;)tl+=1e3;return t.forEach(function(l){var o=dn(l[0]),h={color2:"#BEFF82",type:"gradient"};h.type=="gradient"&&(h.angle="-180");var f=h.type=="gradient"?Me("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Me("v:fill",f,h),g={on:"t",obscured:"t"};++tl,r=r.concat(["<v:shape"+fc({id:"_x0000_s"+tl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Me("v:shadow",null,g),Me("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Tn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Tn("x:AutoFill","False"),Tn("x:Row",String(o.r)),Tn("x:Column",String(o.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),r.push("</xml>"),r.join("")}function kw(e){var t=[Zt,Me("comments",null,{xmlns:ml[0]})],n=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(r){var l=vt(r.a);n.indexOf(l)==-1&&(n.push(l),t.push("<author>"+l+"</author>")),r.T&&r.ID&&n.indexOf("tc="+r.ID)==-1&&(n.push("tc="+r.ID),t.push("<author>tc="+r.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var r=0,l=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?r=n.indexOf("tc="+a[1][0].ID):a[1].forEach(function(f){f.a&&(r=n.indexOf(vt(f.a))),l.push(f.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+r+'"><text>'),l.length<=1)t.push(Tn("t",vt(l[0]||"")));else{for(var o=`Comment:
    `+l[0]+`
`,h=1;h<l.length;++h)o+=`Reply:
    `+l[h]+`
`;t.push(Tn("t",vt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function O5(e,t,n){var a=[Zt,Me("ThreadedComments",null,{xmlns:fn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(r){var l="";(r[1]||[]).forEach(function(o,h){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var f={ref:r[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};h==0?l=f.id:f.parentId=l,o.ID=f.id,o.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),a.push(Me("threadedComment",Tn("text",o.t||""),f))})}),a.push("</ThreadedComments>"),a.join("")}function M5(e){var t=[Zt,Me("personList",null,{xmlns:fn.TCMNT,"xmlns:x":ml[0]}).replace(/[\/]>/,">")];return e.forEach(function(n,a){t.push(Me("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:n,providerId:"None"}))}),t.push("</personList>"),t.join("")}function R5(e){var t={};t.iauthor=e.read_shift(4);var n=hi(e);return t.rfx=n.s,t.ref=bt(n.s),e.l+=16,t}function F5(e,t){return t==null&&(t=be(36)),t.write_shift(4,e[1].iauthor),yl(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var L5=Rn;function B5(e){return xn(e.slice(0,54))}function H5(e){var t=Yn(),n=[];return Ce(t,628),Ce(t,630),e.forEach(function(a){a[1].forEach(function(r){n.indexOf(r.a)>-1||(n.push(r.a.slice(0,54)),Ce(t,632,B5(r.a)))})}),Ce(t,631),Ce(t,633),e.forEach(function(a){a[1].forEach(function(r){r.iauthor=n.indexOf(r.a);var l={s:dn(a[0]),e:dn(a[0])};Ce(t,635,F5([l,r])),r.t&&r.t.length>0&&Ce(t,637,IA(r)),Ce(t,636),delete r.iauthor})}),Ce(t,634),Ce(t,629),t.end()}function P5(e,t){t.FullPaths.forEach(function(n,a){if(a!=0){var r=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");r.slice(-1)!=="/"&&kt.utils.cfb_add(e,r,t.FileIndex[a].content)}})}var jw=["xlsb","xlsm","xlam","biff8","xla"],I5=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(a,r,l,o){var h=!1,f=!1;l.length==0?f=!0:l.charAt(0)=="["&&(f=!0,l=l.slice(1,-1)),o.length==0?h=!0:o.charAt(0)=="["&&(h=!0,o=o.slice(1,-1));var d=l.length>0?parseInt(l,10)|0:0,g=o.length>0?parseInt(o,10)|0:0;return h?g+=t.c:--g,f?d+=t.r:--d,r+(h?"":"$")+Mn(g)+(f?"":"$")+Nn(d)}return function(r,l){return t=l,r.replace(e,n)}}(),Yx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,qx=function(){return function(t,n){return t.replace(Yx,function(a,r,l,o,h,f){var d=Ux(o)-(l?0:n.c),g=zx(f)-(h?0:n.r),p=g==0?"":h?g+1:"["+g+"]",y=d==0?"":l?d+1:"["+d+"]";return r+"R"+p+"C"+y})}}();function z5(e,t){return e.replace(Yx,function(n,a,r,l,o,h){return a+(r=="$"?r+l:Mn(Ux(l)+t.c))+(o=="$"?o+h:Nn(zx(h)+t.r))})}function U5(e){return e.length!=1}function qt(e){e.l+=1}function ps(e,t){var n=e.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function Aw(e,t,n){var a=2;if(n){if(n.biff>=2&&n.biff<=5)return Dw(e);n.biff==12&&(a=4)}var r=e.read_shift(a),l=e.read_shift(a),o=ps(e),h=ps(e);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:l,c:h[0],cRel:h[1],rRel:h[2]}}}function Dw(e){var t=ps(e),n=ps(e),a=e.read_shift(1),r=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:n[0],c:r,cRel:n[1],rRel:n[2]}}}function V5(e,t,n){if(n.biff<8)return Dw(e);var a=e.read_shift(n.biff==12?4:2),r=e.read_shift(n.biff==12?4:2),l=ps(e),o=ps(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r,c:o[0],cRel:o[1],rRel:o[2]}}}function Ow(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return K5(e);var a=e.read_shift(n&&n.biff==12?4:2),r=ps(e);return{r:a,c:r[0],cRel:r[1],rRel:r[2]}}function K5(e){var t=ps(e),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}function W5(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function G5(e,t,n){var a=n&&n.biff?n.biff:8;if(a>=2&&a<=5)return X5(e);var r=e.read_shift(a>=12?4:2),l=e.read_shift(2),o=(l&16384)>>14,h=(l&32768)>>15;if(l&=16383,h==1)for(;r>524287;)r-=1048576;if(o==1)for(;l>8191;)l=l-16384;return{r,c:l,cRel:o,rRel:h}}function X5(e){var t=e.read_shift(2),n=e.read_shift(1),a=(t&32768)>>15,r=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),r==1&&n>=128&&(n=n-256),{r:t,c:n,cRel:r,rRel:a}}function Y5(e,t,n){var a=(e[e.l++]&96)>>5,r=Aw(e,n.biff>=2&&n.biff<=5?6:8,n);return[a,r]}function q5(e,t,n){var a=(e[e.l++]&96)>>5,r=e.read_shift(2,"i"),l=8;if(n)switch(n.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var o=Aw(e,l,n);return[a,r,o]}function $5(e,t,n){var a=(e[e.l++]&96)>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[a]}function Q5(e,t,n){var a=(e[e.l++]&96)>>5,r=e.read_shift(2),l=8;if(n)switch(n.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[a,r]}function Z5(e,t,n){var a=(e[e.l++]&96)>>5,r=V5(e,t-1,n);return[a,r]}function J5(e,t,n){var a=(e[e.l++]&96)>>5;return e.l+=n.biff==2?6:n.biff==12?14:7,[a]}function $v(e){var t=e[e.l+1]&1,n=1;return e.l+=4,[t,n]}function eD(e,t,n){e.l+=2;for(var a=e.read_shift(n&&n.biff==2?1:2),r=[],l=0;l<=a;++l)r.push(e.read_shift(n&&n.biff==2?1:2));return r}function tD(e,t,n){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(n&&n.biff==2?1:2)]}function nD(e,t,n){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(n&&n.biff==2?1:2)]}function aD(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function rD(e,t,n){var a=e[e.l+1]&255?1:0;return e.l+=n&&n.biff==2?3:4,[a]}function Mw(e){var t=e.read_shift(1),n=e.read_shift(1);return[t,n]}function sD(e){return e.read_shift(2),Mw(e)}function iD(e){return e.read_shift(2),Mw(e)}function lD(e,t,n){var a=(e[e.l]&96)>>5;e.l+=1;var r=Ow(e,0,n);return[a,r]}function oD(e,t,n){var a=(e[e.l]&96)>>5;e.l+=1;var r=G5(e,0,n);return[a,r]}function cD(e,t,n){var a=(e[e.l]&96)>>5;e.l+=1;var r=e.read_shift(2);n&&n.biff==5&&(e.l+=12);var l=Ow(e,0,n);return[a,r,l]}function uD(e,t,n){var a=(e[e.l]&96)>>5;e.l+=1;var r=e.read_shift(n&&n.biff<=3?1:2);return[u8[r],Lw[r],a]}function hD(e,t,n){var a=e[e.l++],r=e.read_shift(1),l=n&&n.biff<=3?[a==88?-1:0,e.read_shift(1)]:fD(e);return[r,(l[0]===0?Lw:c8)[l[1]]]}function fD(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function dD(e,t,n){e.l+=n&&n.biff==2?3:4}function xD(e,t,n){if(e.l++,n&&n.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),r=e.read_shift(n&&n.biff==2?1:2);return[a,r]}function gD(e){return e.l++,_c[e.read_shift(1)]}function mD(e){return e.l++,e.read_shift(2)}function pD(e){return e.l++,e.read_shift(1)!==0}function yD(e){return e.l++,vl(e)}function vD(e,t,n){return e.l++,gw(e,t-1,n)}function bD(e,t){var n=[e.read_shift(1)];if(t==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=c6(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:n[1]=_c[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:n[1]=vl(e);break;case 2:n[1]=d6(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function wD(e,t,n){for(var a=e.read_shift(n.biff==12?4:2),r=[],l=0;l!=a;++l)r.push((n.biff==12?hi:m6)(e));return r}function _D(e,t,n){var a=0,r=0;n.biff==12?(a=e.read_shift(4),r=e.read_shift(4)):(r=1+e.read_shift(1),a=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--a,--r==0&&(r=256));for(var l=0,o=[];l!=a&&(o[l]=[]);++l)for(var h=0;h!=r;++h)o[l][h]=bD(e,n.biff);return o}function TD(e,t,n){var a=e.read_shift(1)>>>5&3,r=!n||n.biff>=8?4:2,l=e.read_shift(r);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,l]}function SD(e,t,n){if(n.biff==5)return ND(e);var a=e.read_shift(1)>>>5&3,r=e.read_shift(2),l=e.read_shift(4);return[a,r,l]}function ND(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,n,a]}function ED(e,t,n){var a=e.read_shift(1)>>>5&3;e.l+=n&&n.biff==2?3:4;var r=e.read_shift(n&&n.biff==2?1:2);return[a,r]}function CD(e,t,n){var a=e.read_shift(1)>>>5&3,r=e.read_shift(n&&n.biff==2?1:2);return[a,r]}function kD(e,t,n){var a=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,n.biff==12&&(e.l+=2),[a]}function jD(e,t,n){var a=(e[e.l++]&96)>>5,r=e.read_shift(2),l=4;if(n)switch(n.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[a,r]}var AD=tr,DD=tr,OD=tr;function Tc(e,t,n){return e.l+=2,[W5(e)]}function $x(e){return e.l+=6,[]}var MD=Tc,RD=$x,FD=$x,LD=Tc;function Rw(e){return e.l+=2,[dw(e),e.read_shift(2)&1]}var BD=Tc,HD=Rw,PD=$x,ID=Tc,zD=Tc,UD=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function VD(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(4),r=e.read_shift(2),l=e.read_shift(2),o=UD[n>>2&31];return{ixti:t,coltype:n&3,rt:o,idx:a,c:r,C:l}}function KD(e){return e.l+=2,[e.read_shift(4)]}function WD(e,t,n){return e.l+=5,e.l+=2,e.l+=n.biff==2?1:4,["PTGSHEET"]}function GD(e,t,n){return e.l+=n.biff==2?4:5,["PTGENDSHEET"]}function XD(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function YD(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function qD(e){return e.l+=4,[0,0]}var Qv={1:{n:"PtgExp",f:xD},2:{n:"PtgTbl",f:OD},3:{n:"PtgAdd",f:qt},4:{n:"PtgSub",f:qt},5:{n:"PtgMul",f:qt},6:{n:"PtgDiv",f:qt},7:{n:"PtgPower",f:qt},8:{n:"PtgConcat",f:qt},9:{n:"PtgLt",f:qt},10:{n:"PtgLe",f:qt},11:{n:"PtgEq",f:qt},12:{n:"PtgGe",f:qt},13:{n:"PtgGt",f:qt},14:{n:"PtgNe",f:qt},15:{n:"PtgIsect",f:qt},16:{n:"PtgUnion",f:qt},17:{n:"PtgRange",f:qt},18:{n:"PtgUplus",f:qt},19:{n:"PtgUminus",f:qt},20:{n:"PtgPercent",f:qt},21:{n:"PtgParen",f:qt},22:{n:"PtgMissArg",f:qt},23:{n:"PtgStr",f:vD},26:{n:"PtgSheet",f:WD},27:{n:"PtgEndSheet",f:GD},28:{n:"PtgErr",f:gD},29:{n:"PtgBool",f:pD},30:{n:"PtgInt",f:mD},31:{n:"PtgNum",f:yD},32:{n:"PtgArray",f:J5},33:{n:"PtgFunc",f:uD},34:{n:"PtgFuncVar",f:hD},35:{n:"PtgName",f:TD},36:{n:"PtgRef",f:lD},37:{n:"PtgArea",f:Y5},38:{n:"PtgMemArea",f:ED},39:{n:"PtgMemErr",f:AD},40:{n:"PtgMemNoMem",f:DD},41:{n:"PtgMemFunc",f:CD},42:{n:"PtgRefErr",f:kD},43:{n:"PtgAreaErr",f:$5},44:{n:"PtgRefN",f:oD},45:{n:"PtgAreaN",f:Z5},46:{n:"PtgMemAreaN",f:XD},47:{n:"PtgMemNoMemN",f:YD},57:{n:"PtgNameX",f:SD},58:{n:"PtgRef3d",f:cD},59:{n:"PtgArea3d",f:q5},60:{n:"PtgRefErr3d",f:jD},61:{n:"PtgAreaErr3d",f:Q5},255:{}},$D={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},QD={1:{n:"PtgElfLel",f:Rw},2:{n:"PtgElfRw",f:ID},3:{n:"PtgElfCol",f:MD},6:{n:"PtgElfRwV",f:zD},7:{n:"PtgElfColV",f:LD},10:{n:"PtgElfRadical",f:BD},11:{n:"PtgElfRadicalS",f:PD},13:{n:"PtgElfColS",f:RD},15:{n:"PtgElfColSV",f:FD},16:{n:"PtgElfRadicalLel",f:HD},25:{n:"PtgList",f:VD},29:{n:"PtgSxName",f:KD},255:{}},ZD={0:{n:"PtgAttrNoop",f:qD},1:{n:"PtgAttrSemi",f:rD},2:{n:"PtgAttrIf",f:nD},4:{n:"PtgAttrChoose",f:eD},8:{n:"PtgAttrGoto",f:tD},16:{n:"PtgAttrSum",f:dD},32:{n:"PtgAttrBaxcel",f:$v},33:{n:"PtgAttrBaxcel",f:$v},64:{n:"PtgAttrSpace",f:sD},65:{n:"PtgAttrSpaceSemi",f:iD},128:{n:"PtgAttrIfError",f:aD},255:{}};function JD(e,t,n,a){if(a.biff<8)return tr(e,t);for(var r=e.l+t,l=[],o=0;o!==n.length;++o)switch(n[o][0]){case"PtgArray":n[o][1]=_D(e,0,a),l.push(n[o][1]);break;case"PtgMemArea":n[o][2]=wD(e,n[o][1],a),l.push(n[o][2]);break;case"PtgExp":a&&a.biff==12&&(n[o][1][1]=e.read_shift(4),l.push(n[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[o][0]}return t=r-e.l,t!==0&&l.push(tr(e,t)),l}function e8(e,t,n){for(var a=e.l+t,r,l,o=[];a!=e.l;)t=a-e.l,l=e[e.l],r=Qv[l]||Qv[$D[l]],(l===24||l===25)&&(r=(l===24?QD:ZD)[e[e.l+1]]),!r||!r.f?tr(e,t):o.push([r.n,r.f(e,t,n)]);return o}function t8(e){for(var t=[],n=0;n<e.length;++n){for(var a=e[n],r=[],l=0;l<a.length;++l){var o=a[l];if(o)switch(o[0]){case 2:r.push('"'+o[1].replace(/"/g,'""')+'"');break;default:r.push(o[1])}else r.push("")}t.push(r.join(","))}return t.join(";")}var n8={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function a8(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Fw(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var r="";if(n.biff>8)switch(e[a[0]][0]){case 357:return r=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?r:r+":"+e.SheetNames[a[2]];case 358:return n.SID!=null?e.SheetNames[n.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return r=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?r:r+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[a[0]][0][3]?(r=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?r:r+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Zv(e,t,n){var a=Fw(e,t,n);return a=="#REF"?a:a8(a,n)}function hl(e,t,n,a,r){var l=r&&r.biff||8,o={s:{c:0,r:0}},h=[],f,d,g,p=0,y=0,w,_="";if(!e[0]||!e[0][0])return"";for(var b=-1,T="",S=0,E=e[0].length;S<E;++S){var C=e[0][S];switch(C[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=h.pop(),d=h.pop(),b>=0){switch(e[0][b][1][0]){case 0:T=It(" ",e[0][b][1][1]);break;case 1:T=It("\r",e[0][b][1][1]);break;default:if(T="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}d=d+T,b=-1}h.push(d+n8[C[0]]+f);break;case"PtgIsect":f=h.pop(),d=h.pop(),h.push(d+" "+f);break;case"PtgUnion":f=h.pop(),d=h.pop(),h.push(d+","+f);break;case"PtgRange":f=h.pop(),d=h.pop(),h.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=Xo(C[1][1],o,r),h.push(Yo(g,l));break;case"PtgRefN":g=n?Xo(C[1][1],n,r):C[1][1],h.push(Yo(g,l));break;case"PtgRef3d":p=C[1][1],g=Xo(C[1][2],o,r),_=Zv(a,p,r),h.push(_+"!"+Yo(g,l));break;case"PtgFunc":case"PtgFuncVar":var A=C[1][0],F=C[1][1];A||(A=0),A&=127;var K=A==0?[]:h.slice(-A);h.length-=A,F==="User"&&(F=K.shift()),h.push(F+"("+K.join(",")+")");break;case"PtgBool":h.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":h.push(C[1]);break;case"PtgNum":h.push(String(C[1]));break;case"PtgStr":h.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":h.push(C[1]);break;case"PtgAreaN":w=Lv(C[1][1],n?{s:n}:o,r),h.push(Ld(w,r));break;case"PtgArea":w=Lv(C[1][1],o,r),h.push(Ld(w,r));break;case"PtgArea3d":p=C[1][1],w=C[1][2],_=Zv(a,p,r),h.push(_+"!"+Ld(w,r));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=C[1][2];var D=(a.names||[])[y-1]||(a[0]||[])[y],H=D?D.Name:"SH33TJSNAME"+String(y);H&&H.slice(0,6)=="_xlfn."&&!r.xlfn&&(H=H.slice(6)),h.push(H);break;case"PtgNameX":var M=C[1][1];y=C[1][2];var B;if(r.biff<=5)M<0&&(M=-M),a[M]&&(B=a[M][y]);else{var I="";if(((a[M]||[])[0]||[])[0]==14849||(((a[M]||[])[0]||[])[0]==1025?a[M][y]&&a[M][y].itab>0&&(I=a.SheetNames[a[M][y].itab-1]+"!"):I=a.SheetNames[y-1]+"!"),a[M]&&a[M][y])I+=a[M][y].Name;else if(a[0]&&a[0][y])I+=a[0][y].Name;else{var te=(Fw(a,M,r)||"").split(";;");te[y-1]?I=te[y-1]:I+="SH33TJSERRX"}h.push(I);break}B||(B={Name:"SH33TJSERRY"}),h.push(B.Name);break;case"PtgParen":var q="(",ae=")";if(b>=0){switch(T="",e[0][b][1][0]){case 2:q=It(" ",e[0][b][1][1])+q;break;case 3:q=It("\r",e[0][b][1][1])+q;break;case 4:ae=It(" ",e[0][b][1][1])+ae;break;case 5:ae=It("\r",e[0][b][1][1])+ae;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}b=-1}h.push(q+h.pop()+ae);break;case"PtgRefErr":h.push("#REF!");break;case"PtgRefErr3d":h.push("#REF!");break;case"PtgExp":g={c:C[1][1],r:C[1][0]};var re={c:n.c,r:n.r};if(a.sharedf[bt(g)]){var ee=a.sharedf[bt(g)];h.push(hl(ee,o,re,a,r))}else{var Q=!1;for(f=0;f!=a.arrayf.length;++f)if(d=a.arrayf[f],!(g.c<d[0].s.c||g.c>d[0].e.c)&&!(g.r<d[0].s.r||g.r>d[0].e.r)){h.push(hl(d[1],o,re,a,r)),Q=!0;break}Q||h.push(C[1])}break;case"PtgArray":h.push("{"+t8(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":h.push("");break;case"PtgAreaErr":h.push("#REF!");break;case"PtgAreaErr3d":h.push("#REF!");break;case"PtgList":h.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var pe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(r.biff!=3&&b>=0&&pe.indexOf(e[0][S][0])==-1){C=e[0][b];var ye=!0;switch(C[1][0]){case 4:ye=!1;case 0:T=It(" ",C[1][1]);break;case 5:ye=!1;case 1:T=It("\r",C[1][1]);break;default:if(T="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}h.push((ye?T:"")+h.pop()+(ye?"":T)),b=-1}}if(h.length>1&&r.WTF)throw new Error("bad formula stack");return h[0]}function r8(e){if(e==null){var t=be(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ai(e);return ai(0)}function s8(e,t,n,a,r){var l=ri(t,n,r),o=r8(e.v),h=be(6),f=33;h.write_shift(2,f),h.write_shift(4,0);for(var d=be(e.bf.length),g=0;g<e.bf.length;++g)d[g]=e.bf[g];var p=_n([l,o,h,d]);return p}function af(e,t,n){var a=e.read_shift(4),r=e8(e,a,n),l=e.read_shift(4),o=l>0?JD(e,l,r,n):null;return[r,o]}var i8=af,rf=af,l8=af,o8=af,c8={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Lw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},u8={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function h8(e){var t="of:="+e.replace(Yx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function f8(e){return e.replace(/\./,"!")}var qo=typeof Map<"u";function Qx(e,t,n){var a=0,r=e.length;if(n){if(qo?n.has(t):Object.prototype.hasOwnProperty.call(n,t)){for(var l=qo?n.get(t):n[t];a<l.length;++a)if(e[l[a]].t===t)return e.Count++,l[a]}}else for(;a<r;++a)if(e[a].t===t)return e.Count++,a;return e[r]={t},e.Count++,e.Unique++,n&&(qo?(n.has(t)||n.set(t,[]),n.get(t).push(r)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(r))),r}function sf(e,t){var n={min:e+1,max:e+1},a=-1;return t.MDW&&(Ar=t.MDW),t.width!=null?n.customWidth=1:t.wpx!=null?a=Ph(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(n.width=rx(a),n.customWidth=1):t.width!=null&&(n.width=t.width),t.hidden&&(n.hidden=!0),t.level!=null&&(n.outlineLevel=n.level=t.level),n}function Bw(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=n[0]),e.right==null&&(e.right=n[1]),e.top==null&&(e.top=n[2]),e.bottom==null&&(e.bottom=n[3]),e.header==null&&(e.header=n[4]),e.footer==null&&(e.footer=n[5])}}function vs(e,t,n){var a=n.revssf[t.z!=null?t.z:"General"],r=60,l=e.length;if(a==null&&n.ssf){for(;r<392;++r)if(n.ssf[r]==null){Ob(t.z,r),n.ssf[r]=t.z,n.revssf[t.z]=a=r;break}}for(r=0;r!=l;++r)if(e[r].numFmtId===a)return r;return e[l]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function d8(e,t,n){if(e&&e["!ref"]){var a=Mt(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}function x8(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+Qt(e[n])+'"/>';return t+"</mergeCells>"}function g8(e,t,n,a,r){var l=!1,o={},h=null;if(a.bookType!=="xlsx"&&t.vbaraw){var f=t.SheetNames[n];try{t.Workbook&&(f=t.Workbook.Sheets[n].CodeName||f)}catch{}l=!0,o.codeName=hc(vt(f))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),h=(h||"")+Me("outlinePr",null,d)}!l&&!h||(r[r.length]=Me("sheetPr",h,o))}var m8=["objects","scenarios","selectLockedCells","selectUnlockedCells"],p8=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function y8(e){var t={sheet:1};return m8.forEach(function(n){e[n]!=null&&e[n]&&(t[n]="1")}),p8.forEach(function(n){e[n]!=null&&!e[n]&&(t[n]="0")}),e.password&&(t.password=bw(e.password).toString(16).toUpperCase()),Me("sheetProtection",null,t)}function v8(e){return Bw(e),Me("pageMargins",null,e)}function b8(e,t){for(var n=["<cols>"],a,r=0;r!=t.length;++r)(a=t[r])&&(n[n.length]=Me("col",null,sf(r,a)));return n[n.length]="</cols>",n.join("")}function w8(e,t,n,a){var r=typeof e.ref=="string"?e.ref:Qt(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var l=n.Workbook.Names,o=ca(r);o.s.r==o.e.r&&(o.e.r=ca(t["!ref"]).e.r,r=Qt(o));for(var h=0;h<l.length;++h){var f=l[h];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==a){f.Ref="'"+n.SheetNames[a]+"'!"+r;break}}return h==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+n.SheetNames[a]+"'!"+r}),Me("autoFilter",null,{ref:r})}function _8(e,t,n,a){var r={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(r.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Me("sheetViews",Me("sheetView",null,r),{})}function T8(e,t,n,a){if(e.c&&n["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var r="",l=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":r=e.v?"1":"0";break;case"n":r=""+e.v;break;case"e":r=_c[e.v];break;case"d":a&&a.cellDates?r=Pn(e.v,-1).toISOString():(e=$n(e),e.t="n",r=""+(e.v=qn(Pn(e.v)))),typeof e.z>"u"&&(e.z=Kt[14]);break;default:r=e.v;break}var h=Tn("v",vt(r)),f={r:t},d=vs(a.cellXfs,e,a);switch(d!==0&&(f.s=d),e.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){h=Tn("v",""+Qx(a.Strings,e.v,a.revStrings)),f.t="s";break}f.t="str";break}if(e.t!=l&&(e.t=l,e.v=o),typeof e.f=="string"&&e.f){var g=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;h=Me("f",vt(e.f),g)+(e.v!=null?h:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(f.cm=1),Me("c",h,f)}function S8(e,t,n,a){var r=[],l=[],o=Mt(e["!ref"]),h="",f,d="",g=[],p=0,y=0,w=e["!rows"],_=Array.isArray(e),b={r:d},T,S=-1;for(y=o.s.c;y<=o.e.c;++y)g[y]=Mn(y);for(p=o.s.r;p<=o.e.r;++p){for(l=[],d=Nn(p),y=o.s.c;y<=o.e.c;++y){f=g[y]+d;var E=_?(e[p]||[])[y]:e[f];E!==void 0&&(h=T8(E,f,e,t))!=null&&l.push(h)}(l.length>0||w&&w[p])&&(b={r:d},w&&w[p]&&(T=w[p],T.hidden&&(b.hidden=1),S=-1,T.hpx?S=Ih(T.hpx):T.hpt&&(S=T.hpt),S>-1&&(b.ht=S,b.customHeight=1),T.level&&(b.outlineLevel=T.level)),r[r.length]=Me("row",l.join(""),b))}if(w)for(;p<w.length;++p)w&&w[p]&&(b={r:p+1},T=w[p],T.hidden&&(b.hidden=1),S=-1,T.hpx?S=Ih(T.hpx):T.hpt&&(S=T.hpt),S>-1&&(b.ht=S,b.customHeight=1),T.level&&(b.outlineLevel=T.level),r[r.length]=Me("row","",b));return r.join("")}function Hw(e,t,n,a){var r=[Zt,Me("worksheet",null,{xmlns:ml[0],"xmlns:r":fn.r})],l=n.SheetNames[e],o=0,h="",f=n.Sheets[l];f==null&&(f={});var d=f["!ref"]||"A1",g=Mt(d);if(g.e.c>16383||g.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575),d=Qt(g)}a||(a={}),f["!comments"]=[];var p=[];g8(f,n,e,t,r),r[r.length]=Me("dimension",null,{ref:d}),r[r.length]=_8(f,t,e,n),t.sheetFormat&&(r[r.length]=Me("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(r[r.length]=b8(f,f["!cols"])),r[o=r.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(h=S8(f,t),h.length>0&&(r[r.length]=h)),r.length>o+1&&(r[r.length]="</sheetData>",r[o]=r[o].replace("/>",">")),f["!protect"]&&(r[r.length]=y8(f["!protect"])),f["!autofilter"]!=null&&(r[r.length]=w8(f["!autofilter"],f,n,e)),f["!merges"]!=null&&f["!merges"].length>0&&(r[r.length]=x8(f["!merges"]));var y=-1,w,_=-1;return f["!links"].length>0&&(r[r.length]="<hyperlinks>",f["!links"].forEach(function(b){b[1].Target&&(w={ref:b[0]},b[1].Target.charAt(0)!="#"&&(_=yt(a,-1,vt(b[1].Target).replace(/#.*$/,""),ct.HLINK),w["r:id"]="rId"+_),(y=b[1].Target.indexOf("#"))>-1&&(w.location=vt(b[1].Target.slice(y+1))),b[1].Tooltip&&(w.tooltip=vt(b[1].Tooltip)),r[r.length]=Me("hyperlink",null,w))}),r[r.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(r[r.length]=v8(f["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(r[r.length]=Tn("ignoredErrors",Me("ignoredError",null,{numberStoredAsText:1,sqref:d}))),p.length>0&&(_=yt(a,-1,"../drawings/drawing"+(e+1)+".xml",ct.DRAW),r[r.length]=Me("drawing",null,{"r:id":"rId"+_}),f["!drawing"]=p),f["!comments"].length>0&&(_=yt(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ct.VML),r[r.length]=Me("legacyDrawing",null,{"r:id":"rId"+_}),f["!legacy"]=_),r.length>1&&(r[r.length]="</worksheet>",r[1]=r[1].replace("/>",">")),r.join("")}function N8(e,t){var n={},a=e.l+t;n.r=e.read_shift(4),e.l+=4;var r=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=a,l&7&&(n.level=l&7),l&16&&(n.hidden=!0),l&32&&(n.hpt=r/20),n}function E8(e,t,n){var a=be(145),r=(n["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var l=320;r.hpx?l=Ih(r.hpx)*20:r.hpt&&(l=r.hpt*20),a.write_shift(2,l),a.write_shift(1,0);var o=0;r.level&&(o|=r.level),r.hidden&&(o|=16),(r.hpx||r.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var h=0,f=a.l;a.l+=4;for(var d={r:e,c:0},g=0;g<16;++g)if(!(t.s.c>g+1<<10||t.e.c<g<<10)){for(var p=-1,y=-1,w=g<<10;w<g+1<<10;++w){d.c=w;var _=Array.isArray(n)?(n[d.r]||[])[d.c]:n[bt(d)];_&&(p<0&&(p=w),y=w)}p<0||(++h,a.write_shift(4,p),a.write_shift(4,y))}var b=a.l;return a.l=f,a.write_shift(4,h),a.l=b,a.length>a.l?a.slice(0,a.l):a}function C8(e,t,n,a){var r=E8(a,n,t);(r.length>17||(t["!rows"]||[])[a])&&Ce(e,0,r)}var k8=hi,j8=yl;function A8(){}function D8(e,t){var n={},a=e[e.l];return++e.l,n.above=!(a&64),n.left=!(a&128),e.l+=18,n.name=zA(e),n}function O8(e,t,n){n==null&&(n=be(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),n.write_shift(1,a);for(var r=1;r<3;++r)n.write_shift(1,0);return Lh({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),Jb(e,n),n.slice(0,n.l)}function M8(e){var t=Ca(e);return[t]}function R8(e,t,n){return n==null&&(n=be(8)),oi(t,n)}function F8(e){var t=ci(e);return[t]}function L8(e,t,n){return n==null&&(n=be(4)),ui(t,n)}function B8(e){var t=Ca(e),n=e.read_shift(1);return[t,n,"b"]}function H8(e,t,n){return n==null&&(n=be(9)),oi(t,n),n.write_shift(1,e.v?1:0),n}function P8(e){var t=ci(e),n=e.read_shift(1);return[t,n,"b"]}function I8(e,t,n){return n==null&&(n=be(5)),ui(t,n),n.write_shift(1,e.v?1:0),n}function z8(e){var t=Ca(e),n=e.read_shift(1);return[t,n,"e"]}function U8(e,t,n){return n==null&&(n=be(9)),oi(t,n),n.write_shift(1,e.v),n}function V8(e){var t=ci(e),n=e.read_shift(1);return[t,n,"e"]}function K8(e,t,n){return n==null&&(n=be(8)),ui(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}function W8(e){var t=Ca(e),n=e.read_shift(4);return[t,n,"s"]}function G8(e,t,n){return n==null&&(n=be(12)),oi(t,n),n.write_shift(4,t.v),n}function X8(e){var t=ci(e),n=e.read_shift(4);return[t,n,"s"]}function Y8(e,t,n){return n==null&&(n=be(8)),ui(t,n),n.write_shift(4,t.v),n}function q8(e){var t=Ca(e),n=vl(e);return[t,n,"n"]}function $8(e,t,n){return n==null&&(n=be(16)),oi(t,n),ai(e.v,n),n}function Q8(e){var t=ci(e),n=vl(e);return[t,n,"n"]}function Z8(e,t,n){return n==null&&(n=be(12)),ui(t,n),ai(e.v,n),n}function J8(e){var t=Ca(e),n=ew(e);return[t,n,"n"]}function eO(e,t,n){return n==null&&(n=be(12)),oi(t,n),tw(e.v,n),n}function tO(e){var t=ci(e),n=ew(e);return[t,n,"n"]}function nO(e,t,n){return n==null&&(n=be(8)),ui(t,n),tw(e.v,n),n}function aO(e){var t=Ca(e),n=Vx(e);return[t,n,"is"]}function rO(e){var t=Ca(e),n=Rn(e);return[t,n,"str"]}function sO(e,t,n){return n==null&&(n=be(12+4*e.v.length)),oi(t,n),xn(e.v,n),n.length>n.l?n.slice(0,n.l):n}function iO(e){var t=ci(e),n=Rn(e);return[t,n,"str"]}function lO(e,t,n){return n==null&&(n=be(8+4*e.v.length)),ui(t,n),xn(e.v,n),n.length>n.l?n.slice(0,n.l):n}function oO(e,t,n){var a=e.l+t,r=Ca(e);r.r=n["!row"];var l=e.read_shift(1),o=[r,l,"b"];if(n.cellFormula){e.l+=2;var h=rf(e,a-e.l,n);o[3]=hl(h,null,r,n.supbooks,n)}else e.l=a;return o}function cO(e,t,n){var a=e.l+t,r=Ca(e);r.r=n["!row"];var l=e.read_shift(1),o=[r,l,"e"];if(n.cellFormula){e.l+=2;var h=rf(e,a-e.l,n);o[3]=hl(h,null,r,n.supbooks,n)}else e.l=a;return o}function uO(e,t,n){var a=e.l+t,r=Ca(e);r.r=n["!row"];var l=vl(e),o=[r,l,"n"];if(n.cellFormula){e.l+=2;var h=rf(e,a-e.l,n);o[3]=hl(h,null,r,n.supbooks,n)}else e.l=a;return o}function hO(e,t,n){var a=e.l+t,r=Ca(e);r.r=n["!row"];var l=Rn(e),o=[r,l,"str"];if(n.cellFormula){e.l+=2;var h=rf(e,a-e.l,n);o[3]=hl(h,null,r,n.supbooks,n)}else e.l=a;return o}var fO=hi,dO=yl;function xO(e,t){return t==null&&(t=be(4)),t.write_shift(4,e),t}function gO(e,t){var n=e.l+t,a=hi(e),r=Kx(e),l=Rn(e),o=Rn(e),h=Rn(e);e.l=n;var f={rfx:a,relId:r,loc:l,display:h};return o&&(f.Tooltip=o),f}function mO(e,t){var n=be(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));yl({s:dn(e[0]),e:dn(e[0])},n),Wx("rId"+t,n);var a=e[1].Target.indexOf("#"),r=a==-1?"":e[1].Target.slice(a+1);return xn(r||"",n),xn(e[1].Tooltip||"",n),xn("",n),n.slice(0,n.l)}function pO(){}function yO(e,t,n){var a=e.l+t,r=nw(e),l=e.read_shift(1),o=[r];if(o[2]=l,n.cellFormula){var h=i8(e,a-e.l,n);o[1]=h}else e.l=a;return o}function vO(e,t,n){var a=e.l+t,r=hi(e),l=[r];if(n.cellFormula){var o=o8(e,a-e.l,n);l[1]=o,e.l=a}else e.l=a;return l}function bO(e,t,n){n==null&&(n=be(18));var a=sf(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,(a.width||10)*256),n.write_shift(4,0);var r=0;return t.hidden&&(r|=1),typeof a.width=="number"&&(r|=2),t.level&&(r|=t.level<<8),n.write_shift(2,r),n}var Pw=["left","right","top","bottom","header","footer"];function wO(e){var t={};return Pw.forEach(function(n){t[n]=vl(e)}),t}function _O(e,t){return t==null&&(t=be(6*8)),Bw(e),Pw.forEach(function(n){ai(e[n],t)}),t}function TO(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function SO(e,t,n){n==null&&(n=be(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),n.write_shift(2,a),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function NO(e){var t=be(24);return t.write_shift(4,4),t.write_shift(4,1),yl(e,t),t}function EO(e,t){return t==null&&(t=be(16*4+2)),t.write_shift(2,e.password?bw(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?t.write_shift(4,e[n[0]]!=null&&!e[n[0]]?1:0):t.write_shift(4,e[n[0]]!=null&&e[n[0]]?0:1)}),t}function CO(){}function kO(){}function jO(e,t,n,a,r,l,o){if(t.v===void 0)return!1;var h="";switch(t.t){case"b":h=t.v?"1":"0";break;case"d":t=$n(t),t.z=t.z||Kt[14],t.v=qn(Pn(t.v)),t.t="n";break;case"n":case"e":h=""+t.v;break;default:h=t.v;break}var f={r:n,c:a};switch(f.s=vs(r.cellXfs,t,r),t.l&&l["!links"].push([bt(f),t.l]),t.c&&l["!comments"].push([bt(f),t.c]),t.t){case"s":case"str":return r.bookSST?(h=Qx(r.Strings,t.v,r.revStrings),f.t="s",f.v=h,o?Ce(e,18,Y8(t,f)):Ce(e,7,G8(t,f))):(f.t="str",o?Ce(e,17,lO(t,f)):Ce(e,6,sO(t,f))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Ce(e,13,nO(t,f)):Ce(e,2,eO(t,f)):o?Ce(e,16,Z8(t,f)):Ce(e,5,$8(t,f)),!0;case"b":return f.t="b",o?Ce(e,15,I8(t,f)):Ce(e,4,H8(t,f)),!0;case"e":return f.t="e",o?Ce(e,14,K8(t,f)):Ce(e,3,U8(t,f)),!0}return o?Ce(e,12,L8(t,f)):Ce(e,1,R8(t,f)),!0}function AO(e,t,n,a){var r=Mt(t["!ref"]||"A1"),l,o="",h=[];Ce(e,145);var f=Array.isArray(t),d=r.e.r;t["!rows"]&&(d=Math.max(r.e.r,t["!rows"].length-1));for(var g=r.s.r;g<=d;++g){o=Nn(g),C8(e,t,r,g);var p=!1;if(g<=r.e.r)for(var y=r.s.c;y<=r.e.c;++y){g===r.s.r&&(h[y]=Mn(y)),l=h[y]+o;var w=f?(t[g]||[])[y]:t[l];if(!w){p=!1;continue}p=jO(e,w,g,y,a,t,p)}}Ce(e,146)}function DO(e,t){!t||!t["!merges"]||(Ce(e,177,xO(t["!merges"].length)),t["!merges"].forEach(function(n){Ce(e,176,dO(n))}),Ce(e,178))}function OO(e,t){!t||!t["!cols"]||(Ce(e,390),t["!cols"].forEach(function(n,a){n&&Ce(e,60,bO(a,n))}),Ce(e,391))}function MO(e,t){!t||!t["!ref"]||(Ce(e,648),Ce(e,649,NO(Mt(t["!ref"]))),Ce(e,650))}function RO(e,t,n){t["!links"].forEach(function(a){if(a[1].Target){var r=yt(n,-1,a[1].Target.replace(/#.*$/,""),ct.HLINK);Ce(e,494,mO(a,r))}}),delete t["!links"]}function FO(e,t,n,a){if(t["!comments"].length>0){var r=yt(a,-1,"../drawings/vmlDrawing"+(n+1)+".vml",ct.VML);Ce(e,551,Wx("rId"+r)),t["!legacy"]=r}}function LO(e,t,n,a){if(t["!autofilter"]){var r=t["!autofilter"],l=typeof r.ref=="string"?r.ref:Qt(r.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,h=ca(l);h.s.r==h.e.r&&(h.e.r=ca(t["!ref"]).e.r,l=Qt(h));for(var f=0;f<o.length;++f){var d=o[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+n.SheetNames[a]+"'!"+l;break}}f==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+n.SheetNames[a]+"'!"+l}),Ce(e,161,yl(Mt(l))),Ce(e,162)}}function BO(e,t,n){Ce(e,133),Ce(e,137,SO(t,n)),Ce(e,138),Ce(e,134)}function HO(e,t){t["!protect"]&&Ce(e,535,EO(t["!protect"]))}function PO(e,t,n,a){var r=Yn(),l=n.SheetNames[e],o=n.Sheets[l]||{},h=l;try{n&&n.Workbook&&(h=n.Workbook.Sheets[e].CodeName||h)}catch{}var f=Mt(o["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Ce(r,129),(n.vbaraw||o["!outline"])&&Ce(r,147,O8(h,o["!outline"])),Ce(r,148,j8(f)),BO(r,o,n.Workbook),OO(r,o),AO(r,o,e,t),HO(r,o),LO(r,o,n,e),DO(r,o),RO(r,o,a),o["!margins"]&&Ce(r,476,_O(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&MO(r,o),FO(r,o,e,a),Ce(r,130),r.end()}function IO(e,t){e.l+=10;var n=Rn(e);return{name:n}}var zO=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function UO(e){return!e.Workbook||!e.Workbook.WBProps?"false":vA(e.Workbook.WBProps.date1904)?"true":"false"}var VO="][*?/\\".split("");function Iw(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return VO.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}function KO(e,t,n){e.forEach(function(a,r){Iw(a);for(var l=0;l<r;++l)if(a==e[l])throw new Error("Duplicate Sheet Name: "+a);if(n){var o=t&&t[r]&&t[r].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function WO(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];KO(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)d8(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}function zw(e){var t=[Zt];t[t.length]=Me("workbook",null,{xmlns:ml[0],"xmlns:r":fn.r});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(zO.forEach(function(h){e.Workbook.WBProps[h[0]]!=null&&e.Workbook.WBProps[h[0]]!=h[1]&&(a[h[0]]=e.Workbook.WBProps[h[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Me("workbookPr",null,a);var r=e.Workbook&&e.Workbook.Sheets||[],l=0;if(r&&r[0]&&r[0].Hidden){for(t[t.length]="<bookViews>",l=0;l!=e.SheetNames.length&&!(!r[l]||!r[l].Hidden);++l);l==e.SheetNames.length&&(l=0),t[t.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",l=0;l!=e.SheetNames.length;++l){var o={name:vt(e.SheetNames[l].slice(0,31))};if(o.sheetId=""+(l+1),o["r:id"]="rId"+(l+1),r[l])switch(r[l].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Me("sheet",null,o)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(h){var f={name:h.Name};h.Comment&&(f.comment=h.Comment),h.Sheet!=null&&(f.localSheetId=""+h.Sheet),h.Hidden&&(f.hidden="1"),h.Ref&&(t[t.length]=Me("definedName",vt(h.Ref),f))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function GO(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=ax(e),n.name=Rn(e),n}function XO(e,t){return t||(t=be(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Wx(e.strRelID,t),xn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function YO(e,t){var n={},a=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var r=t>8?Rn(e):"";return r.length>0&&(n.CodeName=r),n.autoCompressPictures=!!(a&65536),n.backupFile=!!(a&64),n.checkCompatibility=!!(a&4096),n.date1904=!!(a&1),n.filterPrivacy=!!(a&8),n.hidePivotFieldList=!!(a&1024),n.promptedSolutions=!!(a&16),n.publishItems=!!(a&2048),n.refreshAllConnections=!!(a&262144),n.saveExternalLinkValues=!!(a&128),n.showBorderUnselectedTables=!!(a&4),n.showInkAnnotation=!!(a&32),n.showObjects=["all","placeholders","none"][a>>13&3],n.showPivotChartFilter=!!(a&32768),n.updateLinks=["userSet","never","always"][a>>8&3],n}function qO(e,t){t||(t=be(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),Jb(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function $O(e,t,n){var a=e.l+t;e.l+=4,e.l+=1;var r=e.read_shift(4),l=UA(e),o=l8(e,0,n),h=Kx(e);e.l=a;var f={Name:l,Ptg:o};return r<268435455&&(f.Sheet=r),h&&(f.Comment=h),f}function QO(e,t){Ce(e,143);for(var n=0;n!=t.SheetNames.length;++n){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,r={Hidden:a,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]};Ce(e,156,XO(r))}Ce(e,144)}function ZO(e,t){t||(t=be(127));for(var n=0;n!=4;++n)t.write_shift(4,0);return xn("SheetJS",t),xn(jh.version,t),xn(jh.version,t),xn("7262",t),t.length>t.l?t.slice(0,t.l):t}function JO(e,t){t||(t=be(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var n=120;return t.write_shift(1,n),t.length>t.l?t.slice(0,t.l):t}function eM(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var n=t.Workbook.Sheets,a=0,r=-1,l=-1;a<n.length;++a)!n[a]||!n[a].Hidden&&r==-1?r=a:n[a].Hidden==1&&l==-1&&(l=a);l>r||(Ce(e,135),Ce(e,158,JO(r)),Ce(e,136))}}function tM(e,t){var n=Yn();return Ce(n,131),Ce(n,128,ZO()),Ce(n,153,qO(e.Workbook&&e.Workbook.WBProps||null)),eM(n,e),QO(n,e),Ce(n,132),n.end()}function nM(e,t,n){return(t.slice(-4)===".bin"?tM:zw)(e)}function aM(e,t,n,a,r){return(t.slice(-4)===".bin"?PO:Hw)(e,n,a,r)}function rM(e,t,n){return(t.slice(-4)===".bin"?_5:Tw)(e,n)}function sM(e,t,n){return(t.slice(-4)===".bin"?q6:vw)(e,n)}function iM(e,t,n){return(t.slice(-4)===".bin"?H5:kw)(e)}function lM(e){return(e.slice(-4)===".bin"?A5:Ew)()}function oM(e,t){var n=[];return e.Props&&n.push(r6(e.Props,t)),e.Custprops&&n.push(s6(e.Props,e.Custprops)),n.join("")}function cM(){return""}function uM(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,r){var l=[];l.push(Me("NumberFormat",null,{"ss:Format":vt(Kt[a.numFmtId])}));var o={"ss:ID":"s"+(21+r)};n.push(Me("Style",l.join(""),o))}),Me("Styles",n.join(""))}function Uw(e){return Me("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+qx(e.Ref,{r:0,c:0})})}function hM(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],a=0;a<t.length;++a){var r=t[a];r.Sheet==null&&(r.Name.match(/^_xlfn\./)||n.push(Uw(r)))}return Me("Names",n.join(""))}function fM(e,t,n,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var r=a.Workbook.Names,l=[],o=0;o<r.length;++o){var h=r[o];h.Sheet==n&&(h.Name.match(/^_xlfn\./)||l.push(Uw(h)))}return l.join("")}function dM(e,t,n,a){if(!e)return"";var r=[];if(e["!margins"]&&(r.push("<PageSetup>"),e["!margins"].header&&r.push(Me("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&r.push(Me("Footer",null,{"x:Margin":e["!margins"].footer})),r.push(Me("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),r.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[n])if(a.Workbook.Sheets[n].Hidden)r.push(Me("Visible",a.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<n&&!(a.Workbook.Sheets[l]&&!a.Workbook.Sheets[l].Hidden);++l);l==n&&r.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&r.push("<DisplayRightToLeft/>"),e["!protect"]&&(r.push(Tn("ProtectContents","True")),e["!protect"].objects&&r.push(Tn("ProtectObjects","True")),e["!protect"].scenarios&&r.push(Tn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?r.push(Tn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&r.push(Tn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&r.push("<"+o[1]+"/>")})),r.length==0?"":Me("WorksheetOptions",r.join(""),{xmlns:ia.x})}function xM(e){return e.map(function(t){var n=yA(t.t||""),a=Me("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return Me("Comment",a,{"ss:Author":t.a})}).join("")}function gM(e,t,n,a,r,l,o){if(!e||e.v==null&&e.f==null)return"";var h={};if(e.f&&(h["ss:Formula"]="="+vt(qx(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var f=dn(e.F.slice(t.length+1));h["ss:ArrayRange"]="RC:R"+(f.r==o.r?"":"["+(f.r-o.r)+"]")+"C"+(f.c==o.c?"":"["+(f.c-o.c)+"]")}if(e.l&&e.l.Target&&(h["ss:HRef"]=vt(e.l.Target),e.l.Tooltip&&(h["x:HRefScreenTip"]=vt(e.l.Tooltip))),n["!merges"])for(var d=n["!merges"],g=0;g!=d.length;++g)d[g].s.c!=o.c||d[g].s.r!=o.r||(d[g].e.c>d[g].s.c&&(h["ss:MergeAcross"]=d[g].e.c-d[g].s.c),d[g].e.r>d[g].s.r&&(h["ss:MergeDown"]=d[g].e.r-d[g].s.r));var p="",y="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":p="Number",y=String(e.v);break;case"b":p="Boolean",y=e.v?"1":"0";break;case"e":p="Error",y=_c[e.v];break;case"d":p="DateTime",y=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Kt[14]);break;case"s":p="String",y=pA(e.v||"");break}var w=vs(a.cellXfs,e,a);h["ss:StyleID"]="s"+(21+w),h["ss:Index"]=o.c+1;var _=e.v!=null?y:"",b=e.t=="z"?"":'<Data ss:Type="'+p+'">'+_+"</Data>";return(e.c||[]).length>0&&(b+=xM(e.c)),Me("Cell",b,h)}function mM(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=_w(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function pM(e,t,n,a){if(!e["!ref"])return"";var r=Mt(e["!ref"]),l=e["!merges"]||[],o=0,h=[];e["!cols"]&&e["!cols"].forEach(function(T,S){Xx(T);var E=!!T.width,C=sf(S,T),A={"ss:Index":S+1};E&&(A["ss:Width"]=Hh(C.width)),T.hidden&&(A["ss:Hidden"]="1"),h.push(Me("Column",null,A))});for(var f=Array.isArray(e),d=r.s.r;d<=r.e.r;++d){for(var g=[mM(d,(e["!rows"]||[])[d])],p=r.s.c;p<=r.e.c;++p){var y=!1;for(o=0;o!=l.length;++o)if(!(l[o].s.c>p)&&!(l[o].s.r>d)&&!(l[o].e.c<p)&&!(l[o].e.r<d)){(l[o].s.c!=p||l[o].s.r!=d)&&(y=!0);break}if(!y){var w={r:d,c:p},_=bt(w),b=f?(e[d]||[])[p]:e[_];g.push(gM(b,_,e,t,n,a,w))}}g.push("</Row>"),g.length>2&&h.push(g.join(""))}return h.join("")}function yM(e,t,n){var a=[],r=n.SheetNames[e],l=n.Sheets[r],o=l?fM(l,t,e,n):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=l?pM(l,t,e,n):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(dM(l,t,e,n)),a.join("")}function vM(e,t){t||(t={}),e.SSF||(e.SSF=$n(Kt)),e.SSF&&(ef(),Jh(e.SSF),t.revssf=tf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],vs(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(oM(e,t)),n.push(cM()),n.push(""),n.push("");for(var a=0;a<e.SheetNames.length;++a)n.push(Me("Worksheet",yM(a,t,e),{"ss:Name":vt(e.SheetNames[a])}));return n[2]=uM(e,t),n[3]=hM(e),Zt+Me("Workbook",n.join(""),{xmlns:ia.ss,"xmlns:o":ia.o,"xmlns:x":ia.x,"xmlns:ss":ia.ss,"xmlns:dt":ia.dt,"xmlns:html":ia.html})}var Pd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function bM(e,t){var n=[],a=[],r=[],l=0,o,h=Nv(Hv,"n"),f=Nv(Pv,"n");if(e.Props)for(o=En(e.Props),l=0;l<o.length;++l)(Object.prototype.hasOwnProperty.call(h,o[l])?n:Object.prototype.hasOwnProperty.call(f,o[l])?a:r).push([o[l],e.Props[o[l]]]);if(e.Custprops)for(o=En(e.Custprops),l=0;l<o.length;++l)Object.prototype.hasOwnProperty.call(e.Props||{},o[l])||(Object.prototype.hasOwnProperty.call(h,o[l])?n:Object.prototype.hasOwnProperty.call(f,o[l])?a:r).push([o[l],e.Custprops[o[l]]]);var d=[];for(l=0;l<r.length;++l)fw.indexOf(r[l][0])>-1||cw.indexOf(r[l][0])>-1||r[l][1]!=null&&d.push(r[l]);a.length&&kt.utils.cfb_add(t,"/SummaryInformation",Kv(a,Pd.SI,f,Pv)),(n.length||d.length)&&kt.utils.cfb_add(t,"/DocumentSummaryInformation",Kv(n,Pd.DSI,h,Hv,d.length?d:null,Pd.UDI))}function wM(e,t){var n=t||{},a=kt.utils.cfb_new({root:"R"}),r="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":r="/Workbook",n.biff=8;break;case"biff5":r="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return kt.utils.cfb_add(a,r,Vw(e,n)),n.biff==8&&(e.Props||e.Custprops)&&bM(e,a),n.biff==8&&e.vbaraw&&P5(a,kt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var _M={0:{f:N8},1:{f:M8},2:{f:J8},3:{f:z8},4:{f:B8},5:{f:q8},6:{f:rO},7:{f:W8},8:{f:hO},9:{f:uO},10:{f:oO},11:{f:cO},12:{f:F8},13:{f:tO},14:{f:V8},15:{f:P8},16:{f:Q8},17:{f:iO},18:{f:X8},19:{f:Vx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:$O},40:{},42:{},43:{f:r5},44:{f:n5},45:{f:l5},46:{f:c5},47:{f:o5},48:{},49:{f:FA},50:{},51:{f:N5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:L6},62:{f:aO},63:{f:D5},64:{f:CO},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:tr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:TO},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:D8},148:{f:k8,p:16},151:{f:pO},152:{},153:{f:YO},154:{},155:{},156:{f:GO},157:{},158:{},159:{T:1,f:G6},160:{T:-1},161:{T:1,f:hi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:fO},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:T5},336:{T:-1},337:{f:k5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ax},357:{},358:{},359:{},360:{T:1},361:{},362:{f:A6},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:yO},427:{f:vO},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:wO},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:A8},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:gO},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ax},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:L5},633:{T:1},634:{T:-1},635:{T:1,f:R5},636:{T:-1},637:{f:PA},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:IO},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:kO},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Re(e,t,n,a){var r=t;if(!isNaN(r)){var l=a||(n||[]).length||0,o=e.next(4);o.write_shift(2,r),o.write_shift(2,l),l>0&&Ix(n)&&e.push(n)}}function TM(e,t,n,a){var r=(n||[]).length||0;if(r<=8224)return Re(e,t,n,r);var l=t;if(!isNaN(l)){for(var o=n.parts||[],h=0,f=0,d=0;d+(o[h]||8224)<=8224;)d+=o[h]||8224,h++;var g=e.next(4);for(g.write_shift(2,l),g.write_shift(2,d),e.push(n.slice(f,f+d)),f+=d;f<r;){for(g=e.next(4),g.write_shift(2,60),d=0;d+(o[h]||8224)<=8224;)d+=o[h]||8224,h++;g.write_shift(2,d),e.push(n.slice(f,f+d)),f+=d}}}function Sc(e,t,n){return e||(e=be(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function SM(e,t,n,a){var r=be(9);return Sc(r,e,t),xw(n,a||"b",r),r}function NM(e,t,n){var a=be(8+2*n.length);return Sc(a,e,t),a.write_shift(1,n.length),a.write_shift(n.length,n,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function EM(e,t,n,a){if(t.v!=null)switch(t.t){case"d":case"n":var r=t.t=="d"?qn(Pn(t.v)):t.v;r==(r|0)&&r>=0&&r<65536?Re(e,2,I6(n,a,r)):Re(e,3,P6(n,a,r));return;case"b":case"e":Re(e,5,SM(n,a,t.v,t.t));return;case"s":case"str":Re(e,4,NM(n,a,(t.v||"").slice(0,255)));return}Re(e,1,Sc(null,n,a))}function CM(e,t,n,a){var r=Array.isArray(t),l=Mt(t["!ref"]||"A1"),o,h="",f=[];if(l.e.c>255||l.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),o=Qt(l)}for(var d=l.s.r;d<=l.e.r;++d){h=Nn(d);for(var g=l.s.c;g<=l.e.c;++g){d===l.s.r&&(f[g]=Mn(g)),o=f[g]+h;var p=r?(t[d]||[])[g]:t[o];p&&EM(e,p,d,g)}}}function kM(e,t){for(var n=t||{},a=Yn(),r=0,l=0;l<e.SheetNames.length;++l)e.SheetNames[l]==n.sheet&&(r=l);if(r==0&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return Re(a,n.biff==4?1033:n.biff==3?521:9,Gx(e,16,n)),CM(a,e.Sheets[e.SheetNames[r]],r,n),Re(a,10),a.end()}function jM(e,t,n){Re(e,49,_6({sz:12,name:"Arial"},n))}function AM(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var r=a[0];r<=a[1];++r)t[r]!=null&&Re(e,1054,N6(r,t[r],n))})}function DM(e,t){var n=be(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),Re(e,2151,n),n=be(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),pw(Mt(t["!ref"]||"A1"),n),n.write_shift(4,4),Re(e,2152,n)}function OM(e,t){for(var n=0;n<16;++n)Re(e,224,Gv({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Re(e,224,Gv(a,0,t))})}function MM(e,t){for(var n=0;n<t["!links"].length;++n){var a=t["!links"][n];Re(e,440,M6(a)),a[1].Tooltip&&Re(e,2048,R6(a))}delete t["!links"]}function RM(e,t){if(t){var n=0;t.forEach(function(a,r){++n<=256&&a&&Re(e,125,B6(sf(r,a),r))})}}function FM(e,t,n,a,r){var l=16+vs(r.cellXfs,t,r);if(t.v==null&&!t.bf){Re(e,513,ri(n,a,l));return}if(t.bf)Re(e,6,s8(t,n,a,r,l));else switch(t.t){case"d":case"n":var o=t.t=="d"?qn(Pn(t.v)):t.v;Re(e,515,j6(n,a,o,l));break;case"b":case"e":Re(e,517,k6(n,a,t.v,l,r,t.t));break;case"s":case"str":if(r.bookSST){var h=Qx(r.Strings,t.v,r.revStrings);Re(e,253,T6(n,a,h,l))}else Re(e,516,S6(n,a,(t.v||"").slice(0,255),l,r));break;default:Re(e,513,ri(n,a,l))}}function LM(e,t,n){var a=Yn(),r=n.SheetNames[e],l=n.Sheets[r]||{},o=(n||{}).Workbook||{},h=(o.Sheets||[])[e]||{},f=Array.isArray(l),d=t.biff==8,g,p="",y=[],w=Mt(l["!ref"]||"A1"),_=d?65536:16384;if(w.e.c>255||w.e.r>=_){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");w.e.c=Math.min(w.e.c,255),w.e.r=Math.min(w.e.c,_-1)}Re(a,2057,Gx(n,16,t)),Re(a,13,Ta(1)),Re(a,12,Ta(100)),Re(a,15,Hn(!0)),Re(a,17,Hn(!1)),Re(a,16,ai(.001)),Re(a,95,Hn(!0)),Re(a,42,Hn(!1)),Re(a,43,Hn(!1)),Re(a,130,Ta(1)),Re(a,128,C6()),Re(a,131,Hn(!1)),Re(a,132,Hn(!1)),d&&RM(a,l["!cols"]),Re(a,512,E6(w,t)),d&&(l["!links"]=[]);for(var b=w.s.r;b<=w.e.r;++b){p=Nn(b);for(var T=w.s.c;T<=w.e.c;++T){b===w.s.r&&(y[T]=Mn(T)),g=y[T]+p;var S=f?(l[b]||[])[T]:l[g];S&&(FM(a,S,b,T,t),d&&S.l&&l["!links"].push([g,S.l]))}}var E=h.CodeName||h.name||r;return d&&Re(a,574,w6((o.Views||[])[0])),d&&(l["!merges"]||[]).length&&Re(a,229,O6(l["!merges"])),d&&MM(a,l),Re(a,442,mw(E)),d&&DM(a,l),Re(a,10),a.end()}function BM(e,t,n){var a=Yn(),r=(e||{}).Workbook||{},l=r.Sheets||[],o=r.WBProps||{},h=n.biff==8,f=n.biff==5;if(Re(a,2057,Gx(e,5,n)),n.bookType=="xla"&&Re(a,135),Re(a,225,h?Ta(1200):null),Re(a,193,o6(2)),f&&Re(a,191),f&&Re(a,192),Re(a,226),Re(a,92,p6("SheetJS",n)),Re(a,66,Ta(h?1200:1252)),h&&Re(a,353,Ta(0)),h&&Re(a,448),Re(a,317,H6(e.SheetNames.length)),h&&e.vbaraw&&Re(a,211),h&&e.vbaraw){var d=o.CodeName||"ThisWorkbook";Re(a,442,mw(d))}Re(a,156,Ta(17)),Re(a,25,Hn(!1)),Re(a,18,Hn(!1)),Re(a,19,Ta(0)),h&&Re(a,431,Hn(!1)),h&&Re(a,444,Ta(0)),Re(a,61,b6()),Re(a,64,Hn(!1)),Re(a,141,Ta(0)),Re(a,34,Hn(UO(e)=="true")),Re(a,14,Hn(!0)),h&&Re(a,439,Hn(!1)),Re(a,218,Ta(0)),jM(a,e,n),AM(a,e.SSF,n),OM(a,n),h&&Re(a,352,Hn(!1));var g=a.end(),p=Yn();h&&Re(p,140,F6()),h&&n.Strings&&TM(p,252,v6(n.Strings)),Re(p,10);var y=p.end(),w=Yn(),_=0,b=0;for(b=0;b<e.SheetNames.length;++b)_+=(h?12:11)+(h?2:1)*e.SheetNames[b].length;var T=g.length+_+y.length;for(b=0;b<e.SheetNames.length;++b){var S=l[b]||{};Re(w,133,y6({pos:T,hs:S.Hidden||0,dt:0,name:e.SheetNames[b]},n)),T+=t[b].length}var E=w.end();if(_!=E.length)throw new Error("BS8 "+_+" != "+E.length);var C=[];return g.length&&C.push(g),E.length&&C.push(E),y.length&&C.push(y),_n(C)}function HM(e,t){var n=t||{},a=[];e&&!e.SSF&&(e.SSF=$n(Kt)),e&&e.SSF&&(ef(),Jh(e.SSF),n.revssf=tf(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Zx(n),n.cellXfs=[],vs(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var r=0;r<e.SheetNames.length;++r)a[a.length]=LM(r,n,e);return a.unshift(BM(e,a,n)),_n(a)}function Vw(e,t){for(var n=0;n<=e.SheetNames.length;++n){var a=e.Sheets[e.SheetNames[n]];if(!(!a||!a["!ref"])){var r=ca(a["!ref"]);r.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var l=t||{};switch(l.biff||2){case 8:case 5:return HM(e,t);case 4:case 3:case 2:return kM(e,t)}throw new Error("invalid type "+l.bookType+" for BIFF")}function PM(e,t,n,a){for(var r=e["!merges"]||[],l=[],o=t.s.c;o<=t.e.c;++o){for(var h=0,f=0,d=0;d<r.length;++d)if(!(r[d].s.r>n||r[d].s.c>o)&&!(r[d].e.r<n||r[d].e.c<o)){if(r[d].s.r<n||r[d].s.c<o){h=-1;break}h=r[d].e.r-r[d].s.r+1,f=r[d].e.c-r[d].s.c+1;break}if(!(h<0)){var g=bt({r:n,c:o}),p=a.dense?(e[n]||[])[o]:e[g],y=p&&p.v!=null&&(p.h||mA(p.w||(Mr(p),p.w)||""))||"",w={};h>1&&(w.rowspan=h),f>1&&(w.colspan=f),a.editable?y='<span contenteditable="true">'+y+"</span>":p&&(w["data-t"]=p&&p.t||"z",p.v!=null&&(w["data-v"]=p.v),p.z!=null&&(w["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+p.l.Target+'">'+y+"</a>")),w.id=(a.id||"sjs")+"-"+g,l.push(Me("td",y,w))}}var _="<tr>";return _+l.join("")+"</tr>"}var IM='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',zM="</body></html>";function UM(e,t,n){var a=[];return a.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function Kw(e,t){var n=t||{},a=n.header!=null?n.header:IM,r=n.footer!=null?n.footer:zM,l=[a],o=ca(e["!ref"]);n.dense=Array.isArray(e),l.push(UM(e,o,n));for(var h=o.s.r;h<=o.e.r;++h)l.push(PM(e,o,h,n));return l.push("</table>"+r),l.join("")}function Ww(e,t,n){var a=n||{},r=0,l=0;if(a.origin!=null)if(typeof a.origin=="number")r=a.origin;else{var o=typeof a.origin=="string"?dn(a.origin):a.origin;r=o.r,l=o.c}var h=t.getElementsByTagName("tr"),f=Math.min(a.sheetRows||1e7,h.length),d={s:{r:0,c:0},e:{r,c:l}};if(e["!ref"]){var g=ca(e["!ref"]);d.s.r=Math.min(d.s.r,g.s.r),d.s.c=Math.min(d.s.c,g.s.c),d.e.r=Math.max(d.e.r,g.e.r),d.e.c=Math.max(d.e.c,g.e.c),r==-1&&(d.e.r=r=g.e.r+1)}var p=[],y=0,w=e["!rows"]||(e["!rows"]=[]),_=0,b=0,T=0,S=0,E=0,C=0;for(e["!cols"]||(e["!cols"]=[]);_<h.length&&b<f;++_){var A=h[_];if(Jv(A)){if(a.display)continue;w[b]={hidden:!0}}var F=A.children;for(T=S=0;T<F.length;++T){var K=F[T];if(!(a.display&&Jv(K))){var D=K.hasAttribute("data-v")?K.getAttribute("data-v"):K.hasAttribute("v")?K.getAttribute("v"):bA(K.innerHTML),H=K.getAttribute("data-z")||K.getAttribute("z");for(y=0;y<p.length;++y){var M=p[y];M.s.c==S+l&&M.s.r<b+r&&b+r<=M.e.r&&(S=M.e.c+1-l,y=-1)}C=+K.getAttribute("colspan")||1,((E=+K.getAttribute("rowspan")||1)>1||C>1)&&p.push({s:{r:b+r,c:S+l},e:{r:b+r+(E||1)-1,c:S+l+(C||1)-1}});var B={t:"s",v:D},I=K.getAttribute("data-t")||K.getAttribute("t")||"";D!=null&&(D.length==0?B.t=I||"z":a.raw||D.trim().length==0||I=="s"||(D==="TRUE"?B={t:"b",v:!0}:D==="FALSE"?B={t:"b",v:!1}:isNaN(jr(D))?isNaN(uc(D).getDate())||(B={t:"d",v:Pn(D)},a.cellDates||(B={t:"n",v:qn(B.v)}),B.z=a.dateNF||Kt[14]):B={t:"n",v:jr(D)})),B.z===void 0&&H!=null&&(B.z=H);var te="",q=K.getElementsByTagName("A");if(q&&q.length)for(var ae=0;ae<q.length&&!(q[ae].hasAttribute("href")&&(te=q[ae].getAttribute("href"),te.charAt(0)!="#"));++ae);te&&te.charAt(0)!="#"&&(B.l={Target:te}),a.dense?(e[b+r]||(e[b+r]=[]),e[b+r][S+l]=B):e[bt({c:S+l,r:b+r})]=B,d.e.c<S+l&&(d.e.c=S+l),S+=C}}++b}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),d.e.r=Math.max(d.e.r,b-1+r),e["!ref"]=Qt(d),b>=f&&(e["!fullref"]=Qt((d.e.r=h.length-_+b-1+r,d))),e}function Gw(e,t){var n=t||{},a=n.dense?[]:{};return Ww(a,e,t)}function VM(e,t){return li(Gw(e,t),t)}function Jv(e){var t="",n=KM(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function KM(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var WM=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+fc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Zt+t}}(),e2=function(){var e=function(l){return vt(l).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,a=function(l,o,h){var f=[];f.push('      <table:table table:name="'+vt(o.SheetNames[h])+`" table:style-name="ta1">
`);var d=0,g=0,p=ca(l["!ref"]||"A1"),y=l["!merges"]||[],w=0,_=Array.isArray(l);if(l["!cols"])for(g=0;g<=p.e.c;++g)f.push("        <table:table-column"+(l["!cols"][g]?' table:style-name="co'+l["!cols"][g].ods+'"':"")+`></table:table-column>
`);var b="",T=l["!rows"]||[];for(d=0;d<p.s.r;++d)b=T[d]?' table:style-name="ro'+T[d].ods+'"':"",f.push("        <table:table-row"+b+`></table:table-row>
`);for(;d<=p.e.r;++d){for(b=T[d]?' table:style-name="ro'+T[d].ods+'"':"",f.push("        <table:table-row"+b+`>
`),g=0;g<p.s.c;++g)f.push(t);for(;g<=p.e.c;++g){var S=!1,E={},C="";for(w=0;w!=y.length;++w)if(!(y[w].s.c>g)&&!(y[w].s.r>d)&&!(y[w].e.c<g)&&!(y[w].e.r<d)){(y[w].s.c!=g||y[w].s.r!=d)&&(S=!0),E["table:number-columns-spanned"]=y[w].e.c-y[w].s.c+1,E["table:number-rows-spanned"]=y[w].e.r-y[w].s.r+1;break}if(S){f.push(n);continue}var A=bt({r:d,c:g}),F=_?(l[d]||[])[g]:l[A];if(F&&F.f&&(E["table:formula"]=vt(h8(F.f)),F.F&&F.F.slice(0,A.length)==A)){var K=ca(F.F);E["table:number-matrix-columns-spanned"]=K.e.c-K.s.c+1,E["table:number-matrix-rows-spanned"]=K.e.r-K.s.r+1}if(!F){f.push(t);continue}switch(F.t){case"b":C=F.v?"TRUE":"FALSE",E["office:value-type"]="boolean",E["office:boolean-value"]=F.v?"true":"false";break;case"n":C=F.w||String(F.v||0),E["office:value-type"]="float",E["office:value"]=F.v||0;break;case"s":case"str":C=F.v==null?"":F.v,E["office:value-type"]="string";break;case"d":C=F.w||Pn(F.v).toISOString(),E["office:value-type"]="date",E["office:date-value"]=Pn(F.v).toISOString(),E["table:style-name"]="ce1";break;default:f.push(t);continue}var D=e(C);if(F.l&&F.l.Target){var H=F.l.Target;H=H.charAt(0)=="#"?"#"+f8(H.slice(1)):H,H.charAt(0)!="#"&&!H.match(/^\w+:/)&&(H="../"+H),D=Me("text:a",D,{"xlink:href":H.replace(/&/g,"&amp;")})}f.push("          "+Me("table:table-cell",Me("text:p",D,{}),E)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},r=function(l,o){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var h=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var g=0;g<d["!cols"].length;++g)if(d["!cols"][g]){var p=d["!cols"][g];if(p.width==null&&p.wpx==null&&p.wch==null)continue;Xx(p),p.ods=h;var y=d["!cols"][g].wpx+"px";l.push('  <style:style style:name="co'+h+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),l.push(`  </style:style>
`),++h}}});var f=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var g=0;g<d["!rows"].length;++g)if(d["!rows"][g]){d["!rows"][g].ods=f;var p=d["!rows"][g].hpx+"px";l.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),l.push(`  </style:style>
`),++f}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(o,h){var f=[Zt],d=fc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),g=fc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});h.bookType=="fods"?(f.push("<office:document"+d+g+`>
`),f.push(lw().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+d+`>
`),r(f,o),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var p=0;p!=o.SheetNames.length;++p)f.push(a(o.Sheets[o.SheetNames[p]],o,p));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),h.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}}();function Xw(e,t){if(t.bookType=="fods")return e2(e,t);var n=Lx(),a="",r=[],l=[];return a="mimetype",$e(n,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",$e(n,a,e2(e,t)),r.push([a,"text/xml"]),l.push([a,"ContentFile"]),a="styles.xml",$e(n,a,WM(e,t)),r.push([a,"text/xml"]),l.push([a,"StylesFile"]),a="meta.xml",$e(n,a,Zt+lw()),r.push([a,"text/xml"]),l.push([a,"MetadataFile"]),a="manifest.rdf",$e(n,a,a6(l)),r.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",$e(n,a,t6(r)),n}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function zh(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function GM(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Fa(hc(e))}function XM(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var a=0;a<t.length;++a)if(e[n+a]!=t[a])continue e;return!0}return!1}function ys(e){var t=e.reduce(function(r,l){return r+l.length},0),n=new Uint8Array(t),a=0;return e.forEach(function(r){n.set(r,a),a+=r.length}),n}function YM(e,t,n){var a=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,r=n/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var l=0;r>=1;++l,r/=256)e[t+l]=r&255;e[t+15]|=n>=0?0:128}function dc(e,t){var n=t?t[0]:0,a=e[n]&127;e:if(e[n++]>=128&&(a|=(e[n]&127)<<7,e[n++]<128||(a|=(e[n]&127)<<14,e[n++]<128)||(a|=(e[n]&127)<<21,e[n++]<128)||(a+=(e[n]&127)*Math.pow(2,28),++n,e[n++]<128)||(a+=(e[n]&127)*Math.pow(2,35),++n,e[n++]<128)||(a+=(e[n]&127)*Math.pow(2,42),++n,e[n++]<128)))break e;return t&&(t[0]=n),a}function pt(e){var t=new Uint8Array(7);t[0]=e&127;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383||(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)||(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)||(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)||(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103))break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function ol(e){var t=0,n=e[t]&127;e:if(e[t++]>=128){if(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128))break e;n|=(e[t]&127)<<28}return n}function nn(e){for(var t=[],n=[0];n[0]<e.length;){var a=n[0],r=dc(e,n),l=r&7;r=Math.floor(r/8);var o=0,h;if(r==0)break;switch(l){case 0:{for(var f=n[0];e[n[0]++]>=128;);h=e.slice(f,n[0])}break;case 5:o=4,h=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,h=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=dc(e,n),h=e.slice(n[0],n[0]+o),n[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(r," at offset ").concat(a))}var d={data:h,type:l};t[r]==null?t[r]=[d]:t[r].push(d)}return t}function vn(e){var t=[];return e.forEach(function(n,a){n.forEach(function(r){r.data&&(t.push(pt(a*8+r.type)),r.type==2&&t.push(pt(r.data.length)),t.push(r.data))})}),ys(t)}function Ma(e){for(var t,n=[],a=[0];a[0]<e.length;){var r=dc(e,a),l=nn(e.slice(a[0],a[0]+r));a[0]+=r;var o={id:ol(l[1][0].data),messages:[]};l[2].forEach(function(h){var f=nn(h.data),d=ol(f[3][0].data);o.messages.push({meta:f,data:e.slice(a[0],a[0]+d)}),a[0]+=d}),(t=l[3])!=null&&t[0]&&(o.merge=ol(l[3][0].data)>>>0>0),n.push(o)}return n}function $i(e){var t=[];return e.forEach(function(n){var a=[];a[1]=[{data:pt(n.id),type:0}],a[2]=[],n.merge!=null&&(a[3]=[{data:pt(+!!n.merge),type:0}]);var r=[];n.messages.forEach(function(o){r.push(o.data),o.meta[3]=[{type:0,data:pt(o.data.length)}],a[2].push({data:vn(o.meta),type:2})});var l=vn(a);t.push(pt(l.length)),t.push(l),r.forEach(function(o){return t.push(o)})}),ys(t)}function qM(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],a=dc(t,n),r=[];n[0]<t.length;){var l=t[n[0]]&3;if(l==0){var o=t[n[0]++]>>2;if(o<60)++o;else{var h=o-59;o=t[n[0]],h>1&&(o|=t[n[0]+1]<<8),h>2&&(o|=t[n[0]+2]<<16),h>3&&(o|=t[n[0]+3]<<24),o>>>=0,o++,n[0]+=h}r.push(t.slice(n[0],n[0]+o)),n[0]+=o;continue}else{var f=0,d=0;if(l==1?(d=(t[n[0]]>>2&7)+4,f=(t[n[0]++]&224)<<3,f|=t[n[0]++]):(d=(t[n[0]++]>>2)+1,l==2?(f=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(f=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),r=[ys(r)],f==0)throw new Error("Invalid offset 0");if(f>r[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(r.push(r[0].slice(-f)),d-=f;d>=r[r.length-1].length;)r.push(r[r.length-1]),d-=r[r.length-1].length;r.push(r[0].slice(-f,-f+d))}}var g=ys(r);if(g.length!=a)throw new Error("Unexpected length: ".concat(g.length," != ").concat(a));return g}function Ra(e){for(var t=[],n=0;n<e.length;){var a=e[n++],r=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(qM(a,e.slice(n,n+r))),n+=r}if(n!==e.length)throw new Error("data is not a valid framed stream!");return ys(t)}function Qi(e){for(var t=[],n=0;n<e.length;){var a=Math.min(e.length-n,268435455),r=new Uint8Array(4);t.push(r);var l=pt(a),o=l.length;t.push(l),a<=60?(o++,t.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(n,n+a)),o+=a,r[0]=0,r[1]=o&255,r[2]=o>>8&255,r[3]=o>>16&255,n+=a}return ys(t)}function Id(e,t){var n=new Uint8Array(32),a=zh(n),r=12,l=0;switch(n[0]=5,e.t){case"n":n[1]=2,YM(n,r,e.v),l|=1,r+=16;break;case"b":n[1]=6,a.setFloat64(r,e.v?1:0,!0),l|=2,r+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,a.setUint32(r,t.indexOf(e.v),!0),l|=8,r+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,l,!0),n.slice(0,r)}function zd(e,t){var n=new Uint8Array(32),a=zh(n),r=12,l=0;switch(n[0]=3,e.t){case"n":n[2]=2,a.setFloat64(r,e.v,!0),l|=32,r+=8;break;case"b":n[2]=6,a.setFloat64(r,e.v?1:0,!0),l|=32,r+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,a.setUint32(r,t.indexOf(e.v),!0),l|=16,r+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,l,!0),n.slice(0,r)}function is(e){var t=nn(e);return dc(t[1][0].data)}function $M(e,t,n){var a,r,l,o;if(!((a=e[6])!=null&&a[0])||!((r=e[7])!=null&&r[0]))throw"Mutation only works on post-BNC storages!";var h=((o=(l=e[8])==null?void 0:l[0])==null?void 0:o.data)&&ol(e[8][0].data)>0||!1;if(h)throw"Math only works with normal offsets";for(var f=0,d=zh(e[7][0].data),g=0,p=[],y=zh(e[4][0].data),w=0,_=[],b=0;b<t.length;++b){if(t[b]==null){d.setUint16(b*2,65535,!0),y.setUint16(b*2,65535);continue}d.setUint16(b*2,g,!0),y.setUint16(b*2,w,!0);var T,S;switch(typeof t[b]){case"string":T=Id({t:"s",v:t[b]},n),S=zd({t:"s",v:t[b]},n);break;case"number":T=Id({t:"n",v:t[b]},n),S=zd({t:"n",v:t[b]},n);break;case"boolean":T=Id({t:"b",v:t[b]},n),S=zd({t:"b",v:t[b]},n);break;default:throw new Error("Unsupported value "+t[b])}p.push(T),g+=T.length,_.push(S),w+=S.length,++f}for(e[2][0].data=pt(f);b<e[7][0].data.length/2;++b)d.setUint16(b*2,65535,!0),y.setUint16(b*2,65535,!0);return e[6][0].data=ys(p),e[3][0].data=ys(_),f}function QM(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=ca(n["!ref"]);a.s.r=a.s.c=0;var r=!1;a.e.c>9&&(r=!0,a.e.c=9),a.e.r>49&&(r=!0,a.e.r=49),r&&console.error("The Numbers writer is currently limited to ".concat(Qt(a)));var l=Uh(n,{range:a,header:1}),o=["~Sh33tJ5~"];l.forEach(function(Z){return Z.forEach(function(k){typeof k=="string"&&o.push(k)})});var h={},f=[],d=kt.read(t.numbers,{type:"base64"});d.FileIndex.map(function(Z,k){return[Z,d.FullPaths[k]]}).forEach(function(Z){var k=Z[0],V=Z[1];if(k.type==2&&k.name.match(/\.iwa/)){var U=k.content,Te=Ra(U),ie=Ma(Te);ie.forEach(function(we){f.push(we.id),h[we.id]={deps:[],location:V,type:ol(we.messages[0].meta[1][0].data)}})}}),f.sort(function(Z,k){return Z-k});var g=f.filter(function(Z){return Z>1}).map(function(Z){return[Z,pt(Z)]});d.FileIndex.map(function(Z,k){return[Z,d.FullPaths[k]]}).forEach(function(Z){var k=Z[0];if(Z[1],!!k.name.match(/\.iwa/)){var V=Ma(Ra(k.content));V.forEach(function(U){U.messages.forEach(function(Te){g.forEach(function(ie){U.messages.some(function(we){return ol(we.meta[1][0].data)!=11006&&XM(we.data,ie[1])})&&h[ie[0]].deps.push(U.id)})})})}});for(var p=kt.find(d,h[1].location),y=Ma(Ra(p.content)),w,_=0;_<y.length;++_){var b=y[_];b.id==1&&(w=b)}var T=is(nn(w.messages[0].data)[1][0].data);for(p=kt.find(d,h[T].location),y=Ma(Ra(p.content)),_=0;_<y.length;++_)b=y[_],b.id==T&&(w=b);for(T=is(nn(w.messages[0].data)[2][0].data),p=kt.find(d,h[T].location),y=Ma(Ra(p.content)),_=0;_<y.length;++_)b=y[_],b.id==T&&(w=b);for(T=is(nn(w.messages[0].data)[2][0].data),p=kt.find(d,h[T].location),y=Ma(Ra(p.content)),_=0;_<y.length;++_)b=y[_],b.id==T&&(w=b);var S=nn(w.messages[0].data);{S[6][0].data=pt(a.e.r+1),S[7][0].data=pt(a.e.c+1);var E=is(S[46][0].data),C=kt.find(d,h[E].location),A=Ma(Ra(C.content));{for(var F=0;F<A.length&&A[F].id!=E;++F);if(A[F].id!=E)throw"Bad ColumnRowUIDMapArchive";var K=nn(A[F].messages[0].data);K[1]=[],K[2]=[],K[3]=[];for(var D=0;D<=a.e.c;++D){var H=[];H[1]=H[2]=[{type:0,data:pt(D+420690)}],K[1].push({type:2,data:vn(H)}),K[2].push({type:0,data:pt(D)}),K[3].push({type:0,data:pt(D)})}K[4]=[],K[5]=[],K[6]=[];for(var M=0;M<=a.e.r;++M)H=[],H[1]=H[2]=[{type:0,data:pt(M+726270)}],K[4].push({type:2,data:vn(H)}),K[5].push({type:0,data:pt(M)}),K[6].push({type:0,data:pt(M)});A[F].messages[0].data=vn(K)}C.content=Qi($i(A)),C.size=C.content.length,delete S[46];var B=nn(S[4][0].data);{B[7][0].data=pt(a.e.r+1);var I=nn(B[1][0].data),te=is(I[2][0].data);C=kt.find(d,h[te].location),A=Ma(Ra(C.content));{if(A[0].id!=te)throw"Bad HeaderStorageBucket";var q=nn(A[0].messages[0].data);for(M=0;M<l.length;++M){var ae=nn(q[2][0].data);ae[1][0].data=pt(M),ae[4][0].data=pt(l[M].length),q[2][M]={type:q[2][0].type,data:vn(ae)}}A[0].messages[0].data=vn(q)}C.content=Qi($i(A)),C.size=C.content.length;var re=is(B[2][0].data);C=kt.find(d,h[re].location),A=Ma(Ra(C.content));{if(A[0].id!=re)throw"Bad HeaderStorageBucket";for(q=nn(A[0].messages[0].data),D=0;D<=a.e.c;++D)ae=nn(q[2][0].data),ae[1][0].data=pt(D),ae[4][0].data=pt(a.e.r+1),q[2][D]={type:q[2][0].type,data:vn(ae)};A[0].messages[0].data=vn(q)}C.content=Qi($i(A)),C.size=C.content.length;var ee=is(B[4][0].data);(function(){for(var Z=kt.find(d,h[ee].location),k=Ma(Ra(Z.content)),V,U=0;U<k.length;++U){var Te=k[U];Te.id==ee&&(V=Te)}var ie=nn(V.messages[0].data);{ie[3]=[];var we=[];o.forEach(function(Ue,rt){we[1]=[{type:0,data:pt(rt)}],we[2]=[{type:0,data:pt(1)}],we[3]=[{type:2,data:GM(Ue)}],ie[3].push({type:2,data:vn(we)})})}V.messages[0].data=vn(ie);var Ne=$i(k),ze=Qi(Ne);Z.content=ze,Z.size=Z.content.length})();var Q=nn(B[3][0].data);{var pe=Q[1][0];delete Q[2];var ye=nn(pe.data);{var Y=is(ye[2][0].data);(function(){for(var Z=kt.find(d,h[Y].location),k=Ma(Ra(Z.content)),V,U=0;U<k.length;++U){var Te=k[U];Te.id==Y&&(V=Te)}var ie=nn(V.messages[0].data);{delete ie[6],delete Q[7];var we=new Uint8Array(ie[5][0].data);ie[5]=[];for(var Ne=0,ze=0;ze<=a.e.r;++ze){var Ue=nn(we);Ne+=$M(Ue,l[ze],o),Ue[1][0].data=pt(ze),ie[5].push({data:vn(Ue),type:2})}ie[1]=[{type:0,data:pt(a.e.c+1)}],ie[2]=[{type:0,data:pt(a.e.r+1)}],ie[3]=[{type:0,data:pt(Ne)}],ie[4]=[{type:0,data:pt(a.e.r+1)}]}V.messages[0].data=vn(ie);var rt=$i(k),Ye=Qi(rt);Z.content=Ye,Z.size=Z.content.length})()}pe.data=vn(ye)}B[3][0].data=vn(Q)}S[4][0].data=vn(B)}w.messages[0].data=vn(S);var de=$i(y),P=Qi(de);return p.content=P,p.size=p.content.length,d}function ZM(e){return function(n){for(var a=0;a!=e.length;++a){var r=e[a];n[r[0]]===void 0&&(n[r[0]]=r[1]),r[2]==="n"&&(n[r[0]]=Number(n[r[0]]))}}}function Zx(e){ZM([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function JM(e,t){return t.bookType=="ods"?Xw(e,t):t.bookType=="numbers"?QM(e,t):t.bookType=="xlsb"?eR(e,t):tR(e,t)}function eR(e,t){tl=1024,e&&!e.SSF&&(e.SSF=$n(Kt)),e&&e.SSF&&(ef(),Jh(e.SSF),t.revssf=tf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,qo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n=t.bookType=="xlsb"?"bin":"xml",a=jw.indexOf(t.bookType)>-1,r=rw();Zx(t=t||{});var l=Lx(),o="",h=0;if(t.cellXfs=[],vs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",$e(l,o,ow(e.Props,t)),r.coreprops.push(o),yt(t.rels,2,o,ct.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(e.SheetNames[d]);e.Props.SheetNames=f}for(e.Props.Worksheets=e.Props.SheetNames.length,$e(l,o,uw(e.Props)),r.extprops.push(o),yt(t.rels,3,o,ct.EXT_PROPS),e.Custprops!==e.Props&&En(e.Custprops||{}).length>0&&(o="docProps/custom.xml",$e(l,o,hw(e.Custprops)),r.custprops.push(o),yt(t.rels,4,o,ct.CUST_PROPS)),h=1;h<=e.SheetNames.length;++h){var g={"!id":{}},p=e.Sheets[e.SheetNames[h-1]],y=(p||{})["!type"]||"sheet";switch(y){case"chart":default:o="xl/worksheets/sheet"+h+"."+n,$e(l,o,aM(h-1,o,t,e,g)),r.sheets.push(o),yt(t.wbrels,-1,"worksheets/sheet"+h+"."+n,ct.WS[0])}if(p){var w=p["!comments"],_=!1,b="";w&&w.length>0&&(b="xl/comments"+h+"."+n,$e(l,b,iM(w,b)),r.comments.push(b),yt(g,-1,"../comments"+h+"."+n,ct.CMNT),_=!0),p["!legacy"]&&_&&$e(l,"xl/drawings/vmlDrawing"+h+".vml",Cw(h,p["!comments"])),delete p["!comments"],delete p["!legacy"]}g["!id"].rId1&&$e(l,iw(o),il(g))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+n,$e(l,o,sM(t.Strings,o,t)),r.strs.push(o),yt(t.wbrels,-1,"sharedStrings."+n,ct.SST)),o="xl/workbook."+n,$e(l,o,nM(e,o)),r.workbooks.push(o),yt(t.rels,1,o,ct.WB),o="xl/theme/theme1.xml",$e(l,o,Nw(e.Themes,t)),r.themes.push(o),yt(t.wbrels,-1,"theme/theme1.xml",ct.THEME),o="xl/styles."+n,$e(l,o,rM(e,o,t)),r.styles.push(o),yt(t.wbrels,-1,"styles."+n,ct.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",$e(l,o,e.vbaraw),r.vba.push(o),yt(t.wbrels,-1,"vbaProject.bin",ct.VBA)),o="xl/metadata."+n,$e(l,o,lM(o)),r.metadata.push(o),yt(t.wbrels,-1,"metadata."+n,ct.XLMETA),$e(l,"[Content_Types].xml",sw(r,t)),$e(l,"_rels/.rels",il(t.rels)),$e(l,"xl/_rels/workbook."+n+".rels",il(t.wbrels)),delete t.revssf,delete t.ssf,l}function tR(e,t){tl=1024,e&&!e.SSF&&(e.SSF=$n(Kt)),e&&e.SSF&&(ef(),Jh(e.SSF),t.revssf=tf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,qo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",a=jw.indexOf(t.bookType)>-1,r=rw();Zx(t=t||{});var l=Lx(),o="",h=0;if(t.cellXfs=[],vs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",$e(l,o,ow(e.Props,t)),r.coreprops.push(o),yt(t.rels,2,o,ct.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(e.SheetNames[d]);e.Props.SheetNames=f}e.Props.Worksheets=e.Props.SheetNames.length,$e(l,o,uw(e.Props)),r.extprops.push(o),yt(t.rels,3,o,ct.EXT_PROPS),e.Custprops!==e.Props&&En(e.Custprops||{}).length>0&&(o="docProps/custom.xml",$e(l,o,hw(e.Custprops)),r.custprops.push(o),yt(t.rels,4,o,ct.CUST_PROPS));var g=["SheetJ5"];for(t.tcid=0,h=1;h<=e.SheetNames.length;++h){var p={"!id":{}},y=e.Sheets[e.SheetNames[h-1]],w=(y||{})["!type"]||"sheet";switch(w){case"chart":default:o="xl/worksheets/sheet"+h+"."+n,$e(l,o,Hw(h-1,t,e,p)),r.sheets.push(o),yt(t.wbrels,-1,"worksheets/sheet"+h+"."+n,ct.WS[0])}if(y){var _=y["!comments"],b=!1,T="";if(_&&_.length>0){var S=!1;_.forEach(function(E){E[1].forEach(function(C){C.T==!0&&(S=!0)})}),S&&(T="xl/threadedComments/threadedComment"+h+"."+n,$e(l,T,O5(_,g,t)),r.threadedcomments.push(T),yt(p,-1,"../threadedComments/threadedComment"+h+"."+n,ct.TCMNT)),T="xl/comments"+h+"."+n,$e(l,T,kw(_)),r.comments.push(T),yt(p,-1,"../comments"+h+"."+n,ct.CMNT),b=!0}y["!legacy"]&&b&&$e(l,"xl/drawings/vmlDrawing"+h+".vml",Cw(h,y["!comments"])),delete y["!comments"],delete y["!legacy"]}p["!id"].rId1&&$e(l,iw(o),il(p))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+n,$e(l,o,vw(t.Strings,t)),r.strs.push(o),yt(t.wbrels,-1,"sharedStrings."+n,ct.SST)),o="xl/workbook."+n,$e(l,o,zw(e)),r.workbooks.push(o),yt(t.rels,1,o,ct.WB),o="xl/theme/theme1.xml",$e(l,o,Nw(e.Themes,t)),r.themes.push(o),yt(t.wbrels,-1,"theme/theme1.xml",ct.THEME),o="xl/styles."+n,$e(l,o,Tw(e,t)),r.styles.push(o),yt(t.wbrels,-1,"styles."+n,ct.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",$e(l,o,e.vbaraw),r.vba.push(o),yt(t.wbrels,-1,"vbaProject.bin",ct.VBA)),o="xl/metadata."+n,$e(l,o,Ew()),r.metadata.push(o),yt(t.wbrels,-1,"metadata."+n,ct.XLMETA),g.length>1&&(o="xl/persons/person.xml",$e(l,o,M5(g)),r.people.push(o),yt(t.wbrels,-1,"persons/person.xml",ct.PEOPLE)),$e(l,"[Content_Types].xml",sw(r,t)),$e(l,"_rels/.rels",il(t.rels)),$e(l,"xl/_rels/workbook."+n+".rels",il(t.wbrels)),delete t.revssf,delete t.ssf,l}function nR(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=Or(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function Yw(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return bc(t.file,kt.write(e,{type:ht?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return kt.write(e,t)}function aR(e,t){var n=$n(t||{}),a=JM(e,n);return rR(a,n)}function rR(e,t){var n={},a=ht?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=a;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var r=e.FullPaths?kt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if(typeof Deno<"u"&&typeof r=="string"){if(t.type=="binary"||t.type=="base64")return r;r=new Uint8Array(Zh(r))}return t.password&&typeof encrypt_agile<"u"?Yw(encrypt_agile(r,t.password),t):t.type==="file"?bc(t.file,r):t.type=="string"?Wo(r):r}function sR(e,t){var n=t||{},a=wM(e,n);return Yw(a,n)}function Qa(e,t,n){n||(n="");var a=n+e;switch(t.type){case"base64":return cc(hc(a));case"binary":return hc(a);case"string":return e;case"file":return bc(t.file,a,"utf8");case"buffer":return ht?Fr(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):Qa(a,{type:"binary"}).split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function iR(e,t){switch(t.type){case"base64":return cc(e);case"binary":return e;case"string":return e;case"file":return bc(t.file,e,"binary");case"buffer":return ht?Fr(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function dh(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",a=0;a<e.length;++a)n+=String.fromCharCode(e[a]);return t.type=="base64"?cc(n):t.type=="string"?Wo(n):n;case"file":return bc(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function qw(e,t){Rj(),WO(e);var n=$n(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var a=qw(e,n);return n.type="array",Zh(a)}var r=0;if(n.sheet&&(typeof n.sheet=="number"?r=n.sheet:r=e.SheetNames.indexOf(n.sheet),!e.SheetNames[r]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return Qa(vM(e,n),n);case"slk":case"sylk":return Qa(U6.from_sheet(e.Sheets[e.SheetNames[r]],n),n);case"htm":case"html":return Qa(Kw(e.Sheets[e.SheetNames[r]],n),n);case"txt":return iR($w(e.Sheets[e.SheetNames[r]],n),n);case"csv":return Qa(Jx(e.Sheets[e.SheetNames[r]],n),n,"\uFEFF");case"dif":return Qa(V6.from_sheet(e.Sheets[e.SheetNames[r]],n),n);case"dbf":return dh(z6.from_sheet(e.Sheets[e.SheetNames[r]],n),n);case"prn":return Qa(K6.from_sheet(e.Sheets[e.SheetNames[r]],n),n);case"rtf":return Qa(Q6.from_sheet(e.Sheets[e.SheetNames[r]],n),n);case"eth":return Qa(yw.from_sheet(e.Sheets[e.SheetNames[r]],n),n);case"fods":return Qa(Xw(e,n),n);case"wk1":return dh(Xv.sheet_to_wk1(e.Sheets[e.SheetNames[r]],n),n);case"wk3":return dh(Xv.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),dh(Vw(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),sR(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return aR(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function lR(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(e.bookType=n.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function oR(e,t,n){var a={};return a.type="file",a.file=t,lR(a),qw(e,a)}function cR(e,t,n,a,r,l,o,h){var f=Nn(n),d=h.defval,g=h.raw||!Object.prototype.hasOwnProperty.call(h,"raw"),p=!0,y=r===1?[]:{};if(r!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:n,enumerable:!1})}catch{y.__rowNum__=n}else y.__rowNum__=n;if(!o||e[n])for(var w=t.s.c;w<=t.e.c;++w){var _=o?e[n][w]:e[a[w]+f];if(_===void 0||_.t===void 0){if(d===void 0)continue;l[w]!=null&&(y[l[w]]=d);continue}var b=_.v;switch(_.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+_.t)}if(l[w]!=null){if(b==null)if(_.t=="e"&&b===null)y[l[w]]=null;else if(d!==void 0)y[l[w]]=d;else if(g&&b===null)y[l[w]]=null;else continue;else y[l[w]]=g&&(_.t!=="n"||_.t==="n"&&h.rawNumbers!==!1)?b:Mr(_,b,h);b!=null&&(p=!1)}}return{row:y,isempty:p}}function Uh(e,t){if(e==null||e["!ref"]==null)return[];var n={t:"n",v:0},a=0,r=1,l=[],o=0,h="",f={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},g=d.range!=null?d.range:e["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof g){case"string":f=Mt(g);break;case"number":f=Mt(e["!ref"]),f.s.r=g;break;default:f=g}a>0&&(r=0);var p=Nn(f.s.r),y=[],w=[],_=0,b=0,T=Array.isArray(e),S=f.s.r,E=0,C={};T&&!e[S]&&(e[S]=[]);var A=d.skipHidden&&e["!cols"]||[],F=d.skipHidden&&e["!rows"]||[];for(E=f.s.c;E<=f.e.c;++E)if(!(A[E]||{}).hidden)switch(y[E]=Mn(E),n=T?e[S][E]:e[y[E]+p],a){case 1:l[E]=E-f.s.c;break;case 2:l[E]=y[E];break;case 3:l[E]=d.header[E-f.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),h=o=Mr(n,null,d),b=C[o]||0,!b)C[o]=1;else{do h=o+"_"+b++;while(C[h]);C[o]=b,C[h]=1}l[E]=h}for(S=f.s.r+r;S<=f.e.r;++S)if(!(F[S]||{}).hidden){var K=cR(e,f,S,y,a,l,T,d);(K.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(w[_++]=K.row)}return w.length=_,w}var t2=/"/g;function uR(e,t,n,a,r,l,o,h){for(var f=!0,d=[],g="",p=Nn(n),y=t.s.c;y<=t.e.c;++y)if(a[y]){var w=h.dense?(e[n]||[])[y]:e[a[y]+p];if(w==null)g="";else if(w.v!=null){f=!1,g=""+(h.rawNumbers&&w.t=="n"?w.v:Mr(w,null,h));for(var _=0,b=0;_!==g.length;++_)if((b=g.charCodeAt(_))===r||b===l||b===34||h.forceQuotes){g='"'+g.replace(t2,'""')+'"';break}g=="ID"&&(g='"ID"')}else w.f!=null&&!w.F?(f=!1,g="="+w.f,g.indexOf(",")>=0&&(g='"'+g.replace(t2,'""')+'"')):g="";d.push(g)}return h.blankrows===!1&&f?null:d.join(o)}function Jx(e,t){var n=[],a=t??{};if(e==null||e["!ref"]==null)return"";var r=Mt(e["!ref"]),l=a.FS!==void 0?a.FS:",",o=l.charCodeAt(0),h=a.RS!==void 0?a.RS:`
`,f=h.charCodeAt(0),d=new RegExp((l=="|"?"\\|":l)+"+$"),g="",p=[];a.dense=Array.isArray(e);for(var y=a.skipHidden&&e["!cols"]||[],w=a.skipHidden&&e["!rows"]||[],_=r.s.c;_<=r.e.c;++_)(y[_]||{}).hidden||(p[_]=Mn(_));for(var b=0,T=r.s.r;T<=r.e.r;++T)(w[T]||{}).hidden||(g=uR(e,r,T,p,o,f,l,a),g!=null&&(a.strip&&(g=g.replace(d,"")),(g||a.blankrows!==!1)&&n.push((b++?h:"")+g)));return delete a.dense,n.join("")}function $w(e,t){t||(t={}),t.FS="	",t.RS=`
`;var n=Jx(e,t);return n}function hR(e){var t="",n,a="";if(e==null||e["!ref"]==null)return[];var r=Mt(e["!ref"]),l="",o=[],h,f=[],d=Array.isArray(e);for(h=r.s.c;h<=r.e.c;++h)o[h]=Mn(h);for(var g=r.s.r;g<=r.e.r;++g)for(l=Nn(g),h=r.s.c;h<=r.e.c;++h)if(t=o[h]+l,n=d?(e[g]||[])[h]:e[t],a="",n!==void 0){if(n.F!=null){if(t=n.F,!n.f)continue;a=n.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(n.f!=null)a=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)a=""+n.v;else if(n.t=="b")a=n.v?"TRUE":"FALSE";else if(n.w!==void 0)a="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?a="'"+n.v:a=""+n.v}}f[f.length]=t+"="+a}return f}function Qw(e,t,n){var a=n||{},r=+!a.skipHeader,l=e||{},o=0,h=0;if(l&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var f=typeof a.origin=="string"?dn(a.origin):a.origin;o=f.r,h=f.c}var d,g={s:{c:0,r:0},e:{c:h,r:o+t.length-1+r}};if(l["!ref"]){var p=Mt(l["!ref"]);g.e.c=Math.max(g.e.c,p.e.c),g.e.r=Math.max(g.e.r,p.e.r),o==-1&&(o=p.e.r+1,g.e.r=o+t.length-1+r)}else o==-1&&(o=0,g.e.r=t.length-1+r);var y=a.header||[],w=0;t.forEach(function(b,T){En(b).forEach(function(S){(w=y.indexOf(S))==-1&&(y[w=y.length]=S);var E=b[S],C="z",A="",F=bt({c:h+w,r:o+T+r});d=xc(l,F),E&&typeof E=="object"&&!(E instanceof Date)?l[F]=E:(typeof E=="number"?C="n":typeof E=="boolean"?C="b":typeof E=="string"?C="s":E instanceof Date?(C="d",a.cellDates||(C="n",E=qn(E)),A=a.dateNF||Kt[14]):E===null&&a.nullError&&(C="e",E=0),d?(d.t=C,d.v=E,delete d.w,delete d.R,A&&(d.z=A)):l[F]=d={t:C,v:E},A&&(d.z=A))})}),g.e.c=Math.max(g.e.c,h+y.length-1);var _=Nn(o);if(r)for(w=0;w<y.length;++w)l[Mn(w+h)+_]={t:"s",v:y[w]};return l["!ref"]=Qt(g),l}function fR(e,t){return Qw(null,e,t)}function xc(e,t,n){if(typeof t=="string"){if(Array.isArray(e)){var a=dn(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?xc(e,bt(t)):xc(e,bt({r:t,c:n||0}))}function dR(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function xR(){return{SheetNames:[],Sheets:{}}}function gR(e,t,n,a){var r=1;if(!n)for(;r<=65535&&e.SheetNames.indexOf(n="Sheet"+r)!=-1;++r,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(n)>=0){var l=n.match(/(^.*?)(\d+)$/);r=l&&+l[2]||0;var o=l&&l[1]||n;for(++r;r<=65535&&e.SheetNames.indexOf(n=o+r)!=-1;++r);}if(Iw(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function mR(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=dR(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[a].Hidden=n}function pR(e,t){return e.z=t,e}function Zw(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}function yR(e,t,n){return Zw(e,"#"+t,n)}function vR(e,t,n){e.c||(e.c=[]),e.c.push({t,a:n||"SheetJS"})}function bR(e,t,n,a){for(var r=typeof t!="string"?t:Mt(t),l=typeof t=="string"?t:Qt(t),o=r.s.r;o<=r.e.r;++o)for(var h=r.s.c;h<=r.e.c;++h){var f=xc(e,o,h);f.t="n",f.F=l,delete f.v,o==r.s.r&&h==r.s.c&&(f.f=n,a&&(f.D=!0))}return e}var Ud={encode_col:Mn,encode_row:Nn,encode_cell:bt,encode_range:Qt,decode_col:Ux,decode_row:zx,split_cell:RA,decode_cell:dn,decode_range:ca,format_cell:Mr,sheet_add_aoa:Zb,sheet_add_json:Qw,sheet_add_dom:Ww,aoa_to_sheet:pl,json_to_sheet:fR,table_to_sheet:Gw,table_to_book:VM,sheet_to_csv:Jx,sheet_to_txt:$w,sheet_to_json:Uh,sheet_to_html:Kw,sheet_to_formulae:hR,sheet_to_row_object_array:Uh,sheet_get_cell:xc,book_new:xR,book_append_sheet:gR,book_set_sheet_visibility:mR,cell_set_number_format:pR,cell_set_hyperlink:Zw,cell_set_internal_link:yR,cell_add_comment:vR,sheet_set_array_formula:bR,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};ii.register(rc,sc,Zs,Sr,rl,el,$h,qh,Cr);const wR=[{label:"Giới tính",value:"gender"},{label:"Độ tuổi",value:"age"},{label:"Khoảng thời gian",value:"time"},{label:"Trạng thái tạm trú",value:"status"}],_R=()=>{const[e,t]=j.useState("gender"),[n,a]=j.useState("2024-05-01"),[r,l]=j.useState("2024-05-31"),[o,h]=j.useState(null),[f,d]=j.useState(null),[g,p]=j.useState(null),[y,w]=j.useState([]),[_,b]=j.useState(!0),[T,S]=j.useState(null);j.useEffect(()=>{(async()=>{var H;try{b(!0),console.log("🔄 Fetching population data for filter:",e);let M=[];switch(e){case"gender":M=[De("/population/gender"),De("/residents")];break;case"age":M=[De("/population/age"),De("/residents")];break;case"status":M=[De("/population/temporary-status"),De("/residents")];break;case"time":M=[De("/population/overview"),De("/residents")];break;default:M=[De("/population/gender"),De("/residents")]}const[B,I]=await Promise.all(M);console.log("📊 Stats data received:",B),console.log("👥 Residents data received:",I),e==="gender"?h(B):e==="age"?d(B):e==="status"&&p(B),w(((H=I.data)==null?void 0:H.residents)||[]),S(null)}catch(M){console.error("❌ Error fetching population data:",M),S("Lỗi khi tải dữ liệu thống kê nhân khẩu: "+M.message)}finally{b(!1)}})()},[e,n,r]);const E=()=>{if(_)return{chart:c.jsx("div",{className:"text-center",children:"Đang tải dữ liệu..."}),legend:null};if(T)return{chart:c.jsx("div",{className:"text-center text-red-500",children:T}),legend:null};if(e==="gender"&&(o!=null&&o.statistics)){const D=o.statistics.chartData||[],H={labels:D.map(B=>B.label),datasets:[{label:"Số lượng",data:D.map(B=>B.value),backgroundColor:["#2196F3","#F6A6F6"],borderColor:["#2196F3","#F6A6F6"],borderWidth:2}]},M={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},datalabels:{color:"#222",font:{weight:"bold",size:16},formatter:(B,I)=>{const te=I.chart.data.datasets[0].data.reduce((ae,re)=>ae+re,0);return(B/te*100).toFixed(0)+"%"}}}};return{chart:c.jsx(ic,{data:H,options:M,plugins:[Cr]}),legend:c.jsx("div",{className:"flex gap-6 justify-center mt-4",children:D.map((B,I)=>c.jsxs("p",{className:"flex items-center",children:[c.jsx("span",{className:"inline-block w-4 h-4 rounded-full mr-2",style:{backgroundColor:I===0?"#2196F3":"#F6A6F6"}}),B.label,": ",B.value," (",B.percentage,"%)"]},I))})}}if(e==="age"&&(f!=null&&f.statistics)){const D=f.statistics.byAgeGroup||[],H={labels:D.map(I=>I.ageGroup),datasets:[{label:"Số lượng",data:D.map(I=>I.count),backgroundColor:["#B6E36C","#F6F36C","#F6A6F6","#7CC6F6"],borderColor:"#1976D2",borderWidth:1,borderRadius:4}]},M=Math.max(...D.map(I=>I.count))+100,B={responsive:!0,plugins:{legend:{display:!1},datalabels:{anchor:"end",align:"top",clamp:!0,color:"#222",font:{weight:"bold",size:16},formatter:I=>I}},scales:{y:{beginAtZero:!0,max:M,ticks:{stepSize:Math.ceil(M/10)}}}};return{chart:c.jsx(Ox,{data:H,options:B,plugins:[Cr]}),legend:c.jsx("div",{className:"flex flex-wrap gap-4 justify-center mt-4",children:D.map((I,te)=>c.jsxs("p",{children:[c.jsx("span",{className:"inline-block w-3 h-3 mr-2",style:{backgroundColor:["#B6E36C","#F6F36C","#F6A6F6","#7CC6F6"][te]}}),I.ageGroup,": ",I.count]},te))})}}if(e==="status"&&(g!=null&&g.statistics)){const D=g.statistics.chartData||[],H={labels:D.map(M=>M.label),datasets:[{label:"Số lượng",data:D.map(M=>M.value),backgroundColor:["#2196F3","#F6A6F6","#B6E36C"],borderColor:["#2196F3","#F6A6F6","#B6E36C"],borderWidth:2}]};return{chart:c.jsx(ic,{data:H,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},datalabels:{color:"#222",font:{weight:"bold",size:16},formatter:(M,B)=>{const I=B.chart.data.datasets[0].data.reduce((q,ae)=>q+ae,0);return(M/I*100).toFixed(0)+"%"}}}},plugins:[Cr]}),legend:c.jsx("div",{className:"flex gap-6 justify-center mt-4",children:D.map((M,B)=>c.jsxs("p",{className:"flex items-center",children:[c.jsx("span",{className:"inline-block w-4 h-4 rounded-full mr-2",style:{backgroundColor:["#2196F3","#F6A6F6","#B6E36C"][B]}}),M.label,": ",M.value," (",M.percentage,"%)"]},B))})}}return{chart:c.jsx("div",{className:"text-center text-gray-500",children:"Chọn loại thống kê để xem dữ liệu"}),legend:null}},{chart:C,legend:A}=E(),F=y.map((D,H)=>({id:D.id,ten:D.hoTen||"N/A",gioiTinh:D.gioiTinh||"N/A",tuoi:D.ngaySinh?new Date().getFullYear()-new Date(D.ngaySinh).getFullYear():"N/A",trangThai:"Thường trú",hoKhau:`HK${String(H+1).padStart(3,"0")}`})),K=()=>{const D=F.length>0?F:[{ten:"Không có dữ liệu",gioiTinh:"",tuoi:"",trangThai:"",hoKhau:""}],H=Ud.json_to_sheet(D.map(B=>({"Họ tên":B.ten,"Giới tính":B.gioiTinh,Tuổi:B.tuoi,"Trạng thái":B.trangThai,"Hộ khẩu":B.hoKhau}))),M=Ud.book_new();Ud.book_append_sheet(M,H,"Nhân khẩu"),oR(M,"thong_ke_nhan_khau.xlsx")};return c.jsx(On,{role:"totruong",children:c.jsxs("div",{className:"p-4 flex flex-col gap-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"THỐNG KÊ NHÂN KHẨU"}),c.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Thống kê dữ liệu nhân khẩu thực tế từ hệ thống"})]}),c.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[c.jsx("label",{className:"font-semibold text-gray-700",children:"Thống kê theo:"}),c.jsx("select",{className:"border border-gray-300 rounded-md px-3 py-2 text-sm",value:e,onChange:D=>t(D.target.value),children:wR.map(D=>c.jsx("option",{value:D.value,children:D.label},D.value))}),e==="time"&&c.jsxs(c.Fragment,{children:[c.jsx("input",{type:"date",className:"border border-gray-300 rounded-md px-2 py-1 text-sm",value:n,onChange:D=>a(D.target.value)}),c.jsx("span",{children:"-"}),c.jsx("input",{type:"date",className:"border border-gray-300 rounded-md px-2 py-1 text-sm",value:r,onChange:D=>l(D.target.value)})]})]}),c.jsxs("div",{className:"bg-white rounded-md shadow-md border border-gray-200 p-6 flex flex-col items-center",children:[c.jsx("div",{className:"w-full h-80 flex items-center justify-center",children:C}),A]}),c.jsxs("div",{className:"mt-6 bg-white rounded-md shadow-md overflow-hidden border border-gray-200",children:[c.jsxs("div",{className:"p-4 bg-gray-100 border-b border-gray-200 flex items-center justify-between",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-800",children:["Danh sách nhân khẩu (",F.length," người)"]}),c.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded-md font-semibold hover:bg-blue-600 transition",onClick:K,children:"Xuất báo cáo"})]}),c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Họ tên"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Giới tính"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Tuổi"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Trạng thái"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-800 uppercase tracking-wider",children:"Hộ khẩu"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:_?c.jsx("tr",{children:c.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:"Đang tải dữ liệu..."})}):F.length>0?F.slice(0,10).map((D,H)=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:D.ten}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:D.gioiTinh}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:D.tuoi}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:D.trangThai}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:D.hoKhau})]},H)):c.jsx("tr",{children:c.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:"Chưa có dữ liệu nhân khẩu"})})})]}),F.length>10&&c.jsxs("div",{className:"px-6 py-3 bg-gray-50 text-sm text-gray-500 text-center",children:["Hiển thị 10/",F.length," kết quả đầu tiên"]})]})]})})};ii.register(rc,sc,Zs,Sr,rl,el,QC,$h,qh,Cr);const TR=()=>{const[e,t]=j.useState("7days"),[n,a]=j.useState({labels:[],datasets:[]}),[r,l]=j.useState({labels:[],datasets:[]}),[o,h]=j.useState({labels:[],datasets:[]}),[f,d]=j.useState(!0),[g,p]=j.useState(null);j.useEffect(()=>{y()},[]);const y=async()=>{try{d(!0),p(null);const[A,,F,K]=await Promise.all([bn.payment.getStatistics(),bn.dotThu.getStatistics(),bn.khoanThu.getAll(),bn.dotThu.getAllWithKhoanThu({page:0,size:10})]);F&&Array.isArray(F)&&w(F,A),K&&K.dotThus&&_(K.dotThus),b(e,A)}catch(A){console.error("Error fetching statistics:",A),p("Không thể tải dữ liệu thống kê. Sử dụng dữ liệu mẫu."),T()}finally{d(!1)}},w=(A,F)=>{const K=A.slice(0,6).map(M=>M.tenKhoan||M.tenkhoanthu),D=["#8BC34A","#FFEB3B","#E91E63","#2196F3","#FF9800","#9C27B0"],H=K.map((M,B)=>{if(F&&F.paymentMethodBreakdown){const te=F.totalAmount||0;return Math.round(te/K.length/1e6)}return[500,200,150,300,100,80][B]||100});l({labels:K,datasets:[{label:"Theo khoản (triệu VND)",data:H,backgroundColor:D.slice(0,K.length),borderColor:Array(K.length).fill("#ffffff"),borderWidth:1}]})},_=A=>{if(!A||A.length===0){h({labels:["Đợt tháng 06/2025","Đợt tháng 07/2025"],datasets:[{label:"Tỷ lệ đợt thu",data:[60,40],backgroundColor:["#2196F3","#E0E0E0"],borderColor:["#ffffff","#ffffff"],borderWidth:2}]});return}const F=A.slice(0,5).map(H=>H.tenDotThu),K=A.slice(0,5).map((H,M)=>H.thongKe&&H.thongKe.tiLeHoanThanh?Math.round(parseFloat(H.thongKe.tiLeHoanThanh)):[75,60,45,30,20][M]||25);h({labels:F,datasets:[{label:"Tỷ lệ đợt thu (%)",data:K,backgroundColor:["#2196F3","#4CAF50","#FF9800","#E91E63","#9C27B0"].slice(0,F.length),borderColor:Array(F.length).fill("#ffffff"),borderWidth:2}]})},b=(A,F)=>{let K=[],D=[];const H=new Date;switch(A){case"7days":if(K=Array.from({length:7},(M,B)=>{const I=new Date(H);return I.setDate(I.getDate()-(6-B)),I.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit"})}),F&&F.totalAmount){const M=F.totalAmount/30/1e6;D=K.map(()=>Math.round(M*(.5+Math.random()*1.5)))}else D=[430,310,200,150,290,160,380];break;case"30days":if(K=Array.from({length:30},(M,B)=>`Ngày ${B+1}`),F&&F.totalAmount){const M=F.totalAmount/30/1e6;D=K.map(()=>Math.round(M*(.3+Math.random()*1.4)))}else D=Array.from({length:30},()=>Math.floor(Math.random()*500)+50);break;case"90days":if(K=Array.from({length:90},(M,B)=>`Ngày ${B+1}`),F&&F.totalAmount){const M=F.totalAmount/90/1e6;D=K.map(()=>Math.round(M*(.2+Math.random()*1.6)))}else D=Array.from({length:90},()=>Math.floor(Math.random()*400)+30);break;default:K=["Hôm nay"],D=[0]}a({labels:K,datasets:[{label:"Doanh thu (triệu VND)",data:D,borderColor:"#9E9E9E",backgroundColor:"#9E9E9E",tension:.3,pointRadius:A==="90days"?2:5,pointBackgroundColor:"#9E9E9E"}]})},T=()=>{l({labels:["Phí quản lý","Phí gửi xe","Phí điện","Phí nước"],datasets:[{label:"Theo khoản (triệu VND)",data:[550,320,280,180],backgroundColor:["#8BC34A","#FFEB3B","#E91E63","#2196F3"],borderColor:["#ffffff","#ffffff","#ffffff","#ffffff"],borderWidth:1}]}),h({labels:["Thu phí tháng 06/2025","Thu phí tháng 07/2025"],datasets:[{label:"Tỷ lệ đợt thu",data:[65,35],backgroundColor:["#2196F3","#E0E0E0"],borderColor:["#ffffff","#ffffff"],borderWidth:2}]}),b(e,null)};j.useEffect(()=>{f||b(e,null)},[e,f]);const S={responsive:!0,plugins:{legend:{display:!1},title:{display:!0,text:"Doanh thu theo khoản",font:{size:16}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Triệu VND"}}}},E={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"right",align:"center"},datalabels:{color:"#ffffff",formatter:(A,F)=>{const K=F.chart.data.datasets[0].data.reduce((H,M)=>H+M,0);return(A/K*100).toFixed(1)+"%"},font:{weight:"bold"}}},layout:{padding:{left:0,right:16,top:0,bottom:0}}},C={responsive:!0,aspectRatio:5,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(A){let F=A.dataset.label||"";return F&&(F+=": "),A.parsed.y!==null&&(F+=A.parsed.y+" triệu VND"),F}}},datalabels:{display:e!=="90days",color:"#000000",align:"end",anchor:"end",offset:4,formatter:A=>A,font:{weight:"bold",size:12}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Triệu VND"}},x:{title:{display:!0,text:"Ngày"}}},layout:{padding:{top:40,left:0,right:0,bottom:0}}};return c.jsx(On,{role:"ketoan",children:c.jsxs("div",{className:"p-4 flex flex-col gap-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"THỐNG KÊ THU PHÍ"}),c.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Chào mừng đến với Hệ thống Quản lý Thu phí Chung cư"})]}),f&&c.jsxs("div",{className:"flex items-center justify-center py-12",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"}),c.jsx("span",{className:"ml-3 text-gray-600",children:"Đang tải dữ liệu thống kê..."})]}),g&&c.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),c.jsx("div",{className:"ml-3",children:c.jsx("p",{className:"text-sm text-yellow-700",children:g})})]})}),!f&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md shadow-sm overflow-hidden",children:[c.jsx("input",{type:"text",placeholder:"Chọn kiểu",className:"flex-1 p-2 outline-none text-sm"}),c.jsx("button",{className:"p-2 border-l border-gray-300 bg-gray-50 text-gray-600 hover:bg-gray-100",children:"..."})]}),c.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md shadow-sm overflow-hidden flex-1",children:[c.jsx("div",{className:"p-2 text-gray-400",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),c.jsx("input",{type:"text",placeholder:"Search",className:"flex-1 p-2 border-l border-gray-300 outline-none text-sm"})]}),c.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded-md shadow-sm hover:bg-blue-600",onClick:y,children:"Làm mới"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"bg-white rounded-md shadow-md overflow-hidden border border-gray-200 p-4 flex flex-col gap-4",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Theo khoản (triệu VND)"}),c.jsx("div",{className:"h-48 flex items-center justify-center",children:r.labels.length>0?c.jsx(Ox,{data:r,options:S}):c.jsx("div",{className:"text-gray-500",children:"Không có dữ liệu"})})]}),c.jsxs("div",{className:"bg-white rounded-md shadow-md overflow-hidden border border-gray-200 p-4 flex flex-col gap-4",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Theo đợt thu"}),c.jsx("div",{className:"h-48 flex items-center justify-center",children:o.labels.length>0?c.jsx(ic,{data:o,options:E}):c.jsx("div",{className:"text-gray-500",children:"Không có dữ liệu"})})]})]}),c.jsxs("div",{className:"bg-white rounded-md shadow-md overflow-hidden border border-gray-200 p-4 flex flex-col gap-4",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Theo thời gian"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{className:`px-4 py-1 text-sm rounded-full ${e==="7days"?"bg-blue-500 text-white":"border border-gray-300 text-gray-700"}`,onClick:()=>t("7days"),children:"7 ngày"}),c.jsx("button",{className:`px-4 py-1 text-sm rounded-full ${e==="30days"?"bg-blue-500 text-white":"border border-gray-300 text-gray-700"}`,onClick:()=>t("30days"),children:"30 ngày"}),c.jsx("button",{className:`px-4 py-1 text-sm rounded-full ${e==="90days"?"bg-blue-500 text-white":"border border-gray-300 text-gray-700"}`,onClick:()=>t("90days"),children:"90 ngày"})]}),c.jsx("div",{className:"h-64 flex items-center justify-center p-4",children:n.labels.length>0?c.jsx(pk,{data:n,options:C}):c.jsx("div",{className:"text-gray-500",children:"Không có dữ liệu"})})]})]})]})})},wa=({children:e,requiredRoles:t=[]})=>{const n=qs.isAuthenticated(),a=t.length===0||qs.hasRole(t);if(!n)return c.jsx(Ji,{to:"/login",replace:!0});if(!a){const r=qs.getCurrentUser();return(r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="accountant"?c.jsx(Ji,{to:"/homepage-ketoan",replace:!0}):(r==null?void 0:r.role)==="manager"?c.jsx(Ji,{to:"/homepage-totruong",replace:!0}):c.jsx(Ji,{to:"/login",replace:!0})}return c.jsx(c.Fragment,{children:e})};function SR(){const e=()=>"/login";return c.jsx(A4,{basename:"/KTPM_FE",children:c.jsxs(i4,{children:[c.jsx(hn,{path:"/login",element:c.jsx($4,{})}),c.jsx(hn,{path:"/forget-password",element:c.jsx(Q4,{})}),c.jsx(hn,{path:"/test",element:c.jsx("div",{children:"Test Page Works!"})}),c.jsx(hn,{path:"/homepage-ketoan",element:c.jsx(wa,{requiredRoles:["admin","accountant"],children:c.jsx(Pk,{})})}),c.jsx(hn,{path:"/quan-ly-khoan-thu",element:c.jsx(wa,{requiredRoles:["admin","accountant"],children:c.jsx(Qk,{})})}),c.jsx(hn,{path:"/quan-ly-dot-thu-phi",element:c.jsx(wa,{requiredRoles:["admin","accountant"],children:c.jsx(tj,{})})}),c.jsx(hn,{path:"/thong-ke-khoan-thu",element:c.jsx(wa,{requiredRoles:["admin","accountant"],children:c.jsx(TR,{})})}),c.jsx(hn,{path:"/homepage-totruong",element:c.jsx(wa,{requiredRoles:["admin","manager"],children:c.jsx(Ik,{})})}),c.jsx(hn,{path:"/quan-ly-ho-khau",element:c.jsx(wa,{requiredRoles:["admin","manager"],children:c.jsx(Kk,{})})}),c.jsx(hn,{path:"/quan-ly-nhan-khau",element:c.jsx(wa,{requiredRoles:["admin","manager"],children:c.jsx(Yk,{})})}),c.jsx(hn,{path:"/quan-ly-tam-tru",element:c.jsx(wa,{requiredRoles:["admin","manager"],children:c.jsx(aj,{})})}),c.jsx(hn,{path:"/lich-su-thay-doi-nhan-khau",element:c.jsx(wa,{requiredRoles:["admin","manager"],children:c.jsx(ij,{})})}),c.jsx(hn,{path:"/quan-ly-phong",element:c.jsx(wa,{requiredRoles:["admin","manager"],children:c.jsx(Dj,{})})}),c.jsx(hn,{path:"/quan-ly-xe",element:c.jsx(wa,{requiredRoles:["admin","manager"],children:c.jsx(kj,{})})}),c.jsx(hn,{path:"/thong-ke-nhan-khau",element:c.jsx(wa,{requiredRoles:["admin","manager"],children:c.jsx(_R,{})})}),c.jsx(hn,{path:"/",element:c.jsx(Ji,{to:e(),replace:!0})}),c.jsx(hn,{path:"*",element:c.jsx(Ji,{to:e(),replace:!0})})]})})}gS.createRoot(document.getElementById("root")).render(c.jsx(j.StrictMode,{children:c.jsx(SR,{})}));
